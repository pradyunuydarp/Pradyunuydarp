(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function nB(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var f1={exports:{}},Rg={},d1={exports:{}},xn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nR;function r5(){if(nR)return xn;nR=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),h=Symbol.iterator;function d(U){return U===null||typeof U!="object"?null:(U=h&&U[h]||U["@@iterator"],typeof U=="function"?U:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,x={};function _(U,X,le){this.props=U,this.context=X,this.refs=x,this.updater=le||m}_.prototype.isReactComponent={},_.prototype.setState=function(U,X){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,X,"setState")},_.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function S(){}S.prototype=_.prototype;function T(U,X,le){this.props=U,this.context=X,this.refs=x,this.updater=le||m}var E=T.prototype=new S;E.constructor=T,g(E,_.prototype),E.isPureReactComponent=!0;var C=Array.isArray,R=Object.prototype.hasOwnProperty,P={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function F(U,X,le){var Z,oe={},pe=null,de=null;if(X!=null)for(Z in X.ref!==void 0&&(de=X.ref),X.key!==void 0&&(pe=""+X.key),X)R.call(X,Z)&&!L.hasOwnProperty(Z)&&(oe[Z]=X[Z]);var ye=arguments.length-2;if(ye===1)oe.children=le;else if(1<ye){for(var Ge=Array(ye),Ke=0;Ke<ye;Ke++)Ge[Ke]=arguments[Ke+2];oe.children=Ge}if(U&&U.defaultProps)for(Z in ye=U.defaultProps,ye)oe[Z]===void 0&&(oe[Z]=ye[Z]);return{$$typeof:r,type:U,key:pe,ref:de,props:oe,_owner:P.current}}function D(U,X){return{$$typeof:r,type:U.type,key:X,ref:U.ref,props:U.props,_owner:U._owner}}function I(U){return typeof U=="object"&&U!==null&&U.$$typeof===r}function N(U){var X={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(le){return X[le]})}var V=/\/+/g;function q(U,X){return typeof U=="object"&&U!==null&&U.key!=null?N(""+U.key):X.toString(36)}function Q(U,X,le,Z,oe){var pe=typeof U;(pe==="undefined"||pe==="boolean")&&(U=null);var de=!1;if(U===null)de=!0;else switch(pe){case"string":case"number":de=!0;break;case"object":switch(U.$$typeof){case r:case e:de=!0}}if(de)return de=U,oe=oe(de),U=Z===""?"."+q(de,0):Z,C(oe)?(le="",U!=null&&(le=U.replace(V,"$&/")+"/"),Q(oe,X,le,"",function(Ke){return Ke})):oe!=null&&(I(oe)&&(oe=D(oe,le+(!oe.key||de&&de.key===oe.key?"":(""+oe.key).replace(V,"$&/")+"/")+U)),X.push(oe)),1;if(de=0,Z=Z===""?".":Z+":",C(U))for(var ye=0;ye<U.length;ye++){pe=U[ye];var Ge=Z+q(pe,ye);de+=Q(pe,X,le,Ge,oe)}else if(Ge=d(U),typeof Ge=="function")for(U=Ge.call(U),ye=0;!(pe=U.next()).done;)pe=pe.value,Ge=Z+q(pe,ye++),de+=Q(pe,X,le,Ge,oe);else if(pe==="object")throw X=String(U),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.");return de}function re(U,X,le){if(U==null)return U;var Z=[],oe=0;return Q(U,Z,"","",function(pe){return X.call(le,pe,oe++)}),Z}function ee(U){if(U._status===-1){var X=U._result;X=X(),X.then(function(le){(U._status===0||U._status===-1)&&(U._status=1,U._result=le)},function(le){(U._status===0||U._status===-1)&&(U._status=2,U._result=le)}),U._status===-1&&(U._status=0,U._result=X)}if(U._status===1)return U._result.default;throw U._result}var se={current:null},W={transition:null},$={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:W,ReactCurrentOwner:P};function j(){throw Error("act(...) is not supported in production builds of React.")}return xn.Children={map:re,forEach:function(U,X,le){re(U,function(){X.apply(this,arguments)},le)},count:function(U){var X=0;return re(U,function(){X++}),X},toArray:function(U){return re(U,function(X){return X})||[]},only:function(U){if(!I(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},xn.Component=_,xn.Fragment=t,xn.Profiler=i,xn.PureComponent=T,xn.StrictMode=n,xn.Suspense=l,xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,xn.act=j,xn.cloneElement=function(U,X,le){if(U==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var Z=g({},U.props),oe=U.key,pe=U.ref,de=U._owner;if(X!=null){if(X.ref!==void 0&&(pe=X.ref,de=P.current),X.key!==void 0&&(oe=""+X.key),U.type&&U.type.defaultProps)var ye=U.type.defaultProps;for(Ge in X)R.call(X,Ge)&&!L.hasOwnProperty(Ge)&&(Z[Ge]=X[Ge]===void 0&&ye!==void 0?ye[Ge]:X[Ge])}var Ge=arguments.length-2;if(Ge===1)Z.children=le;else if(1<Ge){ye=Array(Ge);for(var Ke=0;Ke<Ge;Ke++)ye[Ke]=arguments[Ke+2];Z.children=ye}return{$$typeof:r,type:U.type,key:oe,ref:pe,props:Z,_owner:de}},xn.createContext=function(U){return U={$$typeof:o,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:s,_context:U},U.Consumer=U},xn.createElement=F,xn.createFactory=function(U){var X=F.bind(null,U);return X.type=U,X},xn.createRef=function(){return{current:null}},xn.forwardRef=function(U){return{$$typeof:a,render:U}},xn.isValidElement=I,xn.lazy=function(U){return{$$typeof:c,_payload:{_status:-1,_result:U},_init:ee}},xn.memo=function(U,X){return{$$typeof:u,type:U,compare:X===void 0?null:X}},xn.startTransition=function(U){var X=W.transition;W.transition={};try{U()}finally{W.transition=X}},xn.unstable_act=j,xn.useCallback=function(U,X){return se.current.useCallback(U,X)},xn.useContext=function(U){return se.current.useContext(U)},xn.useDebugValue=function(){},xn.useDeferredValue=function(U){return se.current.useDeferredValue(U)},xn.useEffect=function(U,X){return se.current.useEffect(U,X)},xn.useId=function(){return se.current.useId()},xn.useImperativeHandle=function(U,X,le){return se.current.useImperativeHandle(U,X,le)},xn.useInsertionEffect=function(U,X){return se.current.useInsertionEffect(U,X)},xn.useLayoutEffect=function(U,X){return se.current.useLayoutEffect(U,X)},xn.useMemo=function(U,X){return se.current.useMemo(U,X)},xn.useReducer=function(U,X,le){return se.current.useReducer(U,X,le)},xn.useRef=function(U){return se.current.useRef(U)},xn.useState=function(U){return se.current.useState(U)},xn.useSyncExternalStore=function(U,X,le){return se.current.useSyncExternalStore(U,X,le)},xn.useTransition=function(){return se.current.useTransition()},xn.version="18.3.1",xn}var iR;function BS(){return iR||(iR=1,d1.exports=r5()),d1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rR;function s5(){if(rR)return Rg;rR=1;var r=BS(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var c,h={},d=null,m=null;u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(m=l.ref);for(c in l)n.call(l,c)&&!s.hasOwnProperty(c)&&(h[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:e,type:a,key:d,ref:m,props:h,_owner:i.current}}return Rg.Fragment=t,Rg.jsx=o,Rg.jsxs=o,Rg}var sR;function o5(){return sR||(sR=1,f1.exports=s5()),f1.exports}var J=o5(),ne=BS();const Vu=nB(ne);var Py={},p1={exports:{}},eo={},m1={exports:{}},g1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oR;function a5(){return oR||(oR=1,function(r){function e(W,$){var j=W.length;W.push($);e:for(;0<j;){var U=j-1>>>1,X=W[U];if(0<i(X,$))W[U]=$,W[j]=X,j=U;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var $=W[0],j=W.pop();if(j!==$){W[0]=j;e:for(var U=0,X=W.length,le=X>>>1;U<le;){var Z=2*(U+1)-1,oe=W[Z],pe=Z+1,de=W[pe];if(0>i(oe,j))pe<X&&0>i(de,oe)?(W[U]=de,W[pe]=j,U=pe):(W[U]=oe,W[Z]=j,U=Z);else if(pe<X&&0>i(de,j))W[U]=de,W[pe]=j,U=pe;else break e}}return $}function i(W,$){var j=W.sortIndex-$.sortIndex;return j!==0?j:W.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,m=!1,g=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var $=t(u);$!==null;){if($.callback===null)n(u);else if($.startTime<=W)n(u),$.sortIndex=$.expirationTime,e(l,$);else break;$=t(u)}}function C(W){if(x=!1,E(W),!g)if(t(l)!==null)g=!0,ee(R);else{var $=t(u);$!==null&&se(C,$.startTime-W)}}function R(W,$){g=!1,x&&(x=!1,S(F),F=-1),m=!0;var j=d;try{for(E($),h=t(l);h!==null&&(!(h.expirationTime>$)||W&&!N());){var U=h.callback;if(typeof U=="function"){h.callback=null,d=h.priorityLevel;var X=U(h.expirationTime<=$);$=r.unstable_now(),typeof X=="function"?h.callback=X:h===t(l)&&n(l),E($)}else n(l);h=t(l)}if(h!==null)var le=!0;else{var Z=t(u);Z!==null&&se(C,Z.startTime-$),le=!1}return le}finally{h=null,d=j,m=!1}}var P=!1,L=null,F=-1,D=5,I=-1;function N(){return!(r.unstable_now()-I<D)}function V(){if(L!==null){var W=r.unstable_now();I=W;var $=!0;try{$=L(!0,W)}finally{$?q():(P=!1,L=null)}}else P=!1}var q;if(typeof T=="function")q=function(){T(V)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,re=Q.port2;Q.port1.onmessage=V,q=function(){re.postMessage(null)}}else q=function(){_(V,0)};function ee(W){L=W,P||(P=!0,q())}function se(W,$){F=_(function(){W(r.unstable_now())},$)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(W){W.callback=null},r.unstable_continueExecution=function(){g||m||(g=!0,ee(R))},r.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},r.unstable_getCurrentPriorityLevel=function(){return d},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(W){switch(d){case 1:case 2:case 3:var $=3;break;default:$=d}var j=d;d=$;try{return W()}finally{d=j}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(W,$){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var j=d;d=W;try{return $()}finally{d=j}},r.unstable_scheduleCallback=function(W,$,j){var U=r.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?U+j:U):j=U,W){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=j+X,W={id:c++,callback:$,priorityLevel:W,startTime:j,expirationTime:X,sortIndex:-1},j>U?(W.sortIndex=j,e(u,W),t(l)===null&&W===t(u)&&(x?(S(F),F=-1):x=!0,se(C,j-U))):(W.sortIndex=X,e(l,W),g||m||(g=!0,ee(R))),W},r.unstable_shouldYield=N,r.unstable_wrapCallback=function(W){var $=d;return function(){var j=d;d=$;try{return W.apply(this,arguments)}finally{d=j}}}}(g1)),g1}var aR;function l5(){return aR||(aR=1,m1.exports=a5()),m1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lR;function u5(){if(lR)return eo;lR=1;var r=BS(),e=l5();function t(f){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+f,A=1;A<arguments.length;A++)p+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(f,p){o(f,p),o(f+"Capture",p)}function o(f,p){for(i[f]=p,f=0;f<p.length;f++)n.add(p[f])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},h={};function d(f){return l.call(h,f)?!0:l.call(c,f)?!1:u.test(f)?h[f]=!0:(c[f]=!0,!1)}function m(f,p,A,w){if(A!==null&&A.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return w?!1:A!==null?!A.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function g(f,p,A,w){if(p===null||typeof p>"u"||m(f,p,A,w))return!0;if(w)return!1;if(A!==null)switch(A.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function x(f,p,A,w,B,O,Y){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=w,this.attributeNamespace=B,this.mustUseProperty=A,this.propertyName=f,this.type=p,this.sanitizeURL=O,this.removeEmptyString=Y}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){_[f]=new x(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var p=f[0];_[p]=new x(p,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){_[f]=new x(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){_[f]=new x(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){_[f]=new x(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){_[f]=new x(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){_[f]=new x(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){_[f]=new x(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){_[f]=new x(f,5,!1,f.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function T(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var p=f.replace(S,T);_[p]=new x(p,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var p=f.replace(S,T);_[p]=new x(p,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var p=f.replace(S,T);_[p]=new x(p,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){_[f]=new x(f,1,!1,f.toLowerCase(),null,!1,!1)}),_.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){_[f]=new x(f,1,!1,f.toLowerCase(),null,!0,!0)});function E(f,p,A,w){var B=_.hasOwnProperty(p)?_[p]:null;(B!==null?B.type!==0:w||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(g(p,A,B,w)&&(A=null),w||B===null?d(p)&&(A===null?f.removeAttribute(p):f.setAttribute(p,""+A)):B.mustUseProperty?f[B.propertyName]=A===null?B.type===3?!1:"":A:(p=B.attributeName,w=B.attributeNamespace,A===null?f.removeAttribute(p):(B=B.type,A=B===3||B===4&&A===!0?"":""+A,w?f.setAttributeNS(w,p,A):f.setAttribute(p,A))))}var C=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),P=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),N=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),W=Symbol.iterator;function $(f){return f===null||typeof f!="object"?null:(f=W&&f[W]||f["@@iterator"],typeof f=="function"?f:null)}var j=Object.assign,U;function X(f){if(U===void 0)try{throw Error()}catch(A){var p=A.stack.trim().match(/\n( *(at )?)/);U=p&&p[1]||""}return`
`+U+f}var le=!1;function Z(f,p){if(!f||le)return"";le=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Ve){var w=Ve}Reflect.construct(f,[],p)}else{try{p.call()}catch(Ve){w=Ve}f.call(p.prototype)}else{try{throw Error()}catch(Ve){w=Ve}f()}}catch(Ve){if(Ve&&w&&typeof Ve.stack=="string"){for(var B=Ve.stack.split(`
`),O=w.stack.split(`
`),Y=B.length-1,he=O.length-1;1<=Y&&0<=he&&B[Y]!==O[he];)he--;for(;1<=Y&&0<=he;Y--,he--)if(B[Y]!==O[he]){if(Y!==1||he!==1)do if(Y--,he--,0>he||B[Y]!==O[he]){var ge=`
`+B[Y].replace(" at new "," at ");return f.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",f.displayName)),ge}while(1<=Y&&0<=he);break}}}finally{le=!1,Error.prepareStackTrace=A}return(f=f?f.displayName||f.name:"")?X(f):""}function oe(f){switch(f.tag){case 5:return X(f.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 2:case 15:return f=Z(f.type,!1),f;case 11:return f=Z(f.type.render,!1),f;case 1:return f=Z(f.type,!0),f;default:return""}}function pe(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case L:return"Fragment";case P:return"Portal";case D:return"Profiler";case F:return"StrictMode";case q:return"Suspense";case Q:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case N:return(f.displayName||"Context")+".Consumer";case I:return(f._context.displayName||"Context")+".Provider";case V:var p=f.render;return f=f.displayName,f||(f=p.displayName||p.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case re:return p=f.displayName||null,p!==null?p:pe(f.type)||"Memo";case ee:p=f._payload,f=f._init;try{return pe(f(p))}catch{}}return null}function de(f){var p=f.type;switch(f.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=p.render,f=f.displayName||f.name||"",p.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(p);case 8:return p===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function ye(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function Ge(f){var p=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function Ke(f){var p=Ge(f)?"checked":"value",A=Object.getOwnPropertyDescriptor(f.constructor.prototype,p),w=""+f[p];if(!f.hasOwnProperty(p)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var B=A.get,O=A.set;return Object.defineProperty(f,p,{configurable:!0,get:function(){return B.call(this)},set:function(Y){w=""+Y,O.call(this,Y)}}),Object.defineProperty(f,p,{enumerable:A.enumerable}),{getValue:function(){return w},setValue:function(Y){w=""+Y},stopTracking:function(){f._valueTracker=null,delete f[p]}}}}function De(f){f._valueTracker||(f._valueTracker=Ke(f))}function K(f){if(!f)return!1;var p=f._valueTracker;if(!p)return!0;var A=p.getValue(),w="";return f&&(w=Ge(f)?f.checked?"true":"false":f.value),f=w,f!==A?(p.setValue(f),!0):!1}function Pe(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Be(f,p){var A=p.checked;return j({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:A??f._wrapperState.initialChecked})}function Xe(f,p){var A=p.defaultValue==null?"":p.defaultValue,w=p.checked!=null?p.checked:p.defaultChecked;A=ye(p.value!=null?p.value:A),f._wrapperState={initialChecked:w,initialValue:A,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function ve(f,p){p=p.checked,p!=null&&E(f,"checked",p,!1)}function et(f,p){ve(f,p);var A=ye(p.value),w=p.type;if(A!=null)w==="number"?(A===0&&f.value===""||f.value!=A)&&(f.value=""+A):f.value!==""+A&&(f.value=""+A);else if(w==="submit"||w==="reset"){f.removeAttribute("value");return}p.hasOwnProperty("value")?We(f,p.type,A):p.hasOwnProperty("defaultValue")&&We(f,p.type,ye(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(f.defaultChecked=!!p.defaultChecked)}function Ce(f,p,A){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var w=p.type;if(!(w!=="submit"&&w!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+f._wrapperState.initialValue,A||p===f.value||(f.value=p),f.defaultValue=p}A=f.name,A!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,A!==""&&(f.name=A)}function We(f,p,A){(p!=="number"||Pe(f.ownerDocument)!==f)&&(A==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+A&&(f.defaultValue=""+A))}var te=Array.isArray;function z(f,p,A,w){if(f=f.options,p){p={};for(var B=0;B<A.length;B++)p["$"+A[B]]=!0;for(A=0;A<f.length;A++)B=p.hasOwnProperty("$"+f[A].value),f[A].selected!==B&&(f[A].selected=B),B&&w&&(f[A].defaultSelected=!0)}else{for(A=""+ye(A),p=null,B=0;B<f.length;B++){if(f[B].value===A){f[B].selected=!0,w&&(f[B].defaultSelected=!0);return}p!==null||f[B].disabled||(p=f[B])}p!==null&&(p.selected=!0)}}function me(f,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return j({},p,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function _e(f,p){var A=p.value;if(A==null){if(A=p.children,p=p.defaultValue,A!=null){if(p!=null)throw Error(t(92));if(te(A)){if(1<A.length)throw Error(t(93));A=A[0]}p=A}p==null&&(p=""),A=p}f._wrapperState={initialValue:ye(A)}}function Ee(f,p){var A=ye(p.value),w=ye(p.defaultValue);A!=null&&(A=""+A,A!==f.value&&(f.value=A),p.defaultValue==null&&f.defaultValue!==A&&(f.defaultValue=A)),w!=null&&(f.defaultValue=""+w)}function we(f){var p=f.textContent;p===f._wrapperState.initialValue&&p!==""&&p!==null&&(f.value=p)}function ut(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ke(f,p){return f==null||f==="http://www.w3.org/1999/xhtml"?ut(p):f==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Ze,lt=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,A,w,B){MSApp.execUnsafeLocalFunction(function(){return f(p,A,w,B)})}:f}(function(f,p){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=p;else{for(Ze=Ze||document.createElement("div"),Ze.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=Ze.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;p.firstChild;)f.appendChild(p.firstChild)}});function Ye(f,p){if(p){var A=f.firstChild;if(A&&A===f.lastChild&&A.nodeType===3){A.nodeValue=p;return}}f.textContent=p}var nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ct=["Webkit","ms","Moz","O"];Object.keys(nt).forEach(function(f){Ct.forEach(function(p){p=p+f.charAt(0).toUpperCase()+f.substring(1),nt[p]=nt[f]})});function ht(f,p,A){return p==null||typeof p=="boolean"||p===""?"":A||typeof p!="number"||p===0||nt.hasOwnProperty(f)&&nt[f]?(""+p).trim():p+"px"}function it(f,p){f=f.style;for(var A in p)if(p.hasOwnProperty(A)){var w=A.indexOf("--")===0,B=ht(A,p[A],w);A==="float"&&(A="cssFloat"),w?f.setProperty(A,B):f[A]=B}}var rt=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fe(f,p){if(p){if(rt[f]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,f));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function Je(f,p){if(f.indexOf("-")===-1)return typeof p.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ce=null;function He(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Te=null,Oe=null,st=null;function xt(f){if(f=Ra(f)){if(typeof Te!="function")throw Error(t(280));var p=f.stateNode;p&&(p=zd(p),Te(f.stateNode,f.type,p))}}function _t(f){Oe?st?st.push(f):st=[f]:Oe=f}function Ht(){if(Oe){var f=Oe,p=st;if(st=Oe=null,xt(f),p)for(f=0;f<p.length;f++)xt(p[f])}}function zt(f,p){return f(p)}function gt(){}var Qt=!1;function vn(f,p,A){if(Qt)return f(p,A);Qt=!0;try{return zt(f,p,A)}finally{Qt=!1,(Oe!==null||st!==null)&&(gt(),Ht())}}function Dn(f,p){var A=f.stateNode;if(A===null)return null;var w=zd(A);if(w===null)return null;A=w[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(f=f.type,w=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!w;break e;default:f=!1}if(f)return null;if(A&&typeof A!="function")throw Error(t(231,p,typeof A));return A}var In=!1;if(a)try{var xi={};Object.defineProperty(xi,"passive",{get:function(){In=!0}}),window.addEventListener("test",xi,xi),window.removeEventListener("test",xi,xi)}catch{In=!1}function ns(f,p,A,w,B,O,Y,he,ge){var Ve=Array.prototype.slice.call(arguments,3);try{p.apply(A,Ve)}catch(at){this.onError(at)}}var Ri=!1,Ji=null,Gi=!1,qi=null,Ii={onError:function(f){Ri=!0,Ji=f}};function Hs(f,p,A,w,B,O,Y,he,ge){Ri=!1,Ji=null,ns.apply(Ii,arguments)}function uc(f,p,A,w,B,O,Y,he,ge){if(Hs.apply(this,arguments),Ri){if(Ri){var Ve=Ji;Ri=!1,Ji=null}else throw Error(t(198));Gi||(Gi=!0,qi=Ve)}}function Ss(f){var p=f,A=f;if(f.alternate)for(;p.return;)p=p.return;else{f=p;do p=f,(p.flags&4098)!==0&&(A=p.return),f=p.return;while(f)}return p.tag===3?A:null}function cc(f){if(f.tag===13){var p=f.memoizedState;if(p===null&&(f=f.alternate,f!==null&&(p=f.memoizedState)),p!==null)return p.dehydrated}return null}function ie(f){if(Ss(f)!==f)throw Error(t(188))}function Ae(f){var p=f.alternate;if(!p){if(p=Ss(f),p===null)throw Error(t(188));return p!==f?null:f}for(var A=f,w=p;;){var B=A.return;if(B===null)break;var O=B.alternate;if(O===null){if(w=B.return,w!==null){A=w;continue}break}if(B.child===O.child){for(O=B.child;O;){if(O===A)return ie(B),f;if(O===w)return ie(B),p;O=O.sibling}throw Error(t(188))}if(A.return!==w.return)A=B,w=O;else{for(var Y=!1,he=B.child;he;){if(he===A){Y=!0,A=B,w=O;break}if(he===w){Y=!0,w=B,A=O;break}he=he.sibling}if(!Y){for(he=O.child;he;){if(he===A){Y=!0,A=O,w=B;break}if(he===w){Y=!0,w=O,A=B;break}he=he.sibling}if(!Y)throw Error(t(189))}}if(A.alternate!==w)throw Error(t(190))}if(A.tag!==3)throw Error(t(188));return A.stateNode.current===A?f:p}function Ue(f){return f=Ae(f),f!==null?ze(f):null}function ze(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var p=ze(f);if(p!==null)return p;f=f.sibling}return null}var be=e.unstable_scheduleCallback,ft=e.unstable_cancelCallback,At=e.unstable_shouldYield,Rt=e.unstable_requestPaint,je=e.unstable_now,Ot=e.unstable_getCurrentPriorityLevel,Vt=e.unstable_ImmediatePriority,Pt=e.unstable_UserBlockingPriority,un=e.unstable_NormalPriority,Un=e.unstable_LowPriority,En=e.unstable_IdlePriority,Bn=null,wt=null;function mt(f){if(wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(Bn,f,void 0,(f.current.flags&128)===128)}catch{}}var on=Math.clz32?Math.clz32:fr,Kt=Math.log,Fn=Math.LN2;function fr(f){return f>>>=0,f===0?32:31-(Kt(f)/Fn|0)|0}var Nn=64,qn=4194304;function yn(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Qi(f,p){var A=f.pendingLanes;if(A===0)return 0;var w=0,B=f.suspendedLanes,O=f.pingedLanes,Y=A&268435455;if(Y!==0){var he=Y&~B;he!==0?w=yn(he):(O&=Y,O!==0&&(w=yn(O)))}else Y=A&~B,Y!==0?w=yn(Y):O!==0&&(w=yn(O));if(w===0)return 0;if(p!==0&&p!==w&&(p&B)===0&&(B=w&-w,O=p&-p,B>=O||B===16&&(O&4194240)!==0))return p;if((w&4)!==0&&(w|=A&16),p=f.entangledLanes,p!==0)for(f=f.entanglements,p&=w;0<p;)A=31-on(p),B=1<<A,w|=f[A],p&=~B;return w}function jo(f,p){switch(f){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _i(f,p){for(var A=f.suspendedLanes,w=f.pingedLanes,B=f.expirationTimes,O=f.pendingLanes;0<O;){var Y=31-on(O),he=1<<Y,ge=B[Y];ge===-1?((he&A)===0||(he&w)!==0)&&(B[Y]=jo(he,p)):ge<=p&&(f.expiredLanes|=he),O&=~he}}function Hi(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Cr(){var f=Nn;return Nn<<=1,(Nn&4194240)===0&&(Nn=64),f}function fo(f){for(var p=[],A=0;31>A;A++)p.push(f);return p}function po(f,p,A){f.pendingLanes|=p,p!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,p=31-on(p),f[p]=A}function gd(f,p){var A=f.pendingLanes&~p;f.pendingLanes=p,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=p,f.mutableReadLanes&=p,f.entangledLanes&=p,p=f.entanglements;var w=f.eventTimes;for(f=f.expirationTimes;0<A;){var B=31-on(A),O=1<<B;p[B]=0,w[B]=-1,f[B]=-1,A&=~O}}function mo(f,p){var A=f.entangledLanes|=p;for(f=f.entanglements;A;){var w=31-on(A),B=1<<w;B&p|f[w]&p&&(f[w]|=p),A&=~B}}var mn=0;function Ko(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var ol,hc,fc,$o,Yl,zs=!1,go=[],dr=null,Zt=null,Vs=null,As=new Map,Xo=new Map,Ws=[],vd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ti(f,p){switch(f){case"focusin":case"focusout":dr=null;break;case"dragenter":case"dragleave":Zt=null;break;case"mouseover":case"mouseout":Vs=null;break;case"pointerover":case"pointerout":As.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(p.pointerId)}}function vo(f,p,A,w,B,O){return f===null||f.nativeEvent!==O?(f={blockedOn:p,domEventName:A,eventSystemFlags:w,nativeEvent:O,targetContainers:[B]},p!==null&&(p=Ra(p),p!==null&&hc(p)),f):(f.eventSystemFlags|=w,p=f.targetContainers,B!==null&&p.indexOf(B)===-1&&p.push(B),f)}function yd(f,p,A,w,B){switch(p){case"focusin":return dr=vo(dr,f,p,A,w,B),!0;case"dragenter":return Zt=vo(Zt,f,p,A,w,B),!0;case"mouseover":return Vs=vo(Vs,f,p,A,w,B),!0;case"pointerover":var O=B.pointerId;return As.set(O,vo(As.get(O)||null,f,p,A,w,B)),!0;case"gotpointercapture":return O=B.pointerId,Xo.set(O,vo(Xo.get(O)||null,f,p,A,w,B)),!0}return!1}function br(f){var p=yl(f.target);if(p!==null){var A=Ss(p);if(A!==null){if(p=A.tag,p===13){if(p=cc(A),p!==null){f.blockedOn=p,Yl(f.priority,function(){fc(A)});return}}else if(p===3&&A.stateNode.current.memoizedState.isDehydrated){f.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}f.blockedOn=null}function al(f){if(f.blockedOn!==null)return!1;for(var p=f.targetContainers;0<p.length;){var A=Rr(f.domEventName,f.eventSystemFlags,p[0],f.nativeEvent);if(A===null){A=f.nativeEvent;var w=new A.constructor(A.type,A);ce=w,A.target.dispatchEvent(w),ce=null}else return p=Ra(A),p!==null&&hc(p),f.blockedOn=A,!1;p.shift()}return!0}function ll(f,p,A){al(f)&&A.delete(p)}function Es(){zs=!1,dr!==null&&al(dr)&&(dr=null),Zt!==null&&al(Zt)&&(Zt=null),Vs!==null&&al(Vs)&&(Vs=null),As.forEach(ll),Xo.forEach(ll)}function ya(f,p){f.blockedOn===p&&(f.blockedOn=null,zs||(zs=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Es)))}function ul(f){function p(B){return ya(B,f)}if(0<go.length){ya(go[0],f);for(var A=1;A<go.length;A++){var w=go[A];w.blockedOn===f&&(w.blockedOn=null)}}for(dr!==null&&ya(dr,f),Zt!==null&&ya(Zt,f),Vs!==null&&ya(Vs,f),As.forEach(p),Xo.forEach(p),A=0;A<Ws.length;A++)w=Ws[A],w.blockedOn===f&&(w.blockedOn=null);for(;0<Ws.length&&(A=Ws[0],A.blockedOn===null);)br(A),A.blockedOn===null&&Ws.shift()}var Zi=C.ReactCurrentBatchConfig,er=!0;function Yo(f,p,A,w){var B=mn,O=Zi.transition;Zi.transition=null;try{mn=1,Jl(f,p,A,w)}finally{mn=B,Zi.transition=O}}function js(f,p,A,w){var B=mn,O=Zi.transition;Zi.transition=null;try{mn=4,Jl(f,p,A,w)}finally{mn=B,Zi.transition=O}}function Jl(f,p,A,w){if(er){var B=Rr(f,p,A,w);if(B===null)kd(f,p,w,cl,A),ti(f,w);else if(yd(B,f,p,A,w))w.stopPropagation();else if(ti(f,w),p&4&&-1<vd.indexOf(f)){for(;B!==null;){var O=Ra(B);if(O!==null&&ol(O),O=Rr(f,p,A,w),O===null&&kd(f,p,w,cl,A),O===B)break;B=O}B!==null&&w.stopPropagation()}else kd(f,p,w,null,A)}}var cl=null;function Rr(f,p,A,w){if(cl=null,f=He(w),f=yl(f),f!==null)if(p=Ss(f),p===null)f=null;else if(A=p.tag,A===13){if(f=cc(p),f!==null)return f;f=null}else if(A===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;f=null}else p!==f&&(f=null);return cl=f,null}function hl(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ot()){case Vt:return 1;case Pt:return 4;case un:case Un:return 16;case En:return 536870912;default:return 16}default:return 16}}var is=null,xa=null,tr=null;function zi(){if(tr)return tr;var f,p=xa,A=p.length,w,B="value"in is?is.value:is.textContent,O=B.length;for(f=0;f<A&&p[f]===B[f];f++);var Y=A-f;for(w=1;w<=Y&&p[A-w]===B[O-w];w++);return tr=B.slice(f,1<w?1-w:void 0)}function _a(f){var p=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&p===13&&(f=13)):f=p,f===10&&(f=13),32<=f||f===13?f:0}function rs(){return!0}function Sa(){return!1}function nr(f){function p(A,w,B,O,Y){this._reactName=A,this._targetInst=B,this.type=w,this.nativeEvent=O,this.target=Y,this.currentTarget=null;for(var he in f)f.hasOwnProperty(he)&&(A=f[he],this[he]=A?A(O):O[he]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?rs:Sa,this.isPropagationStopped=Sa,this}return j(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=rs)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=rs)},persist:function(){},isPersistent:rs}),p}var Aa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Li=nr(Aa),Vi=j({},Aa,{view:0,detail:0}),Si=nr(Vi),oi,Hr,Ks,dc=j({},Vi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dl,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Ks&&(Ks&&f.type==="mousemove"?(oi=f.screenX-Ks.screenX,Hr=f.screenY-Ks.screenY):Hr=oi=0,Ks=f),oi)},movementY:function(f){return"movementY"in f?f.movementY:Hr}}),Um=nr(dc),Ea=j({},dc,{dataTransfer:0}),fl=nr(Ea),xd=j({},Vi,{relatedTarget:0}),_d=nr(xd),Sd=j({},Aa,{animationName:0,elapsedTime:0,pseudoElement:0}),zv=nr(Sd),Vv=j({},Aa,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),Nm=nr(Vv),Ad=j({},Aa,{data:0}),Gm=nr(Ad),Wv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pc(f){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(f):(f=Hm[f])?!!p[f]:!1}function dl(){return pc}var Ed=j({},Vi,{key:function(f){if(f.key){var p=Wv[f.key]||f.key;if(p!=="Unidentified")return p}return f.type==="keypress"?(f=_a(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?jv[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dl,charCode:function(f){return f.type==="keypress"?_a(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?_a(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),Td=nr(Ed),$s=j({},dc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ts=nr($s),ql=j({},Vi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dl}),Ta=nr(ql),Ma=j({},Aa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ql=nr(Ma),Kv=j({},dc,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),zm=nr(Kv),Vm=[9,13,27,32],zr=a&&"CompositionEvent"in window,pr=null;a&&"documentMode"in document&&(pr=document.documentMode);var ni=a&&"TextEvent"in window&&!pr,mc=a&&(!zr||pr&&8<pr&&11>=pr),Xs=" ",Wm=!1;function jm(f,p){switch(f){case"keyup":return Vm.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Md(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var pl=!1;function $v(f,p){switch(f){case"compositionend":return Md(p);case"keypress":return p.which!==32?null:(Wm=!0,Xs);case"textInput":return f=p.data,f===Xs&&Wm?null:f;default:return null}}function Eh(f,p){if(pl)return f==="compositionend"||!zr&&jm(f,p)?(f=zi(),tr=xa=is=null,pl=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return mc&&p.locale!=="ko"?null:p.data;default:return null}}var gc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wd(f){var p=f&&f.nodeName&&f.nodeName.toLowerCase();return p==="input"?!!gc[f.type]:p==="textarea"}function vc(f,p,A,w){_t(w),p=Od(p,"onChange"),0<p.length&&(A=new Li("onChange","change",null,A,w),f.push({event:A,listeners:p}))}var ml=null,yc=null;function Xv(f){Ac(f,0)}function wa(f){var p=Ai(f);if(K(p))return f}function Yv(f,p){if(f==="change")return p}var xc=!1;if(a){var ss;if(a){var Zl="oninput"in document;if(!Zl){var eu=document.createElement("div");eu.setAttribute("oninput","return;"),Zl=typeof eu.oninput=="function"}ss=Zl}else ss=!1;xc=ss&&(!document.documentMode||9<document.documentMode)}function yo(){ml&&(ml.detachEvent("onpropertychange",Cd),yc=ml=null)}function Cd(f){if(f.propertyName==="value"&&wa(yc)){var p=[];vc(p,yc,f,He(f)),vn(Xv,p)}}function _c(f,p,A){f==="focusin"?(yo(),ml=p,yc=A,ml.attachEvent("onpropertychange",Cd)):f==="focusout"&&yo()}function Jv(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return wa(yc)}function Km(f,p){if(f==="click")return wa(p)}function ai(f,p){if(f==="input"||f==="change")return wa(p)}function bd(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var Ms=typeof Object.is=="function"?Object.is:bd;function tu(f,p){if(Ms(f,p))return!0;if(typeof f!="object"||f===null||typeof p!="object"||p===null)return!1;var A=Object.keys(f),w=Object.keys(p);if(A.length!==w.length)return!1;for(w=0;w<A.length;w++){var B=A[w];if(!l.call(p,B)||!Ms(f[B],p[B]))return!1}return!0}function Th(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function ws(f,p){var A=Th(f);f=0;for(var w;A;){if(A.nodeType===3){if(w=f+A.textContent.length,f<=p&&w>=p)return{node:A,offset:p-f};f=w}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=Th(A)}}function nu(f,p){return f&&p?f===p?!0:f&&f.nodeType===3?!1:p&&p.nodeType===3?nu(f,p.parentNode):"contains"in f?f.contains(p):f.compareDocumentPosition?!!(f.compareDocumentPosition(p)&16):!1:!1}function li(){for(var f=window,p=Pe();p instanceof f.HTMLIFrameElement;){try{var A=typeof p.contentWindow.location.href=="string"}catch{A=!1}if(A)f=p.contentWindow;else break;p=Pe(f.document)}return p}function ir(f){var p=f&&f.nodeName&&f.nodeName.toLowerCase();return p&&(p==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||p==="textarea"||f.contentEditable==="true")}function rr(f){var p=li(),A=f.focusedElem,w=f.selectionRange;if(p!==A&&A&&A.ownerDocument&&nu(A.ownerDocument.documentElement,A)){if(w!==null&&ir(A)){if(p=w.start,f=w.end,f===void 0&&(f=p),"selectionStart"in A)A.selectionStart=p,A.selectionEnd=Math.min(f,A.value.length);else if(f=(p=A.ownerDocument||document)&&p.defaultView||window,f.getSelection){f=f.getSelection();var B=A.textContent.length,O=Math.min(w.start,B);w=w.end===void 0?O:Math.min(w.end,B),!f.extend&&O>w&&(B=w,w=O,O=B),B=ws(A,O);var Y=ws(A,w);B&&Y&&(f.rangeCount!==1||f.anchorNode!==B.node||f.anchorOffset!==B.offset||f.focusNode!==Y.node||f.focusOffset!==Y.offset)&&(p=p.createRange(),p.setStart(B.node,B.offset),f.removeAllRanges(),O>w?(f.addRange(p),f.extend(Y.node,Y.offset)):(p.setEnd(Y.node,Y.offset),f.addRange(p)))}}for(p=[],f=A;f=f.parentNode;)f.nodeType===1&&p.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<p.length;A++)f=p[A],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var Rd=a&&"documentMode"in document&&11>=document.documentMode,Jo=null,iu=null,Mh=null,sr=!1;function Id(f,p,A){var w=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;sr||Jo==null||Jo!==Pe(w)||(w=Jo,"selectionStart"in w&&ir(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Mh&&tu(Mh,w)||(Mh=w,w=Od(iu,"onSelect"),0<w.length&&(p=new Li("onSelect","select",null,p,A),f.push({event:p,listeners:w}),p.target=Jo)))}function Sc(f,p){var A={};return A[f.toLowerCase()]=p.toLowerCase(),A["Webkit"+f]="webkit"+p,A["Moz"+f]="moz"+p,A}var gl={animationend:Sc("Animation","AnimationEnd"),animationiteration:Sc("Animation","AnimationIteration"),animationstart:Sc("Animation","AnimationStart"),transitionend:Sc("Transition","TransitionEnd")},xo={},_o={};a&&(_o=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function qo(f){if(xo[f])return xo[f];if(!gl[f])return f;var p=gl[f],A;for(A in p)if(p.hasOwnProperty(A)&&A in _o)return xo[f]=p[A];return f}var wh=qo("animationend"),Ch=qo("animationiteration"),$m=qo("animationstart"),Xm=qo("transitionend"),Ym=new Map,Jm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ca(f,p){Ym.set(f,p),s(p,[f])}for(var Ld=0;Ld<Jm.length;Ld++){var bh=Jm[Ld],Rh=bh.toLowerCase(),qv=bh[0].toUpperCase()+bh.slice(1);Ca(Rh,"on"+qv)}Ca(wh,"onAnimationEnd"),Ca(Ch,"onAnimationIteration"),Ca($m,"onAnimationStart"),Ca("dblclick","onDoubleClick"),Ca("focusin","onFocus"),Ca("focusout","onBlur"),Ca(Xm,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pd=new Set("cancel close invalid load scroll toggle".split(" ").concat(vl));function Dd(f,p,A){var w=f.type||"unknown-event";f.currentTarget=A,uc(w,p,void 0,f),f.currentTarget=null}function Ac(f,p){p=(p&4)!==0;for(var A=0;A<f.length;A++){var w=f[A],B=w.event;w=w.listeners;e:{var O=void 0;if(p)for(var Y=w.length-1;0<=Y;Y--){var he=w[Y],ge=he.instance,Ve=he.currentTarget;if(he=he.listener,ge!==O&&B.isPropagationStopped())break e;Dd(B,he,Ve),O=ge}else for(Y=0;Y<w.length;Y++){if(he=w[Y],ge=he.instance,Ve=he.currentTarget,he=he.listener,ge!==O&&B.isPropagationStopped())break e;Dd(B,he,Ve),O=ge}}}if(Gi)throw f=qi,Gi=!1,qi=null,f}function Xn(f,p){var A=p[ou];A===void 0&&(A=p[ou]=new Set);var w=f+"__bubble";A.has(w)||(Fd(p,f,2,!1),A.add(w))}function Bd(f,p,A){var w=0;p&&(w|=4),Fd(A,f,w,p)}var Ih="_reactListening"+Math.random().toString(36).slice(2);function Ec(f){if(!f[Ih]){f[Ih]=!0,n.forEach(function(A){A!=="selectionchange"&&(Pd.has(A)||Bd(A,!1,f),Bd(A,!0,f))});var p=f.nodeType===9?f:f.ownerDocument;p===null||p[Ih]||(p[Ih]=!0,Bd("selectionchange",!1,p))}}function Fd(f,p,A,w){switch(hl(p)){case 1:var B=Yo;break;case 4:B=js;break;default:B=Jl}A=B.bind(null,p,A,f),B=void 0,!In||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(B=!0),w?B!==void 0?f.addEventListener(p,A,{capture:!0,passive:B}):f.addEventListener(p,A,!0):B!==void 0?f.addEventListener(p,A,{passive:B}):f.addEventListener(p,A,!1)}function kd(f,p,A,w,B){var O=w;if((p&1)===0&&(p&2)===0&&w!==null)e:for(;;){if(w===null)return;var Y=w.tag;if(Y===3||Y===4){var he=w.stateNode.containerInfo;if(he===B||he.nodeType===8&&he.parentNode===B)break;if(Y===4)for(Y=w.return;Y!==null;){var ge=Y.tag;if((ge===3||ge===4)&&(ge=Y.stateNode.containerInfo,ge===B||ge.nodeType===8&&ge.parentNode===B))return;Y=Y.return}for(;he!==null;){if(Y=yl(he),Y===null)return;if(ge=Y.tag,ge===5||ge===6){w=O=Y;continue e}he=he.parentNode}}w=w.return}vn(function(){var Ve=O,at=He(A),ct=[];e:{var ot=Ym.get(f);if(ot!==void 0){var bt=Li,Dt=f;switch(f){case"keypress":if(_a(A)===0)break e;case"keydown":case"keyup":bt=Td;break;case"focusin":Dt="focus",bt=_d;break;case"focusout":Dt="blur",bt=_d;break;case"beforeblur":case"afterblur":bt=_d;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":bt=Um;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":bt=fl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":bt=Ta;break;case wh:case Ch:case $m:bt=zv;break;case Xm:bt=Ql;break;case"scroll":bt=Si;break;case"wheel":bt=zm;break;case"copy":case"cut":case"paste":bt=Nm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":bt=Ts}var kt=(p&4)!==0,ji=!kt&&f==="scroll",Ie=kt?ot!==null?ot+"Capture":null:ot;kt=[];for(var xe=Ve,Fe;xe!==null;){Fe=xe;var pt=Fe.stateNode;if(Fe.tag===5&&pt!==null&&(Fe=pt,Ie!==null&&(pt=Dn(xe,Ie),pt!=null&&kt.push(Tc(xe,pt,Fe)))),ji)break;xe=xe.return}0<kt.length&&(ot=new bt(ot,Dt,null,A,at),ct.push({event:ot,listeners:kt}))}}if((p&7)===0){e:{if(ot=f==="mouseover"||f==="pointerover",bt=f==="mouseout"||f==="pointerout",ot&&A!==ce&&(Dt=A.relatedTarget||A.fromElement)&&(yl(Dt)||Dt[Cs]))break e;if((bt||ot)&&(ot=at.window===at?at:(ot=at.ownerDocument)?ot.defaultView||ot.parentWindow:window,bt?(Dt=A.relatedTarget||A.toElement,bt=Ve,Dt=Dt?yl(Dt):null,Dt!==null&&(ji=Ss(Dt),Dt!==ji||Dt.tag!==5&&Dt.tag!==6)&&(Dt=null)):(bt=null,Dt=Ve),bt!==Dt)){if(kt=Um,pt="onMouseLeave",Ie="onMouseEnter",xe="mouse",(f==="pointerout"||f==="pointerover")&&(kt=Ts,pt="onPointerLeave",Ie="onPointerEnter",xe="pointer"),ji=bt==null?ot:Ai(bt),Fe=Dt==null?ot:Ai(Dt),ot=new kt(pt,xe+"leave",bt,A,at),ot.target=ji,ot.relatedTarget=Fe,pt=null,yl(at)===Ve&&(kt=new kt(Ie,xe+"enter",Dt,A,at),kt.target=Fe,kt.relatedTarget=ji,pt=kt),ji=pt,bt&&Dt)t:{for(kt=bt,Ie=Dt,xe=0,Fe=kt;Fe;Fe=ru(Fe))xe++;for(Fe=0,pt=Ie;pt;pt=ru(pt))Fe++;for(;0<xe-Fe;)kt=ru(kt),xe--;for(;0<Fe-xe;)Ie=ru(Ie),Fe--;for(;xe--;){if(kt===Ie||Ie!==null&&kt===Ie.alternate)break t;kt=ru(kt),Ie=ru(Ie)}kt=null}else kt=null;bt!==null&&Qv(ct,ot,bt,kt,!1),Dt!==null&&ji!==null&&Qv(ct,ji,Dt,kt,!0)}}e:{if(ot=Ve?Ai(Ve):window,bt=ot.nodeName&&ot.nodeName.toLowerCase(),bt==="select"||bt==="input"&&ot.type==="file")var Gt=Yv;else if(wd(ot))if(xc)Gt=ai;else{Gt=Jv;var $t=_c}else(bt=ot.nodeName)&&bt.toLowerCase()==="input"&&(ot.type==="checkbox"||ot.type==="radio")&&(Gt=Km);if(Gt&&(Gt=Gt(f,Ve))){vc(ct,Gt,A,at);break e}$t&&$t(f,ot,Ve),f==="focusout"&&($t=ot._wrapperState)&&$t.controlled&&ot.type==="number"&&We(ot,"number",ot.value)}switch($t=Ve?Ai(Ve):window,f){case"focusin":(wd($t)||$t.contentEditable==="true")&&(Jo=$t,iu=Ve,Mh=null);break;case"focusout":Mh=iu=Jo=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,Id(ct,A,at);break;case"selectionchange":if(Rd)break;case"keydown":case"keyup":Id(ct,A,at)}var Xt;if(zr)e:{switch(f){case"compositionstart":var en="onCompositionStart";break e;case"compositionend":en="onCompositionEnd";break e;case"compositionupdate":en="onCompositionUpdate";break e}en=void 0}else pl?jm(f,A)&&(en="onCompositionEnd"):f==="keydown"&&A.keyCode===229&&(en="onCompositionStart");en&&(mc&&A.locale!=="ko"&&(pl||en!=="onCompositionStart"?en==="onCompositionEnd"&&pl&&(Xt=zi()):(is=at,xa="value"in is?is.value:is.textContent,pl=!0)),$t=Od(Ve,en),0<$t.length&&(en=new Gm(en,f,null,A,at),ct.push({event:en,listeners:$t}),Xt?en.data=Xt:(Xt=Md(A),Xt!==null&&(en.data=Xt)))),(Xt=ni?$v(f,A):Eh(f,A))&&(Ve=Od(Ve,"onBeforeInput"),0<Ve.length&&(at=new Gm("onBeforeInput","beforeinput",null,A,at),ct.push({event:at,listeners:Ve}),at.data=Xt))}Ac(ct,p)})}function Tc(f,p,A){return{instance:f,listener:p,currentTarget:A}}function Od(f,p){for(var A=p+"Capture",w=[];f!==null;){var B=f,O=B.stateNode;B.tag===5&&O!==null&&(B=O,O=Dn(f,A),O!=null&&w.unshift(Tc(f,O,B)),O=Dn(f,p),O!=null&&w.push(Tc(f,O,B))),f=f.return}return w}function ru(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function Qv(f,p,A,w,B){for(var O=p._reactName,Y=[];A!==null&&A!==w;){var he=A,ge=he.alternate,Ve=he.stateNode;if(ge!==null&&ge===w)break;he.tag===5&&Ve!==null&&(he=Ve,B?(ge=Dn(A,O),ge!=null&&Y.unshift(Tc(A,ge,he))):B||(ge=Dn(A,O),ge!=null&&Y.push(Tc(A,ge,he)))),A=A.return}Y.length!==0&&f.push({event:p,listeners:Y})}var NA=/\r\n?/g,Zv=/\u0000|\uFFFD/g;function qm(f){return(typeof f=="string"?f:""+f).replace(NA,`
`).replace(Zv,"")}function Lh(f,p,A){if(p=qm(p),qm(f)!==p&&A)throw Error(t(425))}function Ph(){}var Mc=null,Qm=null;function Zm(f,p){return f==="textarea"||f==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var eg=typeof setTimeout=="function"?setTimeout:void 0,tg=typeof clearTimeout=="function"?clearTimeout:void 0,Ud=typeof Promise=="function"?Promise:void 0,GA=typeof queueMicrotask=="function"?queueMicrotask:typeof Ud<"u"?function(f){return Ud.resolve(null).then(f).catch(ey)}:eg;function ey(f){setTimeout(function(){throw f})}function Nd(f,p){var A=p,w=0;do{var B=A.nextSibling;if(f.removeChild(A),B&&B.nodeType===8)if(A=B.data,A==="/$"){if(w===0){f.removeChild(B),ul(p);return}w--}else A!=="$"&&A!=="$?"&&A!=="$!"||w++;A=B}while(A);ul(p)}function ba(f){for(;f!=null;f=f.nextSibling){var p=f.nodeType;if(p===1||p===3)break;if(p===8){if(p=f.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return f}function ng(f){f=f.previousSibling;for(var p=0;f;){if(f.nodeType===8){var A=f.data;if(A==="$"||A==="$!"||A==="$?"){if(p===0)return f;p--}else A==="/$"&&p++}f=f.previousSibling}return null}var su=Math.random().toString(36).slice(2),Wi="__reactFiber$"+su,wc="__reactProps$"+su,Cs="__reactContainer$"+su,ou="__reactEvents$"+su,Gd="__reactListeners$"+su,Hd="__reactHandles$"+su;function yl(f){var p=f[Wi];if(p)return p;for(var A=f.parentNode;A;){if(p=A[Cs]||A[Wi]){if(A=p.alternate,p.child!==null||A!==null&&A.child!==null)for(f=ng(f);f!==null;){if(A=f[Wi])return A;f=ng(f)}return p}f=A,A=f.parentNode}return null}function Ra(f){return f=f[Wi]||f[Cs],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function Ai(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(t(33))}function zd(f){return f[wc]||null}var ig=[],or=-1;function hi(f){return{current:f}}function Yn(f){0>or||(f.current=ig[or],ig[or]=null,or--)}function jn(f,p){or++,ig[or]=f.current,f.current=p}var Ia={},mr=hi(Ia),Vr=hi(!1),La=Ia;function au(f,p){var A=f.type.contextTypes;if(!A)return Ia;var w=f.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===p)return w.__reactInternalMemoizedMaskedChildContext;var B={},O;for(O in A)B[O]=p[O];return w&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=p,f.__reactInternalMemoizedMaskedChildContext=B),B}function Ir(f){return f=f.childContextTypes,f!=null}function Dh(){Yn(Vr),Yn(mr)}function rg(f,p,A){if(mr.current!==Ia)throw Error(t(168));jn(mr,p),jn(Vr,A)}function Bh(f,p,A){var w=f.stateNode;if(p=p.childContextTypes,typeof w.getChildContext!="function")return A;w=w.getChildContext();for(var B in w)if(!(B in p))throw Error(t(108,de(f)||"Unknown",B));return j({},A,w)}function lu(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Ia,La=mr.current,jn(mr,f),jn(Vr,Vr.current),!0}function sg(f,p,A){var w=f.stateNode;if(!w)throw Error(t(169));A?(f=Bh(f,p,La),w.__reactInternalMemoizedMergedChildContext=f,Yn(Vr),Yn(mr),jn(mr,f)):Yn(Vr),jn(Vr,A)}var So=null,Fh=!1,Vd=!1;function kh(f){So===null?So=[f]:So.push(f)}function ty(f){Fh=!0,kh(f)}function Qo(){if(!Vd&&So!==null){Vd=!0;var f=0,p=mn;try{var A=So;for(mn=1;f<A.length;f++){var w=A[f];do w=w(!0);while(w!==null)}So=null,Fh=!1}catch(B){throw So!==null&&(So=So.slice(f+1)),be(Vt,Qo),B}finally{mn=p,Vd=!1}}return null}var uu=[],os=0,Wd=null,jd=0,Wr=[],ar=0,cu=null,vt=1,Ys="";function Pa(f,p){uu[os++]=jd,uu[os++]=Wd,Wd=f,jd=p}function og(f,p,A){Wr[ar++]=vt,Wr[ar++]=Ys,Wr[ar++]=cu,cu=f;var w=vt;f=Ys;var B=32-on(w)-1;w&=~(1<<B),A+=1;var O=32-on(p)+B;if(30<O){var Y=B-B%5;O=(w&(1<<Y)-1).toString(32),w>>=Y,B-=Y,vt=1<<32-on(p)+B|A<<B|w,Ys=O+f}else vt=1<<O|A<<B|w,Ys=f}function ag(f){f.return!==null&&(Pa(f,1),og(f,1,0))}function Da(f){for(;f===Wd;)Wd=uu[--os],uu[os]=null,jd=uu[--os],uu[os]=null;for(;f===cu;)cu=Wr[--ar],Wr[ar]=null,Ys=Wr[--ar],Wr[ar]=null,vt=Wr[--ar],Wr[ar]=null}var gr=null,jr=null,Qn=!1,Js=null;function lg(f,p){var A=ia(5,null,null,0);A.elementType="DELETED",A.stateNode=p,A.return=f,p=f.deletions,p===null?(f.deletions=[A],f.flags|=16):p.push(A)}function ug(f,p){switch(f.tag){case 5:var A=f.type;return p=p.nodeType!==1||A.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(f.stateNode=p,gr=f,jr=ba(p.firstChild),!0):!1;case 6:return p=f.pendingProps===""||p.nodeType!==3?null:p,p!==null?(f.stateNode=p,gr=f,jr=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(A=cu!==null?{id:vt,overflow:Ys}:null,f.memoizedState={dehydrated:p,treeContext:A,retryLane:1073741824},A=ia(18,null,null,0),A.stateNode=p,A.return=f,f.child=A,gr=f,jr=null,!0):!1;default:return!1}}function Kd(f){return(f.mode&1)!==0&&(f.flags&128)===0}function $d(f){if(Qn){var p=jr;if(p){var A=p;if(!ug(f,p)){if(Kd(f))throw Error(t(418));p=ba(A.nextSibling);var w=gr;p&&ug(f,p)?lg(w,A):(f.flags=f.flags&-4097|2,Qn=!1,gr=f)}}else{if(Kd(f))throw Error(t(418));f.flags=f.flags&-4097|2,Qn=!1,gr=f}}}function Xd(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;gr=f}function Cc(f){if(f!==gr)return!1;if(!Qn)return Xd(f),Qn=!0,!1;var p;if((p=f.tag!==3)&&!(p=f.tag!==5)&&(p=f.type,p=p!=="head"&&p!=="body"&&!Zm(f.type,f.memoizedProps)),p&&(p=jr)){if(Kd(f))throw cg(),Error(t(418));for(;p;)lg(f,p),p=ba(p.nextSibling)}if(Xd(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(t(317));e:{for(f=f.nextSibling,p=0;f;){if(f.nodeType===8){var A=f.data;if(A==="/$"){if(p===0){jr=ba(f.nextSibling);break e}p--}else A!=="$"&&A!=="$!"&&A!=="$?"||p++}f=f.nextSibling}jr=null}}else jr=gr?ba(f.stateNode.nextSibling):null;return!0}function cg(){for(var f=jr;f;)f=ba(f.nextSibling)}function xl(){jr=gr=null,Qn=!1}function bc(f){Js===null?Js=[f]:Js.push(f)}var HA=C.ReactCurrentBatchConfig;function Oh(f,p,A){if(f=A.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(t(309));var w=A.stateNode}if(!w)throw Error(t(147,f));var B=w,O=""+f;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===O?p.ref:(p=function(Y){var he=B.refs;Y===null?delete he[O]:he[O]=Y},p._stringRef=O,p)}if(typeof f!="string")throw Error(t(284));if(!A._owner)throw Error(t(290,f))}return f}function Uh(f,p){throw f=Object.prototype.toString.call(p),Error(t(31,f==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":f))}function hg(f){var p=f._init;return p(f._payload)}function fg(f){function p(Ie,xe){if(f){var Fe=Ie.deletions;Fe===null?(Ie.deletions=[xe],Ie.flags|=16):Fe.push(xe)}}function A(Ie,xe){if(!f)return null;for(;xe!==null;)p(Ie,xe),xe=xe.sibling;return null}function w(Ie,xe){for(Ie=new Map;xe!==null;)xe.key!==null?Ie.set(xe.key,xe):Ie.set(xe.index,xe),xe=xe.sibling;return Ie}function B(Ie,xe){return Ie=Nc(Ie,xe),Ie.index=0,Ie.sibling=null,Ie}function O(Ie,xe,Fe){return Ie.index=Fe,f?(Fe=Ie.alternate,Fe!==null?(Fe=Fe.index,Fe<xe?(Ie.flags|=2,xe):Fe):(Ie.flags|=2,xe)):(Ie.flags|=1048576,xe)}function Y(Ie){return f&&Ie.alternate===null&&(Ie.flags|=2),Ie}function he(Ie,xe,Fe,pt){return xe===null||xe.tag!==6?(xe=o1(Fe,Ie.mode,pt),xe.return=Ie,xe):(xe=B(xe,Fe),xe.return=Ie,xe)}function ge(Ie,xe,Fe,pt){var Gt=Fe.type;return Gt===L?at(Ie,xe,Fe.props.children,pt,Fe.key):xe!==null&&(xe.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===ee&&hg(Gt)===xe.type)?(pt=B(xe,Fe.props),pt.ref=Oh(Ie,xe,Fe),pt.return=Ie,pt):(pt=Ty(Fe.type,Fe.key,Fe.props,null,Ie.mode,pt),pt.ref=Oh(Ie,xe,Fe),pt.return=Ie,pt)}function Ve(Ie,xe,Fe,pt){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Fe.containerInfo||xe.stateNode.implementation!==Fe.implementation?(xe=a1(Fe,Ie.mode,pt),xe.return=Ie,xe):(xe=B(xe,Fe.children||[]),xe.return=Ie,xe)}function at(Ie,xe,Fe,pt,Gt){return xe===null||xe.tag!==7?(xe=tf(Fe,Ie.mode,pt,Gt),xe.return=Ie,xe):(xe=B(xe,Fe),xe.return=Ie,xe)}function ct(Ie,xe,Fe){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return xe=o1(""+xe,Ie.mode,Fe),xe.return=Ie,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case R:return Fe=Ty(xe.type,xe.key,xe.props,null,Ie.mode,Fe),Fe.ref=Oh(Ie,null,xe),Fe.return=Ie,Fe;case P:return xe=a1(xe,Ie.mode,Fe),xe.return=Ie,xe;case ee:var pt=xe._init;return ct(Ie,pt(xe._payload),Fe)}if(te(xe)||$(xe))return xe=tf(xe,Ie.mode,Fe,null),xe.return=Ie,xe;Uh(Ie,xe)}return null}function ot(Ie,xe,Fe,pt){var Gt=xe!==null?xe.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return Gt!==null?null:he(Ie,xe,""+Fe,pt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case R:return Fe.key===Gt?ge(Ie,xe,Fe,pt):null;case P:return Fe.key===Gt?Ve(Ie,xe,Fe,pt):null;case ee:return Gt=Fe._init,ot(Ie,xe,Gt(Fe._payload),pt)}if(te(Fe)||$(Fe))return Gt!==null?null:at(Ie,xe,Fe,pt,null);Uh(Ie,Fe)}return null}function bt(Ie,xe,Fe,pt,Gt){if(typeof pt=="string"&&pt!==""||typeof pt=="number")return Ie=Ie.get(Fe)||null,he(xe,Ie,""+pt,Gt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case R:return Ie=Ie.get(pt.key===null?Fe:pt.key)||null,ge(xe,Ie,pt,Gt);case P:return Ie=Ie.get(pt.key===null?Fe:pt.key)||null,Ve(xe,Ie,pt,Gt);case ee:var $t=pt._init;return bt(Ie,xe,Fe,$t(pt._payload),Gt)}if(te(pt)||$(pt))return Ie=Ie.get(Fe)||null,at(xe,Ie,pt,Gt,null);Uh(xe,pt)}return null}function Dt(Ie,xe,Fe,pt){for(var Gt=null,$t=null,Xt=xe,en=xe=0,Br=null;Xt!==null&&en<Fe.length;en++){Xt.index>en?(Br=Xt,Xt=null):Br=Xt.sibling;var kn=ot(Ie,Xt,Fe[en],pt);if(kn===null){Xt===null&&(Xt=Br);break}f&&Xt&&kn.alternate===null&&p(Ie,Xt),xe=O(kn,xe,en),$t===null?Gt=kn:$t.sibling=kn,$t=kn,Xt=Br}if(en===Fe.length)return A(Ie,Xt),Qn&&Pa(Ie,en),Gt;if(Xt===null){for(;en<Fe.length;en++)Xt=ct(Ie,Fe[en],pt),Xt!==null&&(xe=O(Xt,xe,en),$t===null?Gt=Xt:$t.sibling=Xt,$t=Xt);return Qn&&Pa(Ie,en),Gt}for(Xt=w(Ie,Xt);en<Fe.length;en++)Br=bt(Xt,Ie,en,Fe[en],pt),Br!==null&&(f&&Br.alternate!==null&&Xt.delete(Br.key===null?en:Br.key),xe=O(Br,xe,en),$t===null?Gt=Br:$t.sibling=Br,$t=Br);return f&&Xt.forEach(function(Gc){return p(Ie,Gc)}),Qn&&Pa(Ie,en),Gt}function kt(Ie,xe,Fe,pt){var Gt=$(Fe);if(typeof Gt!="function")throw Error(t(150));if(Fe=Gt.call(Fe),Fe==null)throw Error(t(151));for(var $t=Gt=null,Xt=xe,en=xe=0,Br=null,kn=Fe.next();Xt!==null&&!kn.done;en++,kn=Fe.next()){Xt.index>en?(Br=Xt,Xt=null):Br=Xt.sibling;var Gc=ot(Ie,Xt,kn.value,pt);if(Gc===null){Xt===null&&(Xt=Br);break}f&&Xt&&Gc.alternate===null&&p(Ie,Xt),xe=O(Gc,xe,en),$t===null?Gt=Gc:$t.sibling=Gc,$t=Gc,Xt=Br}if(kn.done)return A(Ie,Xt),Qn&&Pa(Ie,en),Gt;if(Xt===null){for(;!kn.done;en++,kn=Fe.next())kn=ct(Ie,kn.value,pt),kn!==null&&(xe=O(kn,xe,en),$t===null?Gt=kn:$t.sibling=kn,$t=kn);return Qn&&Pa(Ie,en),Gt}for(Xt=w(Ie,Xt);!kn.done;en++,kn=Fe.next())kn=bt(Xt,Ie,en,kn.value,pt),kn!==null&&(f&&kn.alternate!==null&&Xt.delete(kn.key===null?en:kn.key),xe=O(kn,xe,en),$t===null?Gt=kn:$t.sibling=kn,$t=kn);return f&&Xt.forEach(function(i5){return p(Ie,i5)}),Qn&&Pa(Ie,en),Gt}function ji(Ie,xe,Fe,pt){if(typeof Fe=="object"&&Fe!==null&&Fe.type===L&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case R:e:{for(var Gt=Fe.key,$t=xe;$t!==null;){if($t.key===Gt){if(Gt=Fe.type,Gt===L){if($t.tag===7){A(Ie,$t.sibling),xe=B($t,Fe.props.children),xe.return=Ie,Ie=xe;break e}}else if($t.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===ee&&hg(Gt)===$t.type){A(Ie,$t.sibling),xe=B($t,Fe.props),xe.ref=Oh(Ie,$t,Fe),xe.return=Ie,Ie=xe;break e}A(Ie,$t);break}else p(Ie,$t);$t=$t.sibling}Fe.type===L?(xe=tf(Fe.props.children,Ie.mode,pt,Fe.key),xe.return=Ie,Ie=xe):(pt=Ty(Fe.type,Fe.key,Fe.props,null,Ie.mode,pt),pt.ref=Oh(Ie,xe,Fe),pt.return=Ie,Ie=pt)}return Y(Ie);case P:e:{for($t=Fe.key;xe!==null;){if(xe.key===$t)if(xe.tag===4&&xe.stateNode.containerInfo===Fe.containerInfo&&xe.stateNode.implementation===Fe.implementation){A(Ie,xe.sibling),xe=B(xe,Fe.children||[]),xe.return=Ie,Ie=xe;break e}else{A(Ie,xe);break}else p(Ie,xe);xe=xe.sibling}xe=a1(Fe,Ie.mode,pt),xe.return=Ie,Ie=xe}return Y(Ie);case ee:return $t=Fe._init,ji(Ie,xe,$t(Fe._payload),pt)}if(te(Fe))return Dt(Ie,xe,Fe,pt);if($(Fe))return kt(Ie,xe,Fe,pt);Uh(Ie,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"?(Fe=""+Fe,xe!==null&&xe.tag===6?(A(Ie,xe.sibling),xe=B(xe,Fe),xe.return=Ie,Ie=xe):(A(Ie,xe),xe=o1(Fe,Ie.mode,pt),xe.return=Ie,Ie=xe),Y(Ie)):A(Ie,xe)}return ji}var hu=fg(!0),Nh=fg(!1),fu=hi(null),du=null,Ba=null,Rc=null;function pu(){Rc=Ba=du=null}function Gh(f){var p=fu.current;Yn(fu),f._currentValue=p}function Hh(f,p,A){for(;f!==null;){var w=f.alternate;if((f.childLanes&p)!==p?(f.childLanes|=p,w!==null&&(w.childLanes|=p)):w!==null&&(w.childLanes&p)!==p&&(w.childLanes|=p),f===A)break;f=f.return}}function _l(f,p){du=f,Rc=Ba=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&p)!==0&&(cn=!0),f.firstContext=null)}function bs(f){var p=f._currentValue;if(Rc!==f)if(f={context:f,memoizedValue:p,next:null},Ba===null){if(du===null)throw Error(t(308));Ba=f,du.dependencies={lanes:0,firstContext:f}}else Ba=Ba.next=f;return p}var Fa=null;function dg(f){Fa===null?Fa=[f]:Fa.push(f)}function zh(f,p,A,w){var B=p.interleaved;return B===null?(A.next=A,dg(p)):(A.next=B.next,B.next=A),p.interleaved=A,Ao(f,w)}function Ao(f,p){f.lanes|=p;var A=f.alternate;for(A!==null&&(A.lanes|=p),A=f,f=f.return;f!==null;)f.childLanes|=p,A=f.alternate,A!==null&&(A.childLanes|=p),A=f,f=f.return;return A.tag===3?A.stateNode:null}var zn=!1;function an(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ei(f,p){f=f.updateQueue,p.updateQueue===f&&(p.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function Vn(f,p){return{eventTime:f,lane:p,tag:0,payload:null,callback:null,next:null}}function ii(f,p,A){var w=f.updateQueue;if(w===null)return null;if(w=w.shared,(Ln&2)!==0){var B=w.pending;return B===null?p.next=p:(p.next=B.next,B.next=p),w.pending=p,Ao(f,A)}return B=w.interleaved,B===null?(p.next=p,dg(w)):(p.next=B.next,B.next=p),w.interleaved=p,Ao(f,A)}function Lr(f,p,A){if(p=p.updateQueue,p!==null&&(p=p.shared,(A&4194240)!==0)){var w=p.lanes;w&=f.pendingLanes,A|=w,p.lanes=A,mo(f,A)}}function mu(f,p){var A=f.updateQueue,w=f.alternate;if(w!==null&&(w=w.updateQueue,A===w)){var B=null,O=null;if(A=A.firstBaseUpdate,A!==null){do{var Y={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};O===null?B=O=Y:O=O.next=Y,A=A.next}while(A!==null);O===null?B=O=p:O=O.next=p}else B=O=p;A={baseState:w.baseState,firstBaseUpdate:B,lastBaseUpdate:O,shared:w.shared,effects:w.effects},f.updateQueue=A;return}f=A.lastBaseUpdate,f===null?A.firstBaseUpdate=p:f.next=p,A.lastBaseUpdate=p}function fi(f,p,A,w){var B=f.updateQueue;zn=!1;var O=B.firstBaseUpdate,Y=B.lastBaseUpdate,he=B.shared.pending;if(he!==null){B.shared.pending=null;var ge=he,Ve=ge.next;ge.next=null,Y===null?O=Ve:Y.next=Ve,Y=ge;var at=f.alternate;at!==null&&(at=at.updateQueue,he=at.lastBaseUpdate,he!==Y&&(he===null?at.firstBaseUpdate=Ve:he.next=Ve,at.lastBaseUpdate=ge))}if(O!==null){var ct=B.baseState;Y=0,at=Ve=ge=null,he=O;do{var ot=he.lane,bt=he.eventTime;if((w&ot)===ot){at!==null&&(at=at.next={eventTime:bt,lane:0,tag:he.tag,payload:he.payload,callback:he.callback,next:null});e:{var Dt=f,kt=he;switch(ot=p,bt=A,kt.tag){case 1:if(Dt=kt.payload,typeof Dt=="function"){ct=Dt.call(bt,ct,ot);break e}ct=Dt;break e;case 3:Dt.flags=Dt.flags&-65537|128;case 0:if(Dt=kt.payload,ot=typeof Dt=="function"?Dt.call(bt,ct,ot):Dt,ot==null)break e;ct=j({},ct,ot);break e;case 2:zn=!0}}he.callback!==null&&he.lane!==0&&(f.flags|=64,ot=B.effects,ot===null?B.effects=[he]:ot.push(he))}else bt={eventTime:bt,lane:ot,tag:he.tag,payload:he.payload,callback:he.callback,next:null},at===null?(Ve=at=bt,ge=ct):at=at.next=bt,Y|=ot;if(he=he.next,he===null){if(he=B.shared.pending,he===null)break;ot=he,he=ot.next,ot.next=null,B.lastBaseUpdate=ot,B.shared.pending=null}}while(!0);if(at===null&&(ge=ct),B.baseState=ge,B.firstBaseUpdate=Ve,B.lastBaseUpdate=at,p=B.shared.interleaved,p!==null){B=p;do Y|=B.lane,B=B.next;while(B!==p)}else O===null&&(B.shared.lanes=0);qh|=Y,f.lanes=Y,f.memoizedState=ct}}function Ic(f,p,A){if(f=p.effects,p.effects=null,f!==null)for(p=0;p<f.length;p++){var w=f[p],B=w.callback;if(B!==null){if(w.callback=null,w=A,typeof B!="function")throw Error(t(191,B));B.call(w)}}}var Zo={},Rs=hi(Zo),gu=hi(Zo),ka=hi(Zo);function Pi(f){if(f===Zo)throw Error(t(174));return f}function Vh(f,p){switch(jn(ka,p),jn(gu,f),jn(Rs,Zo),f=p.nodeType,f){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:ke(null,"");break;default:f=f===8?p.parentNode:p,p=f.namespaceURI||null,f=f.tagName,p=ke(p,f)}Yn(Rs),jn(Rs,p)}function Sl(){Yn(Rs),Yn(gu),Yn(ka)}function vu(f){Pi(ka.current);var p=Pi(Rs.current),A=ke(p,f.type);p!==A&&(jn(gu,f),jn(Rs,A))}function Lc(f){gu.current===f&&(Yn(Rs),Yn(gu))}var Zn=hi(0);function Eo(f){for(var p=f;p!==null;){if(p.tag===13){var A=p.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||A.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Pc=[];function ea(){for(var f=0;f<Pc.length;f++)Pc[f]._workInProgressVersionPrimary=null;Pc.length=0}var yu=C.ReactCurrentDispatcher,xu=C.ReactCurrentBatchConfig,Oa=0,Jn=null,di=null,bn=null,To=!1,Pr=!1,Al=0,as=0;function vr(){throw Error(t(321))}function Wh(f,p){if(p===null)return!1;for(var A=0;A<p.length&&A<f.length;A++)if(!Ms(f[A],p[A]))return!1;return!0}function jh(f,p,A,w,B,O){if(Oa=O,Jn=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,yu.current=f===null||f.memoizedState===null?ly:uy,f=A(w,B),Pr){O=0;do{if(Pr=!1,Al=0,25<=O)throw Error(t(301));O+=1,bn=di=null,p.updateQueue=null,yu.current=cy,f=A(w,B)}while(Pr)}if(yu.current=tp,p=di!==null&&di.next!==null,Oa=0,bn=di=Jn=null,To=!1,p)throw Error(t(300));return f}function pg(){var f=Al!==0;return Al=0,f}function yr(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?Jn.memoizedState=bn=f:bn=bn.next=f,bn}function Is(){if(di===null){var f=Jn.alternate;f=f!==null?f.memoizedState:null}else f=di.next;var p=bn===null?Jn.memoizedState:bn.next;if(p!==null)bn=p,di=f;else{if(f===null)throw Error(t(310));di=f,f={memoizedState:di.memoizedState,baseState:di.baseState,baseQueue:di.baseQueue,queue:di.queue,next:null},bn===null?Jn.memoizedState=bn=f:bn=bn.next=f}return bn}function Dc(f,p){return typeof p=="function"?p(f):p}function Kh(f){var p=Is(),A=p.queue;if(A===null)throw Error(t(311));A.lastRenderedReducer=f;var w=di,B=w.baseQueue,O=A.pending;if(O!==null){if(B!==null){var Y=B.next;B.next=O.next,O.next=Y}w.baseQueue=B=O,A.pending=null}if(B!==null){O=B.next,w=w.baseState;var he=Y=null,ge=null,Ve=O;do{var at=Ve.lane;if((Oa&at)===at)ge!==null&&(ge=ge.next={lane:0,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),w=Ve.hasEagerState?Ve.eagerState:f(w,Ve.action);else{var ct={lane:at,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null};ge===null?(he=ge=ct,Y=w):ge=ge.next=ct,Jn.lanes|=at,qh|=at}Ve=Ve.next}while(Ve!==null&&Ve!==O);ge===null?Y=w:ge.next=he,Ms(w,p.memoizedState)||(cn=!0),p.memoizedState=w,p.baseState=Y,p.baseQueue=ge,A.lastRenderedState=w}if(f=A.interleaved,f!==null){B=f;do O=B.lane,Jn.lanes|=O,qh|=O,B=B.next;while(B!==f)}else B===null&&(A.lanes=0);return[p.memoizedState,A.dispatch]}function Ua(f){var p=Is(),A=p.queue;if(A===null)throw Error(t(311));A.lastRenderedReducer=f;var w=A.dispatch,B=A.pending,O=p.memoizedState;if(B!==null){A.pending=null;var Y=B=B.next;do O=f(O,Y.action),Y=Y.next;while(Y!==B);Ms(O,p.memoizedState)||(cn=!0),p.memoizedState=O,p.baseQueue===null&&(p.baseState=O),A.lastRenderedState=O}return[O,w]}function mg(){}function gg(f,p){var A=Jn,w=Is(),B=p(),O=!Ms(w.memoizedState,B);if(O&&(w.memoizedState=B,cn=!0),w=w.queue,xg(ny.bind(null,A,w,f),[f]),w.getSnapshot!==p||O||bn!==null&&bn.memoizedState.tag&1){if(A.flags|=2048,Mo(9,$h.bind(null,A,w,B,p),void 0,null),Dr===null)throw Error(t(349));(Oa&30)!==0||Yd(A,p,B)}return B}function Yd(f,p,A){f.flags|=16384,f={getSnapshot:p,value:A},p=Jn.updateQueue,p===null?(p={lastEffect:null,stores:null},Jn.updateQueue=p,p.stores=[f]):(A=p.stores,A===null?p.stores=[f]:A.push(f))}function $h(f,p,A,w){p.value=A,p.getSnapshot=w,iy(p)&&vg(f)}function ny(f,p,A){return A(function(){iy(p)&&vg(f)})}function iy(f){var p=f.getSnapshot;f=f.value;try{var A=p();return!Ms(f,A)}catch{return!0}}function vg(f){var p=Ao(f,1);p!==null&&Va(p,f,1,-1)}function yg(f){var p=yr();return typeof f=="function"&&(f=f()),p.memoizedState=p.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dc,lastRenderedState:f},p.queue=f,f=f.dispatch=_u.bind(null,Jn,f),[p.memoizedState,f]}function Mo(f,p,A,w){return f={tag:f,create:p,destroy:A,deps:w,next:null},p=Jn.updateQueue,p===null?(p={lastEffect:null,stores:null},Jn.updateQueue=p,p.lastEffect=f.next=f):(A=p.lastEffect,A===null?p.lastEffect=f.next=f:(w=A.next,A.next=f,f.next=w,p.lastEffect=f)),f}function ry(){return Is().memoizedState}function ta(f,p,A,w){var B=yr();Jn.flags|=f,B.memoizedState=Mo(1|p,A,void 0,w===void 0?null:w)}function Xh(f,p,A,w){var B=Is();w=w===void 0?null:w;var O=void 0;if(di!==null){var Y=di.memoizedState;if(O=Y.destroy,w!==null&&Wh(w,Y.deps)){B.memoizedState=Mo(p,A,O,w);return}}Jn.flags|=f,B.memoizedState=Mo(1|p,A,O,w)}function Kr(f,p){return ta(8390656,8,f,p)}function xg(f,p){return Xh(2048,8,f,p)}function _g(f,p){return Xh(4,2,f,p)}function sy(f,p){return Xh(4,4,f,p)}function oy(f,p){if(typeof p=="function")return f=f(),p(f),function(){p(null)};if(p!=null)return f=f(),p.current=f,function(){p.current=null}}function Sg(f,p,A){return A=A!=null?A.concat([f]):null,Xh(4,4,oy.bind(null,p,f),A)}function Jd(){}function ay(f,p){var A=Is();p=p===void 0?null:p;var w=A.memoizedState;return w!==null&&p!==null&&Wh(p,w[1])?w[0]:(A.memoizedState=[f,p],f)}function Ls(f,p){var A=Is();p=p===void 0?null:p;var w=A.memoizedState;return w!==null&&p!==null&&Wh(p,w[1])?w[0]:(f=f(),A.memoizedState=[f,p],f)}function qd(f,p,A){return(Oa&21)===0?(f.baseState&&(f.baseState=!1,cn=!0),f.memoizedState=A):(Ms(A,p)||(A=Cr(),Jn.lanes|=A,qh|=A,f.baseState=!0),p)}function zA(f,p){var A=mn;mn=A!==0&&4>A?A:4,f(!0);var w=xu.transition;xu.transition={};try{f(!1),p()}finally{mn=A,xu.transition=w}}function Na(){return Is().memoizedState}function Qd(f,p,A){var w=Oc(f);if(A={lane:w,action:A,hasEagerState:!1,eagerState:null,next:null},Yh(f))Zd(p,A);else if(A=zh(f,p,A,w),A!==null){var B=Ds();Va(A,f,w,B),ep(A,p,w)}}function _u(f,p,A){var w=Oc(f),B={lane:w,action:A,hasEagerState:!1,eagerState:null,next:null};if(Yh(f))Zd(p,B);else{var O=f.alternate;if(f.lanes===0&&(O===null||O.lanes===0)&&(O=p.lastRenderedReducer,O!==null))try{var Y=p.lastRenderedState,he=O(Y,A);if(B.hasEagerState=!0,B.eagerState=he,Ms(he,Y)){var ge=p.interleaved;ge===null?(B.next=B,dg(p)):(B.next=ge.next,ge.next=B),p.interleaved=B;return}}catch{}finally{}A=zh(f,p,B,w),A!==null&&(B=Ds(),Va(A,f,w,B),ep(A,p,w))}}function Yh(f){var p=f.alternate;return f===Jn||p!==null&&p===Jn}function Zd(f,p){Pr=To=!0;var A=f.pending;A===null?p.next=p:(p.next=A.next,A.next=p),f.pending=p}function ep(f,p,A){if((A&4194240)!==0){var w=p.lanes;w&=f.pendingLanes,A|=w,p.lanes=A,mo(f,A)}}var tp={readContext:bs,useCallback:vr,useContext:vr,useEffect:vr,useImperativeHandle:vr,useInsertionEffect:vr,useLayoutEffect:vr,useMemo:vr,useReducer:vr,useRef:vr,useState:vr,useDebugValue:vr,useDeferredValue:vr,useTransition:vr,useMutableSource:vr,useSyncExternalStore:vr,useId:vr,unstable_isNewReconciler:!1},ly={readContext:bs,useCallback:function(f,p){return yr().memoizedState=[f,p===void 0?null:p],f},useContext:bs,useEffect:Kr,useImperativeHandle:function(f,p,A){return A=A!=null?A.concat([f]):null,ta(4194308,4,oy.bind(null,p,f),A)},useLayoutEffect:function(f,p){return ta(4194308,4,f,p)},useInsertionEffect:function(f,p){return ta(4,2,f,p)},useMemo:function(f,p){var A=yr();return p=p===void 0?null:p,f=f(),A.memoizedState=[f,p],f},useReducer:function(f,p,A){var w=yr();return p=A!==void 0?A(p):p,w.memoizedState=w.baseState=p,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:p},w.queue=f,f=f.dispatch=Qd.bind(null,Jn,f),[w.memoizedState,f]},useRef:function(f){var p=yr();return f={current:f},p.memoizedState=f},useState:yg,useDebugValue:Jd,useDeferredValue:function(f){return yr().memoizedState=f},useTransition:function(){var f=yg(!1),p=f[0];return f=zA.bind(null,f[1]),yr().memoizedState=f,[p,f]},useMutableSource:function(){},useSyncExternalStore:function(f,p,A){var w=Jn,B=yr();if(Qn){if(A===void 0)throw Error(t(407));A=A()}else{if(A=p(),Dr===null)throw Error(t(349));(Oa&30)!==0||Yd(w,p,A)}B.memoizedState=A;var O={value:A,getSnapshot:p};return B.queue=O,Kr(ny.bind(null,w,O,f),[f]),w.flags|=2048,Mo(9,$h.bind(null,w,O,A,p),void 0,null),A},useId:function(){var f=yr(),p=Dr.identifierPrefix;if(Qn){var A=Ys,w=vt;A=(w&~(1<<32-on(w)-1)).toString(32)+A,p=":"+p+"R"+A,A=Al++,0<A&&(p+="H"+A.toString(32)),p+=":"}else A=as++,p=":"+p+"r"+A.toString(32)+":";return f.memoizedState=p},unstable_isNewReconciler:!1},uy={readContext:bs,useCallback:ay,useContext:bs,useEffect:xg,useImperativeHandle:Sg,useInsertionEffect:_g,useLayoutEffect:sy,useMemo:Ls,useReducer:Kh,useRef:ry,useState:function(){return Kh(Dc)},useDebugValue:Jd,useDeferredValue:function(f){var p=Is();return qd(p,di.memoizedState,f)},useTransition:function(){var f=Kh(Dc)[0],p=Is().memoizedState;return[f,p]},useMutableSource:mg,useSyncExternalStore:gg,useId:Na,unstable_isNewReconciler:!1},cy={readContext:bs,useCallback:ay,useContext:bs,useEffect:xg,useImperativeHandle:Sg,useInsertionEffect:_g,useLayoutEffect:sy,useMemo:Ls,useReducer:Ua,useRef:ry,useState:function(){return Ua(Dc)},useDebugValue:Jd,useDeferredValue:function(f){var p=Is();return di===null?p.memoizedState=f:qd(p,di.memoizedState,f)},useTransition:function(){var f=Ua(Dc)[0],p=Is().memoizedState;return[f,p]},useMutableSource:mg,useSyncExternalStore:gg,useId:Na,unstable_isNewReconciler:!1};function qs(f,p){if(f&&f.defaultProps){p=j({},p),f=f.defaultProps;for(var A in f)p[A]===void 0&&(p[A]=f[A]);return p}return p}function Jh(f,p,A,w){p=f.memoizedState,A=A(w,p),A=A==null?p:j({},p,A),f.memoizedState=A,f.lanes===0&&(f.updateQueue.baseState=A)}var np={isMounted:function(f){return(f=f._reactInternals)?Ss(f)===f:!1},enqueueSetState:function(f,p,A){f=f._reactInternals;var w=Ds(),B=Oc(f),O=Vn(w,B);O.payload=p,A!=null&&(O.callback=A),p=ii(f,O,B),p!==null&&(Va(p,f,B,w),Lr(p,f,B))},enqueueReplaceState:function(f,p,A){f=f._reactInternals;var w=Ds(),B=Oc(f),O=Vn(w,B);O.tag=1,O.payload=p,A!=null&&(O.callback=A),p=ii(f,O,B),p!==null&&(Va(p,f,B,w),Lr(p,f,B))},enqueueForceUpdate:function(f,p){f=f._reactInternals;var A=Ds(),w=Oc(f),B=Vn(A,w);B.tag=2,p!=null&&(B.callback=p),p=ii(f,B,w),p!==null&&(Va(p,f,w,A),Lr(p,f,w))}};function hy(f,p,A,w,B,O,Y){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(w,O,Y):p.prototype&&p.prototype.isPureReactComponent?!tu(A,w)||!tu(B,O):!0}function v(f,p,A){var w=!1,B=Ia,O=p.contextType;return typeof O=="object"&&O!==null?O=bs(O):(B=Ir(p)?La:mr.current,w=p.contextTypes,O=(w=w!=null)?au(f,B):Ia),p=new p(A,O),f.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=np,f.stateNode=p,p._reactInternals=f,w&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=B,f.__reactInternalMemoizedMaskedChildContext=O),p}function y(f,p,A,w){f=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(A,w),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(A,w),p.state!==f&&np.enqueueReplaceState(p,p.state,null)}function M(f,p,A,w){var B=f.stateNode;B.props=A,B.state=f.memoizedState,B.refs={},an(f);var O=p.contextType;typeof O=="object"&&O!==null?B.context=bs(O):(O=Ir(p)?La:mr.current,B.context=au(f,O)),B.state=f.memoizedState,O=p.getDerivedStateFromProps,typeof O=="function"&&(Jh(f,p,O,A),B.state=f.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(p=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),p!==B.state&&np.enqueueReplaceState(B,B.state,null),fi(f,A,B,w),B.state=f.memoizedState),typeof B.componentDidMount=="function"&&(f.flags|=4194308)}function b(f,p){try{var A="",w=p;do A+=oe(w),w=w.return;while(w);var B=A}catch(O){B=`
Error generating stack: `+O.message+`
`+O.stack}return{value:f,source:p,stack:B,digest:null}}function k(f,p,A){return{value:f,source:null,stack:A??null,digest:p??null}}function G(f,p){try{console.error(p.value)}catch(A){setTimeout(function(){throw A})}}var ue=typeof WeakMap=="function"?WeakMap:Map;function Se(f,p,A){A=Vn(-1,A),A.tag=3,A.payload={element:null};var w=p.value;return A.callback=function(){yy||(yy=!0,QA=w),G(f,p)},A}function qe(f,p,A){A=Vn(-1,A),A.tag=3;var w=f.type.getDerivedStateFromError;if(typeof w=="function"){var B=p.value;A.payload=function(){return w(B)},A.callback=function(){G(f,p)}}var O=f.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(A.callback=function(){G(f,p),typeof w!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var Y=p.stack;this.componentDidCatch(p.value,{componentStack:Y!==null?Y:""})}),A}function dt(f,p,A){var w=f.pingCache;if(w===null){w=f.pingCache=new ue;var B=new Set;w.set(p,B)}else B=w.get(p),B===void 0&&(B=new Set,w.set(p,B));B.has(A)||(B.add(A),f=K4.bind(null,f,p,A),p.then(f,f))}function It(f){do{var p;if((p=f.tag===13)&&(p=f.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return f;f=f.return}while(f!==null);return null}function tn(f,p,A,w,B){return(f.mode&1)===0?(f===p?f.flags|=65536:(f.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(p=Vn(-1,1),p.tag=2,ii(A,p,1))),A.lanes|=1),f):(f.flags|=65536,f.lanes=B,f)}var jt=C.ReactCurrentOwner,cn=!1;function Tt(f,p,A,w){p.child=f===null?Nh(p,null,A,w):hu(p,f.child,A,w)}function xr(f,p,A,w,B){A=A.render;var O=p.ref;return _l(p,B),w=jh(f,p,A,w,O,B),A=pg(),f!==null&&!cn?(p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~B,Su(f,p,B)):(Qn&&A&&ag(p),p.flags|=1,Tt(f,p,w,B),p.child)}function Ps(f,p,A,w,B){if(f===null){var O=A.type;return typeof O=="function"&&!s1(O)&&O.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(p.tag=15,p.type=O,Ne(f,p,O,w,B)):(f=Ty(A.type,null,w,p,p.mode,B),f.ref=p.ref,f.return=p,p.child=f)}if(O=f.child,(f.lanes&B)===0){var Y=O.memoizedProps;if(A=A.compare,A=A!==null?A:tu,A(Y,w)&&f.ref===p.ref)return Su(f,p,B)}return p.flags|=1,f=Nc(O,w),f.ref=p.ref,f.return=p,p.child=f}function Ne(f,p,A,w,B){if(f!==null){var O=f.memoizedProps;if(tu(O,w)&&f.ref===p.ref)if(cn=!1,p.pendingProps=w=O,(f.lanes&B)!==0)(f.flags&131072)!==0&&(cn=!0);else return p.lanes=f.lanes,Su(f,p,B)}return Et(f,p,A,w,B)}function Me(f,p,A){var w=p.pendingProps,B=w.children,O=f!==null?f.memoizedState:null;if(w.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},jn(rp,wo),wo|=A;else{if((A&1073741824)===0)return f=O!==null?O.baseLanes|A:A,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:f,cachePool:null,transitions:null},p.updateQueue=null,jn(rp,wo),wo|=f,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=O!==null?O.baseLanes:A,jn(rp,wo),wo|=w}else O!==null?(w=O.baseLanes|A,p.memoizedState=null):w=A,jn(rp,wo),wo|=w;return Tt(f,p,B,A),p.child}function $e(f,p){var A=p.ref;(f===null&&A!==null||f!==null&&f.ref!==A)&&(p.flags|=512,p.flags|=2097152)}function Et(f,p,A,w,B){var O=Ir(A)?La:mr.current;return O=au(p,O),_l(p,B),A=jh(f,p,A,w,O,B),w=pg(),f!==null&&!cn?(p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~B,Su(f,p,B)):(Qn&&w&&ag(p),p.flags|=1,Tt(f,p,A,B),p.child)}function Ut(f,p,A,w,B){if(Ir(A)){var O=!0;lu(p)}else O=!1;if(_l(p,B),p.stateNode===null)dy(f,p),v(p,A,w),M(p,A,w,B),w=!0;else if(f===null){var Y=p.stateNode,he=p.memoizedProps;Y.props=he;var ge=Y.context,Ve=A.contextType;typeof Ve=="object"&&Ve!==null?Ve=bs(Ve):(Ve=Ir(A)?La:mr.current,Ve=au(p,Ve));var at=A.getDerivedStateFromProps,ct=typeof at=="function"||typeof Y.getSnapshotBeforeUpdate=="function";ct||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(he!==w||ge!==Ve)&&y(p,Y,w,Ve),zn=!1;var ot=p.memoizedState;Y.state=ot,fi(p,w,Y,B),ge=p.memoizedState,he!==w||ot!==ge||Vr.current||zn?(typeof at=="function"&&(Jh(p,A,at,w),ge=p.memoizedState),(he=zn||hy(p,A,he,w,ot,ge,Ve))?(ct||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount()),typeof Y.componentDidMount=="function"&&(p.flags|=4194308)):(typeof Y.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=w,p.memoizedState=ge),Y.props=w,Y.state=ge,Y.context=Ve,w=he):(typeof Y.componentDidMount=="function"&&(p.flags|=4194308),w=!1)}else{Y=p.stateNode,Ei(f,p),he=p.memoizedProps,Ve=p.type===p.elementType?he:qs(p.type,he),Y.props=Ve,ct=p.pendingProps,ot=Y.context,ge=A.contextType,typeof ge=="object"&&ge!==null?ge=bs(ge):(ge=Ir(A)?La:mr.current,ge=au(p,ge));var bt=A.getDerivedStateFromProps;(at=typeof bt=="function"||typeof Y.getSnapshotBeforeUpdate=="function")||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(he!==ct||ot!==ge)&&y(p,Y,w,ge),zn=!1,ot=p.memoizedState,Y.state=ot,fi(p,w,Y,B);var Dt=p.memoizedState;he!==ct||ot!==Dt||Vr.current||zn?(typeof bt=="function"&&(Jh(p,A,bt,w),Dt=p.memoizedState),(Ve=zn||hy(p,A,Ve,w,ot,Dt,ge)||!1)?(at||typeof Y.UNSAFE_componentWillUpdate!="function"&&typeof Y.componentWillUpdate!="function"||(typeof Y.componentWillUpdate=="function"&&Y.componentWillUpdate(w,Dt,ge),typeof Y.UNSAFE_componentWillUpdate=="function"&&Y.UNSAFE_componentWillUpdate(w,Dt,ge)),typeof Y.componentDidUpdate=="function"&&(p.flags|=4),typeof Y.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof Y.componentDidUpdate!="function"||he===f.memoizedProps&&ot===f.memoizedState||(p.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||he===f.memoizedProps&&ot===f.memoizedState||(p.flags|=1024),p.memoizedProps=w,p.memoizedState=Dt),Y.props=w,Y.state=Dt,Y.context=ge,w=Ve):(typeof Y.componentDidUpdate!="function"||he===f.memoizedProps&&ot===f.memoizedState||(p.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||he===f.memoizedProps&&ot===f.memoizedState||(p.flags|=1024),w=!1)}return rn(f,p,A,w,O,B)}function rn(f,p,A,w,B,O){$e(f,p);var Y=(p.flags&128)!==0;if(!w&&!Y)return B&&sg(p,A,!1),Su(f,p,O);w=p.stateNode,jt.current=p;var he=Y&&typeof A.getDerivedStateFromError!="function"?null:w.render();return p.flags|=1,f!==null&&Y?(p.child=hu(p,f.child,null,O),p.child=hu(p,null,he,O)):Tt(f,p,he,O),p.memoizedState=w.state,B&&sg(p,A,!0),p.child}function nn(f){var p=f.stateNode;p.pendingContext?rg(f,p.pendingContext,p.pendingContext!==p.context):p.context&&rg(f,p.context,!1),Vh(f,p.containerInfo)}function Mn(f,p,A,w,B){return xl(),bc(B),p.flags|=256,Tt(f,p,A,w),p.child}var Di={dehydrated:null,treeContext:null,retryLane:0};function Tn(f){return{baseLanes:f,cachePool:null,transitions:null}}function Ga(f,p,A){var w=p.pendingProps,B=Zn.current,O=!1,Y=(p.flags&128)!==0,he;if((he=Y)||(he=f!==null&&f.memoizedState===null?!1:(B&2)!==0),he?(O=!0,p.flags&=-129):(f===null||f.memoizedState!==null)&&(B|=1),jn(Zn,B&1),f===null)return $d(p),f=p.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((p.mode&1)===0?p.lanes=1:f.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(Y=w.children,f=w.fallback,O?(w=p.mode,O=p.child,Y={mode:"hidden",children:Y},(w&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=Y):O=My(Y,w,0,null),f=tf(f,w,A,null),O.return=p,f.return=p,O.sibling=f,p.child=O,p.child.memoizedState=Tn(A),p.memoizedState=Di,f):Ag(p,Y));if(B=f.memoizedState,B!==null&&(he=B.dehydrated,he!==null))return B4(f,p,Y,w,he,B,A);if(O){O=w.fallback,Y=p.mode,B=f.child,he=B.sibling;var ge={mode:"hidden",children:w.children};return(Y&1)===0&&p.child!==B?(w=p.child,w.childLanes=0,w.pendingProps=ge,p.deletions=null):(w=Nc(B,ge),w.subtreeFlags=B.subtreeFlags&14680064),he!==null?O=Nc(he,O):(O=tf(O,Y,A,null),O.flags|=2),O.return=p,w.return=p,w.sibling=O,p.child=w,w=O,O=p.child,Y=f.child.memoizedState,Y=Y===null?Tn(A):{baseLanes:Y.baseLanes|A,cachePool:null,transitions:Y.transitions},O.memoizedState=Y,O.childLanes=f.childLanes&~A,p.memoizedState=Di,w}return O=f.child,f=O.sibling,w=Nc(O,{mode:"visible",children:w.children}),(p.mode&1)===0&&(w.lanes=A),w.return=p,w.sibling=null,f!==null&&(A=p.deletions,A===null?(p.deletions=[f],p.flags|=16):A.push(f)),p.child=w,p.memoizedState=null,w}function Ag(f,p){return p=My({mode:"visible",children:p},f.mode,0,null),p.return=f,f.child=p}function fy(f,p,A,w){return w!==null&&bc(w),hu(p,f.child,null,A),f=Ag(p,p.pendingProps.children),f.flags|=2,p.memoizedState=null,f}function B4(f,p,A,w,B,O,Y){if(A)return p.flags&256?(p.flags&=-257,w=k(Error(t(422))),fy(f,p,Y,w)):p.memoizedState!==null?(p.child=f.child,p.flags|=128,null):(O=w.fallback,B=p.mode,w=My({mode:"visible",children:w.children},B,0,null),O=tf(O,B,Y,null),O.flags|=2,w.return=p,O.return=p,w.sibling=O,p.child=w,(p.mode&1)!==0&&hu(p,f.child,null,Y),p.child.memoizedState=Tn(Y),p.memoizedState=Di,O);if((p.mode&1)===0)return fy(f,p,Y,null);if(B.data==="$!"){if(w=B.nextSibling&&B.nextSibling.dataset,w)var he=w.dgst;return w=he,O=Error(t(419)),w=k(O,w,void 0),fy(f,p,Y,w)}if(he=(Y&f.childLanes)!==0,cn||he){if(w=Dr,w!==null){switch(Y&-Y){case 4:B=2;break;case 16:B=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:B=32;break;case 536870912:B=268435456;break;default:B=0}B=(B&(w.suspendedLanes|Y))!==0?0:B,B!==0&&B!==O.retryLane&&(O.retryLane=B,Ao(f,B),Va(w,f,B,-1))}return r1(),w=k(Error(t(421))),fy(f,p,Y,w)}return B.data==="$?"?(p.flags|=128,p.child=f.child,p=$4.bind(null,f),B._reactRetry=p,null):(f=O.treeContext,jr=ba(B.nextSibling),gr=p,Qn=!0,Js=null,f!==null&&(Wr[ar++]=vt,Wr[ar++]=Ys,Wr[ar++]=cu,vt=f.id,Ys=f.overflow,cu=p),p=Ag(p,w.children),p.flags|=4096,p)}function Mb(f,p,A){f.lanes|=p;var w=f.alternate;w!==null&&(w.lanes|=p),Hh(f.return,p,A)}function VA(f,p,A,w,B){var O=f.memoizedState;O===null?f.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:w,tail:A,tailMode:B}:(O.isBackwards=p,O.rendering=null,O.renderingStartTime=0,O.last=w,O.tail=A,O.tailMode=B)}function wb(f,p,A){var w=p.pendingProps,B=w.revealOrder,O=w.tail;if(Tt(f,p,w.children,A),w=Zn.current,(w&2)!==0)w=w&1|2,p.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=p.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Mb(f,A,p);else if(f.tag===19)Mb(f,A,p);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===p)break e;for(;f.sibling===null;){if(f.return===null||f.return===p)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}w&=1}if(jn(Zn,w),(p.mode&1)===0)p.memoizedState=null;else switch(B){case"forwards":for(A=p.child,B=null;A!==null;)f=A.alternate,f!==null&&Eo(f)===null&&(B=A),A=A.sibling;A=B,A===null?(B=p.child,p.child=null):(B=A.sibling,A.sibling=null),VA(p,!1,B,A,O);break;case"backwards":for(A=null,B=p.child,p.child=null;B!==null;){if(f=B.alternate,f!==null&&Eo(f)===null){p.child=B;break}f=B.sibling,B.sibling=A,A=B,B=f}VA(p,!0,A,null,O);break;case"together":VA(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function dy(f,p){(p.mode&1)===0&&f!==null&&(f.alternate=null,p.alternate=null,p.flags|=2)}function Su(f,p,A){if(f!==null&&(p.dependencies=f.dependencies),qh|=p.lanes,(A&p.childLanes)===0)return null;if(f!==null&&p.child!==f.child)throw Error(t(153));if(p.child!==null){for(f=p.child,A=Nc(f,f.pendingProps),p.child=A,A.return=p;f.sibling!==null;)f=f.sibling,A=A.sibling=Nc(f,f.pendingProps),A.return=p;A.sibling=null}return p.child}function F4(f,p,A){switch(p.tag){case 3:nn(p),xl();break;case 5:vu(p);break;case 1:Ir(p.type)&&lu(p);break;case 4:Vh(p,p.stateNode.containerInfo);break;case 10:var w=p.type._context,B=p.memoizedProps.value;jn(fu,w._currentValue),w._currentValue=B;break;case 13:if(w=p.memoizedState,w!==null)return w.dehydrated!==null?(jn(Zn,Zn.current&1),p.flags|=128,null):(A&p.child.childLanes)!==0?Ga(f,p,A):(jn(Zn,Zn.current&1),f=Su(f,p,A),f!==null?f.sibling:null);jn(Zn,Zn.current&1);break;case 19:if(w=(A&p.childLanes)!==0,(f.flags&128)!==0){if(w)return wb(f,p,A);p.flags|=128}if(B=p.memoizedState,B!==null&&(B.rendering=null,B.tail=null,B.lastEffect=null),jn(Zn,Zn.current),w)break;return null;case 22:case 23:return p.lanes=0,Me(f,p,A)}return Su(f,p,A)}var Cb,WA,bb,Rb;Cb=function(f,p){for(var A=p.child;A!==null;){if(A.tag===5||A.tag===6)f.appendChild(A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===p)break;for(;A.sibling===null;){if(A.return===null||A.return===p)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},WA=function(){},bb=function(f,p,A,w){var B=f.memoizedProps;if(B!==w){f=p.stateNode,Pi(Rs.current);var O=null;switch(A){case"input":B=Be(f,B),w=Be(f,w),O=[];break;case"select":B=j({},B,{value:void 0}),w=j({},w,{value:void 0}),O=[];break;case"textarea":B=me(f,B),w=me(f,w),O=[];break;default:typeof B.onClick!="function"&&typeof w.onClick=="function"&&(f.onclick=Ph)}fe(A,w);var Y;A=null;for(Ve in B)if(!w.hasOwnProperty(Ve)&&B.hasOwnProperty(Ve)&&B[Ve]!=null)if(Ve==="style"){var he=B[Ve];for(Y in he)he.hasOwnProperty(Y)&&(A||(A={}),A[Y]="")}else Ve!=="dangerouslySetInnerHTML"&&Ve!=="children"&&Ve!=="suppressContentEditableWarning"&&Ve!=="suppressHydrationWarning"&&Ve!=="autoFocus"&&(i.hasOwnProperty(Ve)?O||(O=[]):(O=O||[]).push(Ve,null));for(Ve in w){var ge=w[Ve];if(he=B!=null?B[Ve]:void 0,w.hasOwnProperty(Ve)&&ge!==he&&(ge!=null||he!=null))if(Ve==="style")if(he){for(Y in he)!he.hasOwnProperty(Y)||ge&&ge.hasOwnProperty(Y)||(A||(A={}),A[Y]="");for(Y in ge)ge.hasOwnProperty(Y)&&he[Y]!==ge[Y]&&(A||(A={}),A[Y]=ge[Y])}else A||(O||(O=[]),O.push(Ve,A)),A=ge;else Ve==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,he=he?he.__html:void 0,ge!=null&&he!==ge&&(O=O||[]).push(Ve,ge)):Ve==="children"?typeof ge!="string"&&typeof ge!="number"||(O=O||[]).push(Ve,""+ge):Ve!=="suppressContentEditableWarning"&&Ve!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ve)?(ge!=null&&Ve==="onScroll"&&Xn("scroll",f),O||he===ge||(O=[])):(O=O||[]).push(Ve,ge))}A&&(O=O||[]).push("style",A);var Ve=O;(p.updateQueue=Ve)&&(p.flags|=4)}},Rb=function(f,p,A,w){A!==w&&(p.flags|=4)};function Eg(f,p){if(!Qn)switch(f.tailMode){case"hidden":p=f.tail;for(var A=null;p!==null;)p.alternate!==null&&(A=p),p=p.sibling;A===null?f.tail=null:A.sibling=null;break;case"collapsed":A=f.tail;for(var w=null;A!==null;)A.alternate!==null&&(w=A),A=A.sibling;w===null?p||f.tail===null?f.tail=null:f.tail.sibling=null:w.sibling=null}}function ls(f){var p=f.alternate!==null&&f.alternate.child===f.child,A=0,w=0;if(p)for(var B=f.child;B!==null;)A|=B.lanes|B.childLanes,w|=B.subtreeFlags&14680064,w|=B.flags&14680064,B.return=f,B=B.sibling;else for(B=f.child;B!==null;)A|=B.lanes|B.childLanes,w|=B.subtreeFlags,w|=B.flags,B.return=f,B=B.sibling;return f.subtreeFlags|=w,f.childLanes=A,p}function k4(f,p,A){var w=p.pendingProps;switch(Da(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ls(p),null;case 1:return Ir(p.type)&&Dh(),ls(p),null;case 3:return w=p.stateNode,Sl(),Yn(Vr),Yn(mr),ea(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(f===null||f.child===null)&&(Cc(p)?p.flags|=4:f===null||f.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Js!==null&&(t1(Js),Js=null))),WA(f,p),ls(p),null;case 5:Lc(p);var B=Pi(ka.current);if(A=p.type,f!==null&&p.stateNode!=null)bb(f,p,A,w,B),f.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!w){if(p.stateNode===null)throw Error(t(166));return ls(p),null}if(f=Pi(Rs.current),Cc(p)){w=p.stateNode,A=p.type;var O=p.memoizedProps;switch(w[Wi]=p,w[wc]=O,f=(p.mode&1)!==0,A){case"dialog":Xn("cancel",w),Xn("close",w);break;case"iframe":case"object":case"embed":Xn("load",w);break;case"video":case"audio":for(B=0;B<vl.length;B++)Xn(vl[B],w);break;case"source":Xn("error",w);break;case"img":case"image":case"link":Xn("error",w),Xn("load",w);break;case"details":Xn("toggle",w);break;case"input":Xe(w,O),Xn("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!O.multiple},Xn("invalid",w);break;case"textarea":_e(w,O),Xn("invalid",w)}fe(A,O),B=null;for(var Y in O)if(O.hasOwnProperty(Y)){var he=O[Y];Y==="children"?typeof he=="string"?w.textContent!==he&&(O.suppressHydrationWarning!==!0&&Lh(w.textContent,he,f),B=["children",he]):typeof he=="number"&&w.textContent!==""+he&&(O.suppressHydrationWarning!==!0&&Lh(w.textContent,he,f),B=["children",""+he]):i.hasOwnProperty(Y)&&he!=null&&Y==="onScroll"&&Xn("scroll",w)}switch(A){case"input":De(w),Ce(w,O,!0);break;case"textarea":De(w),we(w);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(w.onclick=Ph)}w=B,p.updateQueue=w,w!==null&&(p.flags|=4)}else{Y=B.nodeType===9?B:B.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=ut(A)),f==="http://www.w3.org/1999/xhtml"?A==="script"?(f=Y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof w.is=="string"?f=Y.createElement(A,{is:w.is}):(f=Y.createElement(A),A==="select"&&(Y=f,w.multiple?Y.multiple=!0:w.size&&(Y.size=w.size))):f=Y.createElementNS(f,A),f[Wi]=p,f[wc]=w,Cb(f,p,!1,!1),p.stateNode=f;e:{switch(Y=Je(A,w),A){case"dialog":Xn("cancel",f),Xn("close",f),B=w;break;case"iframe":case"object":case"embed":Xn("load",f),B=w;break;case"video":case"audio":for(B=0;B<vl.length;B++)Xn(vl[B],f);B=w;break;case"source":Xn("error",f),B=w;break;case"img":case"image":case"link":Xn("error",f),Xn("load",f),B=w;break;case"details":Xn("toggle",f),B=w;break;case"input":Xe(f,w),B=Be(f,w),Xn("invalid",f);break;case"option":B=w;break;case"select":f._wrapperState={wasMultiple:!!w.multiple},B=j({},w,{value:void 0}),Xn("invalid",f);break;case"textarea":_e(f,w),B=me(f,w),Xn("invalid",f);break;default:B=w}fe(A,B),he=B;for(O in he)if(he.hasOwnProperty(O)){var ge=he[O];O==="style"?it(f,ge):O==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,ge!=null&&lt(f,ge)):O==="children"?typeof ge=="string"?(A!=="textarea"||ge!=="")&&Ye(f,ge):typeof ge=="number"&&Ye(f,""+ge):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(i.hasOwnProperty(O)?ge!=null&&O==="onScroll"&&Xn("scroll",f):ge!=null&&E(f,O,ge,Y))}switch(A){case"input":De(f),Ce(f,w,!1);break;case"textarea":De(f),we(f);break;case"option":w.value!=null&&f.setAttribute("value",""+ye(w.value));break;case"select":f.multiple=!!w.multiple,O=w.value,O!=null?z(f,!!w.multiple,O,!1):w.defaultValue!=null&&z(f,!!w.multiple,w.defaultValue,!0);break;default:typeof B.onClick=="function"&&(f.onclick=Ph)}switch(A){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return ls(p),null;case 6:if(f&&p.stateNode!=null)Rb(f,p,f.memoizedProps,w);else{if(typeof w!="string"&&p.stateNode===null)throw Error(t(166));if(A=Pi(ka.current),Pi(Rs.current),Cc(p)){if(w=p.stateNode,A=p.memoizedProps,w[Wi]=p,(O=w.nodeValue!==A)&&(f=gr,f!==null))switch(f.tag){case 3:Lh(w.nodeValue,A,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&Lh(w.nodeValue,A,(f.mode&1)!==0)}O&&(p.flags|=4)}else w=(A.nodeType===9?A:A.ownerDocument).createTextNode(w),w[Wi]=p,p.stateNode=w}return ls(p),null;case 13:if(Yn(Zn),w=p.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Qn&&jr!==null&&(p.mode&1)!==0&&(p.flags&128)===0)cg(),xl(),p.flags|=98560,O=!1;else if(O=Cc(p),w!==null&&w.dehydrated!==null){if(f===null){if(!O)throw Error(t(318));if(O=p.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(t(317));O[Wi]=p}else xl(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;ls(p),O=!1}else Js!==null&&(t1(Js),Js=null),O=!0;if(!O)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=A,p):(w=w!==null,w!==(f!==null&&f.memoizedState!==null)&&w&&(p.child.flags|=8192,(p.mode&1)!==0&&(f===null||(Zn.current&1)!==0?_r===0&&(_r=3):r1())),p.updateQueue!==null&&(p.flags|=4),ls(p),null);case 4:return Sl(),WA(f,p),f===null&&Ec(p.stateNode.containerInfo),ls(p),null;case 10:return Gh(p.type._context),ls(p),null;case 17:return Ir(p.type)&&Dh(),ls(p),null;case 19:if(Yn(Zn),O=p.memoizedState,O===null)return ls(p),null;if(w=(p.flags&128)!==0,Y=O.rendering,Y===null)if(w)Eg(O,!1);else{if(_r!==0||f!==null&&(f.flags&128)!==0)for(f=p.child;f!==null;){if(Y=Eo(f),Y!==null){for(p.flags|=128,Eg(O,!1),w=Y.updateQueue,w!==null&&(p.updateQueue=w,p.flags|=4),p.subtreeFlags=0,w=A,A=p.child;A!==null;)O=A,f=w,O.flags&=14680066,Y=O.alternate,Y===null?(O.childLanes=0,O.lanes=f,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=Y.childLanes,O.lanes=Y.lanes,O.child=Y.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=Y.memoizedProps,O.memoizedState=Y.memoizedState,O.updateQueue=Y.updateQueue,O.type=Y.type,f=Y.dependencies,O.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),A=A.sibling;return jn(Zn,Zn.current&1|2),p.child}f=f.sibling}O.tail!==null&&je()>sp&&(p.flags|=128,w=!0,Eg(O,!1),p.lanes=4194304)}else{if(!w)if(f=Eo(Y),f!==null){if(p.flags|=128,w=!0,A=f.updateQueue,A!==null&&(p.updateQueue=A,p.flags|=4),Eg(O,!0),O.tail===null&&O.tailMode==="hidden"&&!Y.alternate&&!Qn)return ls(p),null}else 2*je()-O.renderingStartTime>sp&&A!==1073741824&&(p.flags|=128,w=!0,Eg(O,!1),p.lanes=4194304);O.isBackwards?(Y.sibling=p.child,p.child=Y):(A=O.last,A!==null?A.sibling=Y:p.child=Y,O.last=Y)}return O.tail!==null?(p=O.tail,O.rendering=p,O.tail=p.sibling,O.renderingStartTime=je(),p.sibling=null,A=Zn.current,jn(Zn,w?A&1|2:A&1),p):(ls(p),null);case 22:case 23:return i1(),w=p.memoizedState!==null,f!==null&&f.memoizedState!==null!==w&&(p.flags|=8192),w&&(p.mode&1)!==0?(wo&1073741824)!==0&&(ls(p),p.subtreeFlags&6&&(p.flags|=8192)):ls(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function O4(f,p){switch(Da(p),p.tag){case 1:return Ir(p.type)&&Dh(),f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 3:return Sl(),Yn(Vr),Yn(mr),ea(),f=p.flags,(f&65536)!==0&&(f&128)===0?(p.flags=f&-65537|128,p):null;case 5:return Lc(p),null;case 13:if(Yn(Zn),f=p.memoizedState,f!==null&&f.dehydrated!==null){if(p.alternate===null)throw Error(t(340));xl()}return f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 19:return Yn(Zn),null;case 4:return Sl(),null;case 10:return Gh(p.type._context),null;case 22:case 23:return i1(),null;case 24:return null;default:return null}}var py=!1,us=!1,U4=typeof WeakSet=="function"?WeakSet:Set,Lt=null;function ip(f,p){var A=f.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(w){Bi(f,p,w)}else A.current=null}function jA(f,p,A){try{A()}catch(w){Bi(f,p,w)}}var Ib=!1;function N4(f,p){if(Mc=er,f=li(),ir(f)){if("selectionStart"in f)var A={start:f.selectionStart,end:f.selectionEnd};else e:{A=(A=f.ownerDocument)&&A.defaultView||window;var w=A.getSelection&&A.getSelection();if(w&&w.rangeCount!==0){A=w.anchorNode;var B=w.anchorOffset,O=w.focusNode;w=w.focusOffset;try{A.nodeType,O.nodeType}catch{A=null;break e}var Y=0,he=-1,ge=-1,Ve=0,at=0,ct=f,ot=null;t:for(;;){for(var bt;ct!==A||B!==0&&ct.nodeType!==3||(he=Y+B),ct!==O||w!==0&&ct.nodeType!==3||(ge=Y+w),ct.nodeType===3&&(Y+=ct.nodeValue.length),(bt=ct.firstChild)!==null;)ot=ct,ct=bt;for(;;){if(ct===f)break t;if(ot===A&&++Ve===B&&(he=Y),ot===O&&++at===w&&(ge=Y),(bt=ct.nextSibling)!==null)break;ct=ot,ot=ct.parentNode}ct=bt}A=he===-1||ge===-1?null:{start:he,end:ge}}else A=null}A=A||{start:0,end:0}}else A=null;for(Qm={focusedElem:f,selectionRange:A},er=!1,Lt=p;Lt!==null;)if(p=Lt,f=p.child,(p.subtreeFlags&1028)!==0&&f!==null)f.return=p,Lt=f;else for(;Lt!==null;){p=Lt;try{var Dt=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Dt!==null){var kt=Dt.memoizedProps,ji=Dt.memoizedState,Ie=p.stateNode,xe=Ie.getSnapshotBeforeUpdate(p.elementType===p.type?kt:qs(p.type,kt),ji);Ie.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:var Fe=p.stateNode.containerInfo;Fe.nodeType===1?Fe.textContent="":Fe.nodeType===9&&Fe.documentElement&&Fe.removeChild(Fe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(pt){Bi(p,p.return,pt)}if(f=p.sibling,f!==null){f.return=p.return,Lt=f;break}Lt=p.return}return Dt=Ib,Ib=!1,Dt}function Tg(f,p,A){var w=p.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var B=w=w.next;do{if((B.tag&f)===f){var O=B.destroy;B.destroy=void 0,O!==void 0&&jA(p,A,O)}B=B.next}while(B!==w)}}function my(f,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var A=p=p.next;do{if((A.tag&f)===f){var w=A.create;A.destroy=w()}A=A.next}while(A!==p)}}function KA(f){var p=f.ref;if(p!==null){var A=f.stateNode;switch(f.tag){case 5:f=A;break;default:f=A}typeof p=="function"?p(f):p.current=f}}function Lb(f){var p=f.alternate;p!==null&&(f.alternate=null,Lb(p)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(p=f.stateNode,p!==null&&(delete p[Wi],delete p[wc],delete p[ou],delete p[Gd],delete p[Hd])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function Pb(f){return f.tag===5||f.tag===3||f.tag===4}function Db(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Pb(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function $A(f,p,A){var w=f.tag;if(w===5||w===6)f=f.stateNode,p?A.nodeType===8?A.parentNode.insertBefore(f,p):A.insertBefore(f,p):(A.nodeType===8?(p=A.parentNode,p.insertBefore(f,A)):(p=A,p.appendChild(f)),A=A._reactRootContainer,A!=null||p.onclick!==null||(p.onclick=Ph));else if(w!==4&&(f=f.child,f!==null))for($A(f,p,A),f=f.sibling;f!==null;)$A(f,p,A),f=f.sibling}function XA(f,p,A){var w=f.tag;if(w===5||w===6)f=f.stateNode,p?A.insertBefore(f,p):A.appendChild(f);else if(w!==4&&(f=f.child,f!==null))for(XA(f,p,A),f=f.sibling;f!==null;)XA(f,p,A),f=f.sibling}var $r=null,Ha=!1;function Bc(f,p,A){for(A=A.child;A!==null;)Bb(f,p,A),A=A.sibling}function Bb(f,p,A){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(Bn,A)}catch{}switch(A.tag){case 5:us||ip(A,p);case 6:var w=$r,B=Ha;$r=null,Bc(f,p,A),$r=w,Ha=B,$r!==null&&(Ha?(f=$r,A=A.stateNode,f.nodeType===8?f.parentNode.removeChild(A):f.removeChild(A)):$r.removeChild(A.stateNode));break;case 18:$r!==null&&(Ha?(f=$r,A=A.stateNode,f.nodeType===8?Nd(f.parentNode,A):f.nodeType===1&&Nd(f,A),ul(f)):Nd($r,A.stateNode));break;case 4:w=$r,B=Ha,$r=A.stateNode.containerInfo,Ha=!0,Bc(f,p,A),$r=w,Ha=B;break;case 0:case 11:case 14:case 15:if(!us&&(w=A.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){B=w=w.next;do{var O=B,Y=O.destroy;O=O.tag,Y!==void 0&&((O&2)!==0||(O&4)!==0)&&jA(A,p,Y),B=B.next}while(B!==w)}Bc(f,p,A);break;case 1:if(!us&&(ip(A,p),w=A.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=A.memoizedProps,w.state=A.memoizedState,w.componentWillUnmount()}catch(he){Bi(A,p,he)}Bc(f,p,A);break;case 21:Bc(f,p,A);break;case 22:A.mode&1?(us=(w=us)||A.memoizedState!==null,Bc(f,p,A),us=w):Bc(f,p,A);break;default:Bc(f,p,A)}}function Fb(f){var p=f.updateQueue;if(p!==null){f.updateQueue=null;var A=f.stateNode;A===null&&(A=f.stateNode=new U4),p.forEach(function(w){var B=X4.bind(null,f,w);A.has(w)||(A.add(w),w.then(B,B))})}}function za(f,p){var A=p.deletions;if(A!==null)for(var w=0;w<A.length;w++){var B=A[w];try{var O=f,Y=p,he=Y;e:for(;he!==null;){switch(he.tag){case 5:$r=he.stateNode,Ha=!1;break e;case 3:$r=he.stateNode.containerInfo,Ha=!0;break e;case 4:$r=he.stateNode.containerInfo,Ha=!0;break e}he=he.return}if($r===null)throw Error(t(160));Bb(O,Y,B),$r=null,Ha=!1;var ge=B.alternate;ge!==null&&(ge.return=null),B.return=null}catch(Ve){Bi(B,p,Ve)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)kb(p,f),p=p.sibling}function kb(f,p){var A=f.alternate,w=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(za(p,f),El(f),w&4){try{Tg(3,f,f.return),my(3,f)}catch(kt){Bi(f,f.return,kt)}try{Tg(5,f,f.return)}catch(kt){Bi(f,f.return,kt)}}break;case 1:za(p,f),El(f),w&512&&A!==null&&ip(A,A.return);break;case 5:if(za(p,f),El(f),w&512&&A!==null&&ip(A,A.return),f.flags&32){var B=f.stateNode;try{Ye(B,"")}catch(kt){Bi(f,f.return,kt)}}if(w&4&&(B=f.stateNode,B!=null)){var O=f.memoizedProps,Y=A!==null?A.memoizedProps:O,he=f.type,ge=f.updateQueue;if(f.updateQueue=null,ge!==null)try{he==="input"&&O.type==="radio"&&O.name!=null&&ve(B,O),Je(he,Y);var Ve=Je(he,O);for(Y=0;Y<ge.length;Y+=2){var at=ge[Y],ct=ge[Y+1];at==="style"?it(B,ct):at==="dangerouslySetInnerHTML"?lt(B,ct):at==="children"?Ye(B,ct):E(B,at,ct,Ve)}switch(he){case"input":et(B,O);break;case"textarea":Ee(B,O);break;case"select":var ot=B._wrapperState.wasMultiple;B._wrapperState.wasMultiple=!!O.multiple;var bt=O.value;bt!=null?z(B,!!O.multiple,bt,!1):ot!==!!O.multiple&&(O.defaultValue!=null?z(B,!!O.multiple,O.defaultValue,!0):z(B,!!O.multiple,O.multiple?[]:"",!1))}B[wc]=O}catch(kt){Bi(f,f.return,kt)}}break;case 6:if(za(p,f),El(f),w&4){if(f.stateNode===null)throw Error(t(162));B=f.stateNode,O=f.memoizedProps;try{B.nodeValue=O}catch(kt){Bi(f,f.return,kt)}}break;case 3:if(za(p,f),El(f),w&4&&A!==null&&A.memoizedState.isDehydrated)try{ul(p.containerInfo)}catch(kt){Bi(f,f.return,kt)}break;case 4:za(p,f),El(f);break;case 13:za(p,f),El(f),B=f.child,B.flags&8192&&(O=B.memoizedState!==null,B.stateNode.isHidden=O,!O||B.alternate!==null&&B.alternate.memoizedState!==null||(qA=je())),w&4&&Fb(f);break;case 22:if(at=A!==null&&A.memoizedState!==null,f.mode&1?(us=(Ve=us)||at,za(p,f),us=Ve):za(p,f),El(f),w&8192){if(Ve=f.memoizedState!==null,(f.stateNode.isHidden=Ve)&&!at&&(f.mode&1)!==0)for(Lt=f,at=f.child;at!==null;){for(ct=Lt=at;Lt!==null;){switch(ot=Lt,bt=ot.child,ot.tag){case 0:case 11:case 14:case 15:Tg(4,ot,ot.return);break;case 1:ip(ot,ot.return);var Dt=ot.stateNode;if(typeof Dt.componentWillUnmount=="function"){w=ot,A=ot.return;try{p=w,Dt.props=p.memoizedProps,Dt.state=p.memoizedState,Dt.componentWillUnmount()}catch(kt){Bi(w,A,kt)}}break;case 5:ip(ot,ot.return);break;case 22:if(ot.memoizedState!==null){Nb(ct);continue}}bt!==null?(bt.return=ot,Lt=bt):Nb(ct)}at=at.sibling}e:for(at=null,ct=f;;){if(ct.tag===5){if(at===null){at=ct;try{B=ct.stateNode,Ve?(O=B.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(he=ct.stateNode,ge=ct.memoizedProps.style,Y=ge!=null&&ge.hasOwnProperty("display")?ge.display:null,he.style.display=ht("display",Y))}catch(kt){Bi(f,f.return,kt)}}}else if(ct.tag===6){if(at===null)try{ct.stateNode.nodeValue=Ve?"":ct.memoizedProps}catch(kt){Bi(f,f.return,kt)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===f)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===f)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===f)break e;at===ct&&(at=null),ct=ct.return}at===ct&&(at=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:za(p,f),El(f),w&4&&Fb(f);break;case 21:break;default:za(p,f),El(f)}}function El(f){var p=f.flags;if(p&2){try{e:{for(var A=f.return;A!==null;){if(Pb(A)){var w=A;break e}A=A.return}throw Error(t(160))}switch(w.tag){case 5:var B=w.stateNode;w.flags&32&&(Ye(B,""),w.flags&=-33);var O=Db(f);XA(f,O,B);break;case 3:case 4:var Y=w.stateNode.containerInfo,he=Db(f);$A(f,he,Y);break;default:throw Error(t(161))}}catch(ge){Bi(f,f.return,ge)}f.flags&=-3}p&4096&&(f.flags&=-4097)}function G4(f,p,A){Lt=f,Ob(f)}function Ob(f,p,A){for(var w=(f.mode&1)!==0;Lt!==null;){var B=Lt,O=B.child;if(B.tag===22&&w){var Y=B.memoizedState!==null||py;if(!Y){var he=B.alternate,ge=he!==null&&he.memoizedState!==null||us;he=py;var Ve=us;if(py=Y,(us=ge)&&!Ve)for(Lt=B;Lt!==null;)Y=Lt,ge=Y.child,Y.tag===22&&Y.memoizedState!==null?Gb(B):ge!==null?(ge.return=Y,Lt=ge):Gb(B);for(;O!==null;)Lt=O,Ob(O),O=O.sibling;Lt=B,py=he,us=Ve}Ub(f)}else(B.subtreeFlags&8772)!==0&&O!==null?(O.return=B,Lt=O):Ub(f)}}function Ub(f){for(;Lt!==null;){var p=Lt;if((p.flags&8772)!==0){var A=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:us||my(5,p);break;case 1:var w=p.stateNode;if(p.flags&4&&!us)if(A===null)w.componentDidMount();else{var B=p.elementType===p.type?A.memoizedProps:qs(p.type,A.memoizedProps);w.componentDidUpdate(B,A.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var O=p.updateQueue;O!==null&&Ic(p,O,w);break;case 3:var Y=p.updateQueue;if(Y!==null){if(A=null,p.child!==null)switch(p.child.tag){case 5:A=p.child.stateNode;break;case 1:A=p.child.stateNode}Ic(p,Y,A)}break;case 5:var he=p.stateNode;if(A===null&&p.flags&4){A=he;var ge=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":ge.autoFocus&&A.focus();break;case"img":ge.src&&(A.src=ge.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Ve=p.alternate;if(Ve!==null){var at=Ve.memoizedState;if(at!==null){var ct=at.dehydrated;ct!==null&&ul(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}us||p.flags&512&&KA(p)}catch(ot){Bi(p,p.return,ot)}}if(p===f){Lt=null;break}if(A=p.sibling,A!==null){A.return=p.return,Lt=A;break}Lt=p.return}}function Nb(f){for(;Lt!==null;){var p=Lt;if(p===f){Lt=null;break}var A=p.sibling;if(A!==null){A.return=p.return,Lt=A;break}Lt=p.return}}function Gb(f){for(;Lt!==null;){var p=Lt;try{switch(p.tag){case 0:case 11:case 15:var A=p.return;try{my(4,p)}catch(ge){Bi(p,A,ge)}break;case 1:var w=p.stateNode;if(typeof w.componentDidMount=="function"){var B=p.return;try{w.componentDidMount()}catch(ge){Bi(p,B,ge)}}var O=p.return;try{KA(p)}catch(ge){Bi(p,O,ge)}break;case 5:var Y=p.return;try{KA(p)}catch(ge){Bi(p,Y,ge)}}}catch(ge){Bi(p,p.return,ge)}if(p===f){Lt=null;break}var he=p.sibling;if(he!==null){he.return=p.return,Lt=he;break}Lt=p.return}}var H4=Math.ceil,gy=C.ReactCurrentDispatcher,YA=C.ReactCurrentOwner,na=C.ReactCurrentBatchConfig,Ln=0,Dr=null,lr=null,Xr=0,wo=0,rp=hi(0),_r=0,Mg=null,qh=0,vy=0,JA=0,wg=null,Qs=null,qA=0,sp=1/0,Au=null,yy=!1,QA=null,Fc=null,xy=!1,kc=null,_y=0,Cg=0,ZA=null,Sy=-1,Ay=0;function Ds(){return(Ln&6)!==0?je():Sy!==-1?Sy:Sy=je()}function Oc(f){return(f.mode&1)===0?1:(Ln&2)!==0&&Xr!==0?Xr&-Xr:HA.transition!==null?(Ay===0&&(Ay=Cr()),Ay):(f=mn,f!==0||(f=window.event,f=f===void 0?16:hl(f.type)),f)}function Va(f,p,A,w){if(50<Cg)throw Cg=0,ZA=null,Error(t(185));po(f,A,w),((Ln&2)===0||f!==Dr)&&(f===Dr&&((Ln&2)===0&&(vy|=A),_r===4&&Uc(f,Xr)),Zs(f,w),A===1&&Ln===0&&(p.mode&1)===0&&(sp=je()+500,Fh&&Qo()))}function Zs(f,p){var A=f.callbackNode;_i(f,p);var w=Qi(f,f===Dr?Xr:0);if(w===0)A!==null&&ft(A),f.callbackNode=null,f.callbackPriority=0;else if(p=w&-w,f.callbackPriority!==p){if(A!=null&&ft(A),p===1)f.tag===0?ty(zb.bind(null,f)):kh(zb.bind(null,f)),GA(function(){(Ln&6)===0&&Qo()}),A=null;else{switch(Ko(w)){case 1:A=Vt;break;case 4:A=Pt;break;case 16:A=un;break;case 536870912:A=En;break;default:A=un}A=Jb(A,Hb.bind(null,f))}f.callbackPriority=p,f.callbackNode=A}}function Hb(f,p){if(Sy=-1,Ay=0,(Ln&6)!==0)throw Error(t(327));var A=f.callbackNode;if(op()&&f.callbackNode!==A)return null;var w=Qi(f,f===Dr?Xr:0);if(w===0)return null;if((w&30)!==0||(w&f.expiredLanes)!==0||p)p=Ey(f,w);else{p=w;var B=Ln;Ln|=2;var O=Wb();(Dr!==f||Xr!==p)&&(Au=null,sp=je()+500,Zh(f,p));do try{W4();break}catch(he){Vb(f,he)}while(!0);pu(),gy.current=O,Ln=B,lr!==null?p=0:(Dr=null,Xr=0,p=_r)}if(p!==0){if(p===2&&(B=Hi(f),B!==0&&(w=B,p=e1(f,B))),p===1)throw A=Mg,Zh(f,0),Uc(f,w),Zs(f,je()),A;if(p===6)Uc(f,w);else{if(B=f.current.alternate,(w&30)===0&&!z4(B)&&(p=Ey(f,w),p===2&&(O=Hi(f),O!==0&&(w=O,p=e1(f,O))),p===1))throw A=Mg,Zh(f,0),Uc(f,w),Zs(f,je()),A;switch(f.finishedWork=B,f.finishedLanes=w,p){case 0:case 1:throw Error(t(345));case 2:ef(f,Qs,Au);break;case 3:if(Uc(f,w),(w&130023424)===w&&(p=qA+500-je(),10<p)){if(Qi(f,0)!==0)break;if(B=f.suspendedLanes,(B&w)!==w){Ds(),f.pingedLanes|=f.suspendedLanes&B;break}f.timeoutHandle=eg(ef.bind(null,f,Qs,Au),p);break}ef(f,Qs,Au);break;case 4:if(Uc(f,w),(w&4194240)===w)break;for(p=f.eventTimes,B=-1;0<w;){var Y=31-on(w);O=1<<Y,Y=p[Y],Y>B&&(B=Y),w&=~O}if(w=B,w=je()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*H4(w/1960))-w,10<w){f.timeoutHandle=eg(ef.bind(null,f,Qs,Au),w);break}ef(f,Qs,Au);break;case 5:ef(f,Qs,Au);break;default:throw Error(t(329))}}}return Zs(f,je()),f.callbackNode===A?Hb.bind(null,f):null}function e1(f,p){var A=wg;return f.current.memoizedState.isDehydrated&&(Zh(f,p).flags|=256),f=Ey(f,p),f!==2&&(p=Qs,Qs=A,p!==null&&t1(p)),f}function t1(f){Qs===null?Qs=f:Qs.push.apply(Qs,f)}function z4(f){for(var p=f;;){if(p.flags&16384){var A=p.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var w=0;w<A.length;w++){var B=A[w],O=B.getSnapshot;B=B.value;try{if(!Ms(O(),B))return!1}catch{return!1}}}if(A=p.child,p.subtreeFlags&16384&&A!==null)A.return=p,p=A;else{if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Uc(f,p){for(p&=~JA,p&=~vy,f.suspendedLanes|=p,f.pingedLanes&=~p,f=f.expirationTimes;0<p;){var A=31-on(p),w=1<<A;f[A]=-1,p&=~w}}function zb(f){if((Ln&6)!==0)throw Error(t(327));op();var p=Qi(f,0);if((p&1)===0)return Zs(f,je()),null;var A=Ey(f,p);if(f.tag!==0&&A===2){var w=Hi(f);w!==0&&(p=w,A=e1(f,w))}if(A===1)throw A=Mg,Zh(f,0),Uc(f,p),Zs(f,je()),A;if(A===6)throw Error(t(345));return f.finishedWork=f.current.alternate,f.finishedLanes=p,ef(f,Qs,Au),Zs(f,je()),null}function n1(f,p){var A=Ln;Ln|=1;try{return f(p)}finally{Ln=A,Ln===0&&(sp=je()+500,Fh&&Qo())}}function Qh(f){kc!==null&&kc.tag===0&&(Ln&6)===0&&op();var p=Ln;Ln|=1;var A=na.transition,w=mn;try{if(na.transition=null,mn=1,f)return f()}finally{mn=w,na.transition=A,Ln=p,(Ln&6)===0&&Qo()}}function i1(){wo=rp.current,Yn(rp)}function Zh(f,p){f.finishedWork=null,f.finishedLanes=0;var A=f.timeoutHandle;if(A!==-1&&(f.timeoutHandle=-1,tg(A)),lr!==null)for(A=lr.return;A!==null;){var w=A;switch(Da(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&Dh();break;case 3:Sl(),Yn(Vr),Yn(mr),ea();break;case 5:Lc(w);break;case 4:Sl();break;case 13:Yn(Zn);break;case 19:Yn(Zn);break;case 10:Gh(w.type._context);break;case 22:case 23:i1()}A=A.return}if(Dr=f,lr=f=Nc(f.current,null),Xr=wo=p,_r=0,Mg=null,JA=vy=qh=0,Qs=wg=null,Fa!==null){for(p=0;p<Fa.length;p++)if(A=Fa[p],w=A.interleaved,w!==null){A.interleaved=null;var B=w.next,O=A.pending;if(O!==null){var Y=O.next;O.next=B,w.next=Y}A.pending=w}Fa=null}return f}function Vb(f,p){do{var A=lr;try{if(pu(),yu.current=tp,To){for(var w=Jn.memoizedState;w!==null;){var B=w.queue;B!==null&&(B.pending=null),w=w.next}To=!1}if(Oa=0,bn=di=Jn=null,Pr=!1,Al=0,YA.current=null,A===null||A.return===null){_r=1,Mg=p,lr=null;break}e:{var O=f,Y=A.return,he=A,ge=p;if(p=Xr,he.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Ve=ge,at=he,ct=at.tag;if((at.mode&1)===0&&(ct===0||ct===11||ct===15)){var ot=at.alternate;ot?(at.updateQueue=ot.updateQueue,at.memoizedState=ot.memoizedState,at.lanes=ot.lanes):(at.updateQueue=null,at.memoizedState=null)}var bt=It(Y);if(bt!==null){bt.flags&=-257,tn(bt,Y,he,O,p),bt.mode&1&&dt(O,Ve,p),p=bt,ge=Ve;var Dt=p.updateQueue;if(Dt===null){var kt=new Set;kt.add(ge),p.updateQueue=kt}else Dt.add(ge);break e}else{if((p&1)===0){dt(O,Ve,p),r1();break e}ge=Error(t(426))}}else if(Qn&&he.mode&1){var ji=It(Y);if(ji!==null){(ji.flags&65536)===0&&(ji.flags|=256),tn(ji,Y,he,O,p),bc(b(ge,he));break e}}O=ge=b(ge,he),_r!==4&&(_r=2),wg===null?wg=[O]:wg.push(O),O=Y;do{switch(O.tag){case 3:O.flags|=65536,p&=-p,O.lanes|=p;var Ie=Se(O,ge,p);mu(O,Ie);break e;case 1:he=ge;var xe=O.type,Fe=O.stateNode;if((O.flags&128)===0&&(typeof xe.getDerivedStateFromError=="function"||Fe!==null&&typeof Fe.componentDidCatch=="function"&&(Fc===null||!Fc.has(Fe)))){O.flags|=65536,p&=-p,O.lanes|=p;var pt=qe(O,he,p);mu(O,pt);break e}}O=O.return}while(O!==null)}Kb(A)}catch(Gt){p=Gt,lr===A&&A!==null&&(lr=A=A.return);continue}break}while(!0)}function Wb(){var f=gy.current;return gy.current=tp,f===null?tp:f}function r1(){(_r===0||_r===3||_r===2)&&(_r=4),Dr===null||(qh&268435455)===0&&(vy&268435455)===0||Uc(Dr,Xr)}function Ey(f,p){var A=Ln;Ln|=2;var w=Wb();(Dr!==f||Xr!==p)&&(Au=null,Zh(f,p));do try{V4();break}catch(B){Vb(f,B)}while(!0);if(pu(),Ln=A,gy.current=w,lr!==null)throw Error(t(261));return Dr=null,Xr=0,_r}function V4(){for(;lr!==null;)jb(lr)}function W4(){for(;lr!==null&&!At();)jb(lr)}function jb(f){var p=Yb(f.alternate,f,wo);f.memoizedProps=f.pendingProps,p===null?Kb(f):lr=p,YA.current=null}function Kb(f){var p=f;do{var A=p.alternate;if(f=p.return,(p.flags&32768)===0){if(A=k4(A,p,wo),A!==null){lr=A;return}}else{if(A=O4(A,p),A!==null){A.flags&=32767,lr=A;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{_r=6,lr=null;return}}if(p=p.sibling,p!==null){lr=p;return}lr=p=f}while(p!==null);_r===0&&(_r=5)}function ef(f,p,A){var w=mn,B=na.transition;try{na.transition=null,mn=1,j4(f,p,A,w)}finally{na.transition=B,mn=w}return null}function j4(f,p,A,w){do op();while(kc!==null);if((Ln&6)!==0)throw Error(t(327));A=f.finishedWork;var B=f.finishedLanes;if(A===null)return null;if(f.finishedWork=null,f.finishedLanes=0,A===f.current)throw Error(t(177));f.callbackNode=null,f.callbackPriority=0;var O=A.lanes|A.childLanes;if(gd(f,O),f===Dr&&(lr=Dr=null,Xr=0),(A.subtreeFlags&2064)===0&&(A.flags&2064)===0||xy||(xy=!0,Jb(un,function(){return op(),null})),O=(A.flags&15990)!==0,(A.subtreeFlags&15990)!==0||O){O=na.transition,na.transition=null;var Y=mn;mn=1;var he=Ln;Ln|=4,YA.current=null,N4(f,A),kb(A,f),rr(Qm),er=!!Mc,Qm=Mc=null,f.current=A,G4(A),Rt(),Ln=he,mn=Y,na.transition=O}else f.current=A;if(xy&&(xy=!1,kc=f,_y=B),O=f.pendingLanes,O===0&&(Fc=null),mt(A.stateNode),Zs(f,je()),p!==null)for(w=f.onRecoverableError,A=0;A<p.length;A++)B=p[A],w(B.value,{componentStack:B.stack,digest:B.digest});if(yy)throw yy=!1,f=QA,QA=null,f;return(_y&1)!==0&&f.tag!==0&&op(),O=f.pendingLanes,(O&1)!==0?f===ZA?Cg++:(Cg=0,ZA=f):Cg=0,Qo(),null}function op(){if(kc!==null){var f=Ko(_y),p=na.transition,A=mn;try{if(na.transition=null,mn=16>f?16:f,kc===null)var w=!1;else{if(f=kc,kc=null,_y=0,(Ln&6)!==0)throw Error(t(331));var B=Ln;for(Ln|=4,Lt=f.current;Lt!==null;){var O=Lt,Y=O.child;if((Lt.flags&16)!==0){var he=O.deletions;if(he!==null){for(var ge=0;ge<he.length;ge++){var Ve=he[ge];for(Lt=Ve;Lt!==null;){var at=Lt;switch(at.tag){case 0:case 11:case 15:Tg(8,at,O)}var ct=at.child;if(ct!==null)ct.return=at,Lt=ct;else for(;Lt!==null;){at=Lt;var ot=at.sibling,bt=at.return;if(Lb(at),at===Ve){Lt=null;break}if(ot!==null){ot.return=bt,Lt=ot;break}Lt=bt}}}var Dt=O.alternate;if(Dt!==null){var kt=Dt.child;if(kt!==null){Dt.child=null;do{var ji=kt.sibling;kt.sibling=null,kt=ji}while(kt!==null)}}Lt=O}}if((O.subtreeFlags&2064)!==0&&Y!==null)Y.return=O,Lt=Y;else e:for(;Lt!==null;){if(O=Lt,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Tg(9,O,O.return)}var Ie=O.sibling;if(Ie!==null){Ie.return=O.return,Lt=Ie;break e}Lt=O.return}}var xe=f.current;for(Lt=xe;Lt!==null;){Y=Lt;var Fe=Y.child;if((Y.subtreeFlags&2064)!==0&&Fe!==null)Fe.return=Y,Lt=Fe;else e:for(Y=xe;Lt!==null;){if(he=Lt,(he.flags&2048)!==0)try{switch(he.tag){case 0:case 11:case 15:my(9,he)}}catch(Gt){Bi(he,he.return,Gt)}if(he===Y){Lt=null;break e}var pt=he.sibling;if(pt!==null){pt.return=he.return,Lt=pt;break e}Lt=he.return}}if(Ln=B,Qo(),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(Bn,f)}catch{}w=!0}return w}finally{mn=A,na.transition=p}}return!1}function $b(f,p,A){p=b(A,p),p=Se(f,p,1),f=ii(f,p,1),p=Ds(),f!==null&&(po(f,1,p),Zs(f,p))}function Bi(f,p,A){if(f.tag===3)$b(f,f,A);else for(;p!==null;){if(p.tag===3){$b(p,f,A);break}else if(p.tag===1){var w=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Fc===null||!Fc.has(w))){f=b(A,f),f=qe(p,f,1),p=ii(p,f,1),f=Ds(),p!==null&&(po(p,1,f),Zs(p,f));break}}p=p.return}}function K4(f,p,A){var w=f.pingCache;w!==null&&w.delete(p),p=Ds(),f.pingedLanes|=f.suspendedLanes&A,Dr===f&&(Xr&A)===A&&(_r===4||_r===3&&(Xr&130023424)===Xr&&500>je()-qA?Zh(f,0):JA|=A),Zs(f,p)}function Xb(f,p){p===0&&((f.mode&1)===0?p=1:(p=qn,qn<<=1,(qn&130023424)===0&&(qn=4194304)));var A=Ds();f=Ao(f,p),f!==null&&(po(f,p,A),Zs(f,A))}function $4(f){var p=f.memoizedState,A=0;p!==null&&(A=p.retryLane),Xb(f,A)}function X4(f,p){var A=0;switch(f.tag){case 13:var w=f.stateNode,B=f.memoizedState;B!==null&&(A=B.retryLane);break;case 19:w=f.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(p),Xb(f,A)}var Yb;Yb=function(f,p,A){if(f!==null)if(f.memoizedProps!==p.pendingProps||Vr.current)cn=!0;else{if((f.lanes&A)===0&&(p.flags&128)===0)return cn=!1,F4(f,p,A);cn=(f.flags&131072)!==0}else cn=!1,Qn&&(p.flags&1048576)!==0&&og(p,jd,p.index);switch(p.lanes=0,p.tag){case 2:var w=p.type;dy(f,p),f=p.pendingProps;var B=au(p,mr.current);_l(p,A),B=jh(null,p,w,f,B,A);var O=pg();return p.flags|=1,typeof B=="object"&&B!==null&&typeof B.render=="function"&&B.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Ir(w)?(O=!0,lu(p)):O=!1,p.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,an(p),B.updater=np,p.stateNode=B,B._reactInternals=p,M(p,w,f,A),p=rn(null,p,w,!0,O,A)):(p.tag=0,Qn&&O&&ag(p),Tt(null,p,B,A),p=p.child),p;case 16:w=p.elementType;e:{switch(dy(f,p),f=p.pendingProps,B=w._init,w=B(w._payload),p.type=w,B=p.tag=J4(w),f=qs(w,f),B){case 0:p=Et(null,p,w,f,A);break e;case 1:p=Ut(null,p,w,f,A);break e;case 11:p=xr(null,p,w,f,A);break e;case 14:p=Ps(null,p,w,qs(w.type,f),A);break e}throw Error(t(306,w,""))}return p;case 0:return w=p.type,B=p.pendingProps,B=p.elementType===w?B:qs(w,B),Et(f,p,w,B,A);case 1:return w=p.type,B=p.pendingProps,B=p.elementType===w?B:qs(w,B),Ut(f,p,w,B,A);case 3:e:{if(nn(p),f===null)throw Error(t(387));w=p.pendingProps,O=p.memoizedState,B=O.element,Ei(f,p),fi(p,w,null,A);var Y=p.memoizedState;if(w=Y.element,O.isDehydrated)if(O={element:w,isDehydrated:!1,cache:Y.cache,pendingSuspenseBoundaries:Y.pendingSuspenseBoundaries,transitions:Y.transitions},p.updateQueue.baseState=O,p.memoizedState=O,p.flags&256){B=b(Error(t(423)),p),p=Mn(f,p,w,A,B);break e}else if(w!==B){B=b(Error(t(424)),p),p=Mn(f,p,w,A,B);break e}else for(jr=ba(p.stateNode.containerInfo.firstChild),gr=p,Qn=!0,Js=null,A=Nh(p,null,w,A),p.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(xl(),w===B){p=Su(f,p,A);break e}Tt(f,p,w,A)}p=p.child}return p;case 5:return vu(p),f===null&&$d(p),w=p.type,B=p.pendingProps,O=f!==null?f.memoizedProps:null,Y=B.children,Zm(w,B)?Y=null:O!==null&&Zm(w,O)&&(p.flags|=32),$e(f,p),Tt(f,p,Y,A),p.child;case 6:return f===null&&$d(p),null;case 13:return Ga(f,p,A);case 4:return Vh(p,p.stateNode.containerInfo),w=p.pendingProps,f===null?p.child=hu(p,null,w,A):Tt(f,p,w,A),p.child;case 11:return w=p.type,B=p.pendingProps,B=p.elementType===w?B:qs(w,B),xr(f,p,w,B,A);case 7:return Tt(f,p,p.pendingProps,A),p.child;case 8:return Tt(f,p,p.pendingProps.children,A),p.child;case 12:return Tt(f,p,p.pendingProps.children,A),p.child;case 10:e:{if(w=p.type._context,B=p.pendingProps,O=p.memoizedProps,Y=B.value,jn(fu,w._currentValue),w._currentValue=Y,O!==null)if(Ms(O.value,Y)){if(O.children===B.children&&!Vr.current){p=Su(f,p,A);break e}}else for(O=p.child,O!==null&&(O.return=p);O!==null;){var he=O.dependencies;if(he!==null){Y=O.child;for(var ge=he.firstContext;ge!==null;){if(ge.context===w){if(O.tag===1){ge=Vn(-1,A&-A),ge.tag=2;var Ve=O.updateQueue;if(Ve!==null){Ve=Ve.shared;var at=Ve.pending;at===null?ge.next=ge:(ge.next=at.next,at.next=ge),Ve.pending=ge}}O.lanes|=A,ge=O.alternate,ge!==null&&(ge.lanes|=A),Hh(O.return,A,p),he.lanes|=A;break}ge=ge.next}}else if(O.tag===10)Y=O.type===p.type?null:O.child;else if(O.tag===18){if(Y=O.return,Y===null)throw Error(t(341));Y.lanes|=A,he=Y.alternate,he!==null&&(he.lanes|=A),Hh(Y,A,p),Y=O.sibling}else Y=O.child;if(Y!==null)Y.return=O;else for(Y=O;Y!==null;){if(Y===p){Y=null;break}if(O=Y.sibling,O!==null){O.return=Y.return,Y=O;break}Y=Y.return}O=Y}Tt(f,p,B.children,A),p=p.child}return p;case 9:return B=p.type,w=p.pendingProps.children,_l(p,A),B=bs(B),w=w(B),p.flags|=1,Tt(f,p,w,A),p.child;case 14:return w=p.type,B=qs(w,p.pendingProps),B=qs(w.type,B),Ps(f,p,w,B,A);case 15:return Ne(f,p,p.type,p.pendingProps,A);case 17:return w=p.type,B=p.pendingProps,B=p.elementType===w?B:qs(w,B),dy(f,p),p.tag=1,Ir(w)?(f=!0,lu(p)):f=!1,_l(p,A),v(p,w,B),M(p,w,B,A),rn(null,p,w,!0,f,A);case 19:return wb(f,p,A);case 22:return Me(f,p,A)}throw Error(t(156,p.tag))};function Jb(f,p){return be(f,p)}function Y4(f,p,A,w){this.tag=f,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ia(f,p,A,w){return new Y4(f,p,A,w)}function s1(f){return f=f.prototype,!(!f||!f.isReactComponent)}function J4(f){if(typeof f=="function")return s1(f)?1:0;if(f!=null){if(f=f.$$typeof,f===V)return 11;if(f===re)return 14}return 2}function Nc(f,p){var A=f.alternate;return A===null?(A=ia(f.tag,p,f.key,f.mode),A.elementType=f.elementType,A.type=f.type,A.stateNode=f.stateNode,A.alternate=f,f.alternate=A):(A.pendingProps=p,A.type=f.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=f.flags&14680064,A.childLanes=f.childLanes,A.lanes=f.lanes,A.child=f.child,A.memoizedProps=f.memoizedProps,A.memoizedState=f.memoizedState,A.updateQueue=f.updateQueue,p=f.dependencies,A.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},A.sibling=f.sibling,A.index=f.index,A.ref=f.ref,A}function Ty(f,p,A,w,B,O){var Y=2;if(w=f,typeof f=="function")s1(f)&&(Y=1);else if(typeof f=="string")Y=5;else e:switch(f){case L:return tf(A.children,B,O,p);case F:Y=8,B|=8;break;case D:return f=ia(12,A,p,B|2),f.elementType=D,f.lanes=O,f;case q:return f=ia(13,A,p,B),f.elementType=q,f.lanes=O,f;case Q:return f=ia(19,A,p,B),f.elementType=Q,f.lanes=O,f;case se:return My(A,B,O,p);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case I:Y=10;break e;case N:Y=9;break e;case V:Y=11;break e;case re:Y=14;break e;case ee:Y=16,w=null;break e}throw Error(t(130,f==null?f:typeof f,""))}return p=ia(Y,A,p,B),p.elementType=f,p.type=w,p.lanes=O,p}function tf(f,p,A,w){return f=ia(7,f,w,p),f.lanes=A,f}function My(f,p,A,w){return f=ia(22,f,w,p),f.elementType=se,f.lanes=A,f.stateNode={isHidden:!1},f}function o1(f,p,A){return f=ia(6,f,null,p),f.lanes=A,f}function a1(f,p,A){return p=ia(4,f.children!==null?f.children:[],f.key,p),p.lanes=A,p.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},p}function q4(f,p,A,w,B){this.tag=p,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fo(0),this.expirationTimes=fo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fo(0),this.identifierPrefix=w,this.onRecoverableError=B,this.mutableSourceEagerHydrationData=null}function l1(f,p,A,w,B,O,Y,he,ge){return f=new q4(f,p,A,he,ge),p===1?(p=1,O===!0&&(p|=8)):p=0,O=ia(3,null,null,p),f.current=O,O.stateNode=f,O.memoizedState={element:w,isDehydrated:A,cache:null,transitions:null,pendingSuspenseBoundaries:null},an(O),f}function Q4(f,p,A){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:w==null?null:""+w,children:f,containerInfo:p,implementation:A}}function qb(f){if(!f)return Ia;f=f._reactInternals;e:{if(Ss(f)!==f||f.tag!==1)throw Error(t(170));var p=f;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Ir(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(f.tag===1){var A=f.type;if(Ir(A))return Bh(f,A,p)}return p}function Qb(f,p,A,w,B,O,Y,he,ge){return f=l1(A,w,!0,f,B,O,Y,he,ge),f.context=qb(null),A=f.current,w=Ds(),B=Oc(A),O=Vn(w,B),O.callback=p??null,ii(A,O,B),f.current.lanes=B,po(f,B,w),Zs(f,w),f}function wy(f,p,A,w){var B=p.current,O=Ds(),Y=Oc(B);return A=qb(A),p.context===null?p.context=A:p.pendingContext=A,p=Vn(O,Y),p.payload={element:f},w=w===void 0?null:w,w!==null&&(p.callback=w),f=ii(B,p,Y),f!==null&&(Va(f,B,Y,O),Lr(f,B,Y)),Y}function Cy(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Zb(f,p){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var A=f.retryLane;f.retryLane=A!==0&&A<p?A:p}}function u1(f,p){Zb(f,p),(f=f.alternate)&&Zb(f,p)}function Z4(){return null}var eR=typeof reportError=="function"?reportError:function(f){console.error(f)};function c1(f){this._internalRoot=f}by.prototype.render=c1.prototype.render=function(f){var p=this._internalRoot;if(p===null)throw Error(t(409));wy(f,p,null,null)},by.prototype.unmount=c1.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var p=f.containerInfo;Qh(function(){wy(null,f,null,null)}),p[Cs]=null}};function by(f){this._internalRoot=f}by.prototype.unstable_scheduleHydration=function(f){if(f){var p=$o();f={blockedOn:null,target:f,priority:p};for(var A=0;A<Ws.length&&p!==0&&p<Ws[A].priority;A++);Ws.splice(A,0,f),A===0&&br(f)}};function h1(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function Ry(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function tR(){}function e5(f,p,A,w,B){if(B){if(typeof w=="function"){var O=w;w=function(){var Ve=Cy(Y);O.call(Ve)}}var Y=Qb(p,w,f,0,null,!1,!1,"",tR);return f._reactRootContainer=Y,f[Cs]=Y.current,Ec(f.nodeType===8?f.parentNode:f),Qh(),Y}for(;B=f.lastChild;)f.removeChild(B);if(typeof w=="function"){var he=w;w=function(){var Ve=Cy(ge);he.call(Ve)}}var ge=l1(f,0,!1,null,null,!1,!1,"",tR);return f._reactRootContainer=ge,f[Cs]=ge.current,Ec(f.nodeType===8?f.parentNode:f),Qh(function(){wy(p,ge,A,w)}),ge}function Iy(f,p,A,w,B){var O=A._reactRootContainer;if(O){var Y=O;if(typeof B=="function"){var he=B;B=function(){var ge=Cy(Y);he.call(ge)}}wy(p,Y,f,B)}else Y=e5(A,p,f,B,w);return Cy(Y)}ol=function(f){switch(f.tag){case 3:var p=f.stateNode;if(p.current.memoizedState.isDehydrated){var A=yn(p.pendingLanes);A!==0&&(mo(p,A|1),Zs(p,je()),(Ln&6)===0&&(sp=je()+500,Qo()))}break;case 13:Qh(function(){var w=Ao(f,1);if(w!==null){var B=Ds();Va(w,f,1,B)}}),u1(f,1)}},hc=function(f){if(f.tag===13){var p=Ao(f,134217728);if(p!==null){var A=Ds();Va(p,f,134217728,A)}u1(f,134217728)}},fc=function(f){if(f.tag===13){var p=Oc(f),A=Ao(f,p);if(A!==null){var w=Ds();Va(A,f,p,w)}u1(f,p)}},$o=function(){return mn},Yl=function(f,p){var A=mn;try{return mn=f,p()}finally{mn=A}},Te=function(f,p,A){switch(p){case"input":if(et(f,A),p=A.name,A.type==="radio"&&p!=null){for(A=f;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<A.length;p++){var w=A[p];if(w!==f&&w.form===f.form){var B=zd(w);if(!B)throw Error(t(90));K(w),et(w,B)}}}break;case"textarea":Ee(f,A);break;case"select":p=A.value,p!=null&&z(f,!!A.multiple,p,!1)}},zt=n1,gt=Qh;var t5={usingClientEntryPoint:!1,Events:[Ra,Ai,zd,_t,Ht,n1]},bg={findFiberByHostInstance:yl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n5={bundleType:bg.bundleType,version:bg.version,rendererPackageName:bg.rendererPackageName,rendererConfig:bg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=Ue(f),f===null?null:f.stateNode},findFiberByHostInstance:bg.findFiberByHostInstance||Z4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ly=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ly.isDisabled&&Ly.supportsFiber)try{Bn=Ly.inject(n5),wt=Ly}catch{}}return eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t5,eo.createPortal=function(f,p){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h1(p))throw Error(t(200));return Q4(f,p,null,A)},eo.createRoot=function(f,p){if(!h1(f))throw Error(t(299));var A=!1,w="",B=eR;return p!=null&&(p.unstable_strictMode===!0&&(A=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onRecoverableError!==void 0&&(B=p.onRecoverableError)),p=l1(f,1,!1,null,null,A,!1,w,B),f[Cs]=p.current,Ec(f.nodeType===8?f.parentNode:f),new c1(p)},eo.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var p=f._reactInternals;if(p===void 0)throw typeof f.render=="function"?Error(t(188)):(f=Object.keys(f).join(","),Error(t(268,f)));return f=Ue(p),f=f===null?null:f.stateNode,f},eo.flushSync=function(f){return Qh(f)},eo.hydrate=function(f,p,A){if(!Ry(p))throw Error(t(200));return Iy(null,f,p,!0,A)},eo.hydrateRoot=function(f,p,A){if(!h1(f))throw Error(t(405));var w=A!=null&&A.hydratedSources||null,B=!1,O="",Y=eR;if(A!=null&&(A.unstable_strictMode===!0&&(B=!0),A.identifierPrefix!==void 0&&(O=A.identifierPrefix),A.onRecoverableError!==void 0&&(Y=A.onRecoverableError)),p=Qb(p,null,f,1,A??null,B,!1,O,Y),f[Cs]=p.current,Ec(f),w)for(f=0;f<w.length;f++)A=w[f],B=A._getVersion,B=B(A._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[A,B]:p.mutableSourceEagerHydrationData.push(A,B);return new by(p)},eo.render=function(f,p,A){if(!Ry(p))throw Error(t(200));return Iy(null,f,p,!1,A)},eo.unmountComponentAtNode=function(f){if(!Ry(f))throw Error(t(40));return f._reactRootContainer?(Qh(function(){Iy(null,null,f,!1,function(){f._reactRootContainer=null,f[Cs]=null})}),!0):!1},eo.unstable_batchedUpdates=n1,eo.unstable_renderSubtreeIntoContainer=function(f,p,A,w){if(!Ry(A))throw Error(t(200));if(f==null||f._reactInternals===void 0)throw Error(t(38));return Iy(f,p,A,!1,w)},eo.version="18.3.1-next-f1338f8080-20240426",eo}var uR;function c5(){if(uR)return p1.exports;uR=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),p1.exports=u5(),p1.exports}var cR;function h5(){if(cR)return Py;cR=1;var r=c5();return Py.createRoot=r.createRoot,Py.hydrateRoot=r.hydrateRoot,Py}var iB=h5();/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const bm="167",Sf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Af={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},rB=0,ST=1,sB=2,f5=3,oB=0,FS=1,f0=2,Ya=3,Wl=0,Ns=1,Lo=2,Wu=0,Nf=1,AT=2,ET=3,TT=4,aB=5,ih=100,lB=101,uB=102,cB=103,hB=104,fB=200,dB=201,pB=202,mB=203,T_=204,M_=205,gB=206,vB=207,yB=208,xB=209,_B=210,SB=211,AB=212,EB=213,TB=214,MB=0,wB=1,CB=2,O0=3,bB=4,RB=5,IB=6,LB=7,vv=0,PB=1,DB=2,Ul=0,BB=1,FB=2,kB=3,XM=4,OB=5,UB=6,NB=7,MT="attached",GB="detached",kS=300,Yu=301,ch=302,U0=303,N0=304,Rm=306,hh=1e3,Bo=1001,am=1002,Er=1003,OS=1004,d5=1004,If=1005,p5=1005,vi=1006,qp=1007,m5=1007,da=1008,g5=1008,Za=1009,YM=1010,JM=1011,lm=1012,US=1013,Ju=1014,ro=1015,Im=1016,NS=1017,GS=1018,Zf=1020,qM=35902,QM=1021,ZM=1022,ms=1023,ew=1024,tw=1025,Gf=1026,ed=1027,HS=1028,yv=1029,nw=1030,zS=1031,v5=1032,VS=1033,d0=33776,p0=33777,m0=33778,g0=33779,w_=35840,C_=35841,b_=35842,R_=35843,I_=36196,L_=37492,P_=37496,D_=37808,B_=37809,F_=37810,k_=37811,O_=37812,U_=37813,N_=37814,G_=37815,H_=37816,z_=37817,V_=37818,W_=37819,j_=37820,K_=37821,v0=36492,$_=36494,X_=36495,iw=36283,Y_=36284,J_=36285,q_=36286,HB=2200,zB=2201,VB=2202,um=2300,cm=2301,n_=2302,Lf=2400,Pf=2401,G0=2402,WS=2500,rw=2501,WB=0,sw=1,Q_=2,jB=3200,ow=3201,y5=3202,x5=3203,vh=0,KB=1,Ou="",fa="srgb",ic="srgb-linear",jS="display-p3",xv="display-p3-linear",H0="linear",ri="srgb",z0="rec709",V0="p3",_5=0,Ef=7680,S5=7681,A5=7682,E5=7683,T5=34055,M5=34056,w5=5386,C5=512,b5=513,R5=514,I5=515,L5=516,P5=517,D5=518,wT=519,$B=512,XB=513,YB=514,aw=515,JB=516,qB=517,QB=518,ZB=519,W0=35044,B5=35048,F5=35040,k5=35045,O5=35049,U5=35041,N5=35046,G5=35050,H5=35042,z5="100",CT="300 es",Dl=2e3,j0=2001;let rc=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};const cs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let hR=1234567;const Hf=Math.PI/180,hm=180/Math.PI;function ko(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(cs[r&255]+cs[r>>8&255]+cs[r>>16&255]+cs[r>>24&255]+"-"+cs[e&255]+cs[e>>8&255]+"-"+cs[e>>16&15|64]+cs[e>>24&255]+"-"+cs[t&63|128]+cs[t>>8&255]+"-"+cs[t>>16&255]+cs[t>>24&255]+cs[n&255]+cs[n>>8&255]+cs[n>>16&255]+cs[n>>24&255]).toLowerCase()}function Oi(r,e,t){return Math.max(e,Math.min(t,r))}function lw(r,e){return(r%e+e)%e}function V5(r,e,t,n,i){return n+(r-e)*(i-n)/(t-e)}function W5(r,e,t){return r!==e?(t-r)/(e-r):0}function y0(r,e,t){return(1-t)*r+t*e}function j5(r,e,t,n){return y0(r,e,1-Math.exp(-t*n))}function K5(r,e=1){return e-Math.abs(lw(r,e*2)-e)}function $5(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function X5(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function Y5(r,e){return r+Math.floor(Math.random()*(e-r+1))}function J5(r,e){return r+Math.random()*(e-r)}function q5(r){return r*(.5-Math.random())}function Q5(r){r!==void 0&&(hR=r);let e=hR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Z5(r){return r*Hf}function eG(r){return r*hm}function tG(r){return(r&r-1)===0&&r!==0}function nG(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function iG(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function rG(r,e,t,n,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+n)/2),c=o((e+n)/2),h=s((e-n)/2),d=o((e-n)/2),m=s((n-e)/2),g=o((n-e)/2);switch(i){case"XYX":r.set(a*c,l*h,l*d,a*u);break;case"YZY":r.set(l*d,a*c,l*h,a*u);break;case"ZXZ":r.set(l*h,l*d,a*c,a*u);break;case"XZX":r.set(a*c,l*g,l*m,a*u);break;case"YXY":r.set(l*m,a*c,l*g,a*u);break;case"ZYZ":r.set(l*g,l*m,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Os(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function fn(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const _v={DEG2RAD:Hf,RAD2DEG:hm,generateUUID:ko,clamp:Oi,euclideanModulo:lw,mapLinear:V5,inverseLerp:W5,lerp:y0,damp:j5,pingpong:K5,smoothstep:$5,smootherstep:X5,randInt:Y5,randFloat:J5,randFloatSpread:q5,seededRandom:Q5,degToRad:Z5,radToDeg:eG,isPowerOfTwo:tG,ceilPowerOfTwo:nG,floorPowerOfTwo:iG,setQuaternionFromProperEuler:rG,normalize:fn,denormalize:Os};class Qe{constructor(e=0,t=0){Qe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*i+e.x,this.y=s*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ln{constructor(e,t,n,i,s,o,a,l,u){ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,s,o,a,l,u)}set(e,t,n,i,s,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=s,c[5]=l,c[6]=n,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],u=n[1],c=n[4],h=n[7],d=n[2],m=n[5],g=n[8],x=i[0],_=i[3],S=i[6],T=i[1],E=i[4],C=i[7],R=i[2],P=i[5],L=i[8];return s[0]=o*x+a*T+l*R,s[3]=o*_+a*E+l*P,s[6]=o*S+a*C+l*L,s[1]=u*x+c*T+h*R,s[4]=u*_+c*E+h*P,s[7]=u*S+c*C+h*L,s[2]=d*x+m*T+g*R,s[5]=d*_+m*E+g*P,s[8]=d*S+m*C+g*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-n*s*c+n*a*l+i*s*u-i*o*l}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=a*l-c*s,m=u*s-o*l,g=t*h+n*d+i*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/g;return e[0]=h*x,e[1]=(i*u-c*n)*x,e[2]=(a*n-i*o)*x,e[3]=d*x,e[4]=(c*t-i*l)*x,e[5]=(i*s-a*t)*x,e[6]=m*x,e[7]=(n*l-u*t)*x,e[8]=(o*t-n*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(n*l,n*u,-n*(l*o+u*a)+o+e,-i*u,i*l,-i*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(v1.makeScale(e,t)),this}rotate(e){return this.premultiply(v1.makeRotation(-e)),this}translate(e,t){return this.premultiply(v1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const v1=new ln;function eF(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}const sG={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Up(r,e){return new sG[r](e)}function K0(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function tF(){const r=K0("canvas");return r.style.display="block",r}const fR={};function Qp(r){r in fR||(fR[r]=!0,console.warn(r))}function oG(r,e,t){return new Promise(function(n,i){function s(){switch(r.clientWaitSync(e,r.SYNC_FLUSH_COMMANDS_BIT,0)){case r.WAIT_FAILED:i();break;case r.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}const dR=new ln().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),pR=new ln().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ig={[ic]:{transfer:H0,primaries:z0,luminanceCoefficients:[.2126,.7152,.0722],toReference:r=>r,fromReference:r=>r},[fa]:{transfer:ri,primaries:z0,luminanceCoefficients:[.2126,.7152,.0722],toReference:r=>r.convertSRGBToLinear(),fromReference:r=>r.convertLinearToSRGB()},[xv]:{transfer:H0,primaries:V0,luminanceCoefficients:[.2289,.6917,.0793],toReference:r=>r.applyMatrix3(pR),fromReference:r=>r.applyMatrix3(dR)},[jS]:{transfer:ri,primaries:V0,luminanceCoefficients:[.2289,.6917,.0793],toReference:r=>r.convertSRGBToLinear().applyMatrix3(pR),fromReference:r=>r.applyMatrix3(dR).convertLinearToSRGB()}},aG=new Set([ic,xv]),On={enabled:!0,_workingColorSpace:ic,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(r){if(!aG.has(r))throw new Error(`Unsupported working color space, "${r}".`);this._workingColorSpace=r},convert:function(r,e,t){if(this.enabled===!1||e===t||!e||!t)return r;const n=Ig[e].toReference,i=Ig[t].fromReference;return i(n(r))},fromWorkingColorSpace:function(r,e){return this.convert(r,this._workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this._workingColorSpace)},getPrimaries:function(r){return Ig[r].primaries},getTransfer:function(r){return r===Ou?H0:Ig[r].transfer},getLuminanceCoefficients:function(r,e=this._workingColorSpace){return r.fromArray(Ig[e].luminanceCoefficients)}};function Zp(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function y1(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let ap;class nF{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ap===void 0&&(ap=K0("canvas")),ap.width=e.width,ap.height=e.height;const n=ap.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ap}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=K0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=Zp(s[o]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Zp(t[n]/255)*255):t[n]=Zp(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let lG=0;class Df{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:lG++}),this.uuid=ko(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(x1(i[o].image)):s.push(x1(i[o]))}else s=x1(i);n.url=s}return t||(e.images[this.uuid]=n),n}}function x1(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?nF.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let uG=0;class ci extends rc{constructor(e=ci.DEFAULT_IMAGE,t=ci.DEFAULT_MAPPING,n=Bo,i=Bo,s=vi,o=da,a=ms,l=Za,u=ci.DEFAULT_ANISOTROPY,c=Ou){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:uG++}),this.uuid=ko(),this.name="",this.source=new Df(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Qe(0,0),this.repeat=new Qe(1,1),this.center=new Qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==kS)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hh:e.x=e.x-Math.floor(e.x);break;case Bo:e.x=e.x<0?0:1;break;case am:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hh:e.y=e.y-Math.floor(e.y);break;case Bo:e.y=e.y<0?0:1;break;case am:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ci.DEFAULT_IMAGE=null;ci.DEFAULT_MAPPING=kS;ci.DEFAULT_ANISOTROPY=1;class gn{constructor(e=0,t=0,n=0,i=1){gn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],m=l[5],g=l[9],x=l[2],_=l[6],S=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-x)<.01&&Math.abs(g-_)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+x)<.1&&Math.abs(g+_)<.1&&Math.abs(u+m+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(u+1)/2,C=(m+1)/2,R=(S+1)/2,P=(c+d)/4,L=(h+x)/4,F=(g+_)/4;return E>C&&E>R?E<.01?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(E),i=P/n,s=L/n):C>R?C<.01?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(C),n=P/i,s=F/i):R<.01?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(R),n=L/s,i=F/s),this.set(n,i,s,t),this}let T=Math.sqrt((_-g)*(_-g)+(h-x)*(h-x)+(d-c)*(d-c));return Math.abs(T)<.001&&(T=1),this.x=(_-g)/T,this.y=(h-x)/T,this.z=(d-c)/T,this.w=Math.acos((u+m+S-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class iF extends rc{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new gn(0,0,e,t),this.scissorTest=!1,this.viewport=new gn(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:vi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const s=new ci(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Df(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class el extends iF{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class KS extends ci{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Er,this.minFilter=Er,this.wrapR=Bo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class cG extends el{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new KS(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class uw extends ci{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Er,this.minFilter=Er,this.wrapR=Bo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hG extends el{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new uw(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Nr{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,s,o,a){let l=n[i+0],u=n[i+1],c=n[i+2],h=n[i+3];const d=s[o+0],m=s[o+1],g=s[o+2],x=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=d,e[t+1]=m,e[t+2]=g,e[t+3]=x;return}if(h!==x||l!==d||u!==m||c!==g){let _=1-a;const S=l*d+u*m+c*g+h*x,T=S>=0?1:-1,E=1-S*S;if(E>Number.EPSILON){const R=Math.sqrt(E),P=Math.atan2(R,S*T);_=Math.sin(_*P)/R,a=Math.sin(a*P)/R}const C=a*T;if(l=l*_+d*C,u=u*_+m*C,c=c*_+g*C,h=h*_+x*C,_===1-a){const R=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=R,u*=R,c*=R,h*=R}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,i,s,o){const a=n[i],l=n[i+1],u=n[i+2],c=n[i+3],h=s[o],d=s[o+1],m=s[o+2],g=s[o+3];return e[t]=a*g+c*h+l*m-u*d,e[t+1]=l*g+c*d+u*h-a*m,e[t+2]=u*g+c*m+a*d-l*h,e[t+3]=c*g-a*h-l*d-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(n/2),c=a(i/2),h=a(s/2),d=l(n/2),m=l(i/2),g=l(s/2);switch(o){case"XYZ":this._x=d*c*h+u*m*g,this._y=u*m*h-d*c*g,this._z=u*c*g+d*m*h,this._w=u*c*h-d*m*g;break;case"YXZ":this._x=d*c*h+u*m*g,this._y=u*m*h-d*c*g,this._z=u*c*g-d*m*h,this._w=u*c*h+d*m*g;break;case"ZXY":this._x=d*c*h-u*m*g,this._y=u*m*h+d*c*g,this._z=u*c*g+d*m*h,this._w=u*c*h-d*m*g;break;case"ZYX":this._x=d*c*h-u*m*g,this._y=u*m*h+d*c*g,this._z=u*c*g-d*m*h,this._w=u*c*h+d*m*g;break;case"YZX":this._x=d*c*h+u*m*g,this._y=u*m*h+d*c*g,this._z=u*c*g-d*m*h,this._w=u*c*h-d*m*g;break;case"XZY":this._x=d*c*h-u*m*g,this._y=u*m*h-d*c*g,this._z=u*c*g+d*m*h,this._w=u*c*h+d*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],d=n+a+h;if(d>0){const m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(c-l)*m,this._y=(s-u)*m,this._z=(o-i)*m}else if(n>a&&n>h){const m=2*Math.sqrt(1+n-a-h);this._w=(c-l)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+u)/m}else if(a>h){const m=2*Math.sqrt(1+a-n-h);this._w=(s-u)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(l+c)/m}else{const m=2*Math.sqrt(1+h-n-a);this._w=(o-i)/m,this._x=(s+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Oi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=n*c+o*a+i*u-s*l,this._y=i*c+o*l+s*a-n*u,this._z=s*c+o*u+n*l-i*a,this._w=o*c-n*a-i*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*n+t*this._x,this._y=m*i+t*this._y,this._z=m*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=i*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ae{constructor(e=0,t=0,n=0){ae.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(mR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*i-a*n),c=2*(a*t-s*i),h=2*(s*n-o*t);return this.x=t+l*u+o*h-a*c,this.y=n+l*c+a*u-s*h,this.z=i+l*h+s*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-n*l,this.z=n*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return _1.copy(this).projectOnVector(e),this.sub(_1)}reflect(e){return this.sub(_1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Oi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _1=new ae,mR=new Nr;class Ni{constructor(e=new ae(1/0,1/0,1/0),t=new ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Wa.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Wa.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Wa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Wa):Wa.fromBufferAttribute(s,o),Wa.applyMatrix4(e.matrixWorld),this.expandByPoint(Wa);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Dy.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Dy.copy(n.boundingBox)),Dy.applyMatrix4(e.matrixWorld),this.union(Dy)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Wa),Wa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Lg),By.subVectors(this.max,Lg),lp.subVectors(e.a,Lg),up.subVectors(e.b,Lg),cp.subVectors(e.c,Lg),Hc.subVectors(up,lp),zc.subVectors(cp,up),nf.subVectors(lp,cp);let t=[0,-Hc.z,Hc.y,0,-zc.z,zc.y,0,-nf.z,nf.y,Hc.z,0,-Hc.x,zc.z,0,-zc.x,nf.z,0,-nf.x,-Hc.y,Hc.x,0,-zc.y,zc.x,0,-nf.y,nf.x,0];return!S1(t,lp,up,cp,By)||(t=[1,0,0,0,1,0,0,0,1],!S1(t,lp,up,cp,By))?!1:(Fy.crossVectors(Hc,zc),t=[Fy.x,Fy.y,Fy.z],S1(t,lp,up,cp,By))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Wa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Wa).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Eu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Eu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Eu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Eu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Eu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Eu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Eu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Eu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Eu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Eu=[new ae,new ae,new ae,new ae,new ae,new ae,new ae,new ae],Wa=new ae,Dy=new Ni,lp=new ae,up=new ae,cp=new ae,Hc=new ae,zc=new ae,nf=new ae,Lg=new ae,By=new ae,Fy=new ae,rf=new ae;function S1(r,e,t,n,i){for(let s=0,o=r.length-3;s<=o;s+=3){rf.fromArray(r,s);const a=i.x*Math.abs(rf.x)+i.y*Math.abs(rf.y)+i.z*Math.abs(rf.z),l=e.dot(rf),u=t.dot(rf),c=n.dot(rf);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const fG=new Ni,Pg=new ae,A1=new ae;class Yi{constructor(e=new ae,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):fG.setFromPoints(e).getCenter(n);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Pg.subVectors(e,this.center);const t=Pg.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(Pg,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(A1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Pg.copy(e.center).add(A1)),this.expandByPoint(Pg.copy(e.center).sub(A1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Tu=new ae,E1=new ae,ky=new ae,Vc=new ae,T1=new ae,Oy=new ae,M1=new ae;class ld{constructor(e=new ae,t=new ae(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Tu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Tu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Tu.copy(this.origin).addScaledVector(this.direction,t),Tu.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){E1.copy(e).add(t).multiplyScalar(.5),ky.copy(t).sub(e).normalize(),Vc.copy(this.origin).sub(E1);const s=e.distanceTo(t)*.5,o=-this.direction.dot(ky),a=Vc.dot(this.direction),l=-Vc.dot(ky),u=Vc.lengthSq(),c=Math.abs(1-o*o);let h,d,m,g;if(c>0)if(h=o*l-a,d=o*a-l,g=s*c,h>=0)if(d>=-g)if(d<=g){const x=1/c;h*=x,d*=x,m=h*(h+o*d+2*a)+d*(o*h+d+2*l)+u}else d=s,h=Math.max(0,-(o*d+a)),m=-h*h+d*(d+2*l)+u;else d=-s,h=Math.max(0,-(o*d+a)),m=-h*h+d*(d+2*l)+u;else d<=-g?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),m=-h*h+d*(d+2*l)+u):d<=g?(h=0,d=Math.min(Math.max(-s,-l),s),m=d*(d+2*l)+u):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),m=-h*h+d*(d+2*l)+u);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),m=-h*h+d*(d+2*l)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,h),i&&i.copy(E1).addScaledVector(ky,d),m}intersectSphere(e,t){Tu.subVectors(e.center,this.origin);const n=Tu.dot(this.direction),i=Tu.dot(Tu)-n*n,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(n=(e.min.x-d.x)*u,i=(e.max.x-d.x)*u):(n=(e.max.x-d.x)*u,i=(e.min.x-d.x)*u),c>=0?(s=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(s=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),n>o||s>i||((s>n||isNaN(n))&&(n=s),(o<i||isNaN(i))&&(i=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>i)||((a>n||n!==n)&&(n=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,Tu)!==null}intersectTriangle(e,t,n,i,s){T1.subVectors(t,e),Oy.subVectors(n,e),M1.crossVectors(T1,Oy);let o=this.direction.dot(M1),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Vc.subVectors(this.origin,e);const l=a*this.direction.dot(Oy.crossVectors(Vc,Oy));if(l<0)return null;const u=a*this.direction.dot(T1.cross(Vc));if(u<0||l+u>o)return null;const c=-a*Vc.dot(M1);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Wt{constructor(e,t,n,i,s,o,a,l,u,c,h,d,m,g,x,_){Wt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,s,o,a,l,u,c,h,d,m,g,x,_)}set(e,t,n,i,s,o,a,l,u,c,h,d,m,g,x,_){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=i,S[1]=s,S[5]=o,S[9]=a,S[13]=l,S[2]=u,S[6]=c,S[10]=h,S[14]=d,S[3]=m,S[7]=g,S[11]=x,S[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Wt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/hp.setFromMatrixColumn(e,0).length(),s=1/hp.setFromMatrixColumn(e,1).length(),o=1/hp.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(i),u=Math.sin(i),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=o*c,m=o*h,g=a*c,x=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=m+g*u,t[5]=d-x*u,t[9]=-a*l,t[2]=x-d*u,t[6]=g+m*u,t[10]=o*l}else if(e.order==="YXZ"){const d=l*c,m=l*h,g=u*c,x=u*h;t[0]=d+x*a,t[4]=g*a-m,t[8]=o*u,t[1]=o*h,t[5]=o*c,t[9]=-a,t[2]=m*a-g,t[6]=x+d*a,t[10]=o*l}else if(e.order==="ZXY"){const d=l*c,m=l*h,g=u*c,x=u*h;t[0]=d-x*a,t[4]=-o*h,t[8]=g+m*a,t[1]=m+g*a,t[5]=o*c,t[9]=x-d*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const d=o*c,m=o*h,g=a*c,x=a*h;t[0]=l*c,t[4]=g*u-m,t[8]=d*u+x,t[1]=l*h,t[5]=x*u+d,t[9]=m*u-g,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const d=o*l,m=o*u,g=a*l,x=a*u;t[0]=l*c,t[4]=x-d*h,t[8]=g*h+m,t[1]=h,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=m*h+g,t[10]=d-x*h}else if(e.order==="XZY"){const d=o*l,m=o*u,g=a*l,x=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=d*h+x,t[5]=o*c,t[9]=m*h-g,t[2]=g*h-m,t[6]=a*c,t[10]=x*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(dG,e,pG)}lookAt(e,t,n){const i=this.elements;return Co.subVectors(e,t),Co.lengthSq()===0&&(Co.z=1),Co.normalize(),Wc.crossVectors(n,Co),Wc.lengthSq()===0&&(Math.abs(n.z)===1?Co.x+=1e-4:Co.z+=1e-4,Co.normalize(),Wc.crossVectors(n,Co)),Wc.normalize(),Uy.crossVectors(Co,Wc),i[0]=Wc.x,i[4]=Uy.x,i[8]=Co.x,i[1]=Wc.y,i[5]=Uy.y,i[9]=Co.y,i[2]=Wc.z,i[6]=Uy.z,i[10]=Co.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],u=n[12],c=n[1],h=n[5],d=n[9],m=n[13],g=n[2],x=n[6],_=n[10],S=n[14],T=n[3],E=n[7],C=n[11],R=n[15],P=i[0],L=i[4],F=i[8],D=i[12],I=i[1],N=i[5],V=i[9],q=i[13],Q=i[2],re=i[6],ee=i[10],se=i[14],W=i[3],$=i[7],j=i[11],U=i[15];return s[0]=o*P+a*I+l*Q+u*W,s[4]=o*L+a*N+l*re+u*$,s[8]=o*F+a*V+l*ee+u*j,s[12]=o*D+a*q+l*se+u*U,s[1]=c*P+h*I+d*Q+m*W,s[5]=c*L+h*N+d*re+m*$,s[9]=c*F+h*V+d*ee+m*j,s[13]=c*D+h*q+d*se+m*U,s[2]=g*P+x*I+_*Q+S*W,s[6]=g*L+x*N+_*re+S*$,s[10]=g*F+x*V+_*ee+S*j,s[14]=g*D+x*q+_*se+S*U,s[3]=T*P+E*I+C*Q+R*W,s[7]=T*L+E*N+C*re+R*$,s[11]=T*F+E*V+C*ee+R*j,s[15]=T*D+E*q+C*se+R*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],m=e[14],g=e[3],x=e[7],_=e[11],S=e[15];return g*(+s*l*h-i*u*h-s*a*d+n*u*d+i*a*m-n*l*m)+x*(+t*l*m-t*u*d+s*o*d-i*o*m+i*u*c-s*l*c)+_*(+t*u*h-t*a*m-s*o*h+n*o*m+s*a*c-n*u*c)+S*(-i*a*c-t*l*h+t*a*d+i*o*h-n*o*d+n*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],g=e[12],x=e[13],_=e[14],S=e[15],T=h*_*u-x*d*u+x*l*m-a*_*m-h*l*S+a*d*S,E=g*d*u-c*_*u-g*l*m+o*_*m+c*l*S-o*d*S,C=c*x*u-g*h*u+g*a*m-o*x*m-c*a*S+o*h*S,R=g*h*l-c*x*l-g*a*d+o*x*d+c*a*_-o*h*_,P=t*T+n*E+i*C+s*R;if(P===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const L=1/P;return e[0]=T*L,e[1]=(x*d*s-h*_*s-x*i*m+n*_*m+h*i*S-n*d*S)*L,e[2]=(a*_*s-x*l*s+x*i*u-n*_*u-a*i*S+n*l*S)*L,e[3]=(h*l*s-a*d*s-h*i*u+n*d*u+a*i*m-n*l*m)*L,e[4]=E*L,e[5]=(c*_*s-g*d*s+g*i*m-t*_*m-c*i*S+t*d*S)*L,e[6]=(g*l*s-o*_*s-g*i*u+t*_*u+o*i*S-t*l*S)*L,e[7]=(o*d*s-c*l*s+c*i*u-t*d*u-o*i*m+t*l*m)*L,e[8]=C*L,e[9]=(g*h*s-c*x*s-g*n*m+t*x*m+c*n*S-t*h*S)*L,e[10]=(o*x*s-g*a*s+g*n*u-t*x*u-o*n*S+t*a*S)*L,e[11]=(c*a*s-o*h*s-c*n*u+t*h*u+o*n*m-t*a*m)*L,e[12]=R*L,e[13]=(c*x*i-g*h*i+g*n*d-t*x*d-c*n*_+t*h*_)*L,e[14]=(g*a*i-o*x*i-g*n*l+t*x*l+o*n*_-t*a*_)*L,e[15]=(o*h*i-c*a*i+c*n*l-t*h*l-o*n*d+t*a*d)*L,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+n,u*a-i*l,u*l+i*a,0,u*a+i*l,c*a+n,c*l-i*o,0,u*l-i*a,c*l+i*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,o){return this.set(1,n,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,c=o+o,h=a+a,d=s*u,m=s*c,g=s*h,x=o*c,_=o*h,S=a*h,T=l*u,E=l*c,C=l*h,R=n.x,P=n.y,L=n.z;return i[0]=(1-(x+S))*R,i[1]=(m+C)*R,i[2]=(g-E)*R,i[3]=0,i[4]=(m-C)*P,i[5]=(1-(d+S))*P,i[6]=(_+T)*P,i[7]=0,i[8]=(g+E)*L,i[9]=(_-T)*L,i[10]=(1-(d+x))*L,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=hp.set(i[0],i[1],i[2]).length();const o=hp.set(i[4],i[5],i[6]).length(),a=hp.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],ja.copy(this);const u=1/s,c=1/o,h=1/a;return ja.elements[0]*=u,ja.elements[1]*=u,ja.elements[2]*=u,ja.elements[4]*=c,ja.elements[5]*=c,ja.elements[6]*=c,ja.elements[8]*=h,ja.elements[9]*=h,ja.elements[10]*=h,t.setFromRotationMatrix(ja),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,i,s,o,a=Dl){const l=this.elements,u=2*s/(t-e),c=2*s/(n-i),h=(t+e)/(t-e),d=(n+i)/(n-i);let m,g;if(a===Dl)m=-(o+s)/(o-s),g=-2*o*s/(o-s);else if(a===j0)m=-o/(o-s),g=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,i,s,o,a=Dl){const l=this.elements,u=1/(t-e),c=1/(n-i),h=1/(o-s),d=(t+e)*u,m=(n+i)*c;let g,x;if(a===Dl)g=(o+s)*h,x=-2*h;else if(a===j0)g=s*h,x=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=x,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const hp=new ae,ja=new Wt,dG=new ae(0,0,0),pG=new ae(1,1,1),Wc=new ae,Uy=new ae,Co=new ae,gR=new Wt,vR=new Nr;class No{constructor(e=0,t=0,n=0,i=No.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],m=i[10];switch(t){case"XYZ":this._y=Math.asin(Oi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Oi(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Oi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Oi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Oi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-Oi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return gR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gR,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vR.setFromEuler(this),this.setFromQuaternion(vR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}No.DEFAULT_ORDER="XYZ";class zf{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let mG=0;const yR=new ae,fp=new Nr,Mu=new Wt,Ny=new ae,Dg=new ae,gG=new ae,vG=new Nr,xR=new ae(1,0,0),_R=new ae(0,1,0),SR=new ae(0,0,1),AR={type:"added"},yG={type:"removed"},dp={type:"childadded",child:null},w1={type:"childremoved",child:null};class An extends rc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:mG++}),this.uuid=ko(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=An.DEFAULT_UP.clone();const e=new ae,t=new No,n=new Nr,i=new ae(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Wt},normalMatrix:{value:new ln}}),this.matrix=new Wt,this.matrixWorld=new Wt,this.matrixAutoUpdate=An.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=An.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new zf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return fp.setFromAxisAngle(e,t),this.quaternion.multiply(fp),this}rotateOnWorldAxis(e,t){return fp.setFromAxisAngle(e,t),this.quaternion.premultiply(fp),this}rotateX(e){return this.rotateOnAxis(xR,e)}rotateY(e){return this.rotateOnAxis(_R,e)}rotateZ(e){return this.rotateOnAxis(SR,e)}translateOnAxis(e,t){return yR.copy(e).applyQuaternion(this.quaternion),this.position.add(yR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(xR,e)}translateY(e){return this.translateOnAxis(_R,e)}translateZ(e){return this.translateOnAxis(SR,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Mu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Ny.copy(e):Ny.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Dg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Mu.lookAt(Dg,Ny,this.up):Mu.lookAt(Ny,Dg,this.up),this.quaternion.setFromRotationMatrix(Mu),i&&(Mu.extractRotation(i.matrixWorld),fp.setFromRotationMatrix(Mu),this.quaternion.premultiply(fp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(AR),dp.child=e,this.dispatchEvent(dp),dp.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(yG),w1.child=e,this.dispatchEvent(w1),w1.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Mu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Mu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Mu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(AR),dp.child=e,this.dispatchEvent(dp),dp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Dg,e,gG),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Dg,vG,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),d=o(e.skeletons),m=o(e.animations),g=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),u.length>0&&(n.textures=u),c.length>0&&(n.images=c),h.length>0&&(n.shapes=h),d.length>0&&(n.skeletons=d),m.length>0&&(n.animations=m),g.length>0&&(n.nodes=g)}return n.object=i,n;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}An.DEFAULT_UP=new ae(0,1,0);An.DEFAULT_MATRIX_AUTO_UPDATE=!0;An.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ka=new ae,wu=new ae,C1=new ae,Cu=new ae,pp=new ae,mp=new ae,ER=new ae,b1=new ae,R1=new ae,I1=new ae;class Po{constructor(e=new ae,t=new ae,n=new ae){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Ka.subVectors(e,t),i.cross(Ka);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){Ka.subVectors(i,t),wu.subVectors(n,t),C1.subVectors(e,t);const o=Ka.dot(Ka),a=Ka.dot(wu),l=Ka.dot(C1),u=wu.dot(wu),c=wu.dot(C1),h=o*u-a*a;if(h===0)return s.set(0,0,0),null;const d=1/h,m=(u*l-a*c)*d,g=(o*c-a*l)*d;return s.set(1-m-g,g,m)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Cu)===null?!1:Cu.x>=0&&Cu.y>=0&&Cu.x+Cu.y<=1}static getInterpolation(e,t,n,i,s,o,a,l){return this.getBarycoord(e,t,n,i,Cu)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Cu.x),l.addScaledVector(o,Cu.y),l.addScaledVector(a,Cu.z),l)}static isFrontFacing(e,t,n,i){return Ka.subVectors(n,t),wu.subVectors(e,t),Ka.cross(wu).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ka.subVectors(this.c,this.b),wu.subVectors(this.a,this.b),Ka.cross(wu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Po.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Po.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,s){return Po.getInterpolation(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return Po.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Po.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let o,a;pp.subVectors(i,n),mp.subVectors(s,n),b1.subVectors(e,n);const l=pp.dot(b1),u=mp.dot(b1);if(l<=0&&u<=0)return t.copy(n);R1.subVectors(e,i);const c=pp.dot(R1),h=mp.dot(R1);if(c>=0&&h<=c)return t.copy(i);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(n).addScaledVector(pp,o);I1.subVectors(e,s);const m=pp.dot(I1),g=mp.dot(I1);if(g>=0&&m<=g)return t.copy(s);const x=m*u-l*g;if(x<=0&&u>=0&&g<=0)return a=u/(u-g),t.copy(n).addScaledVector(mp,a);const _=c*g-m*h;if(_<=0&&h-c>=0&&m-g>=0)return ER.subVectors(s,i),a=(h-c)/(h-c+(m-g)),t.copy(i).addScaledVector(ER,a);const S=1/(_+x+d);return o=x*S,a=d*S,t.copy(n).addScaledVector(pp,o).addScaledVector(mp,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const rF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},jc={h:0,s:0,l:0},Gy={h:0,s:0,l:0};function L1(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}class yt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=fa){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,On.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=On.workingColorSpace){return this.r=e,this.g=t,this.b=n,On.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=On.workingColorSpace){if(e=lw(e,1),t=Oi(t,0,1),n=Oi(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=L1(o,s,e+1/3),this.g=L1(o,s,e),this.b=L1(o,s,e-1/3)}return On.toWorkingColorSpace(this,i),this}setStyle(e,t=fa){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=fa){const n=rF[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Zp(e.r),this.g=Zp(e.g),this.b=Zp(e.b),this}copyLinearToSRGB(e){return this.r=y1(e.r),this.g=y1(e.g),this.b=y1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=fa){return On.fromWorkingColorSpace(hs.copy(this),e),Math.round(Oi(hs.r*255,0,255))*65536+Math.round(Oi(hs.g*255,0,255))*256+Math.round(Oi(hs.b*255,0,255))}getHexString(e=fa){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=On.workingColorSpace){On.fromWorkingColorSpace(hs.copy(this),t);const n=hs.r,i=hs.g,s=hs.b,o=Math.max(n,i,s),a=Math.min(n,i,s);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const h=o-a;switch(u=c<=.5?h/(o+a):h/(2-o-a),o){case n:l=(i-s)/h+(i<s?6:0);break;case i:l=(s-n)/h+2;break;case s:l=(n-i)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=On.workingColorSpace){return On.fromWorkingColorSpace(hs.copy(this),t),e.r=hs.r,e.g=hs.g,e.b=hs.b,e}getStyle(e=fa){On.fromWorkingColorSpace(hs.copy(this),e);const t=hs.r,n=hs.g,i=hs.b;return e!==fa?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(jc),this.setHSL(jc.h+e,jc.s+t,jc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(jc),e.getHSL(Gy);const n=y0(jc.h,Gy.h,t),i=y0(jc.s,Gy.s,t),s=y0(jc.l,Gy.l,t);return this.setHSL(n,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*i,this.g=s[1]*t+s[4]*n+s[7]*i,this.b=s[2]*t+s[5]*n+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const hs=new yt;yt.NAMES=rF;let xG=0;class Tr extends rc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:xG++}),this.uuid=ko(),this.name="",this.type="Material",this.blending=Nf,this.side=Wl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=T_,this.blendDst=M_,this.blendEquation=ih,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new yt(0,0,0),this.blendAlpha=0,this.depthFunc=O0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=wT,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ef,this.stencilZFail=Ef,this.stencilZPass=Ef,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Nf&&(n.blending=this.blending),this.side!==Wl&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==T_&&(n.blendSrc=this.blendSrc),this.blendDst!==M_&&(n.blendDst=this.blendDst),this.blendEquation!==ih&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==O0&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==wT&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Ef&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Ef&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Ef&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}}class so extends Tr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new yt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new No,this.combine=vv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Uu=_G();function _G(){const r=new ArrayBuffer(4),e=new Float32Array(r),t=new Uint32Array(r),n=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(n[l]=0,n[l|256]=32768,i[l]=24,i[l|256]=24):u<-14?(n[l]=1024>>-u-14,n[l|256]=1024>>-u-14|32768,i[l]=-u-1,i[l|256]=-u-1):u<=15?(n[l]=u+15<<10,n[l|256]=u+15<<10|32768,i[l]=13,i[l|256]=13):u<128?(n[l]=31744,n[l|256]=64512,i[l]=24,i[l|256]=24):(n[l]=31744,n[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;(u&8388608)===0;)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function no(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=Oi(r,-65504,65504),Uu.floatView[0]=r;const e=Uu.uint32View[0],t=e>>23&511;return Uu.baseTable[t]+((e&8388607)>>Uu.shiftTable[t])}function n0(r){const e=r>>10;return Uu.uint32View[0]=Uu.mantissaTable[Uu.offsetTable[e]+(r&1023)]+Uu.exponentTable[e],Uu.floatView[0]}const SG={toHalfFloat:no,fromHalfFloat:n0},ur=new ae,Hy=new Qe;class Pn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=W0,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ro,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Qp("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Hy.fromBufferAttribute(this,t),Hy.applyMatrix3(e),this.setXY(t,Hy.x,Hy.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)ur.fromBufferAttribute(this,t),ur.applyMatrix3(e),this.setXYZ(t,ur.x,ur.y,ur.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ur.fromBufferAttribute(this,t),ur.applyMatrix4(e),this.setXYZ(t,ur.x,ur.y,ur.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ur.fromBufferAttribute(this,t),ur.applyNormalMatrix(e),this.setXYZ(t,ur.x,ur.y,ur.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ur.fromBufferAttribute(this,t),ur.transformDirection(e),this.setXYZ(t,ur.x,ur.y,ur.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Os(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=fn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Os(t,this.array)),t}setX(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Os(t,this.array)),t}setY(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Os(t,this.array)),t}setZ(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Os(t,this.array)),t}setW(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array),i=fn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array),i=fn(i,this.array),s=fn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==W0&&(e.usage=this.usage),e}}class AG extends Pn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class EG extends Pn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class TG extends Pn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class MG extends Pn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class cw extends Pn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class wG extends Pn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class hw extends Pn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class CG extends Pn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=n0(this.array[e*this.itemSize]);return this.normalized&&(t=Os(t,this.array)),t}setX(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize]=no(t),this}getY(e){let t=n0(this.array[e*this.itemSize+1]);return this.normalized&&(t=Os(t,this.array)),t}setY(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize+1]=no(t),this}getZ(e){let t=n0(this.array[e*this.itemSize+2]);return this.normalized&&(t=Os(t,this.array)),t}setZ(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize+2]=no(t),this}getW(e){let t=n0(this.array[e*this.itemSize+3]);return this.normalized&&(t=Os(t,this.array)),t}setW(e,t){return this.normalized&&(t=fn(t,this.array)),this.array[e*this.itemSize+3]=no(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array)),this.array[e+0]=no(t),this.array[e+1]=no(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array),i=fn(i,this.array)),this.array[e+0]=no(t),this.array[e+1]=no(n),this.array[e+2]=no(i),this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array),i=fn(i,this.array),s=fn(s,this.array)),this.array[e+0]=no(t),this.array[e+1]=no(n),this.array[e+2]=no(i),this.array[e+3]=no(s),this}}class Ft extends Pn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let bG=0;const ra=new Wt,P1=new An,gp=new ae,bo=new Ni,Bg=new Ni,Fr=new ae;class dn extends rc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:bG++}),this.uuid=ko(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(eF(e)?hw:cw)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new ln().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ra.makeRotationFromQuaternion(e),this.applyMatrix4(ra),this}rotateX(e){return ra.makeRotationX(e),this.applyMatrix4(ra),this}rotateY(e){return ra.makeRotationY(e),this.applyMatrix4(ra),this}rotateZ(e){return ra.makeRotationZ(e),this.applyMatrix4(ra),this}translate(e,t,n){return ra.makeTranslation(e,t,n),this.applyMatrix4(ra),this}scale(e,t,n){return ra.makeScale(e,t,n),this.applyMatrix4(ra),this}lookAt(e){return P1.lookAt(e),P1.updateMatrix(),this.applyMatrix4(P1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(gp).negate(),this.translate(gp.x,gp.y,gp.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ft(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ni);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ae(-1/0,-1/0,-1/0),new ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const s=t[n];bo.setFromBufferAttribute(s),this.morphTargetsRelative?(Fr.addVectors(this.boundingBox.min,bo.min),this.boundingBox.expandByPoint(Fr),Fr.addVectors(this.boundingBox.max,bo.max),this.boundingBox.expandByPoint(Fr)):(this.boundingBox.expandByPoint(bo.min),this.boundingBox.expandByPoint(bo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ae,1/0);return}if(e){const n=this.boundingSphere.center;if(bo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Bg.setFromBufferAttribute(a),this.morphTargetsRelative?(Fr.addVectors(bo.min,Bg.min),bo.expandByPoint(Fr),Fr.addVectors(bo.max,Bg.max),bo.expandByPoint(Fr)):(bo.expandByPoint(Bg.min),bo.expandByPoint(Bg.max))}bo.getCenter(n);let i=0;for(let s=0,o=e.count;s<o;s++)Fr.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(Fr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)Fr.fromBufferAttribute(a,u),l&&(gp.fromBufferAttribute(e,u),Fr.add(gp)),i=Math.max(i,n.distanceToSquared(Fr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Pn(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let F=0;F<n.count;F++)a[F]=new ae,l[F]=new ae;const u=new ae,c=new ae,h=new ae,d=new Qe,m=new Qe,g=new Qe,x=new ae,_=new ae;function S(F,D,I){u.fromBufferAttribute(n,F),c.fromBufferAttribute(n,D),h.fromBufferAttribute(n,I),d.fromBufferAttribute(s,F),m.fromBufferAttribute(s,D),g.fromBufferAttribute(s,I),c.sub(u),h.sub(u),m.sub(d),g.sub(d);const N=1/(m.x*g.y-g.x*m.y);isFinite(N)&&(x.copy(c).multiplyScalar(g.y).addScaledVector(h,-m.y).multiplyScalar(N),_.copy(h).multiplyScalar(m.x).addScaledVector(c,-g.x).multiplyScalar(N),a[F].add(x),a[D].add(x),a[I].add(x),l[F].add(_),l[D].add(_),l[I].add(_))}let T=this.groups;T.length===0&&(T=[{start:0,count:e.count}]);for(let F=0,D=T.length;F<D;++F){const I=T[F],N=I.start,V=I.count;for(let q=N,Q=N+V;q<Q;q+=3)S(e.getX(q+0),e.getX(q+1),e.getX(q+2))}const E=new ae,C=new ae,R=new ae,P=new ae;function L(F){R.fromBufferAttribute(i,F),P.copy(R);const D=a[F];E.copy(D),E.sub(R.multiplyScalar(R.dot(D))).normalize(),C.crossVectors(P,D);const N=C.dot(l[F])<0?-1:1;o.setXYZW(F,E.x,E.y,E.z,N)}for(let F=0,D=T.length;F<D;++F){const I=T[F],N=I.start,V=I.count;for(let q=N,Q=N+V;q<Q;q+=3)L(e.getX(q+0)),L(e.getX(q+1)),L(e.getX(q+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Pn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let d=0,m=n.count;d<m;d++)n.setXYZ(d,0,0,0);const i=new ae,s=new ae,o=new ae,a=new ae,l=new ae,u=new ae,c=new ae,h=new ae;if(e)for(let d=0,m=e.count;d<m;d+=3){const g=e.getX(d+0),x=e.getX(d+1),_=e.getX(d+2);i.fromBufferAttribute(t,g),s.fromBufferAttribute(t,x),o.fromBufferAttribute(t,_),c.subVectors(o,s),h.subVectors(i,s),c.cross(h),a.fromBufferAttribute(n,g),l.fromBufferAttribute(n,x),u.fromBufferAttribute(n,_),a.add(c),l.add(c),u.add(c),n.setXYZ(g,a.x,a.y,a.z),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(_,u.x,u.y,u.z)}else for(let d=0,m=t.count;d<m;d+=3)i.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),c.subVectors(o,s),h.subVectors(i,s),c.cross(h),n.setXYZ(d+0,c.x,c.y,c.z),n.setXYZ(d+1,c.x,c.y,c.z),n.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Fr.fromBufferAttribute(e,t),Fr.normalize(),e.setXYZ(t,Fr.x,Fr.y,Fr.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,d=new u.constructor(l.length*c);let m=0,g=0;for(let x=0,_=l.length;x<_;x++){a.isInterleavedBufferAttribute?m=l[x]*a.data.stride+a.offset:m=l[x]*c;for(let S=0;S<c;S++)d[g++]=u[m++]}return new Pn(d,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new dn,n=this.index.array,i=this.attributes;for(const a in i){const l=i[a],u=e(l,n);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let c=0,h=u.length;c<h;c++){const d=u[c],m=e(d,n);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const u=n[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const m=u[h];c.push(m.toJSON(e.data))}c.length>0&&(i[l]=c,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let d=0,m=h.length;d<m;d++)c.push(h[d].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const TR=new Wt,sf=new ld,zy=new Yi,MR=new ae,vp=new ae,yp=new ae,xp=new ae,D1=new ae,Vy=new ae,Wy=new Qe,jy=new Qe,Ky=new Qe,wR=new ae,CR=new ae,bR=new ae,$y=new ae,Xy=new ae;class ui extends An{constructor(e=new dn,t=new so){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){Vy.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=a[l],h=s[l];c!==0&&(D1.fromBufferAttribute(h,e),o?Vy.addScaledVector(D1,c):Vy.addScaledVector(D1.sub(t),c))}t.add(Vy)}return t}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),zy.copy(n.boundingSphere),zy.applyMatrix4(s),sf.copy(e.ray).recast(e.near),!(zy.containsPoint(sf.origin)===!1&&(sf.intersectSphere(zy,MR)===null||sf.origin.distanceToSquared(MR)>(e.far-e.near)**2))&&(TR.copy(s).invert(),sf.copy(e.ray).applyMatrix4(TR),!(n.boundingBox!==null&&sf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,sf)))}_computeIntersections(e,t,n){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,d=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let g=0,x=d.length;g<x;g++){const _=d[g],S=o[_.materialIndex],T=Math.max(_.start,m.start),E=Math.min(a.count,Math.min(_.start+_.count,m.start+m.count));for(let C=T,R=E;C<R;C+=3){const P=a.getX(C),L=a.getX(C+1),F=a.getX(C+2);i=Yy(this,S,e,n,u,c,h,P,L,F),i&&(i.faceIndex=Math.floor(C/3),i.face.materialIndex=_.materialIndex,t.push(i))}}else{const g=Math.max(0,m.start),x=Math.min(a.count,m.start+m.count);for(let _=g,S=x;_<S;_+=3){const T=a.getX(_),E=a.getX(_+1),C=a.getX(_+2);i=Yy(this,o,e,n,u,c,h,T,E,C),i&&(i.faceIndex=Math.floor(_/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let g=0,x=d.length;g<x;g++){const _=d[g],S=o[_.materialIndex],T=Math.max(_.start,m.start),E=Math.min(l.count,Math.min(_.start+_.count,m.start+m.count));for(let C=T,R=E;C<R;C+=3){const P=C,L=C+1,F=C+2;i=Yy(this,S,e,n,u,c,h,P,L,F),i&&(i.faceIndex=Math.floor(C/3),i.face.materialIndex=_.materialIndex,t.push(i))}}else{const g=Math.max(0,m.start),x=Math.min(l.count,m.start+m.count);for(let _=g,S=x;_<S;_+=3){const T=_,E=_+1,C=_+2;i=Yy(this,o,e,n,u,c,h,T,E,C),i&&(i.faceIndex=Math.floor(_/3),t.push(i))}}}}function RG(r,e,t,n,i,s,o,a){let l;if(e.side===Ns?l=n.intersectTriangle(o,s,i,!0,a):l=n.intersectTriangle(i,s,o,e.side===Wl,a),l===null)return null;Xy.copy(a),Xy.applyMatrix4(r.matrixWorld);const u=t.ray.origin.distanceTo(Xy);return u<t.near||u>t.far?null:{distance:u,point:Xy.clone(),object:r}}function Yy(r,e,t,n,i,s,o,a,l,u){r.getVertexPosition(a,vp),r.getVertexPosition(l,yp),r.getVertexPosition(u,xp);const c=RG(r,e,t,n,vp,yp,xp,$y);if(c){i&&(Wy.fromBufferAttribute(i,a),jy.fromBufferAttribute(i,l),Ky.fromBufferAttribute(i,u),c.uv=Po.getInterpolation($y,vp,yp,xp,Wy,jy,Ky,new Qe)),s&&(Wy.fromBufferAttribute(s,a),jy.fromBufferAttribute(s,l),Ky.fromBufferAttribute(s,u),c.uv1=Po.getInterpolation($y,vp,yp,xp,Wy,jy,Ky,new Qe)),o&&(wR.fromBufferAttribute(o,a),CR.fromBufferAttribute(o,l),bR.fromBufferAttribute(o,u),c.normal=Po.getInterpolation($y,vp,yp,xp,wR,CR,bR,new ae),c.normal.dot(n.direction)>0&&c.normal.multiplyScalar(-1));const h={a,b:l,c:u,normal:new ae,materialIndex:0};Po.getNormal(vp,yp,xp,h.normal),c.face=h}return c}class ud extends dn{constructor(e=1,t=1,n=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],c=[],h=[];let d=0,m=0;g("z","y","x",-1,-1,n,t,e,o,s,0),g("z","y","x",1,-1,n,t,-e,o,s,1),g("x","z","y",1,1,e,n,t,i,o,2),g("x","z","y",1,-1,e,n,-t,i,o,3),g("x","y","z",1,-1,e,t,n,i,s,4),g("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(l),this.setAttribute("position",new Ft(u,3)),this.setAttribute("normal",new Ft(c,3)),this.setAttribute("uv",new Ft(h,2));function g(x,_,S,T,E,C,R,P,L,F,D){const I=C/L,N=R/F,V=C/2,q=R/2,Q=P/2,re=L+1,ee=F+1;let se=0,W=0;const $=new ae;for(let j=0;j<ee;j++){const U=j*N-q;for(let X=0;X<re;X++){const le=X*I-V;$[x]=le*T,$[_]=U*E,$[S]=Q,u.push($.x,$.y,$.z),$[x]=0,$[_]=0,$[S]=P>0?1:-1,c.push($.x,$.y,$.z),h.push(X/L),h.push(1-j/F),se+=1}}for(let j=0;j<F;j++)for(let U=0;U<L;U++){const X=d+U+re*j,le=d+U+re*(j+1),Z=d+(U+1)+re*(j+1),oe=d+(U+1)+re*j;l.push(X,le,oe),l.push(le,Z,oe),W+=6}a.addGroup(m,W,D),m+=W,d+=se}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ud(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function fm(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const i=r[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function Fs(r){const e={};for(let t=0;t<r.length;t++){const n=fm(r[t]);for(const i in n)e[i]=n[i]}return e}function IG(r){const e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function sF(r){const e=r.getRenderTarget();return e===null?r.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:On.workingColorSpace}const $0={clone:fm,merge:Fs};var LG=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,PG=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Go extends Tr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=LG,this.fragmentShader=PG,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=fm(e.uniforms),this.uniformsGroups=IG(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Sv extends An{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Wt,this.projectionMatrix=new Wt,this.projectionMatrixInverse=new Wt,this.coordinateSystem=Dl}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Kc=new ae,RR=new Qe,IR=new Qe;class mi extends Sv{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=hm*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Hf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return hm*2*Math.atan(Math.tan(Hf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Kc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Kc.x,Kc.y).multiplyScalar(-e/Kc.z),Kc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Kc.x,Kc.y).multiplyScalar(-e/Kc.z)}getViewSize(e,t){return this.getViewBounds(e,RR,IR),t.subVectors(IR,RR)}setViewOffset(e,t,n,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Hf*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*n/u,i*=o.width/l,n*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const _p=-90,Sp=1;class oF extends An{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new mi(_p,Sp,e,t);i.layers=this.layers,this.add(i);const s=new mi(_p,Sp,e,t);s.layers=this.layers,this.add(s);const o=new mi(_p,Sp,e,t);o.layers=this.layers,this.add(o);const a=new mi(_p,Sp,e,t);a.layers=this.layers,this.add(a);const l=new mi(_p,Sp,e,t);l.layers=this.layers,this.add(l);const u=new mi(_p,Sp,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Dl)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===j0)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;const x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,s),e.setRenderTarget(n,1,i),e.render(t,o),e.setRenderTarget(n,2,i),e.render(t,a),e.setRenderTarget(n,3,i),e.render(t,l),e.setRenderTarget(n,4,i),e.render(t,u),n.texture.generateMipmaps=x,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(h,d,m),e.xr.enabled=g,n.texture.needsPMREMUpdate=!0}}class Av extends ci{constructor(e,t,n,i,s,o,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:Yu,super(e,t,n,i,s,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class aF extends el{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Av(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:vi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ud(5,5,5),s=new Go({name:"CubemapFromEquirect",uniforms:fm(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ns,blending:Wu});s.uniforms.tEquirect.value=t;const o=new ui(i,s),a=t.minFilter;return t.minFilter===da&&(t.minFilter=vi),new oF(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,i);e.setRenderTarget(s)}}const B1=new ae,DG=new ae,BG=new ln;class Fu{constructor(e=new ae(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=B1.subVectors(n,t).cross(DG.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(B1),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||BG.getNormalMatrix(e),i=this.coplanarPoint(B1).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const of=new Yi,Jy=new ae;class Ev{constructor(e=new Fu,t=new Fu,n=new Fu,i=new Fu,s=new Fu,o=new Fu){this.planes=[e,t,n,i,s,o]}set(e,t,n,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Dl){const n=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],c=i[5],h=i[6],d=i[7],m=i[8],g=i[9],x=i[10],_=i[11],S=i[12],T=i[13],E=i[14],C=i[15];if(n[0].setComponents(l-s,d-u,_-m,C-S).normalize(),n[1].setComponents(l+s,d+u,_+m,C+S).normalize(),n[2].setComponents(l+o,d+c,_+g,C+T).normalize(),n[3].setComponents(l-o,d-c,_-g,C-T).normalize(),n[4].setComponents(l-a,d-h,_-x,C-E).normalize(),t===Dl)n[5].setComponents(l+a,d+h,_+x,C+E).normalize();else if(t===j0)n[5].setComponents(a,h,x,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),of.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),of.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(of)}intersectsSprite(e){return of.center.set(0,0,0),of.radius=.7071067811865476,of.applyMatrix4(e.matrixWorld),this.intersectsSphere(of)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Jy.x=i.normal.x>0?e.max.x:e.min.x,Jy.y=i.normal.y>0?e.max.y:e.min.y,Jy.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Jy)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function lF(){let r=null,e=!1,t=null,n=null;function i(s,o){t(s,o),n=r.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(i),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){r=s}}}function FG(r){const e=new WeakMap;function t(a,l){const u=a.array,c=a.usage,h=u.byteLength,d=r.createBuffer();r.bindBuffer(l,d),r.bufferData(l,u,c),a.onUploadCallback();let m;if(u instanceof Float32Array)m=r.FLOAT;else if(u instanceof Uint16Array)a.isFloat16BufferAttribute?m=r.HALF_FLOAT:m=r.UNSIGNED_SHORT;else if(u instanceof Int16Array)m=r.SHORT;else if(u instanceof Uint32Array)m=r.UNSIGNED_INT;else if(u instanceof Int32Array)m=r.INT;else if(u instanceof Int8Array)m=r.BYTE;else if(u instanceof Uint8Array)m=r.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)m=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:m,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:h}}function n(a,l,u){const c=l.array,h=l._updateRange,d=l.updateRanges;if(r.bindBuffer(u,a),h.count===-1&&d.length===0&&r.bufferSubData(u,0,c),d.length!==0){for(let m=0,g=d.length;m<g;m++){const x=d[m];r.bufferSubData(u,x.start*c.BYTES_PER_ELEMENT,c,x.start,x.count)}l.clearUpdateRanges()}h.count!==-1&&(r.bufferSubData(u,h.offset*c.BYTES_PER_ELEMENT,c,h.offset,h.count),h.count=-1),l.onUploadCallback()}function i(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(r.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const c=e.get(a);(!c||c.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const u=e.get(a);if(u===void 0)e.set(a,t(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(u.buffer,a,l),u.version=a.version}}return{get:i,remove:s,update:o}}class sc extends dn{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(i),u=a+1,c=l+1,h=e/a,d=t/l,m=[],g=[],x=[],_=[];for(let S=0;S<c;S++){const T=S*d-o;for(let E=0;E<u;E++){const C=E*h-s;g.push(C,-T,0),x.push(0,0,1),_.push(E/a),_.push(1-S/l)}}for(let S=0;S<l;S++)for(let T=0;T<a;T++){const E=T+u*S,C=T+u*(S+1),R=T+1+u*(S+1),P=T+1+u*S;m.push(E,C,P),m.push(C,R,P)}this.setIndex(m),this.setAttribute("position",new Ft(g,3)),this.setAttribute("normal",new Ft(x,3)),this.setAttribute("uv",new Ft(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sc(e.width,e.height,e.widthSegments,e.heightSegments)}}var kG=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,OG=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,UG=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,NG=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,GG=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,HG=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,zG=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,VG=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,WG=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,jG=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,KG=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,$G=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,XG=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,YG=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,JG=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,qG=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,QG=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,ZG=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,e8=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,t8=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,n8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,i8=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,r8=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,s8=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,o8=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,a8=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,l8=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,u8=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,c8=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,h8=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,f8="gl_FragColor = linearToOutputTexel( gl_FragColor );",d8=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,p8=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,m8=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,g8=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,v8=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,y8=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,x8=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,_8=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,S8=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,A8=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,E8=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,T8=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,M8=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,w8=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,C8=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,b8=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,R8=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,I8=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,L8=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,P8=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,D8=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,B8=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,F8=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,k8=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,O8=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,U8=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,N8=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,G8=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,H8=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,z8=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,V8=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,W8=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,j8=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,K8=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,$8=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,X8=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Y8=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,J8=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,q8=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Q8=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Z8=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,eH=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,tH=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,nH=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,iH=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,rH=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,sH=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,oH=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,aH=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,lH=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,uH=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,cH=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,hH=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,fH=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dH=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,pH=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,mH=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,gH=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,vH=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,yH=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,xH=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,_H=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,SH=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,AH=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,EH=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,TH=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,MH=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wH=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,CH=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,bH=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,RH=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,IH=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,LH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,PH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,DH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,BH=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const FH=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,kH=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,OH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,UH=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,NH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,GH=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,HH=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,zH=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,VH=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,WH=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,jH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,KH=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$H=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,XH=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,YH=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,JH=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qH=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,QH=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZH=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ez=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tz=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,nz=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,iz=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rz=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sz=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,oz=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,az=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lz=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uz=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,cz=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,hz=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fz=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,dz=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,pz=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,hn={alphahash_fragment:kG,alphahash_pars_fragment:OG,alphamap_fragment:UG,alphamap_pars_fragment:NG,alphatest_fragment:GG,alphatest_pars_fragment:HG,aomap_fragment:zG,aomap_pars_fragment:VG,batching_pars_vertex:WG,batching_vertex:jG,begin_vertex:KG,beginnormal_vertex:$G,bsdfs:XG,iridescence_fragment:YG,bumpmap_pars_fragment:JG,clipping_planes_fragment:qG,clipping_planes_pars_fragment:QG,clipping_planes_pars_vertex:ZG,clipping_planes_vertex:e8,color_fragment:t8,color_pars_fragment:n8,color_pars_vertex:i8,color_vertex:r8,common:s8,cube_uv_reflection_fragment:o8,defaultnormal_vertex:a8,displacementmap_pars_vertex:l8,displacementmap_vertex:u8,emissivemap_fragment:c8,emissivemap_pars_fragment:h8,colorspace_fragment:f8,colorspace_pars_fragment:d8,envmap_fragment:p8,envmap_common_pars_fragment:m8,envmap_pars_fragment:g8,envmap_pars_vertex:v8,envmap_physical_pars_fragment:b8,envmap_vertex:y8,fog_vertex:x8,fog_pars_vertex:_8,fog_fragment:S8,fog_pars_fragment:A8,gradientmap_pars_fragment:E8,lightmap_pars_fragment:T8,lights_lambert_fragment:M8,lights_lambert_pars_fragment:w8,lights_pars_begin:C8,lights_toon_fragment:R8,lights_toon_pars_fragment:I8,lights_phong_fragment:L8,lights_phong_pars_fragment:P8,lights_physical_fragment:D8,lights_physical_pars_fragment:B8,lights_fragment_begin:F8,lights_fragment_maps:k8,lights_fragment_end:O8,logdepthbuf_fragment:U8,logdepthbuf_pars_fragment:N8,logdepthbuf_pars_vertex:G8,logdepthbuf_vertex:H8,map_fragment:z8,map_pars_fragment:V8,map_particle_fragment:W8,map_particle_pars_fragment:j8,metalnessmap_fragment:K8,metalnessmap_pars_fragment:$8,morphinstance_vertex:X8,morphcolor_vertex:Y8,morphnormal_vertex:J8,morphtarget_pars_vertex:q8,morphtarget_vertex:Q8,normal_fragment_begin:Z8,normal_fragment_maps:eH,normal_pars_fragment:tH,normal_pars_vertex:nH,normal_vertex:iH,normalmap_pars_fragment:rH,clearcoat_normal_fragment_begin:sH,clearcoat_normal_fragment_maps:oH,clearcoat_pars_fragment:aH,iridescence_pars_fragment:lH,opaque_fragment:uH,packing:cH,premultiplied_alpha_fragment:hH,project_vertex:fH,dithering_fragment:dH,dithering_pars_fragment:pH,roughnessmap_fragment:mH,roughnessmap_pars_fragment:gH,shadowmap_pars_fragment:vH,shadowmap_pars_vertex:yH,shadowmap_vertex:xH,shadowmask_pars_fragment:_H,skinbase_vertex:SH,skinning_pars_vertex:AH,skinning_vertex:EH,skinnormal_vertex:TH,specularmap_fragment:MH,specularmap_pars_fragment:wH,tonemapping_fragment:CH,tonemapping_pars_fragment:bH,transmission_fragment:RH,transmission_pars_fragment:IH,uv_pars_fragment:LH,uv_pars_vertex:PH,uv_vertex:DH,worldpos_vertex:BH,background_vert:FH,background_frag:kH,backgroundCube_vert:OH,backgroundCube_frag:UH,cube_vert:NH,cube_frag:GH,depth_vert:HH,depth_frag:zH,distanceRGBA_vert:VH,distanceRGBA_frag:WH,equirect_vert:jH,equirect_frag:KH,linedashed_vert:$H,linedashed_frag:XH,meshbasic_vert:YH,meshbasic_frag:JH,meshlambert_vert:qH,meshlambert_frag:QH,meshmatcap_vert:ZH,meshmatcap_frag:ez,meshnormal_vert:tz,meshnormal_frag:nz,meshphong_vert:iz,meshphong_frag:rz,meshphysical_vert:sz,meshphysical_frag:oz,meshtoon_vert:az,meshtoon_frag:lz,points_vert:uz,points_frag:cz,shadow_vert:hz,shadow_frag:fz,sprite_vert:dz,sprite_frag:pz},St={common:{diffuse:{value:new yt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ln},alphaMap:{value:null},alphaMapTransform:{value:new ln},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ln}},envmap:{envMap:{value:null},envMapRotation:{value:new ln},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ln}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ln}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ln},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ln},normalScale:{value:new Qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ln},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ln}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ln}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ln}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new yt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new yt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ln},alphaTest:{value:0},uvTransform:{value:new ln}},sprite:{diffuse:{value:new yt(16777215)},opacity:{value:1},center:{value:new Qe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ln},alphaMap:{value:null},alphaMapTransform:{value:new ln},alphaTest:{value:0}}},Ja={basic:{uniforms:Fs([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.fog]),vertexShader:hn.meshbasic_vert,fragmentShader:hn.meshbasic_frag},lambert:{uniforms:Fs([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.fog,St.lights,{emissive:{value:new yt(0)}}]),vertexShader:hn.meshlambert_vert,fragmentShader:hn.meshlambert_frag},phong:{uniforms:Fs([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.fog,St.lights,{emissive:{value:new yt(0)},specular:{value:new yt(1118481)},shininess:{value:30}}]),vertexShader:hn.meshphong_vert,fragmentShader:hn.meshphong_frag},standard:{uniforms:Fs([St.common,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.roughnessmap,St.metalnessmap,St.fog,St.lights,{emissive:{value:new yt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:hn.meshphysical_vert,fragmentShader:hn.meshphysical_frag},toon:{uniforms:Fs([St.common,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.gradientmap,St.fog,St.lights,{emissive:{value:new yt(0)}}]),vertexShader:hn.meshtoon_vert,fragmentShader:hn.meshtoon_frag},matcap:{uniforms:Fs([St.common,St.bumpmap,St.normalmap,St.displacementmap,St.fog,{matcap:{value:null}}]),vertexShader:hn.meshmatcap_vert,fragmentShader:hn.meshmatcap_frag},points:{uniforms:Fs([St.points,St.fog]),vertexShader:hn.points_vert,fragmentShader:hn.points_frag},dashed:{uniforms:Fs([St.common,St.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:hn.linedashed_vert,fragmentShader:hn.linedashed_frag},depth:{uniforms:Fs([St.common,St.displacementmap]),vertexShader:hn.depth_vert,fragmentShader:hn.depth_frag},normal:{uniforms:Fs([St.common,St.bumpmap,St.normalmap,St.displacementmap,{opacity:{value:1}}]),vertexShader:hn.meshnormal_vert,fragmentShader:hn.meshnormal_frag},sprite:{uniforms:Fs([St.sprite,St.fog]),vertexShader:hn.sprite_vert,fragmentShader:hn.sprite_frag},background:{uniforms:{uvTransform:{value:new ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:hn.background_vert,fragmentShader:hn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ln}},vertexShader:hn.backgroundCube_vert,fragmentShader:hn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:hn.cube_vert,fragmentShader:hn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:hn.equirect_vert,fragmentShader:hn.equirect_frag},distanceRGBA:{uniforms:Fs([St.common,St.displacementmap,{referencePosition:{value:new ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:hn.distanceRGBA_vert,fragmentShader:hn.distanceRGBA_frag},shadow:{uniforms:Fs([St.lights,St.fog,{color:{value:new yt(0)},opacity:{value:1}}]),vertexShader:hn.shadow_vert,fragmentShader:hn.shadow_frag}};Ja.physical={uniforms:Fs([Ja.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ln},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ln},clearcoatNormalScale:{value:new Qe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ln},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ln},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ln},sheen:{value:0},sheenColor:{value:new yt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ln},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ln},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ln},transmissionSamplerSize:{value:new Qe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ln},attenuationDistance:{value:0},attenuationColor:{value:new yt(0)},specularColor:{value:new yt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ln},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ln},anisotropyVector:{value:new Qe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ln}}]),vertexShader:hn.meshphysical_vert,fragmentShader:hn.meshphysical_frag};const qy={r:0,b:0,g:0},af=new No,mz=new Wt;function gz(r,e,t,n,i,s,o){const a=new yt(0);let l=s===!0?0:1,u,c,h=null,d=0,m=null;function g(T){let E=T.isScene===!0?T.background:null;return E&&E.isTexture&&(E=(T.backgroundBlurriness>0?t:e).get(E)),E}function x(T){let E=!1;const C=g(T);C===null?S(a,l):C&&C.isColor&&(S(C,1),E=!0);const R=r.xr.getEnvironmentBlendMode();R==="additive"?n.buffers.color.setClear(0,0,0,1,o):R==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(r.autoClear||E)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil))}function _(T,E){const C=g(E);C&&(C.isCubeTexture||C.mapping===Rm)?(c===void 0&&(c=new ui(new ud(1,1,1),new Go({name:"BackgroundCubeMaterial",uniforms:fm(Ja.backgroundCube.uniforms),vertexShader:Ja.backgroundCube.vertexShader,fragmentShader:Ja.backgroundCube.fragmentShader,side:Ns,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(R,P,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),af.copy(E.backgroundRotation),af.x*=-1,af.y*=-1,af.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(af.y*=-1,af.z*=-1),c.material.uniforms.envMap.value=C,c.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=E.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(mz.makeRotationFromEuler(af)),c.material.toneMapped=On.getTransfer(C.colorSpace)!==ri,(h!==C||d!==C.version||m!==r.toneMapping)&&(c.material.needsUpdate=!0,h=C,d=C.version,m=r.toneMapping),c.layers.enableAll(),T.unshift(c,c.geometry,c.material,0,0,null)):C&&C.isTexture&&(u===void 0&&(u=new ui(new sc(2,2),new Go({name:"BackgroundMaterial",uniforms:fm(Ja.background.uniforms),vertexShader:Ja.background.vertexShader,fragmentShader:Ja.background.fragmentShader,side:Wl,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=C,u.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,u.material.toneMapped=On.getTransfer(C.colorSpace)!==ri,C.matrixAutoUpdate===!0&&C.updateMatrix(),u.material.uniforms.uvTransform.value.copy(C.matrix),(h!==C||d!==C.version||m!==r.toneMapping)&&(u.material.needsUpdate=!0,h=C,d=C.version,m=r.toneMapping),u.layers.enableAll(),T.unshift(u,u.geometry,u.material,0,0,null))}function S(T,E){T.getRGB(qy,sF(r)),n.buffers.color.setClear(qy.r,qy.g,qy.b,E,o)}return{getClearColor:function(){return a},setClearColor:function(T,E=1){a.set(T),l=E,S(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(T){l=T,S(a,l)},render:x,addToRenderList:_}}function vz(r,e){const t=r.getParameter(r.MAX_VERTEX_ATTRIBS),n={},i=d(null);let s=i,o=!1;function a(I,N,V,q,Q){let re=!1;const ee=h(q,V,N);s!==ee&&(s=ee,u(s.object)),re=m(I,q,V,Q),re&&g(I,q,V,Q),Q!==null&&e.update(Q,r.ELEMENT_ARRAY_BUFFER),(re||o)&&(o=!1,C(I,N,V,q),Q!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.get(Q).buffer))}function l(){return r.createVertexArray()}function u(I){return r.bindVertexArray(I)}function c(I){return r.deleteVertexArray(I)}function h(I,N,V){const q=V.wireframe===!0;let Q=n[I.id];Q===void 0&&(Q={},n[I.id]=Q);let re=Q[N.id];re===void 0&&(re={},Q[N.id]=re);let ee=re[q];return ee===void 0&&(ee=d(l()),re[q]=ee),ee}function d(I){const N=[],V=[],q=[];for(let Q=0;Q<t;Q++)N[Q]=0,V[Q]=0,q[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:N,enabledAttributes:V,attributeDivisors:q,object:I,attributes:{},index:null}}function m(I,N,V,q){const Q=s.attributes,re=N.attributes;let ee=0;const se=V.getAttributes();for(const W in se)if(se[W].location>=0){const j=Q[W];let U=re[W];if(U===void 0&&(W==="instanceMatrix"&&I.instanceMatrix&&(U=I.instanceMatrix),W==="instanceColor"&&I.instanceColor&&(U=I.instanceColor)),j===void 0||j.attribute!==U||U&&j.data!==U.data)return!0;ee++}return s.attributesNum!==ee||s.index!==q}function g(I,N,V,q){const Q={},re=N.attributes;let ee=0;const se=V.getAttributes();for(const W in se)if(se[W].location>=0){let j=re[W];j===void 0&&(W==="instanceMatrix"&&I.instanceMatrix&&(j=I.instanceMatrix),W==="instanceColor"&&I.instanceColor&&(j=I.instanceColor));const U={};U.attribute=j,j&&j.data&&(U.data=j.data),Q[W]=U,ee++}s.attributes=Q,s.attributesNum=ee,s.index=q}function x(){const I=s.newAttributes;for(let N=0,V=I.length;N<V;N++)I[N]=0}function _(I){S(I,0)}function S(I,N){const V=s.newAttributes,q=s.enabledAttributes,Q=s.attributeDivisors;V[I]=1,q[I]===0&&(r.enableVertexAttribArray(I),q[I]=1),Q[I]!==N&&(r.vertexAttribDivisor(I,N),Q[I]=N)}function T(){const I=s.newAttributes,N=s.enabledAttributes;for(let V=0,q=N.length;V<q;V++)N[V]!==I[V]&&(r.disableVertexAttribArray(V),N[V]=0)}function E(I,N,V,q,Q,re,ee){ee===!0?r.vertexAttribIPointer(I,N,V,Q,re):r.vertexAttribPointer(I,N,V,q,Q,re)}function C(I,N,V,q){x();const Q=q.attributes,re=V.getAttributes(),ee=N.defaultAttributeValues;for(const se in re){const W=re[se];if(W.location>=0){let $=Q[se];if($===void 0&&(se==="instanceMatrix"&&I.instanceMatrix&&($=I.instanceMatrix),se==="instanceColor"&&I.instanceColor&&($=I.instanceColor)),$!==void 0){const j=$.normalized,U=$.itemSize,X=e.get($);if(X===void 0)continue;const le=X.buffer,Z=X.type,oe=X.bytesPerElement,pe=Z===r.INT||Z===r.UNSIGNED_INT||$.gpuType===US;if($.isInterleavedBufferAttribute){const de=$.data,ye=de.stride,Ge=$.offset;if(de.isInstancedInterleavedBuffer){for(let Ke=0;Ke<W.locationSize;Ke++)S(W.location+Ke,de.meshPerAttribute);I.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Ke=0;Ke<W.locationSize;Ke++)_(W.location+Ke);r.bindBuffer(r.ARRAY_BUFFER,le);for(let Ke=0;Ke<W.locationSize;Ke++)E(W.location+Ke,U/W.locationSize,Z,j,ye*oe,(Ge+U/W.locationSize*Ke)*oe,pe)}else{if($.isInstancedBufferAttribute){for(let de=0;de<W.locationSize;de++)S(W.location+de,$.meshPerAttribute);I.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=$.meshPerAttribute*$.count)}else for(let de=0;de<W.locationSize;de++)_(W.location+de);r.bindBuffer(r.ARRAY_BUFFER,le);for(let de=0;de<W.locationSize;de++)E(W.location+de,U/W.locationSize,Z,j,U*oe,U/W.locationSize*de*oe,pe)}}else if(ee!==void 0){const j=ee[se];if(j!==void 0)switch(j.length){case 2:r.vertexAttrib2fv(W.location,j);break;case 3:r.vertexAttrib3fv(W.location,j);break;case 4:r.vertexAttrib4fv(W.location,j);break;default:r.vertexAttrib1fv(W.location,j)}}}}T()}function R(){F();for(const I in n){const N=n[I];for(const V in N){const q=N[V];for(const Q in q)c(q[Q].object),delete q[Q];delete N[V]}delete n[I]}}function P(I){if(n[I.id]===void 0)return;const N=n[I.id];for(const V in N){const q=N[V];for(const Q in q)c(q[Q].object),delete q[Q];delete N[V]}delete n[I.id]}function L(I){for(const N in n){const V=n[N];if(V[I.id]===void 0)continue;const q=V[I.id];for(const Q in q)c(q[Q].object),delete q[Q];delete V[I.id]}}function F(){D(),o=!0,s!==i&&(s=i,u(s.object))}function D(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:a,reset:F,resetDefaultState:D,dispose:R,releaseStatesOfGeometry:P,releaseStatesOfProgram:L,initAttributes:x,enableAttribute:_,disableUnusedAttributes:T}}function yz(r,e,t){let n;function i(u){n=u}function s(u,c){r.drawArrays(n,u,c),t.update(c,n,1)}function o(u,c,h){h!==0&&(r.drawArraysInstanced(n,u,c,h),t.update(c,n,h))}function a(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,u,0,c,0,h);let m=0;for(let g=0;g<h;g++)m+=c[g];t.update(m,n,1)}function l(u,c,h,d){if(h===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let g=0;g<u.length;g++)o(u[g],c[g],d[g]);else{m.multiDrawArraysInstancedWEBGL(n,u,0,c,0,d,0,h);let g=0;for(let x=0;x<h;x++)g+=c[x];for(let x=0;x<d.length;x++)t.update(g,n,d[x])}}this.setMode=i,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function xz(r,e,t,n){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const P=e.get("EXT_texture_filter_anisotropic");i=r.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(P){return!(P!==ms&&n.convert(P)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(P){const L=P===Im&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(P!==Za&&n.convert(P)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)&&P!==ro&&!L)}function l(P){if(P==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const c=l(u);c!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const h=t.logarithmicDepthBuffer===!0,d=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),m=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=r.getParameter(r.MAX_TEXTURE_SIZE),x=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),_=r.getParameter(r.MAX_VERTEX_ATTRIBS),S=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),T=r.getParameter(r.MAX_VARYING_VECTORS),E=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),C=m>0,R=r.getParameter(r.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:u,logarithmicDepthBuffer:h,maxTextures:d,maxVertexTextures:m,maxTextureSize:g,maxCubemapSize:x,maxAttributes:_,maxVertexUniforms:S,maxVaryings:T,maxFragmentUniforms:E,vertexTextures:C,maxSamples:R}}function _z(r){const e=this;let t=null,n=0,i=!1,s=!1;const o=new Fu,a=new ln,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const m=h.length!==0||d||n!==0||i;return i=d,n=h.length,m},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=c(h,d,0)},this.setState=function(h,d,m){const g=h.clippingPlanes,x=h.clipIntersection,_=h.clipShadows,S=r.get(h);if(!i||g===null||g.length===0||s&&!_)s?c(null):u();else{const T=s?0:n,E=T*4;let C=S.clippingState||null;l.value=C,C=c(g,d,E,m);for(let R=0;R!==E;++R)C[R]=t[R];S.clippingState=C,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=T}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function c(h,d,m,g){const x=h!==null?h.length:0;let _=null;if(x!==0){if(_=l.value,g!==!0||_===null){const S=m+x*4,T=d.matrixWorldInverse;a.getNormalMatrix(T),(_===null||_.length<S)&&(_=new Float32Array(S));for(let E=0,C=m;E!==x;++E,C+=4)o.copy(h[E]).applyMatrix4(T,a),o.normal.toArray(_,C),_[C+3]=o.constant}l.value=_,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,_}}function Sz(r){let e=new WeakMap;function t(o,a){return a===U0?o.mapping=Yu:a===N0&&(o.mapping=ch),o}function n(o){if(o&&o.isTexture){const a=o.mapping;if(a===U0||a===N0)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new aF(l.height);return u.fromEquirectangularTexture(r,o),e.set(o,u),o.addEventListener("dispose",i),t(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Qa extends Sv{constructor(e=-1,t=1,n=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Np=4,LR=[.125,.215,.35,.446,.526,.582],Rf=20,F1=new Qa,PR=new yt;let k1=null,O1=0,U1=0,N1=!1;const Tf=(1+Math.sqrt(5))/2,Ap=1/Tf,DR=[new ae(-Tf,Ap,0),new ae(Tf,Ap,0),new ae(-Ap,0,Tf),new ae(Ap,0,Tf),new ae(0,Tf,-Ap),new ae(0,Tf,Ap),new ae(-1,1,-1),new ae(1,1,-1),new ae(-1,1,1),new ae(1,1,1)];class bT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){k1=this._renderer.getRenderTarget(),O1=this._renderer.getActiveCubeFace(),U1=this._renderer.getActiveMipmapLevel(),N1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=kR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=FR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(k1,O1,U1),this._renderer.xr.enabled=N1,e.scissorTest=!1,Qy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Yu||e.mapping===ch?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),k1=this._renderer.getRenderTarget(),O1=this._renderer.getActiveCubeFace(),U1=this._renderer.getActiveMipmapLevel(),N1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:vi,minFilter:vi,generateMipmaps:!1,type:Im,format:ms,colorSpace:ic,depthBuffer:!1},i=BR(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=BR(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Az(s)),this._blurMaterial=Ez(s,e,t)}return i}_compileMaterial(e){const t=new ui(this._lodPlanes[0],e);this._renderer.compile(t,F1)}_sceneToCubeUV(e,t,n,i){const a=new mi(90,1,t,n),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear,d=c.toneMapping;c.getClearColor(PR),c.toneMapping=Ul,c.autoClear=!1;const m=new so({name:"PMREM.Background",side:Ns,depthWrite:!1,depthTest:!1}),g=new ui(new ud,m);let x=!1;const _=e.background;_?_.isColor&&(m.color.copy(_),e.background=null,x=!0):(m.color.copy(PR),x=!0);for(let S=0;S<6;S++){const T=S%3;T===0?(a.up.set(0,l[S],0),a.lookAt(u[S],0,0)):T===1?(a.up.set(0,0,l[S]),a.lookAt(0,u[S],0)):(a.up.set(0,l[S],0),a.lookAt(0,0,u[S]));const E=this._cubeSize;Qy(i,T*E,S>2?E:0,E,E),c.setRenderTarget(i),x&&c.render(g,a),c.render(e,a)}g.geometry.dispose(),g.material.dispose(),c.toneMapping=d,c.autoClear=h,e.background=_}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Yu||e.mapping===ch;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=kR()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=FR());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new ui(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Qy(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,F1)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=DR[(i-s-1)%DR.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",s),this._halfBlur(o,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new ui(this._lodPlanes[i],u),d=u.uniforms,m=this._sizeLods[n]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Rf-1),x=s/g,_=isFinite(s)?1+Math.floor(c*x):Rf;_>Rf&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${Rf}`);const S=[];let T=0;for(let L=0;L<Rf;++L){const F=L/x,D=Math.exp(-F*F/2);S.push(D),L===0?T+=D:L<_&&(T+=2*D)}for(let L=0;L<S.length;L++)S[L]=S[L]/T;d.envMap.value=e.texture,d.samples.value=_,d.weights.value=S,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:E}=this;d.dTheta.value=g,d.mipInt.value=E-n;const C=this._sizeLods[i],R=3*C*(i>E-Np?i-E+Np:0),P=4*(this._cubeSize-C);Qy(t,R,P,3*C,2*C),l.setRenderTarget(t),l.render(h,F1)}}function Az(r){const e=[],t=[],n=[];let i=r;const s=r-Np+1+LR.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>r-Np?l=LR[o-r+Np-1]:o===0&&(l=0),n.push(l);const u=1/(a-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],m=6,g=6,x=3,_=2,S=1,T=new Float32Array(x*g*m),E=new Float32Array(_*g*m),C=new Float32Array(S*g*m);for(let P=0;P<m;P++){const L=P%3*2/3-1,F=P>2?0:-1,D=[L,F,0,L+2/3,F,0,L+2/3,F+1,0,L,F,0,L+2/3,F+1,0,L,F+1,0];T.set(D,x*g*P),E.set(d,_*g*P);const I=[P,P,P,P,P,P];C.set(I,S*g*P)}const R=new dn;R.setAttribute("position",new Pn(T,x)),R.setAttribute("uv",new Pn(E,_)),R.setAttribute("faceIndex",new Pn(C,S)),e.push(R),i>Np&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function BR(r,e,t){const n=new el(r,e,t);return n.texture.mapping=Rm,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Qy(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function Ez(r,e,t){const n=new Float32Array(Rf),i=new ae(0,1,0);return new Go({name:"SphericalGaussianBlur",defines:{n:Rf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:fw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Wu,depthTest:!1,depthWrite:!1})}function FR(){return new Go({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:fw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Wu,depthTest:!1,depthWrite:!1})}function kR(){return new Go({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:fw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Wu,depthTest:!1,depthWrite:!1})}function fw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Tz(r){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){const l=a.mapping,u=l===U0||l===N0,c=l===Yu||l===ch;if(u||c){let h=e.get(a);const d=h!==void 0?h.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==d)return t===null&&(t=new bT(r)),h=u?t.fromEquirectangular(a,h):t.fromCubemap(a,h),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),h.texture;if(h!==void 0)return h.texture;{const m=a.image;return u&&m&&m.height>0||c&&m&&i(m)?(t===null&&(t=new bT(r)),h=u?t.fromEquirectangular(a):t.fromCubemap(a),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),a.addEventListener("dispose",s),h.texture):null}}}return a}function i(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function Mz(r){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=r.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&Qp("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function wz(r,e,t,n){const i={},s=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const g in d.attributes)e.remove(d.attributes[g]);for(const g in d.morphAttributes){const x=d.morphAttributes[g];for(let _=0,S=x.length;_<S;_++)e.remove(x[_])}d.removeEventListener("dispose",o),delete i[d.id];const m=s.get(d);m&&(e.remove(m),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(h,d){return i[d.id]===!0||(d.addEventListener("dispose",o),i[d.id]=!0,t.memory.geometries++),d}function l(h){const d=h.attributes;for(const g in d)e.update(d[g],r.ARRAY_BUFFER);const m=h.morphAttributes;for(const g in m){const x=m[g];for(let _=0,S=x.length;_<S;_++)e.update(x[_],r.ARRAY_BUFFER)}}function u(h){const d=[],m=h.index,g=h.attributes.position;let x=0;if(m!==null){const T=m.array;x=m.version;for(let E=0,C=T.length;E<C;E+=3){const R=T[E+0],P=T[E+1],L=T[E+2];d.push(R,P,P,L,L,R)}}else if(g!==void 0){const T=g.array;x=g.version;for(let E=0,C=T.length/3-1;E<C;E+=3){const R=E+0,P=E+1,L=E+2;d.push(R,P,P,L,L,R)}}else return;const _=new(eF(d)?hw:cw)(d,1);_.version=x;const S=s.get(h);S&&e.remove(S),s.set(h,_)}function c(h){const d=s.get(h);if(d){const m=h.index;m!==null&&d.version<m.version&&u(h)}else u(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function Cz(r,e,t){let n;function i(d){n=d}let s,o;function a(d){s=d.type,o=d.bytesPerElement}function l(d,m){r.drawElements(n,m,s,d*o),t.update(m,n,1)}function u(d,m,g){g!==0&&(r.drawElementsInstanced(n,m,s,d*o,g),t.update(m,n,g))}function c(d,m,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,m,0,s,d,0,g);let _=0;for(let S=0;S<g;S++)_+=m[S];t.update(_,n,1)}function h(d,m,g,x){if(g===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let S=0;S<d.length;S++)u(d[S]/o,m[S],x[S]);else{_.multiDrawElementsInstancedWEBGL(n,m,0,s,d,0,x,0,g);let S=0;for(let T=0;T<g;T++)S+=m[T];for(let T=0;T<x.length;T++)t.update(S,n,x[T])}}this.setMode=i,this.setIndex=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function bz(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case r.TRIANGLES:t.triangles+=a*(s/3);break;case r.LINES:t.lines+=a*(s/2);break;case r.LINE_STRIP:t.lines+=a*(s-1);break;case r.LINE_LOOP:t.lines+=a*s;break;case r.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function Rz(r,e,t){const n=new WeakMap,i=new gn;function s(o,a,l){const u=o.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,h=c!==void 0?c.length:0;let d=n.get(a);if(d===void 0||d.count!==h){let I=function(){F.dispose(),n.delete(a),a.removeEventListener("dispose",I)};var m=I;d!==void 0&&d.texture.dispose();const g=a.morphAttributes.position!==void 0,x=a.morphAttributes.normal!==void 0,_=a.morphAttributes.color!==void 0,S=a.morphAttributes.position||[],T=a.morphAttributes.normal||[],E=a.morphAttributes.color||[];let C=0;g===!0&&(C=1),x===!0&&(C=2),_===!0&&(C=3);let R=a.attributes.position.count*C,P=1;R>e.maxTextureSize&&(P=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const L=new Float32Array(R*P*4*h),F=new KS(L,R,P,h);F.type=ro,F.needsUpdate=!0;const D=C*4;for(let N=0;N<h;N++){const V=S[N],q=T[N],Q=E[N],re=R*P*4*N;for(let ee=0;ee<V.count;ee++){const se=ee*D;g===!0&&(i.fromBufferAttribute(V,ee),L[re+se+0]=i.x,L[re+se+1]=i.y,L[re+se+2]=i.z,L[re+se+3]=0),x===!0&&(i.fromBufferAttribute(q,ee),L[re+se+4]=i.x,L[re+se+5]=i.y,L[re+se+6]=i.z,L[re+se+7]=0),_===!0&&(i.fromBufferAttribute(Q,ee),L[re+se+8]=i.x,L[re+se+9]=i.y,L[re+se+10]=i.z,L[re+se+11]=Q.itemSize===4?i.w:1)}}d={count:h,texture:F,size:new Qe(R,P)},n.set(a,d),a.addEventListener("dispose",I)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(r,"morphTexture",o.morphTexture,t);else{let g=0;for(let _=0;_<u.length;_++)g+=u[_];const x=a.morphTargetsRelative?1:1-g;l.getUniforms().setValue(r,"morphTargetBaseInfluence",x),l.getUniforms().setValue(r,"morphTargetInfluences",u)}l.getUniforms().setValue(r,"morphTargetsTexture",d.texture,t),l.getUniforms().setValue(r,"morphTargetsTextureSize",d.size)}return{update:s}}function Iz(r,e,t,n){let i=new WeakMap;function s(l){const u=n.render.frame,c=l.geometry,h=e.get(l,c);if(i.get(h)!==u&&(e.update(h),i.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==u&&(t.update(l.instanceMatrix,r.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,r.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;i.get(d)!==u&&(d.update(),i.set(d,u))}return h}function o(){i=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}class dw extends ci{constructor(e,t,n,i,s,o,a,l,u,c=Gf){if(c!==Gf&&c!==ed)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===Gf&&(n=Ju),n===void 0&&c===ed&&(n=Zf),super(null,i,s,o,a,l,c,n,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Er,this.minFilter=l!==void 0?l:Er,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const uF=new ci,OR=new dw(1,1),cF=new KS,hF=new uw,fF=new Av,UR=[],NR=[],GR=new Float32Array(16),HR=new Float32Array(9),zR=new Float32Array(4);function Lm(r,e,t){const n=r[0];if(n<=0||n>0)return r;const i=e*t;let s=UR[i];if(s===void 0&&(s=new Float32Array(i),UR[i]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,r[o].toArray(s,a)}return s}function Mr(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function wr(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function $S(r,e){let t=NR[e];t===void 0&&(t=new Int32Array(e),NR[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function Lz(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function Pz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;r.uniform2fv(this.addr,e),wr(t,e)}}function Dz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Mr(t,e))return;r.uniform3fv(this.addr,e),wr(t,e)}}function Bz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;r.uniform4fv(this.addr,e),wr(t,e)}}function Fz(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),wr(t,e)}else{if(Mr(t,n))return;zR.set(n),r.uniformMatrix2fv(this.addr,!1,zR),wr(t,n)}}function kz(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),wr(t,e)}else{if(Mr(t,n))return;HR.set(n),r.uniformMatrix3fv(this.addr,!1,HR),wr(t,n)}}function Oz(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Mr(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),wr(t,e)}else{if(Mr(t,n))return;GR.set(n),r.uniformMatrix4fv(this.addr,!1,GR),wr(t,n)}}function Uz(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function Nz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;r.uniform2iv(this.addr,e),wr(t,e)}}function Gz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mr(t,e))return;r.uniform3iv(this.addr,e),wr(t,e)}}function Hz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;r.uniform4iv(this.addr,e),wr(t,e)}}function zz(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function Vz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mr(t,e))return;r.uniform2uiv(this.addr,e),wr(t,e)}}function Wz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mr(t,e))return;r.uniform3uiv(this.addr,e),wr(t,e)}}function jz(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mr(t,e))return;r.uniform4uiv(this.addr,e),wr(t,e)}}function Kz(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i);let s;this.type===r.SAMPLER_2D_SHADOW?(OR.compareFunction=aw,s=OR):s=uF,t.setTexture2D(e||s,i)}function $z(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||hF,i)}function Xz(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||fF,i)}function Yz(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||cF,i)}function Jz(r){switch(r){case 5126:return Lz;case 35664:return Pz;case 35665:return Dz;case 35666:return Bz;case 35674:return Fz;case 35675:return kz;case 35676:return Oz;case 5124:case 35670:return Uz;case 35667:case 35671:return Nz;case 35668:case 35672:return Gz;case 35669:case 35673:return Hz;case 5125:return zz;case 36294:return Vz;case 36295:return Wz;case 36296:return jz;case 35678:case 36198:case 36298:case 36306:case 35682:return Kz;case 35679:case 36299:case 36307:return $z;case 35680:case 36300:case 36308:case 36293:return Xz;case 36289:case 36303:case 36311:case 36292:return Yz}}function qz(r,e){r.uniform1fv(this.addr,e)}function Qz(r,e){const t=Lm(e,this.size,2);r.uniform2fv(this.addr,t)}function Zz(r,e){const t=Lm(e,this.size,3);r.uniform3fv(this.addr,t)}function eV(r,e){const t=Lm(e,this.size,4);r.uniform4fv(this.addr,t)}function tV(r,e){const t=Lm(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function nV(r,e){const t=Lm(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function iV(r,e){const t=Lm(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function rV(r,e){r.uniform1iv(this.addr,e)}function sV(r,e){r.uniform2iv(this.addr,e)}function oV(r,e){r.uniform3iv(this.addr,e)}function aV(r,e){r.uniform4iv(this.addr,e)}function lV(r,e){r.uniform1uiv(this.addr,e)}function uV(r,e){r.uniform2uiv(this.addr,e)}function cV(r,e){r.uniform3uiv(this.addr,e)}function hV(r,e){r.uniform4uiv(this.addr,e)}function fV(r,e,t){const n=this.cache,i=e.length,s=$S(t,i);Mr(n,s)||(r.uniform1iv(this.addr,s),wr(n,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||uF,s[o])}function dV(r,e,t){const n=this.cache,i=e.length,s=$S(t,i);Mr(n,s)||(r.uniform1iv(this.addr,s),wr(n,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||hF,s[o])}function pV(r,e,t){const n=this.cache,i=e.length,s=$S(t,i);Mr(n,s)||(r.uniform1iv(this.addr,s),wr(n,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||fF,s[o])}function mV(r,e,t){const n=this.cache,i=e.length,s=$S(t,i);Mr(n,s)||(r.uniform1iv(this.addr,s),wr(n,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||cF,s[o])}function gV(r){switch(r){case 5126:return qz;case 35664:return Qz;case 35665:return Zz;case 35666:return eV;case 35674:return tV;case 35675:return nV;case 35676:return iV;case 5124:case 35670:return rV;case 35667:case 35671:return sV;case 35668:case 35672:return oV;case 35669:case 35673:return aV;case 5125:return lV;case 36294:return uV;case 36295:return cV;case 36296:return hV;case 35678:case 36198:case 36298:case 36306:case 35682:return fV;case 35679:case 36299:case 36307:return dV;case 35680:case 36300:case 36308:case 36293:return pV;case 36289:case 36303:case 36311:case 36292:return mV}}class vV{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=Jz(t.type)}}class yV{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=gV(t.type)}}class xV{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],n)}}}const G1=/(\w+)(\])?(\[|\.)?/g;function VR(r,e){r.seq.push(e),r.map[e.id]=e}function _V(r,e,t){const n=r.name,i=n.length;for(G1.lastIndex=0;;){const s=G1.exec(n),o=G1.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===i){VR(t,u===void 0?new vV(a,r,e):new yV(a,r,e));break}else{let h=t.map[a];h===void 0&&(h=new xV(a),VR(t,h)),t=h}}}class i_{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);_V(s,o,this)}}setValue(e,t,n,i){const s=this.map[t];s!==void 0&&s.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&n.push(o)}return n}}function WR(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}const SV=37297;let AV=0;function EV(r,e){const t=r.split(`
`),n=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}function TV(r){const e=On.getPrimaries(On.workingColorSpace),t=On.getPrimaries(r);let n;switch(e===t?n="":e===V0&&t===z0?n="LinearDisplayP3ToLinearSRGB":e===z0&&t===V0&&(n="LinearSRGBToLinearDisplayP3"),r){case ic:case xv:return[n,"LinearTransferOETF"];case fa:case jS:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",r),[n,"LinearTransferOETF"]}}function jR(r,e,t){const n=r.getShaderParameter(e,r.COMPILE_STATUS),i=r.getShaderInfoLog(e).trim();if(n&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+EV(r.getShaderSource(e),o)}else return i}function MV(r,e){const t=TV(e);return`vec4 ${r}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function wV(r,e){let t;switch(e){case BB:t="Linear";break;case FB:t="Reinhard";break;case kB:t="OptimizedCineon";break;case XM:t="ACESFilmic";break;case UB:t="AgX";break;case NB:t="Neutral";break;case OB:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Zy=new ae;function CV(){On.getLuminanceCoefficients(Zy);const r=Zy.x.toFixed(4),e=Zy.y.toFixed(4),t=Zy.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${r}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function bV(r){return[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(i0).join(`
`)}function RV(r){const e=[];for(const t in r){const n=r[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function IV(r,e){const t={},n=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=r.getActiveAttrib(e,i),o=s.name;let a=1;s.type===r.FLOAT_MAT2&&(a=2),s.type===r.FLOAT_MAT3&&(a=3),s.type===r.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:r.getAttribLocation(e,o),locationSize:a}}return t}function i0(r){return r!==""}function KR(r,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function $R(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const LV=/^[ \t]*#include +<([\w\d./]+)>/gm;function RT(r){return r.replace(LV,DV)}const PV=new Map;function DV(r,e){let t=hn[e];if(t===void 0){const n=PV.get(e);if(n!==void 0)t=hn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return RT(t)}const BV=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function XR(r){return r.replace(BV,FV)}function FV(r,e,t,n){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function YR(r){let e=`precision ${r.precision} float;
	precision ${r.precision} int;
	precision ${r.precision} sampler2D;
	precision ${r.precision} samplerCube;
	precision ${r.precision} sampler3D;
	precision ${r.precision} sampler2DArray;
	precision ${r.precision} sampler2DShadow;
	precision ${r.precision} samplerCubeShadow;
	precision ${r.precision} sampler2DArrayShadow;
	precision ${r.precision} isampler2D;
	precision ${r.precision} isampler3D;
	precision ${r.precision} isamplerCube;
	precision ${r.precision} isampler2DArray;
	precision ${r.precision} usampler2D;
	precision ${r.precision} usampler3D;
	precision ${r.precision} usamplerCube;
	precision ${r.precision} usampler2DArray;
	`;return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function kV(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===FS?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===f0?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Ya&&(e="SHADOWMAP_TYPE_VSM"),e}function OV(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case Yu:case ch:e="ENVMAP_TYPE_CUBE";break;case Rm:e="ENVMAP_TYPE_CUBE_UV";break}return e}function UV(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case ch:e="ENVMAP_MODE_REFRACTION";break}return e}function NV(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case vv:e="ENVMAP_BLENDING_MULTIPLY";break;case PB:e="ENVMAP_BLENDING_MIX";break;case DB:e="ENVMAP_BLENDING_ADD";break}return e}function GV(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function HV(r,e,t,n){const i=r.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=kV(t),u=OV(t),c=UV(t),h=NV(t),d=GV(t),m=bV(t),g=RV(s),x=i.createProgram();let _,S,T=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(i0).join(`
`),_.length>0&&(_+=`
`),S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(i0).join(`
`),S.length>0&&(S+=`
`)):(_=[YR(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(i0).join(`
`),S=[YR(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ul?"#define TONE_MAPPING":"",t.toneMapping!==Ul?hn.tonemapping_pars_fragment:"",t.toneMapping!==Ul?wV("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",hn.colorspace_pars_fragment,MV("linearToOutputTexel",t.outputColorSpace),CV(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(i0).join(`
`)),o=RT(o),o=KR(o,t),o=$R(o,t),a=RT(a),a=KR(a,t),a=$R(a,t),o=XR(o),a=XR(a),t.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,_=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,S=["#define varying in",t.glslVersion===CT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===CT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const E=T+_+o,C=T+S+a,R=WR(i,i.VERTEX_SHADER,E),P=WR(i,i.FRAGMENT_SHADER,C);i.attachShader(x,R),i.attachShader(x,P),t.index0AttributeName!==void 0?i.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(x,0,"position"),i.linkProgram(x);function L(N){if(r.debug.checkShaderErrors){const V=i.getProgramInfoLog(x).trim(),q=i.getShaderInfoLog(R).trim(),Q=i.getShaderInfoLog(P).trim();let re=!0,ee=!0;if(i.getProgramParameter(x,i.LINK_STATUS)===!1)if(re=!1,typeof r.debug.onShaderError=="function")r.debug.onShaderError(i,x,R,P);else{const se=jR(i,R,"vertex"),W=jR(i,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(x,i.VALIDATE_STATUS)+`

Material Name: `+N.name+`
Material Type: `+N.type+`

Program Info Log: `+V+`
`+se+`
`+W)}else V!==""?console.warn("THREE.WebGLProgram: Program Info Log:",V):(q===""||Q==="")&&(ee=!1);ee&&(N.diagnostics={runnable:re,programLog:V,vertexShader:{log:q,prefix:_},fragmentShader:{log:Q,prefix:S}})}i.deleteShader(R),i.deleteShader(P),F=new i_(i,x),D=IV(i,x)}let F;this.getUniforms=function(){return F===void 0&&L(this),F};let D;this.getAttributes=function(){return D===void 0&&L(this),D};let I=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return I===!1&&(I=i.getProgramParameter(x,SV)),I},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=AV++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=R,this.fragmentShader=P,this}let zV=0;class VV{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new WV(e),t.set(e,n)),n}}class WV{constructor(e){this.id=zV++,this.code=e,this.usedTimes=0}}function jV(r,e,t,n,i,s,o){const a=new zf,l=new VV,u=new Set,c=[],h=i.logarithmicDepthBuffer,d=i.vertexTextures;let m=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(D){return u.add(D),D===0?"uv":`uv${D}`}function _(D,I,N,V,q){const Q=V.fog,re=q.geometry,ee=D.isMeshStandardMaterial?V.environment:null,se=(D.isMeshStandardMaterial?t:e).get(D.envMap||ee),W=se&&se.mapping===Rm?se.image.height:null,$=g[D.type];D.precision!==null&&(m=i.getMaxPrecision(D.precision),m!==D.precision&&console.warn("THREE.WebGLProgram.getParameters:",D.precision,"not supported, using",m,"instead."));const j=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,U=j!==void 0?j.length:0;let X=0;re.morphAttributes.position!==void 0&&(X=1),re.morphAttributes.normal!==void 0&&(X=2),re.morphAttributes.color!==void 0&&(X=3);let le,Z,oe,pe;if($){const gt=Ja[$];le=gt.vertexShader,Z=gt.fragmentShader}else le=D.vertexShader,Z=D.fragmentShader,l.update(D),oe=l.getVertexShaderID(D),pe=l.getFragmentShaderID(D);const de=r.getRenderTarget(),ye=q.isInstancedMesh===!0,Ge=q.isBatchedMesh===!0,Ke=!!D.map,De=!!D.matcap,K=!!se,Pe=!!D.aoMap,Be=!!D.lightMap,Xe=!!D.bumpMap,ve=!!D.normalMap,et=!!D.displacementMap,Ce=!!D.emissiveMap,We=!!D.metalnessMap,te=!!D.roughnessMap,z=D.anisotropy>0,me=D.clearcoat>0,_e=D.dispersion>0,Ee=D.iridescence>0,we=D.sheen>0,ut=D.transmission>0,ke=z&&!!D.anisotropyMap,Ze=me&&!!D.clearcoatMap,lt=me&&!!D.clearcoatNormalMap,Ye=me&&!!D.clearcoatRoughnessMap,nt=Ee&&!!D.iridescenceMap,Ct=Ee&&!!D.iridescenceThicknessMap,ht=we&&!!D.sheenColorMap,it=we&&!!D.sheenRoughnessMap,rt=!!D.specularMap,fe=!!D.specularColorMap,Je=!!D.specularIntensityMap,ce=ut&&!!D.transmissionMap,He=ut&&!!D.thicknessMap,Te=!!D.gradientMap,Oe=!!D.alphaMap,st=D.alphaTest>0,xt=!!D.alphaHash,_t=!!D.extensions;let Ht=Ul;D.toneMapped&&(de===null||de.isXRRenderTarget===!0)&&(Ht=r.toneMapping);const zt={shaderID:$,shaderType:D.type,shaderName:D.name,vertexShader:le,fragmentShader:Z,defines:D.defines,customVertexShaderID:oe,customFragmentShaderID:pe,isRawShaderMaterial:D.isRawShaderMaterial===!0,glslVersion:D.glslVersion,precision:m,batching:Ge,batchingColor:Ge&&q._colorsTexture!==null,instancing:ye,instancingColor:ye&&q.instanceColor!==null,instancingMorph:ye&&q.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:de===null?r.outputColorSpace:de.isXRRenderTarget===!0?de.texture.colorSpace:ic,alphaToCoverage:!!D.alphaToCoverage,map:Ke,matcap:De,envMap:K,envMapMode:K&&se.mapping,envMapCubeUVHeight:W,aoMap:Pe,lightMap:Be,bumpMap:Xe,normalMap:ve,displacementMap:d&&et,emissiveMap:Ce,normalMapObjectSpace:ve&&D.normalMapType===KB,normalMapTangentSpace:ve&&D.normalMapType===vh,metalnessMap:We,roughnessMap:te,anisotropy:z,anisotropyMap:ke,clearcoat:me,clearcoatMap:Ze,clearcoatNormalMap:lt,clearcoatRoughnessMap:Ye,dispersion:_e,iridescence:Ee,iridescenceMap:nt,iridescenceThicknessMap:Ct,sheen:we,sheenColorMap:ht,sheenRoughnessMap:it,specularMap:rt,specularColorMap:fe,specularIntensityMap:Je,transmission:ut,transmissionMap:ce,thicknessMap:He,gradientMap:Te,opaque:D.transparent===!1&&D.blending===Nf&&D.alphaToCoverage===!1,alphaMap:Oe,alphaTest:st,alphaHash:xt,combine:D.combine,mapUv:Ke&&x(D.map.channel),aoMapUv:Pe&&x(D.aoMap.channel),lightMapUv:Be&&x(D.lightMap.channel),bumpMapUv:Xe&&x(D.bumpMap.channel),normalMapUv:ve&&x(D.normalMap.channel),displacementMapUv:et&&x(D.displacementMap.channel),emissiveMapUv:Ce&&x(D.emissiveMap.channel),metalnessMapUv:We&&x(D.metalnessMap.channel),roughnessMapUv:te&&x(D.roughnessMap.channel),anisotropyMapUv:ke&&x(D.anisotropyMap.channel),clearcoatMapUv:Ze&&x(D.clearcoatMap.channel),clearcoatNormalMapUv:lt&&x(D.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ye&&x(D.clearcoatRoughnessMap.channel),iridescenceMapUv:nt&&x(D.iridescenceMap.channel),iridescenceThicknessMapUv:Ct&&x(D.iridescenceThicknessMap.channel),sheenColorMapUv:ht&&x(D.sheenColorMap.channel),sheenRoughnessMapUv:it&&x(D.sheenRoughnessMap.channel),specularMapUv:rt&&x(D.specularMap.channel),specularColorMapUv:fe&&x(D.specularColorMap.channel),specularIntensityMapUv:Je&&x(D.specularIntensityMap.channel),transmissionMapUv:ce&&x(D.transmissionMap.channel),thicknessMapUv:He&&x(D.thicknessMap.channel),alphaMapUv:Oe&&x(D.alphaMap.channel),vertexTangents:!!re.attributes.tangent&&(ve||z),vertexColors:D.vertexColors,vertexAlphas:D.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,pointsUvs:q.isPoints===!0&&!!re.attributes.uv&&(Ke||Oe),fog:!!Q,useFog:D.fog===!0,fogExp2:!!Q&&Q.isFogExp2,flatShading:D.flatShading===!0,sizeAttenuation:D.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:q.isSkinnedMesh===!0,morphTargets:re.morphAttributes.position!==void 0,morphNormals:re.morphAttributes.normal!==void 0,morphColors:re.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:X,numDirLights:I.directional.length,numPointLights:I.point.length,numSpotLights:I.spot.length,numSpotLightMaps:I.spotLightMap.length,numRectAreaLights:I.rectArea.length,numHemiLights:I.hemi.length,numDirLightShadows:I.directionalShadowMap.length,numPointLightShadows:I.pointShadowMap.length,numSpotLightShadows:I.spotShadowMap.length,numSpotLightShadowsWithMaps:I.numSpotLightShadowsWithMaps,numLightProbes:I.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:D.dithering,shadowMapEnabled:r.shadowMap.enabled&&N.length>0,shadowMapType:r.shadowMap.type,toneMapping:Ht,decodeVideoTexture:Ke&&D.map.isVideoTexture===!0&&On.getTransfer(D.map.colorSpace)===ri,premultipliedAlpha:D.premultipliedAlpha,doubleSided:D.side===Lo,flipSided:D.side===Ns,useDepthPacking:D.depthPacking>=0,depthPacking:D.depthPacking||0,index0AttributeName:D.index0AttributeName,extensionClipCullDistance:_t&&D.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(_t&&D.extensions.multiDraw===!0||Ge)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:D.customProgramCacheKey()};return zt.vertexUv1s=u.has(1),zt.vertexUv2s=u.has(2),zt.vertexUv3s=u.has(3),u.clear(),zt}function S(D){const I=[];if(D.shaderID?I.push(D.shaderID):(I.push(D.customVertexShaderID),I.push(D.customFragmentShaderID)),D.defines!==void 0)for(const N in D.defines)I.push(N),I.push(D.defines[N]);return D.isRawShaderMaterial===!1&&(T(I,D),E(I,D),I.push(r.outputColorSpace)),I.push(D.customProgramCacheKey),I.join()}function T(D,I){D.push(I.precision),D.push(I.outputColorSpace),D.push(I.envMapMode),D.push(I.envMapCubeUVHeight),D.push(I.mapUv),D.push(I.alphaMapUv),D.push(I.lightMapUv),D.push(I.aoMapUv),D.push(I.bumpMapUv),D.push(I.normalMapUv),D.push(I.displacementMapUv),D.push(I.emissiveMapUv),D.push(I.metalnessMapUv),D.push(I.roughnessMapUv),D.push(I.anisotropyMapUv),D.push(I.clearcoatMapUv),D.push(I.clearcoatNormalMapUv),D.push(I.clearcoatRoughnessMapUv),D.push(I.iridescenceMapUv),D.push(I.iridescenceThicknessMapUv),D.push(I.sheenColorMapUv),D.push(I.sheenRoughnessMapUv),D.push(I.specularMapUv),D.push(I.specularColorMapUv),D.push(I.specularIntensityMapUv),D.push(I.transmissionMapUv),D.push(I.thicknessMapUv),D.push(I.combine),D.push(I.fogExp2),D.push(I.sizeAttenuation),D.push(I.morphTargetsCount),D.push(I.morphAttributeCount),D.push(I.numDirLights),D.push(I.numPointLights),D.push(I.numSpotLights),D.push(I.numSpotLightMaps),D.push(I.numHemiLights),D.push(I.numRectAreaLights),D.push(I.numDirLightShadows),D.push(I.numPointLightShadows),D.push(I.numSpotLightShadows),D.push(I.numSpotLightShadowsWithMaps),D.push(I.numLightProbes),D.push(I.shadowMapType),D.push(I.toneMapping),D.push(I.numClippingPlanes),D.push(I.numClipIntersection),D.push(I.depthPacking)}function E(D,I){a.disableAll(),I.supportsVertexTextures&&a.enable(0),I.instancing&&a.enable(1),I.instancingColor&&a.enable(2),I.instancingMorph&&a.enable(3),I.matcap&&a.enable(4),I.envMap&&a.enable(5),I.normalMapObjectSpace&&a.enable(6),I.normalMapTangentSpace&&a.enable(7),I.clearcoat&&a.enable(8),I.iridescence&&a.enable(9),I.alphaTest&&a.enable(10),I.vertexColors&&a.enable(11),I.vertexAlphas&&a.enable(12),I.vertexUv1s&&a.enable(13),I.vertexUv2s&&a.enable(14),I.vertexUv3s&&a.enable(15),I.vertexTangents&&a.enable(16),I.anisotropy&&a.enable(17),I.alphaHash&&a.enable(18),I.batching&&a.enable(19),I.dispersion&&a.enable(20),I.batchingColor&&a.enable(21),D.push(a.mask),a.disableAll(),I.fog&&a.enable(0),I.useFog&&a.enable(1),I.flatShading&&a.enable(2),I.logarithmicDepthBuffer&&a.enable(3),I.skinning&&a.enable(4),I.morphTargets&&a.enable(5),I.morphNormals&&a.enable(6),I.morphColors&&a.enable(7),I.premultipliedAlpha&&a.enable(8),I.shadowMapEnabled&&a.enable(9),I.doubleSided&&a.enable(10),I.flipSided&&a.enable(11),I.useDepthPacking&&a.enable(12),I.dithering&&a.enable(13),I.transmission&&a.enable(14),I.sheen&&a.enable(15),I.opaque&&a.enable(16),I.pointsUvs&&a.enable(17),I.decodeVideoTexture&&a.enable(18),I.alphaToCoverage&&a.enable(19),D.push(a.mask)}function C(D){const I=g[D.type];let N;if(I){const V=Ja[I];N=$0.clone(V.uniforms)}else N=D.uniforms;return N}function R(D,I){let N;for(let V=0,q=c.length;V<q;V++){const Q=c[V];if(Q.cacheKey===I){N=Q,++N.usedTimes;break}}return N===void 0&&(N=new HV(r,I,D,s),c.push(N)),N}function P(D){if(--D.usedTimes===0){const I=c.indexOf(D);c[I]=c[c.length-1],c.pop(),D.destroy()}}function L(D){l.remove(D)}function F(){l.dispose()}return{getParameters:_,getProgramCacheKey:S,getUniforms:C,acquireProgram:R,releaseProgram:P,releaseShaderCache:L,programs:c,dispose:F}}function KV(){let r=new WeakMap;function e(s){let o=r.get(s);return o===void 0&&(o={},r.set(s,o)),o}function t(s){r.delete(s)}function n(s,o,a){r.get(s)[o]=a}function i(){r=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function $V(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function JR(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function qR(){const r=[];let e=0;const t=[],n=[],i=[];function s(){e=0,t.length=0,n.length=0,i.length=0}function o(h,d,m,g,x,_){let S=r[e];return S===void 0?(S={id:h.id,object:h,geometry:d,material:m,groupOrder:g,renderOrder:h.renderOrder,z:x,group:_},r[e]=S):(S.id=h.id,S.object=h,S.geometry=d,S.material=m,S.groupOrder=g,S.renderOrder=h.renderOrder,S.z=x,S.group=_),e++,S}function a(h,d,m,g,x,_){const S=o(h,d,m,g,x,_);m.transmission>0?n.push(S):m.transparent===!0?i.push(S):t.push(S)}function l(h,d,m,g,x,_){const S=o(h,d,m,g,x,_);m.transmission>0?n.unshift(S):m.transparent===!0?i.unshift(S):t.unshift(S)}function u(h,d){t.length>1&&t.sort(h||$V),n.length>1&&n.sort(d||JR),i.length>1&&i.sort(d||JR)}function c(){for(let h=e,d=r.length;h<d;h++){const m=r[h];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:n,transparent:i,init:s,push:a,unshift:l,finish:c,sort:u}}function XV(){let r=new WeakMap;function e(n,i){const s=r.get(n);let o;return s===void 0?(o=new qR,r.set(n,[o])):i>=s.length?(o=new qR,s.push(o)):o=s[i],o}function t(){r=new WeakMap}return{get:e,dispose:t}}function YV(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ae,color:new yt};break;case"SpotLight":t={position:new ae,direction:new ae,color:new yt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ae,color:new yt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ae,skyColor:new yt,groundColor:new yt};break;case"RectAreaLight":t={color:new yt,position:new ae,halfWidth:new ae,halfHeight:new ae};break}return r[e.id]=t,t}}}function JV(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let qV=0;function QV(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function ZV(r){const e=new YV,t=JV(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)n.probe.push(new ae);const i=new ae,s=new Wt,o=new Wt;function a(u){let c=0,h=0,d=0;for(let D=0;D<9;D++)n.probe[D].set(0,0,0);let m=0,g=0,x=0,_=0,S=0,T=0,E=0,C=0,R=0,P=0,L=0;u.sort(QV);for(let D=0,I=u.length;D<I;D++){const N=u[D],V=N.color,q=N.intensity,Q=N.distance,re=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)c+=V.r*q,h+=V.g*q,d+=V.b*q;else if(N.isLightProbe){for(let ee=0;ee<9;ee++)n.probe[ee].addScaledVector(N.sh.coefficients[ee],q);L++}else if(N.isDirectionalLight){const ee=e.get(N);if(ee.color.copy(N.color).multiplyScalar(N.intensity),N.castShadow){const se=N.shadow,W=t.get(N);W.shadowIntensity=se.intensity,W.shadowBias=se.bias,W.shadowNormalBias=se.normalBias,W.shadowRadius=se.radius,W.shadowMapSize=se.mapSize,n.directionalShadow[m]=W,n.directionalShadowMap[m]=re,n.directionalShadowMatrix[m]=N.shadow.matrix,T++}n.directional[m]=ee,m++}else if(N.isSpotLight){const ee=e.get(N);ee.position.setFromMatrixPosition(N.matrixWorld),ee.color.copy(V).multiplyScalar(q),ee.distance=Q,ee.coneCos=Math.cos(N.angle),ee.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),ee.decay=N.decay,n.spot[x]=ee;const se=N.shadow;if(N.map&&(n.spotLightMap[R]=N.map,R++,se.updateMatrices(N),N.castShadow&&P++),n.spotLightMatrix[x]=se.matrix,N.castShadow){const W=t.get(N);W.shadowIntensity=se.intensity,W.shadowBias=se.bias,W.shadowNormalBias=se.normalBias,W.shadowRadius=se.radius,W.shadowMapSize=se.mapSize,n.spotShadow[x]=W,n.spotShadowMap[x]=re,C++}x++}else if(N.isRectAreaLight){const ee=e.get(N);ee.color.copy(V).multiplyScalar(q),ee.halfWidth.set(N.width*.5,0,0),ee.halfHeight.set(0,N.height*.5,0),n.rectArea[_]=ee,_++}else if(N.isPointLight){const ee=e.get(N);if(ee.color.copy(N.color).multiplyScalar(N.intensity),ee.distance=N.distance,ee.decay=N.decay,N.castShadow){const se=N.shadow,W=t.get(N);W.shadowIntensity=se.intensity,W.shadowBias=se.bias,W.shadowNormalBias=se.normalBias,W.shadowRadius=se.radius,W.shadowMapSize=se.mapSize,W.shadowCameraNear=se.camera.near,W.shadowCameraFar=se.camera.far,n.pointShadow[g]=W,n.pointShadowMap[g]=re,n.pointShadowMatrix[g]=N.shadow.matrix,E++}n.point[g]=ee,g++}else if(N.isHemisphereLight){const ee=e.get(N);ee.skyColor.copy(N.color).multiplyScalar(q),ee.groundColor.copy(N.groundColor).multiplyScalar(q),n.hemi[S]=ee,S++}}_>0&&(r.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=St.LTC_FLOAT_1,n.rectAreaLTC2=St.LTC_FLOAT_2):(n.rectAreaLTC1=St.LTC_HALF_1,n.rectAreaLTC2=St.LTC_HALF_2)),n.ambient[0]=c,n.ambient[1]=h,n.ambient[2]=d;const F=n.hash;(F.directionalLength!==m||F.pointLength!==g||F.spotLength!==x||F.rectAreaLength!==_||F.hemiLength!==S||F.numDirectionalShadows!==T||F.numPointShadows!==E||F.numSpotShadows!==C||F.numSpotMaps!==R||F.numLightProbes!==L)&&(n.directional.length=m,n.spot.length=x,n.rectArea.length=_,n.point.length=g,n.hemi.length=S,n.directionalShadow.length=T,n.directionalShadowMap.length=T,n.pointShadow.length=E,n.pointShadowMap.length=E,n.spotShadow.length=C,n.spotShadowMap.length=C,n.directionalShadowMatrix.length=T,n.pointShadowMatrix.length=E,n.spotLightMatrix.length=C+R-P,n.spotLightMap.length=R,n.numSpotLightShadowsWithMaps=P,n.numLightProbes=L,F.directionalLength=m,F.pointLength=g,F.spotLength=x,F.rectAreaLength=_,F.hemiLength=S,F.numDirectionalShadows=T,F.numPointShadows=E,F.numSpotShadows=C,F.numSpotMaps=R,F.numLightProbes=L,n.version=qV++)}function l(u,c){let h=0,d=0,m=0,g=0,x=0;const _=c.matrixWorldInverse;for(let S=0,T=u.length;S<T;S++){const E=u[S];if(E.isDirectionalLight){const C=n.directional[h];C.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(_),h++}else if(E.isSpotLight){const C=n.spot[m];C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(_),C.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(_),m++}else if(E.isRectAreaLight){const C=n.rectArea[g];C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(_),o.identity(),s.copy(E.matrixWorld),s.premultiply(_),o.extractRotation(s),C.halfWidth.set(E.width*.5,0,0),C.halfHeight.set(0,E.height*.5,0),C.halfWidth.applyMatrix4(o),C.halfHeight.applyMatrix4(o),g++}else if(E.isPointLight){const C=n.point[d];C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(_),d++}else if(E.isHemisphereLight){const C=n.hemi[x];C.direction.setFromMatrixPosition(E.matrixWorld),C.direction.transformDirection(_),x++}}}return{setup:a,setupView:l,state:n}}function QR(r){const e=new ZV(r),t=[],n=[];function i(c){u.camera=c,t.length=0,n.length=0}function s(c){t.push(c)}function o(c){n.push(c)}function a(){e.setup(t)}function l(c){e.setupView(t,c)}const u={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:u,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function e6(r){let e=new WeakMap;function t(i,s=0){const o=e.get(i);let a;return o===void 0?(a=new QR(r),e.set(i,[a])):s>=o.length?(a=new QR(r),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}class XS extends Tr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=jB,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class YS extends Tr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const t6=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,n6=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function i6(r,e,t){let n=new Ev;const i=new Qe,s=new Qe,o=new gn,a=new XS({depthPacking:ow}),l=new YS,u={},c=t.maxTextureSize,h={[Wl]:Ns,[Ns]:Wl,[Lo]:Lo},d=new Go({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qe},radius:{value:4}},vertexShader:t6,fragmentShader:n6}),m=d.clone();m.defines.HORIZONTAL_PASS=1;const g=new dn;g.setAttribute("position",new Pn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new ui(g,d),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=FS;let S=this.type;this.render=function(P,L,F){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||P.length===0)return;const D=r.getRenderTarget(),I=r.getActiveCubeFace(),N=r.getActiveMipmapLevel(),V=r.state;V.setBlending(Wu),V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);const q=S!==Ya&&this.type===Ya,Q=S===Ya&&this.type!==Ya;for(let re=0,ee=P.length;re<ee;re++){const se=P[re],W=se.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",se,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;i.copy(W.mapSize);const $=W.getFrameExtents();if(i.multiply($),s.copy(W.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(s.x=Math.floor(c/$.x),i.x=s.x*$.x,W.mapSize.x=s.x),i.y>c&&(s.y=Math.floor(c/$.y),i.y=s.y*$.y,W.mapSize.y=s.y)),W.map===null||q===!0||Q===!0){const U=this.type!==Ya?{minFilter:Er,magFilter:Er}:{};W.map!==null&&W.map.dispose(),W.map=new el(i.x,i.y,U),W.map.texture.name=se.name+".shadowMap",W.camera.updateProjectionMatrix()}r.setRenderTarget(W.map),r.clear();const j=W.getViewportCount();for(let U=0;U<j;U++){const X=W.getViewport(U);o.set(s.x*X.x,s.y*X.y,s.x*X.z,s.y*X.w),V.viewport(o),W.updateMatrices(se,U),n=W.getFrustum(),C(L,F,W.camera,se,this.type)}W.isPointLightShadow!==!0&&this.type===Ya&&T(W,F),W.needsUpdate=!1}S=this.type,_.needsUpdate=!1,r.setRenderTarget(D,I,N)};function T(P,L){const F=e.update(x);d.defines.VSM_SAMPLES!==P.blurSamples&&(d.defines.VSM_SAMPLES=P.blurSamples,m.defines.VSM_SAMPLES=P.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),P.mapPass===null&&(P.mapPass=new el(i.x,i.y)),d.uniforms.shadow_pass.value=P.map.texture,d.uniforms.resolution.value=P.mapSize,d.uniforms.radius.value=P.radius,r.setRenderTarget(P.mapPass),r.clear(),r.renderBufferDirect(L,null,F,d,x,null),m.uniforms.shadow_pass.value=P.mapPass.texture,m.uniforms.resolution.value=P.mapSize,m.uniforms.radius.value=P.radius,r.setRenderTarget(P.map),r.clear(),r.renderBufferDirect(L,null,F,m,x,null)}function E(P,L,F,D){let I=null;const N=F.isPointLight===!0?P.customDistanceMaterial:P.customDepthMaterial;if(N!==void 0)I=N;else if(I=F.isPointLight===!0?l:a,r.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){const V=I.uuid,q=L.uuid;let Q=u[V];Q===void 0&&(Q={},u[V]=Q);let re=Q[q];re===void 0&&(re=I.clone(),Q[q]=re,L.addEventListener("dispose",R)),I=re}if(I.visible=L.visible,I.wireframe=L.wireframe,D===Ya?I.side=L.shadowSide!==null?L.shadowSide:L.side:I.side=L.shadowSide!==null?L.shadowSide:h[L.side],I.alphaMap=L.alphaMap,I.alphaTest=L.alphaTest,I.map=L.map,I.clipShadows=L.clipShadows,I.clippingPlanes=L.clippingPlanes,I.clipIntersection=L.clipIntersection,I.displacementMap=L.displacementMap,I.displacementScale=L.displacementScale,I.displacementBias=L.displacementBias,I.wireframeLinewidth=L.wireframeLinewidth,I.linewidth=L.linewidth,F.isPointLight===!0&&I.isMeshDistanceMaterial===!0){const V=r.properties.get(I);V.light=F}return I}function C(P,L,F,D,I){if(P.visible===!1)return;if(P.layers.test(L.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&I===Ya)&&(!P.frustumCulled||n.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,P.matrixWorld);const q=e.update(P),Q=P.material;if(Array.isArray(Q)){const re=q.groups;for(let ee=0,se=re.length;ee<se;ee++){const W=re[ee],$=Q[W.materialIndex];if($&&$.visible){const j=E(P,$,D,I);P.onBeforeShadow(r,P,L,F,q,j,W),r.renderBufferDirect(F,null,q,j,P,W),P.onAfterShadow(r,P,L,F,q,j,W)}}}else if(Q.visible){const re=E(P,Q,D,I);P.onBeforeShadow(r,P,L,F,q,re,null),r.renderBufferDirect(F,null,q,re,P,null),P.onAfterShadow(r,P,L,F,q,re,null)}}const V=P.children;for(let q=0,Q=V.length;q<Q;q++)C(V[q],L,F,D,I)}function R(P){P.target.removeEventListener("dispose",R);for(const F in u){const D=u[F],I=P.target.uuid;I in D&&(D[I].dispose(),delete D[I])}}}function r6(r){function e(){let ce=!1;const He=new gn;let Te=null;const Oe=new gn(0,0,0,0);return{setMask:function(st){Te!==st&&!ce&&(r.colorMask(st,st,st,st),Te=st)},setLocked:function(st){ce=st},setClear:function(st,xt,_t,Ht,zt){zt===!0&&(st*=Ht,xt*=Ht,_t*=Ht),He.set(st,xt,_t,Ht),Oe.equals(He)===!1&&(r.clearColor(st,xt,_t,Ht),Oe.copy(He))},reset:function(){ce=!1,Te=null,Oe.set(-1,0,0,0)}}}function t(){let ce=!1,He=null,Te=null,Oe=null;return{setTest:function(st){st?pe(r.DEPTH_TEST):de(r.DEPTH_TEST)},setMask:function(st){He!==st&&!ce&&(r.depthMask(st),He=st)},setFunc:function(st){if(Te!==st){switch(st){case MB:r.depthFunc(r.NEVER);break;case wB:r.depthFunc(r.ALWAYS);break;case CB:r.depthFunc(r.LESS);break;case O0:r.depthFunc(r.LEQUAL);break;case bB:r.depthFunc(r.EQUAL);break;case RB:r.depthFunc(r.GEQUAL);break;case IB:r.depthFunc(r.GREATER);break;case LB:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}Te=st}},setLocked:function(st){ce=st},setClear:function(st){Oe!==st&&(r.clearDepth(st),Oe=st)},reset:function(){ce=!1,He=null,Te=null,Oe=null}}}function n(){let ce=!1,He=null,Te=null,Oe=null,st=null,xt=null,_t=null,Ht=null,zt=null;return{setTest:function(gt){ce||(gt?pe(r.STENCIL_TEST):de(r.STENCIL_TEST))},setMask:function(gt){He!==gt&&!ce&&(r.stencilMask(gt),He=gt)},setFunc:function(gt,Qt,vn){(Te!==gt||Oe!==Qt||st!==vn)&&(r.stencilFunc(gt,Qt,vn),Te=gt,Oe=Qt,st=vn)},setOp:function(gt,Qt,vn){(xt!==gt||_t!==Qt||Ht!==vn)&&(r.stencilOp(gt,Qt,vn),xt=gt,_t=Qt,Ht=vn)},setLocked:function(gt){ce=gt},setClear:function(gt){zt!==gt&&(r.clearStencil(gt),zt=gt)},reset:function(){ce=!1,He=null,Te=null,Oe=null,st=null,xt=null,_t=null,Ht=null,zt=null}}}const i=new e,s=new t,o=new n,a=new WeakMap,l=new WeakMap;let u={},c={},h=new WeakMap,d=[],m=null,g=!1,x=null,_=null,S=null,T=null,E=null,C=null,R=null,P=new yt(0,0,0),L=0,F=!1,D=null,I=null,N=null,V=null,q=null;const Q=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let re=!1,ee=0;const se=r.getParameter(r.VERSION);se.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(se)[1]),re=ee>=1):se.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(se)[1]),re=ee>=2);let W=null,$={};const j=r.getParameter(r.SCISSOR_BOX),U=r.getParameter(r.VIEWPORT),X=new gn().fromArray(j),le=new gn().fromArray(U);function Z(ce,He,Te,Oe){const st=new Uint8Array(4),xt=r.createTexture();r.bindTexture(ce,xt),r.texParameteri(ce,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(ce,r.TEXTURE_MAG_FILTER,r.NEAREST);for(let _t=0;_t<Te;_t++)ce===r.TEXTURE_3D||ce===r.TEXTURE_2D_ARRAY?r.texImage3D(He,0,r.RGBA,1,1,Oe,0,r.RGBA,r.UNSIGNED_BYTE,st):r.texImage2D(He+_t,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,st);return xt}const oe={};oe[r.TEXTURE_2D]=Z(r.TEXTURE_2D,r.TEXTURE_2D,1),oe[r.TEXTURE_CUBE_MAP]=Z(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),oe[r.TEXTURE_2D_ARRAY]=Z(r.TEXTURE_2D_ARRAY,r.TEXTURE_2D_ARRAY,1,1),oe[r.TEXTURE_3D]=Z(r.TEXTURE_3D,r.TEXTURE_3D,1,1),i.setClear(0,0,0,1),s.setClear(1),o.setClear(0),pe(r.DEPTH_TEST),s.setFunc(O0),Xe(!1),ve(ST),pe(r.CULL_FACE),Pe(Wu);function pe(ce){u[ce]!==!0&&(r.enable(ce),u[ce]=!0)}function de(ce){u[ce]!==!1&&(r.disable(ce),u[ce]=!1)}function ye(ce,He){return c[ce]!==He?(r.bindFramebuffer(ce,He),c[ce]=He,ce===r.DRAW_FRAMEBUFFER&&(c[r.FRAMEBUFFER]=He),ce===r.FRAMEBUFFER&&(c[r.DRAW_FRAMEBUFFER]=He),!0):!1}function Ge(ce,He){let Te=d,Oe=!1;if(ce){Te=h.get(He),Te===void 0&&(Te=[],h.set(He,Te));const st=ce.textures;if(Te.length!==st.length||Te[0]!==r.COLOR_ATTACHMENT0){for(let xt=0,_t=st.length;xt<_t;xt++)Te[xt]=r.COLOR_ATTACHMENT0+xt;Te.length=st.length,Oe=!0}}else Te[0]!==r.BACK&&(Te[0]=r.BACK,Oe=!0);Oe&&r.drawBuffers(Te)}function Ke(ce){return m!==ce?(r.useProgram(ce),m=ce,!0):!1}const De={[ih]:r.FUNC_ADD,[lB]:r.FUNC_SUBTRACT,[uB]:r.FUNC_REVERSE_SUBTRACT};De[cB]=r.MIN,De[hB]=r.MAX;const K={[fB]:r.ZERO,[dB]:r.ONE,[pB]:r.SRC_COLOR,[T_]:r.SRC_ALPHA,[_B]:r.SRC_ALPHA_SATURATE,[yB]:r.DST_COLOR,[gB]:r.DST_ALPHA,[mB]:r.ONE_MINUS_SRC_COLOR,[M_]:r.ONE_MINUS_SRC_ALPHA,[xB]:r.ONE_MINUS_DST_COLOR,[vB]:r.ONE_MINUS_DST_ALPHA,[SB]:r.CONSTANT_COLOR,[AB]:r.ONE_MINUS_CONSTANT_COLOR,[EB]:r.CONSTANT_ALPHA,[TB]:r.ONE_MINUS_CONSTANT_ALPHA};function Pe(ce,He,Te,Oe,st,xt,_t,Ht,zt,gt){if(ce===Wu){g===!0&&(de(r.BLEND),g=!1);return}if(g===!1&&(pe(r.BLEND),g=!0),ce!==aB){if(ce!==x||gt!==F){if((_!==ih||E!==ih)&&(r.blendEquation(r.FUNC_ADD),_=ih,E=ih),gt)switch(ce){case Nf:r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case AT:r.blendFunc(r.ONE,r.ONE);break;case ET:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case TT:r.blendFuncSeparate(r.ZERO,r.SRC_COLOR,r.ZERO,r.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}else switch(ce){case Nf:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case AT:r.blendFunc(r.SRC_ALPHA,r.ONE);break;case ET:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case TT:r.blendFunc(r.ZERO,r.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}S=null,T=null,C=null,R=null,P.set(0,0,0),L=0,x=ce,F=gt}return}st=st||He,xt=xt||Te,_t=_t||Oe,(He!==_||st!==E)&&(r.blendEquationSeparate(De[He],De[st]),_=He,E=st),(Te!==S||Oe!==T||xt!==C||_t!==R)&&(r.blendFuncSeparate(K[Te],K[Oe],K[xt],K[_t]),S=Te,T=Oe,C=xt,R=_t),(Ht.equals(P)===!1||zt!==L)&&(r.blendColor(Ht.r,Ht.g,Ht.b,zt),P.copy(Ht),L=zt),x=ce,F=!1}function Be(ce,He){ce.side===Lo?de(r.CULL_FACE):pe(r.CULL_FACE);let Te=ce.side===Ns;He&&(Te=!Te),Xe(Te),ce.blending===Nf&&ce.transparent===!1?Pe(Wu):Pe(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.blendColor,ce.blendAlpha,ce.premultipliedAlpha),s.setFunc(ce.depthFunc),s.setTest(ce.depthTest),s.setMask(ce.depthWrite),i.setMask(ce.colorWrite);const Oe=ce.stencilWrite;o.setTest(Oe),Oe&&(o.setMask(ce.stencilWriteMask),o.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),o.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),Ce(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),ce.alphaToCoverage===!0?pe(r.SAMPLE_ALPHA_TO_COVERAGE):de(r.SAMPLE_ALPHA_TO_COVERAGE)}function Xe(ce){D!==ce&&(ce?r.frontFace(r.CW):r.frontFace(r.CCW),D=ce)}function ve(ce){ce!==rB?(pe(r.CULL_FACE),ce!==I&&(ce===ST?r.cullFace(r.BACK):ce===sB?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):de(r.CULL_FACE),I=ce}function et(ce){ce!==N&&(re&&r.lineWidth(ce),N=ce)}function Ce(ce,He,Te){ce?(pe(r.POLYGON_OFFSET_FILL),(V!==He||q!==Te)&&(r.polygonOffset(He,Te),V=He,q=Te)):de(r.POLYGON_OFFSET_FILL)}function We(ce){ce?pe(r.SCISSOR_TEST):de(r.SCISSOR_TEST)}function te(ce){ce===void 0&&(ce=r.TEXTURE0+Q-1),W!==ce&&(r.activeTexture(ce),W=ce)}function z(ce,He,Te){Te===void 0&&(W===null?Te=r.TEXTURE0+Q-1:Te=W);let Oe=$[Te];Oe===void 0&&(Oe={type:void 0,texture:void 0},$[Te]=Oe),(Oe.type!==ce||Oe.texture!==He)&&(W!==Te&&(r.activeTexture(Te),W=Te),r.bindTexture(ce,He||oe[ce]),Oe.type=ce,Oe.texture=He)}function me(){const ce=$[W];ce!==void 0&&ce.type!==void 0&&(r.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)}function _e(){try{r.compressedTexImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ee(){try{r.compressedTexImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function we(){try{r.texSubImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ut(){try{r.texSubImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ke(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ze(){try{r.compressedTexSubImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function lt(){try{r.texStorage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ye(){try{r.texStorage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function nt(){try{r.texImage2D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ct(){try{r.texImage3D.apply(r,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ht(ce){X.equals(ce)===!1&&(r.scissor(ce.x,ce.y,ce.z,ce.w),X.copy(ce))}function it(ce){le.equals(ce)===!1&&(r.viewport(ce.x,ce.y,ce.z,ce.w),le.copy(ce))}function rt(ce,He){let Te=l.get(He);Te===void 0&&(Te=new WeakMap,l.set(He,Te));let Oe=Te.get(ce);Oe===void 0&&(Oe=r.getUniformBlockIndex(He,ce.name),Te.set(ce,Oe))}function fe(ce,He){const Oe=l.get(He).get(ce);a.get(He)!==Oe&&(r.uniformBlockBinding(He,Oe,ce.__bindingPointIndex),a.set(He,Oe))}function Je(){r.disable(r.BLEND),r.disable(r.CULL_FACE),r.disable(r.DEPTH_TEST),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SCISSOR_TEST),r.disable(r.STENCIL_TEST),r.disable(r.SAMPLE_ALPHA_TO_COVERAGE),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO),r.blendFuncSeparate(r.ONE,r.ZERO,r.ONE,r.ZERO),r.blendColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(r.LESS),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(r.ALWAYS,0,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),r.clearStencil(0),r.cullFace(r.BACK),r.frontFace(r.CCW),r.polygonOffset(0,0),r.activeTexture(r.TEXTURE0),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),u={},W=null,$={},c={},h=new WeakMap,d=[],m=null,g=!1,x=null,_=null,S=null,T=null,E=null,C=null,R=null,P=new yt(0,0,0),L=0,F=!1,D=null,I=null,N=null,V=null,q=null,X.set(0,0,r.canvas.width,r.canvas.height),le.set(0,0,r.canvas.width,r.canvas.height),i.reset(),s.reset(),o.reset()}return{buffers:{color:i,depth:s,stencil:o},enable:pe,disable:de,bindFramebuffer:ye,drawBuffers:Ge,useProgram:Ke,setBlending:Pe,setMaterial:Be,setFlipSided:Xe,setCullFace:ve,setLineWidth:et,setPolygonOffset:Ce,setScissorTest:We,activeTexture:te,bindTexture:z,unbindTexture:me,compressedTexImage2D:_e,compressedTexImage3D:Ee,texImage2D:nt,texImage3D:Ct,updateUBOMapping:rt,uniformBlockBinding:fe,texStorage2D:lt,texStorage3D:Ye,texSubImage2D:we,texSubImage3D:ut,compressedTexSubImage2D:ke,compressedTexSubImage3D:Ze,scissor:ht,viewport:it,reset:Je}}function s6(r,e){const t=r.image&&r.image.width?r.image.width/r.image.height:1;return t>e?(r.repeat.x=1,r.repeat.y=t/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2):(r.repeat.x=e/t,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0),r}function o6(r,e){const t=r.image&&r.image.width?r.image.width/r.image.height:1;return t>e?(r.repeat.x=e/t,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0):(r.repeat.x=1,r.repeat.y=t/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2),r}function a6(r){return r.repeat.x=1,r.repeat.y=1,r.offset.x=0,r.offset.y=0,r}function IT(r,e,t,n){const i=l6(n);switch(t){case QM:return r*e;case ew:return r*e;case tw:return r*e*2;case HS:return r*e/i.components*i.byteLength;case yv:return r*e/i.components*i.byteLength;case nw:return r*e*2/i.components*i.byteLength;case zS:return r*e*2/i.components*i.byteLength;case ZM:return r*e*3/i.components*i.byteLength;case ms:return r*e*4/i.components*i.byteLength;case VS:return r*e*4/i.components*i.byteLength;case d0:case p0:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case m0:case g0:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case C_:case R_:return Math.max(r,16)*Math.max(e,8)/4;case w_:case b_:return Math.max(r,8)*Math.max(e,8)/2;case I_:case L_:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case P_:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case D_:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case B_:return Math.floor((r+4)/5)*Math.floor((e+3)/4)*16;case F_:return Math.floor((r+4)/5)*Math.floor((e+4)/5)*16;case k_:return Math.floor((r+5)/6)*Math.floor((e+4)/5)*16;case O_:return Math.floor((r+5)/6)*Math.floor((e+5)/6)*16;case U_:return Math.floor((r+7)/8)*Math.floor((e+4)/5)*16;case N_:return Math.floor((r+7)/8)*Math.floor((e+5)/6)*16;case G_:return Math.floor((r+7)/8)*Math.floor((e+7)/8)*16;case H_:return Math.floor((r+9)/10)*Math.floor((e+4)/5)*16;case z_:return Math.floor((r+9)/10)*Math.floor((e+5)/6)*16;case V_:return Math.floor((r+9)/10)*Math.floor((e+7)/8)*16;case W_:return Math.floor((r+9)/10)*Math.floor((e+9)/10)*16;case j_:return Math.floor((r+11)/12)*Math.floor((e+9)/10)*16;case K_:return Math.floor((r+11)/12)*Math.floor((e+11)/12)*16;case v0:case $_:case X_:return Math.ceil(r/4)*Math.ceil(e/4)*16;case iw:case Y_:return Math.ceil(r/4)*Math.ceil(e/4)*8;case J_:case q_:return Math.ceil(r/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function l6(r){switch(r){case Za:case YM:return{byteLength:1,components:1};case lm:case JM:case Im:return{byteLength:2,components:1};case NS:case GS:return{byteLength:2,components:4};case Ju:case US:case ro:return{byteLength:4,components:1};case qM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${r}.`)}const u6={contain:s6,cover:o6,fill:a6,getByteLength:IT};function c6(r,e,t,n,i,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Qe,c=new WeakMap;let h;const d=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(te,z){return m?new OffscreenCanvas(te,z):K0("canvas")}function x(te,z,me){let _e=1;const Ee=We(te);if((Ee.width>me||Ee.height>me)&&(_e=me/Math.max(Ee.width,Ee.height)),_e<1)if(typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&te instanceof ImageBitmap||typeof VideoFrame<"u"&&te instanceof VideoFrame){const we=Math.floor(_e*Ee.width),ut=Math.floor(_e*Ee.height);h===void 0&&(h=g(we,ut));const ke=z?g(we,ut):h;return ke.width=we,ke.height=ut,ke.getContext("2d").drawImage(te,0,0,we,ut),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ee.width+"x"+Ee.height+") to ("+we+"x"+ut+")."),ke}else return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ee.width+"x"+Ee.height+")."),te;return te}function _(te){return te.generateMipmaps&&te.minFilter!==Er&&te.minFilter!==vi}function S(te){r.generateMipmap(te)}function T(te,z,me,_e,Ee=!1){if(te!==null){if(r[te]!==void 0)return r[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let we=z;if(z===r.RED&&(me===r.FLOAT&&(we=r.R32F),me===r.HALF_FLOAT&&(we=r.R16F),me===r.UNSIGNED_BYTE&&(we=r.R8)),z===r.RED_INTEGER&&(me===r.UNSIGNED_BYTE&&(we=r.R8UI),me===r.UNSIGNED_SHORT&&(we=r.R16UI),me===r.UNSIGNED_INT&&(we=r.R32UI),me===r.BYTE&&(we=r.R8I),me===r.SHORT&&(we=r.R16I),me===r.INT&&(we=r.R32I)),z===r.RG&&(me===r.FLOAT&&(we=r.RG32F),me===r.HALF_FLOAT&&(we=r.RG16F),me===r.UNSIGNED_BYTE&&(we=r.RG8)),z===r.RG_INTEGER&&(me===r.UNSIGNED_BYTE&&(we=r.RG8UI),me===r.UNSIGNED_SHORT&&(we=r.RG16UI),me===r.UNSIGNED_INT&&(we=r.RG32UI),me===r.BYTE&&(we=r.RG8I),me===r.SHORT&&(we=r.RG16I),me===r.INT&&(we=r.RG32I)),z===r.RGB&&me===r.UNSIGNED_INT_5_9_9_9_REV&&(we=r.RGB9_E5),z===r.RGBA){const ut=Ee?H0:On.getTransfer(_e);me===r.FLOAT&&(we=r.RGBA32F),me===r.HALF_FLOAT&&(we=r.RGBA16F),me===r.UNSIGNED_BYTE&&(we=ut===ri?r.SRGB8_ALPHA8:r.RGBA8),me===r.UNSIGNED_SHORT_4_4_4_4&&(we=r.RGBA4),me===r.UNSIGNED_SHORT_5_5_5_1&&(we=r.RGB5_A1)}return(we===r.R16F||we===r.R32F||we===r.RG16F||we===r.RG32F||we===r.RGBA16F||we===r.RGBA32F)&&e.get("EXT_color_buffer_float"),we}function E(te,z){let me;return te?z===null||z===Ju||z===Zf?me=r.DEPTH24_STENCIL8:z===ro?me=r.DEPTH32F_STENCIL8:z===lm&&(me=r.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):z===null||z===Ju||z===Zf?me=r.DEPTH_COMPONENT24:z===ro?me=r.DEPTH_COMPONENT32F:z===lm&&(me=r.DEPTH_COMPONENT16),me}function C(te,z){return _(te)===!0||te.isFramebufferTexture&&te.minFilter!==Er&&te.minFilter!==vi?Math.log2(Math.max(z.width,z.height))+1:te.mipmaps!==void 0&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?z.mipmaps.length:1}function R(te){const z=te.target;z.removeEventListener("dispose",R),L(z),z.isVideoTexture&&c.delete(z)}function P(te){const z=te.target;z.removeEventListener("dispose",P),D(z)}function L(te){const z=n.get(te);if(z.__webglInit===void 0)return;const me=te.source,_e=d.get(me);if(_e){const Ee=_e[z.__cacheKey];Ee.usedTimes--,Ee.usedTimes===0&&F(te),Object.keys(_e).length===0&&d.delete(me)}n.remove(te)}function F(te){const z=n.get(te);r.deleteTexture(z.__webglTexture);const me=te.source,_e=d.get(me);delete _e[z.__cacheKey],o.memory.textures--}function D(te){const z=n.get(te);if(te.depthTexture&&te.depthTexture.dispose(),te.isWebGLCubeRenderTarget)for(let _e=0;_e<6;_e++){if(Array.isArray(z.__webglFramebuffer[_e]))for(let Ee=0;Ee<z.__webglFramebuffer[_e].length;Ee++)r.deleteFramebuffer(z.__webglFramebuffer[_e][Ee]);else r.deleteFramebuffer(z.__webglFramebuffer[_e]);z.__webglDepthbuffer&&r.deleteRenderbuffer(z.__webglDepthbuffer[_e])}else{if(Array.isArray(z.__webglFramebuffer))for(let _e=0;_e<z.__webglFramebuffer.length;_e++)r.deleteFramebuffer(z.__webglFramebuffer[_e]);else r.deleteFramebuffer(z.__webglFramebuffer);if(z.__webglDepthbuffer&&r.deleteRenderbuffer(z.__webglDepthbuffer),z.__webglMultisampledFramebuffer&&r.deleteFramebuffer(z.__webglMultisampledFramebuffer),z.__webglColorRenderbuffer)for(let _e=0;_e<z.__webglColorRenderbuffer.length;_e++)z.__webglColorRenderbuffer[_e]&&r.deleteRenderbuffer(z.__webglColorRenderbuffer[_e]);z.__webglDepthRenderbuffer&&r.deleteRenderbuffer(z.__webglDepthRenderbuffer)}const me=te.textures;for(let _e=0,Ee=me.length;_e<Ee;_e++){const we=n.get(me[_e]);we.__webglTexture&&(r.deleteTexture(we.__webglTexture),o.memory.textures--),n.remove(me[_e])}n.remove(te)}let I=0;function N(){I=0}function V(){const te=I;return te>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+i.maxTextures),I+=1,te}function q(te){const z=[];return z.push(te.wrapS),z.push(te.wrapT),z.push(te.wrapR||0),z.push(te.magFilter),z.push(te.minFilter),z.push(te.anisotropy),z.push(te.internalFormat),z.push(te.format),z.push(te.type),z.push(te.generateMipmaps),z.push(te.premultiplyAlpha),z.push(te.flipY),z.push(te.unpackAlignment),z.push(te.colorSpace),z.join()}function Q(te,z){const me=n.get(te);if(te.isVideoTexture&&et(te),te.isRenderTargetTexture===!1&&te.version>0&&me.__version!==te.version){const _e=te.image;if(_e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(_e.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(me,te,z);return}}t.bindTexture(r.TEXTURE_2D,me.__webglTexture,r.TEXTURE0+z)}function re(te,z){const me=n.get(te);if(te.version>0&&me.__version!==te.version){le(me,te,z);return}t.bindTexture(r.TEXTURE_2D_ARRAY,me.__webglTexture,r.TEXTURE0+z)}function ee(te,z){const me=n.get(te);if(te.version>0&&me.__version!==te.version){le(me,te,z);return}t.bindTexture(r.TEXTURE_3D,me.__webglTexture,r.TEXTURE0+z)}function se(te,z){const me=n.get(te);if(te.version>0&&me.__version!==te.version){Z(me,te,z);return}t.bindTexture(r.TEXTURE_CUBE_MAP,me.__webglTexture,r.TEXTURE0+z)}const W={[hh]:r.REPEAT,[Bo]:r.CLAMP_TO_EDGE,[am]:r.MIRRORED_REPEAT},$={[Er]:r.NEAREST,[OS]:r.NEAREST_MIPMAP_NEAREST,[If]:r.NEAREST_MIPMAP_LINEAR,[vi]:r.LINEAR,[qp]:r.LINEAR_MIPMAP_NEAREST,[da]:r.LINEAR_MIPMAP_LINEAR},j={[$B]:r.NEVER,[ZB]:r.ALWAYS,[XB]:r.LESS,[aw]:r.LEQUAL,[YB]:r.EQUAL,[QB]:r.GEQUAL,[JB]:r.GREATER,[qB]:r.NOTEQUAL};function U(te,z){if(z.type===ro&&e.has("OES_texture_float_linear")===!1&&(z.magFilter===vi||z.magFilter===qp||z.magFilter===If||z.magFilter===da||z.minFilter===vi||z.minFilter===qp||z.minFilter===If||z.minFilter===da)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),r.texParameteri(te,r.TEXTURE_WRAP_S,W[z.wrapS]),r.texParameteri(te,r.TEXTURE_WRAP_T,W[z.wrapT]),(te===r.TEXTURE_3D||te===r.TEXTURE_2D_ARRAY)&&r.texParameteri(te,r.TEXTURE_WRAP_R,W[z.wrapR]),r.texParameteri(te,r.TEXTURE_MAG_FILTER,$[z.magFilter]),r.texParameteri(te,r.TEXTURE_MIN_FILTER,$[z.minFilter]),z.compareFunction&&(r.texParameteri(te,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(te,r.TEXTURE_COMPARE_FUNC,j[z.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(z.magFilter===Er||z.minFilter!==If&&z.minFilter!==da||z.type===ro&&e.has("OES_texture_float_linear")===!1)return;if(z.anisotropy>1||n.get(z).__currentAnisotropy){const me=e.get("EXT_texture_filter_anisotropic");r.texParameterf(te,me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,i.getMaxAnisotropy())),n.get(z).__currentAnisotropy=z.anisotropy}}}function X(te,z){let me=!1;te.__webglInit===void 0&&(te.__webglInit=!0,z.addEventListener("dispose",R));const _e=z.source;let Ee=d.get(_e);Ee===void 0&&(Ee={},d.set(_e,Ee));const we=q(z);if(we!==te.__cacheKey){Ee[we]===void 0&&(Ee[we]={texture:r.createTexture(),usedTimes:0},o.memory.textures++,me=!0),Ee[we].usedTimes++;const ut=Ee[te.__cacheKey];ut!==void 0&&(Ee[te.__cacheKey].usedTimes--,ut.usedTimes===0&&F(z)),te.__cacheKey=we,te.__webglTexture=Ee[we].texture}return me}function le(te,z,me){let _e=r.TEXTURE_2D;(z.isDataArrayTexture||z.isCompressedArrayTexture)&&(_e=r.TEXTURE_2D_ARRAY),z.isData3DTexture&&(_e=r.TEXTURE_3D);const Ee=X(te,z),we=z.source;t.bindTexture(_e,te.__webglTexture,r.TEXTURE0+me);const ut=n.get(we);if(we.version!==ut.__version||Ee===!0){t.activeTexture(r.TEXTURE0+me);const ke=On.getPrimaries(On.workingColorSpace),Ze=z.colorSpace===Ou?null:On.getPrimaries(z.colorSpace),lt=z.colorSpace===Ou||ke===Ze?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,z.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,z.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,lt);let Ye=x(z.image,!1,i.maxTextureSize);Ye=Ce(z,Ye);const nt=s.convert(z.format,z.colorSpace),Ct=s.convert(z.type);let ht=T(z.internalFormat,nt,Ct,z.colorSpace,z.isVideoTexture);U(_e,z);let it;const rt=z.mipmaps,fe=z.isVideoTexture!==!0,Je=ut.__version===void 0||Ee===!0,ce=we.dataReady,He=C(z,Ye);if(z.isDepthTexture)ht=E(z.format===ed,z.type),Je&&(fe?t.texStorage2D(r.TEXTURE_2D,1,ht,Ye.width,Ye.height):t.texImage2D(r.TEXTURE_2D,0,ht,Ye.width,Ye.height,0,nt,Ct,null));else if(z.isDataTexture)if(rt.length>0){fe&&Je&&t.texStorage2D(r.TEXTURE_2D,He,ht,rt[0].width,rt[0].height);for(let Te=0,Oe=rt.length;Te<Oe;Te++)it=rt[Te],fe?ce&&t.texSubImage2D(r.TEXTURE_2D,Te,0,0,it.width,it.height,nt,Ct,it.data):t.texImage2D(r.TEXTURE_2D,Te,ht,it.width,it.height,0,nt,Ct,it.data);z.generateMipmaps=!1}else fe?(Je&&t.texStorage2D(r.TEXTURE_2D,He,ht,Ye.width,Ye.height),ce&&t.texSubImage2D(r.TEXTURE_2D,0,0,0,Ye.width,Ye.height,nt,Ct,Ye.data)):t.texImage2D(r.TEXTURE_2D,0,ht,Ye.width,Ye.height,0,nt,Ct,Ye.data);else if(z.isCompressedTexture)if(z.isCompressedArrayTexture){fe&&Je&&t.texStorage3D(r.TEXTURE_2D_ARRAY,He,ht,rt[0].width,rt[0].height,Ye.depth);for(let Te=0,Oe=rt.length;Te<Oe;Te++)if(it=rt[Te],z.format!==ms)if(nt!==null)if(fe){if(ce)if(z.layerUpdates.size>0){const st=IT(it.width,it.height,z.format,z.type);for(const xt of z.layerUpdates){const _t=it.data.subarray(xt*st/it.data.BYTES_PER_ELEMENT,(xt+1)*st/it.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Te,0,0,xt,it.width,it.height,1,nt,_t,0,0)}z.clearLayerUpdates()}else t.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Te,0,0,0,it.width,it.height,Ye.depth,nt,it.data,0,0)}else t.compressedTexImage3D(r.TEXTURE_2D_ARRAY,Te,ht,it.width,it.height,Ye.depth,0,it.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else fe?ce&&t.texSubImage3D(r.TEXTURE_2D_ARRAY,Te,0,0,0,it.width,it.height,Ye.depth,nt,Ct,it.data):t.texImage3D(r.TEXTURE_2D_ARRAY,Te,ht,it.width,it.height,Ye.depth,0,nt,Ct,it.data)}else{fe&&Je&&t.texStorage2D(r.TEXTURE_2D,He,ht,rt[0].width,rt[0].height);for(let Te=0,Oe=rt.length;Te<Oe;Te++)it=rt[Te],z.format!==ms?nt!==null?fe?ce&&t.compressedTexSubImage2D(r.TEXTURE_2D,Te,0,0,it.width,it.height,nt,it.data):t.compressedTexImage2D(r.TEXTURE_2D,Te,ht,it.width,it.height,0,it.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):fe?ce&&t.texSubImage2D(r.TEXTURE_2D,Te,0,0,it.width,it.height,nt,Ct,it.data):t.texImage2D(r.TEXTURE_2D,Te,ht,it.width,it.height,0,nt,Ct,it.data)}else if(z.isDataArrayTexture)if(fe){if(Je&&t.texStorage3D(r.TEXTURE_2D_ARRAY,He,ht,Ye.width,Ye.height,Ye.depth),ce)if(z.layerUpdates.size>0){const Te=IT(Ye.width,Ye.height,z.format,z.type);for(const Oe of z.layerUpdates){const st=Ye.data.subarray(Oe*Te/Ye.data.BYTES_PER_ELEMENT,(Oe+1)*Te/Ye.data.BYTES_PER_ELEMENT);t.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,Oe,Ye.width,Ye.height,1,nt,Ct,st)}z.clearLayerUpdates()}else t.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,Ye.width,Ye.height,Ye.depth,nt,Ct,Ye.data)}else t.texImage3D(r.TEXTURE_2D_ARRAY,0,ht,Ye.width,Ye.height,Ye.depth,0,nt,Ct,Ye.data);else if(z.isData3DTexture)fe?(Je&&t.texStorage3D(r.TEXTURE_3D,He,ht,Ye.width,Ye.height,Ye.depth),ce&&t.texSubImage3D(r.TEXTURE_3D,0,0,0,0,Ye.width,Ye.height,Ye.depth,nt,Ct,Ye.data)):t.texImage3D(r.TEXTURE_3D,0,ht,Ye.width,Ye.height,Ye.depth,0,nt,Ct,Ye.data);else if(z.isFramebufferTexture){if(Je)if(fe)t.texStorage2D(r.TEXTURE_2D,He,ht,Ye.width,Ye.height);else{let Te=Ye.width,Oe=Ye.height;for(let st=0;st<He;st++)t.texImage2D(r.TEXTURE_2D,st,ht,Te,Oe,0,nt,Ct,null),Te>>=1,Oe>>=1}}else if(rt.length>0){if(fe&&Je){const Te=We(rt[0]);t.texStorage2D(r.TEXTURE_2D,He,ht,Te.width,Te.height)}for(let Te=0,Oe=rt.length;Te<Oe;Te++)it=rt[Te],fe?ce&&t.texSubImage2D(r.TEXTURE_2D,Te,0,0,nt,Ct,it):t.texImage2D(r.TEXTURE_2D,Te,ht,nt,Ct,it);z.generateMipmaps=!1}else if(fe){if(Je){const Te=We(Ye);t.texStorage2D(r.TEXTURE_2D,He,ht,Te.width,Te.height)}ce&&t.texSubImage2D(r.TEXTURE_2D,0,0,0,nt,Ct,Ye)}else t.texImage2D(r.TEXTURE_2D,0,ht,nt,Ct,Ye);_(z)&&S(_e),ut.__version=we.version,z.onUpdate&&z.onUpdate(z)}te.__version=z.version}function Z(te,z,me){if(z.image.length!==6)return;const _e=X(te,z),Ee=z.source;t.bindTexture(r.TEXTURE_CUBE_MAP,te.__webglTexture,r.TEXTURE0+me);const we=n.get(Ee);if(Ee.version!==we.__version||_e===!0){t.activeTexture(r.TEXTURE0+me);const ut=On.getPrimaries(On.workingColorSpace),ke=z.colorSpace===Ou?null:On.getPrimaries(z.colorSpace),Ze=z.colorSpace===Ou||ut===ke?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,z.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,z.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ze);const lt=z.isCompressedTexture||z.image[0].isCompressedTexture,Ye=z.image[0]&&z.image[0].isDataTexture,nt=[];for(let Oe=0;Oe<6;Oe++)!lt&&!Ye?nt[Oe]=x(z.image[Oe],!0,i.maxCubemapSize):nt[Oe]=Ye?z.image[Oe].image:z.image[Oe],nt[Oe]=Ce(z,nt[Oe]);const Ct=nt[0],ht=s.convert(z.format,z.colorSpace),it=s.convert(z.type),rt=T(z.internalFormat,ht,it,z.colorSpace),fe=z.isVideoTexture!==!0,Je=we.__version===void 0||_e===!0,ce=Ee.dataReady;let He=C(z,Ct);U(r.TEXTURE_CUBE_MAP,z);let Te;if(lt){fe&&Je&&t.texStorage2D(r.TEXTURE_CUBE_MAP,He,rt,Ct.width,Ct.height);for(let Oe=0;Oe<6;Oe++){Te=nt[Oe].mipmaps;for(let st=0;st<Te.length;st++){const xt=Te[st];z.format!==ms?ht!==null?fe?ce&&t.compressedTexSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st,0,0,xt.width,xt.height,ht,xt.data):t.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st,rt,xt.width,xt.height,0,xt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):fe?ce&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st,0,0,xt.width,xt.height,ht,it,xt.data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st,rt,xt.width,xt.height,0,ht,it,xt.data)}}}else{if(Te=z.mipmaps,fe&&Je){Te.length>0&&He++;const Oe=We(nt[0]);t.texStorage2D(r.TEXTURE_CUBE_MAP,He,rt,Oe.width,Oe.height)}for(let Oe=0;Oe<6;Oe++)if(Ye){fe?ce&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,0,0,nt[Oe].width,nt[Oe].height,ht,it,nt[Oe].data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,rt,nt[Oe].width,nt[Oe].height,0,ht,it,nt[Oe].data);for(let st=0;st<Te.length;st++){const _t=Te[st].image[Oe].image;fe?ce&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st+1,0,0,_t.width,_t.height,ht,it,_t.data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st+1,rt,_t.width,_t.height,0,ht,it,_t.data)}}else{fe?ce&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,0,0,ht,it,nt[Oe]):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,rt,ht,it,nt[Oe]);for(let st=0;st<Te.length;st++){const xt=Te[st];fe?ce&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st+1,0,0,ht,it,xt.image[Oe]):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,st+1,rt,ht,it,xt.image[Oe])}}}_(z)&&S(r.TEXTURE_CUBE_MAP),we.__version=Ee.version,z.onUpdate&&z.onUpdate(z)}te.__version=z.version}function oe(te,z,me,_e,Ee,we){const ut=s.convert(me.format,me.colorSpace),ke=s.convert(me.type),Ze=T(me.internalFormat,ut,ke,me.colorSpace);if(!n.get(z).__hasExternalTextures){const Ye=Math.max(1,z.width>>we),nt=Math.max(1,z.height>>we);Ee===r.TEXTURE_3D||Ee===r.TEXTURE_2D_ARRAY?t.texImage3D(Ee,we,Ze,Ye,nt,z.depth,0,ut,ke,null):t.texImage2D(Ee,we,Ze,Ye,nt,0,ut,ke,null)}t.bindFramebuffer(r.FRAMEBUFFER,te),ve(z)?a.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,_e,Ee,n.get(me).__webglTexture,0,Xe(z)):(Ee===r.TEXTURE_2D||Ee>=r.TEXTURE_CUBE_MAP_POSITIVE_X&&Ee<=r.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&r.framebufferTexture2D(r.FRAMEBUFFER,_e,Ee,n.get(me).__webglTexture,we),t.bindFramebuffer(r.FRAMEBUFFER,null)}function pe(te,z,me){if(r.bindRenderbuffer(r.RENDERBUFFER,te),z.depthBuffer){const _e=z.depthTexture,Ee=_e&&_e.isDepthTexture?_e.type:null,we=E(z.stencilBuffer,Ee),ut=z.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,ke=Xe(z);ve(z)?a.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,ke,we,z.width,z.height):me?r.renderbufferStorageMultisample(r.RENDERBUFFER,ke,we,z.width,z.height):r.renderbufferStorage(r.RENDERBUFFER,we,z.width,z.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,ut,r.RENDERBUFFER,te)}else{const _e=z.textures;for(let Ee=0;Ee<_e.length;Ee++){const we=_e[Ee],ut=s.convert(we.format,we.colorSpace),ke=s.convert(we.type),Ze=T(we.internalFormat,ut,ke,we.colorSpace),lt=Xe(z);me&&ve(z)===!1?r.renderbufferStorageMultisample(r.RENDERBUFFER,lt,Ze,z.width,z.height):ve(z)?a.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,lt,Ze,z.width,z.height):r.renderbufferStorage(r.RENDERBUFFER,Ze,z.width,z.height)}}r.bindRenderbuffer(r.RENDERBUFFER,null)}function de(te,z){if(z&&z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(r.FRAMEBUFFER,te),!(z.depthTexture&&z.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(z.depthTexture).__webglTexture||z.depthTexture.image.width!==z.width||z.depthTexture.image.height!==z.height)&&(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=!0),Q(z.depthTexture,0);const _e=n.get(z.depthTexture).__webglTexture,Ee=Xe(z);if(z.depthTexture.format===Gf)ve(z)?a.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,_e,0,Ee):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,_e,0);else if(z.depthTexture.format===ed)ve(z)?a.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,_e,0,Ee):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,_e,0);else throw new Error("Unknown depthTexture format")}function ye(te){const z=n.get(te),me=te.isWebGLCubeRenderTarget===!0;if(te.depthTexture&&!z.__autoAllocateDepthBuffer){if(me)throw new Error("target.depthTexture not supported in Cube render targets");de(z.__webglFramebuffer,te)}else if(me){z.__webglDepthbuffer=[];for(let _e=0;_e<6;_e++)t.bindFramebuffer(r.FRAMEBUFFER,z.__webglFramebuffer[_e]),z.__webglDepthbuffer[_e]=r.createRenderbuffer(),pe(z.__webglDepthbuffer[_e],te,!1)}else t.bindFramebuffer(r.FRAMEBUFFER,z.__webglFramebuffer),z.__webglDepthbuffer=r.createRenderbuffer(),pe(z.__webglDepthbuffer,te,!1);t.bindFramebuffer(r.FRAMEBUFFER,null)}function Ge(te,z,me){const _e=n.get(te);z!==void 0&&oe(_e.__webglFramebuffer,te,te.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,0),me!==void 0&&ye(te)}function Ke(te){const z=te.texture,me=n.get(te),_e=n.get(z);te.addEventListener("dispose",P);const Ee=te.textures,we=te.isWebGLCubeRenderTarget===!0,ut=Ee.length>1;if(ut||(_e.__webglTexture===void 0&&(_e.__webglTexture=r.createTexture()),_e.__version=z.version,o.memory.textures++),we){me.__webglFramebuffer=[];for(let ke=0;ke<6;ke++)if(z.mipmaps&&z.mipmaps.length>0){me.__webglFramebuffer[ke]=[];for(let Ze=0;Ze<z.mipmaps.length;Ze++)me.__webglFramebuffer[ke][Ze]=r.createFramebuffer()}else me.__webglFramebuffer[ke]=r.createFramebuffer()}else{if(z.mipmaps&&z.mipmaps.length>0){me.__webglFramebuffer=[];for(let ke=0;ke<z.mipmaps.length;ke++)me.__webglFramebuffer[ke]=r.createFramebuffer()}else me.__webglFramebuffer=r.createFramebuffer();if(ut)for(let ke=0,Ze=Ee.length;ke<Ze;ke++){const lt=n.get(Ee[ke]);lt.__webglTexture===void 0&&(lt.__webglTexture=r.createTexture(),o.memory.textures++)}if(te.samples>0&&ve(te)===!1){me.__webglMultisampledFramebuffer=r.createFramebuffer(),me.__webglColorRenderbuffer=[],t.bindFramebuffer(r.FRAMEBUFFER,me.__webglMultisampledFramebuffer);for(let ke=0;ke<Ee.length;ke++){const Ze=Ee[ke];me.__webglColorRenderbuffer[ke]=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,me.__webglColorRenderbuffer[ke]);const lt=s.convert(Ze.format,Ze.colorSpace),Ye=s.convert(Ze.type),nt=T(Ze.internalFormat,lt,Ye,Ze.colorSpace,te.isXRRenderTarget===!0),Ct=Xe(te);r.renderbufferStorageMultisample(r.RENDERBUFFER,Ct,nt,te.width,te.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+ke,r.RENDERBUFFER,me.__webglColorRenderbuffer[ke])}r.bindRenderbuffer(r.RENDERBUFFER,null),te.depthBuffer&&(me.__webglDepthRenderbuffer=r.createRenderbuffer(),pe(me.__webglDepthRenderbuffer,te,!0)),t.bindFramebuffer(r.FRAMEBUFFER,null)}}if(we){t.bindTexture(r.TEXTURE_CUBE_MAP,_e.__webglTexture),U(r.TEXTURE_CUBE_MAP,z);for(let ke=0;ke<6;ke++)if(z.mipmaps&&z.mipmaps.length>0)for(let Ze=0;Ze<z.mipmaps.length;Ze++)oe(me.__webglFramebuffer[ke][Ze],te,z,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+ke,Ze);else oe(me.__webglFramebuffer[ke],te,z,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0);_(z)&&S(r.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ut){for(let ke=0,Ze=Ee.length;ke<Ze;ke++){const lt=Ee[ke],Ye=n.get(lt);t.bindTexture(r.TEXTURE_2D,Ye.__webglTexture),U(r.TEXTURE_2D,lt),oe(me.__webglFramebuffer,te,lt,r.COLOR_ATTACHMENT0+ke,r.TEXTURE_2D,0),_(lt)&&S(r.TEXTURE_2D)}t.unbindTexture()}else{let ke=r.TEXTURE_2D;if((te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(ke=te.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),t.bindTexture(ke,_e.__webglTexture),U(ke,z),z.mipmaps&&z.mipmaps.length>0)for(let Ze=0;Ze<z.mipmaps.length;Ze++)oe(me.__webglFramebuffer[Ze],te,z,r.COLOR_ATTACHMENT0,ke,Ze);else oe(me.__webglFramebuffer,te,z,r.COLOR_ATTACHMENT0,ke,0);_(z)&&S(ke),t.unbindTexture()}te.depthBuffer&&ye(te)}function De(te){const z=te.textures;for(let me=0,_e=z.length;me<_e;me++){const Ee=z[me];if(_(Ee)){const we=te.isWebGLCubeRenderTarget?r.TEXTURE_CUBE_MAP:r.TEXTURE_2D,ut=n.get(Ee).__webglTexture;t.bindTexture(we,ut),S(we),t.unbindTexture()}}}const K=[],Pe=[];function Be(te){if(te.samples>0){if(ve(te)===!1){const z=te.textures,me=te.width,_e=te.height;let Ee=r.COLOR_BUFFER_BIT;const we=te.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,ut=n.get(te),ke=z.length>1;if(ke)for(let Ze=0;Ze<z.length;Ze++)t.bindFramebuffer(r.FRAMEBUFFER,ut.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+Ze,r.RENDERBUFFER,null),t.bindFramebuffer(r.FRAMEBUFFER,ut.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+Ze,r.TEXTURE_2D,null,0);t.bindFramebuffer(r.READ_FRAMEBUFFER,ut.__webglMultisampledFramebuffer),t.bindFramebuffer(r.DRAW_FRAMEBUFFER,ut.__webglFramebuffer);for(let Ze=0;Ze<z.length;Ze++){if(te.resolveDepthBuffer&&(te.depthBuffer&&(Ee|=r.DEPTH_BUFFER_BIT),te.stencilBuffer&&te.resolveStencilBuffer&&(Ee|=r.STENCIL_BUFFER_BIT)),ke){r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,ut.__webglColorRenderbuffer[Ze]);const lt=n.get(z[Ze]).__webglTexture;r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,lt,0)}r.blitFramebuffer(0,0,me,_e,0,0,me,_e,Ee,r.NEAREST),l===!0&&(K.length=0,Pe.length=0,K.push(r.COLOR_ATTACHMENT0+Ze),te.depthBuffer&&te.resolveDepthBuffer===!1&&(K.push(we),Pe.push(we),r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,Pe)),r.invalidateFramebuffer(r.READ_FRAMEBUFFER,K))}if(t.bindFramebuffer(r.READ_FRAMEBUFFER,null),t.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),ke)for(let Ze=0;Ze<z.length;Ze++){t.bindFramebuffer(r.FRAMEBUFFER,ut.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+Ze,r.RENDERBUFFER,ut.__webglColorRenderbuffer[Ze]);const lt=n.get(z[Ze]).__webglTexture;t.bindFramebuffer(r.FRAMEBUFFER,ut.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+Ze,r.TEXTURE_2D,lt,0)}t.bindFramebuffer(r.DRAW_FRAMEBUFFER,ut.__webglMultisampledFramebuffer)}else if(te.depthBuffer&&te.resolveDepthBuffer===!1&&l){const z=te.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,[z])}}}function Xe(te){return Math.min(i.maxSamples,te.samples)}function ve(te){const z=n.get(te);return te.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&z.__useRenderToTexture!==!1}function et(te){const z=o.render.frame;c.get(te)!==z&&(c.set(te,z),te.update())}function Ce(te,z){const me=te.colorSpace,_e=te.format,Ee=te.type;return te.isCompressedTexture===!0||te.isVideoTexture===!0||me!==ic&&me!==Ou&&(On.getTransfer(me)===ri?(_e!==ms||Ee!==Za)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",me)),z}function We(te){return typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement?(u.width=te.naturalWidth||te.width,u.height=te.naturalHeight||te.height):typeof VideoFrame<"u"&&te instanceof VideoFrame?(u.width=te.displayWidth,u.height=te.displayHeight):(u.width=te.width,u.height=te.height),u}this.allocateTextureUnit=V,this.resetTextureUnits=N,this.setTexture2D=Q,this.setTexture2DArray=re,this.setTexture3D=ee,this.setTextureCube=se,this.rebindTextures=Ge,this.setupRenderTarget=Ke,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=Be,this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=oe,this.useMultisampledRTT=ve}function dF(r,e){function t(n,i=Ou){let s;const o=On.getTransfer(i);if(n===Za)return r.UNSIGNED_BYTE;if(n===NS)return r.UNSIGNED_SHORT_4_4_4_4;if(n===GS)return r.UNSIGNED_SHORT_5_5_5_1;if(n===qM)return r.UNSIGNED_INT_5_9_9_9_REV;if(n===YM)return r.BYTE;if(n===JM)return r.SHORT;if(n===lm)return r.UNSIGNED_SHORT;if(n===US)return r.INT;if(n===Ju)return r.UNSIGNED_INT;if(n===ro)return r.FLOAT;if(n===Im)return r.HALF_FLOAT;if(n===QM)return r.ALPHA;if(n===ZM)return r.RGB;if(n===ms)return r.RGBA;if(n===ew)return r.LUMINANCE;if(n===tw)return r.LUMINANCE_ALPHA;if(n===Gf)return r.DEPTH_COMPONENT;if(n===ed)return r.DEPTH_STENCIL;if(n===HS)return r.RED;if(n===yv)return r.RED_INTEGER;if(n===nw)return r.RG;if(n===zS)return r.RG_INTEGER;if(n===VS)return r.RGBA_INTEGER;if(n===d0||n===p0||n===m0||n===g0)if(o===ri)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===d0)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===p0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===m0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===g0)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===d0)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===p0)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===m0)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===g0)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===w_||n===C_||n===b_||n===R_)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===w_)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===C_)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===b_)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===R_)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===I_||n===L_||n===P_)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===I_||n===L_)return o===ri?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===P_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===D_||n===B_||n===F_||n===k_||n===O_||n===U_||n===N_||n===G_||n===H_||n===z_||n===V_||n===W_||n===j_||n===K_)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===D_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===B_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===F_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===k_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===O_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===U_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===N_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===G_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===H_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===z_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===V_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===W_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===j_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===K_)return o===ri?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===v0||n===$_||n===X_)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===v0)return o===ri?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===$_)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===X_)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===iw||n===Y_||n===J_||n===q_)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===v0)return s.COMPRESSED_RED_RGTC1_EXT;if(n===Y_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===J_)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===q_)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Zf?r.UNSIGNED_INT_24_8:r[n]!==void 0?r[n]:null}return{convert:t}}class pF extends mi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Gu extends An{constructor(){super(),this.isGroup=!0,this.type="Group"}}const h6={type:"move"};class H1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Gu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Gu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Gu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const x of e.hand.values()){const _=t.getJointPose(x,n),S=this._getHandJoint(u,x);_!==null&&(S.matrix.fromArray(_.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=_.radius),S.visible=_!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),m=.02,g=.005;u.inputState.pinching&&d>m+g?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=m-g&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(h6)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Gu;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const f6=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,d6=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class p6{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const i=new ci,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Go({vertexShader:f6,fragmentShader:d6,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ui(new sc(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class m6 extends rc{constructor(e,t){super();const n=this;let i=null,s=1,o=null,a="local-floor",l=1,u=null,c=null,h=null,d=null,m=null,g=null;const x=new p6,_=t.getContextAttributes();let S=null,T=null;const E=[],C=[],R=new Qe;let P=null;const L=new mi;L.layers.enable(1),L.viewport=new gn;const F=new mi;F.layers.enable(2),F.viewport=new gn;const D=[L,F],I=new pF;I.layers.enable(1),I.layers.enable(2);let N=null,V=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Z){let oe=E[Z];return oe===void 0&&(oe=new H1,E[Z]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(Z){let oe=E[Z];return oe===void 0&&(oe=new H1,E[Z]=oe),oe.getGripSpace()},this.getHand=function(Z){let oe=E[Z];return oe===void 0&&(oe=new H1,E[Z]=oe),oe.getHandSpace()};function q(Z){const oe=C.indexOf(Z.inputSource);if(oe===-1)return;const pe=E[oe];pe!==void 0&&(pe.update(Z.inputSource,Z.frame,u||o),pe.dispatchEvent({type:Z.type,data:Z.inputSource}))}function Q(){i.removeEventListener("select",q),i.removeEventListener("selectstart",q),i.removeEventListener("selectend",q),i.removeEventListener("squeeze",q),i.removeEventListener("squeezestart",q),i.removeEventListener("squeezeend",q),i.removeEventListener("end",Q),i.removeEventListener("inputsourceschange",re);for(let Z=0;Z<E.length;Z++){const oe=C[Z];oe!==null&&(C[Z]=null,E[Z].disconnect(oe))}N=null,V=null,x.reset(),e.setRenderTarget(S),m=null,d=null,h=null,i=null,T=null,le.stop(),n.isPresenting=!1,e.setPixelRatio(P),e.setSize(R.width,R.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Z){s=Z,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Z){a=Z,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(Z){u=Z},this.getBaseLayer=function(){return d!==null?d:m},this.getBinding=function(){return h},this.getFrame=function(){return g},this.getSession=function(){return i},this.setSession=async function(Z){if(i=Z,i!==null){if(S=e.getRenderTarget(),i.addEventListener("select",q),i.addEventListener("selectstart",q),i.addEventListener("selectend",q),i.addEventListener("squeeze",q),i.addEventListener("squeezestart",q),i.addEventListener("squeezeend",q),i.addEventListener("end",Q),i.addEventListener("inputsourceschange",re),_.xrCompatible!==!0&&await t.makeXRCompatible(),P=e.getPixelRatio(),e.getSize(R),i.renderState.layers===void 0){const oe={antialias:_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(i,t,oe),i.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),T=new el(m.framebufferWidth,m.framebufferHeight,{format:ms,type:Za,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil})}else{let oe=null,pe=null,de=null;_.depth&&(de=_.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,oe=_.stencil?ed:Gf,pe=_.stencil?Zf:Ju);const ye={colorFormat:t.RGBA8,depthFormat:de,scaleFactor:s};h=new XRWebGLBinding(i,t),d=h.createProjectionLayer(ye),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),T=new el(d.textureWidth,d.textureHeight,{format:ms,type:Za,depthTexture:new dw(d.textureWidth,d.textureHeight,pe,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1})}T.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await i.requestReferenceSpace(a),le.setContext(i),le.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return x.getDepthTexture()};function re(Z){for(let oe=0;oe<Z.removed.length;oe++){const pe=Z.removed[oe],de=C.indexOf(pe);de>=0&&(C[de]=null,E[de].disconnect(pe))}for(let oe=0;oe<Z.added.length;oe++){const pe=Z.added[oe];let de=C.indexOf(pe);if(de===-1){for(let Ge=0;Ge<E.length;Ge++)if(Ge>=C.length){C.push(pe),de=Ge;break}else if(C[Ge]===null){C[Ge]=pe,de=Ge;break}if(de===-1)break}const ye=E[de];ye&&ye.connect(pe)}}const ee=new ae,se=new ae;function W(Z,oe,pe){ee.setFromMatrixPosition(oe.matrixWorld),se.setFromMatrixPosition(pe.matrixWorld);const de=ee.distanceTo(se),ye=oe.projectionMatrix.elements,Ge=pe.projectionMatrix.elements,Ke=ye[14]/(ye[10]-1),De=ye[14]/(ye[10]+1),K=(ye[9]+1)/ye[5],Pe=(ye[9]-1)/ye[5],Be=(ye[8]-1)/ye[0],Xe=(Ge[8]+1)/Ge[0],ve=Ke*Be,et=Ke*Xe,Ce=de/(-Be+Xe),We=Ce*-Be;oe.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Z.translateX(We),Z.translateZ(Ce),Z.matrixWorld.compose(Z.position,Z.quaternion,Z.scale),Z.matrixWorldInverse.copy(Z.matrixWorld).invert();const te=Ke+Ce,z=De+Ce,me=ve-We,_e=et+(de-We),Ee=K*De/z*te,we=Pe*De/z*te;Z.projectionMatrix.makePerspective(me,_e,Ee,we,te,z),Z.projectionMatrixInverse.copy(Z.projectionMatrix).invert()}function $(Z,oe){oe===null?Z.matrixWorld.copy(Z.matrix):Z.matrixWorld.multiplyMatrices(oe.matrixWorld,Z.matrix),Z.matrixWorldInverse.copy(Z.matrixWorld).invert()}this.updateCamera=function(Z){if(i===null)return;x.texture!==null&&(Z.near=x.depthNear,Z.far=x.depthFar),I.near=F.near=L.near=Z.near,I.far=F.far=L.far=Z.far,(N!==I.near||V!==I.far)&&(i.updateRenderState({depthNear:I.near,depthFar:I.far}),N=I.near,V=I.far,L.near=N,L.far=V,F.near=N,F.far=V,L.updateProjectionMatrix(),F.updateProjectionMatrix(),Z.updateProjectionMatrix());const oe=Z.parent,pe=I.cameras;$(I,oe);for(let de=0;de<pe.length;de++)$(pe[de],oe);pe.length===2?W(I,L,F):I.projectionMatrix.copy(L.projectionMatrix),j(Z,I,oe)};function j(Z,oe,pe){pe===null?Z.matrix.copy(oe.matrixWorld):(Z.matrix.copy(pe.matrixWorld),Z.matrix.invert(),Z.matrix.multiply(oe.matrixWorld)),Z.matrix.decompose(Z.position,Z.quaternion,Z.scale),Z.updateMatrixWorld(!0),Z.projectionMatrix.copy(oe.projectionMatrix),Z.projectionMatrixInverse.copy(oe.projectionMatrixInverse),Z.isPerspectiveCamera&&(Z.fov=hm*2*Math.atan(1/Z.projectionMatrix.elements[5]),Z.zoom=1)}this.getCamera=function(){return I},this.getFoveation=function(){if(!(d===null&&m===null))return l},this.setFoveation=function(Z){l=Z,d!==null&&(d.fixedFoveation=Z),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=Z)},this.hasDepthSensing=function(){return x.texture!==null},this.getDepthSensingMesh=function(){return x.getMesh(I)};let U=null;function X(Z,oe){if(c=oe.getViewerPose(u||o),g=oe,c!==null){const pe=c.views;m!==null&&(e.setRenderTargetFramebuffer(T,m.framebuffer),e.setRenderTarget(T));let de=!1;pe.length!==I.cameras.length&&(I.cameras.length=0,de=!0);for(let Ge=0;Ge<pe.length;Ge++){const Ke=pe[Ge];let De=null;if(m!==null)De=m.getViewport(Ke);else{const Pe=h.getViewSubImage(d,Ke);De=Pe.viewport,Ge===0&&(e.setRenderTargetTextures(T,Pe.colorTexture,d.ignoreDepthValues?void 0:Pe.depthStencilTexture),e.setRenderTarget(T))}let K=D[Ge];K===void 0&&(K=new mi,K.layers.enable(Ge),K.viewport=new gn,D[Ge]=K),K.matrix.fromArray(Ke.transform.matrix),K.matrix.decompose(K.position,K.quaternion,K.scale),K.projectionMatrix.fromArray(Ke.projectionMatrix),K.projectionMatrixInverse.copy(K.projectionMatrix).invert(),K.viewport.set(De.x,De.y,De.width,De.height),Ge===0&&(I.matrix.copy(K.matrix),I.matrix.decompose(I.position,I.quaternion,I.scale)),de===!0&&I.cameras.push(K)}const ye=i.enabledFeatures;if(ye&&ye.includes("depth-sensing")){const Ge=h.getDepthInformation(pe[0]);Ge&&Ge.isValid&&Ge.texture&&x.init(e,Ge,i.renderState)}}for(let pe=0;pe<E.length;pe++){const de=C[pe],ye=E[pe];de!==null&&ye!==void 0&&ye.update(de,oe,u||o)}U&&U(Z,oe),oe.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:oe}),g=null}const le=new lF;le.setAnimationLoop(X),this.setAnimationLoop=function(Z){U=Z},this.dispose=function(){}}}const lf=new No,g6=new Wt;function v6(r,e){function t(_,S){_.matrixAutoUpdate===!0&&_.updateMatrix(),S.value.copy(_.matrix)}function n(_,S){S.color.getRGB(_.fogColor.value,sF(r)),S.isFog?(_.fogNear.value=S.near,_.fogFar.value=S.far):S.isFogExp2&&(_.fogDensity.value=S.density)}function i(_,S,T,E,C){S.isMeshBasicMaterial||S.isMeshLambertMaterial?s(_,S):S.isMeshToonMaterial?(s(_,S),h(_,S)):S.isMeshPhongMaterial?(s(_,S),c(_,S)):S.isMeshStandardMaterial?(s(_,S),d(_,S),S.isMeshPhysicalMaterial&&m(_,S,C)):S.isMeshMatcapMaterial?(s(_,S),g(_,S)):S.isMeshDepthMaterial?s(_,S):S.isMeshDistanceMaterial?(s(_,S),x(_,S)):S.isMeshNormalMaterial?s(_,S):S.isLineBasicMaterial?(o(_,S),S.isLineDashedMaterial&&a(_,S)):S.isPointsMaterial?l(_,S,T,E):S.isSpriteMaterial?u(_,S):S.isShadowMaterial?(_.color.value.copy(S.color),_.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function s(_,S){_.opacity.value=S.opacity,S.color&&_.diffuse.value.copy(S.color),S.emissive&&_.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(_.map.value=S.map,t(S.map,_.mapTransform)),S.alphaMap&&(_.alphaMap.value=S.alphaMap,t(S.alphaMap,_.alphaMapTransform)),S.bumpMap&&(_.bumpMap.value=S.bumpMap,t(S.bumpMap,_.bumpMapTransform),_.bumpScale.value=S.bumpScale,S.side===Ns&&(_.bumpScale.value*=-1)),S.normalMap&&(_.normalMap.value=S.normalMap,t(S.normalMap,_.normalMapTransform),_.normalScale.value.copy(S.normalScale),S.side===Ns&&_.normalScale.value.negate()),S.displacementMap&&(_.displacementMap.value=S.displacementMap,t(S.displacementMap,_.displacementMapTransform),_.displacementScale.value=S.displacementScale,_.displacementBias.value=S.displacementBias),S.emissiveMap&&(_.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,_.emissiveMapTransform)),S.specularMap&&(_.specularMap.value=S.specularMap,t(S.specularMap,_.specularMapTransform)),S.alphaTest>0&&(_.alphaTest.value=S.alphaTest);const T=e.get(S),E=T.envMap,C=T.envMapRotation;E&&(_.envMap.value=E,lf.copy(C),lf.x*=-1,lf.y*=-1,lf.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(lf.y*=-1,lf.z*=-1),_.envMapRotation.value.setFromMatrix4(g6.makeRotationFromEuler(lf)),_.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=S.reflectivity,_.ior.value=S.ior,_.refractionRatio.value=S.refractionRatio),S.lightMap&&(_.lightMap.value=S.lightMap,_.lightMapIntensity.value=S.lightMapIntensity,t(S.lightMap,_.lightMapTransform)),S.aoMap&&(_.aoMap.value=S.aoMap,_.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,_.aoMapTransform))}function o(_,S){_.diffuse.value.copy(S.color),_.opacity.value=S.opacity,S.map&&(_.map.value=S.map,t(S.map,_.mapTransform))}function a(_,S){_.dashSize.value=S.dashSize,_.totalSize.value=S.dashSize+S.gapSize,_.scale.value=S.scale}function l(_,S,T,E){_.diffuse.value.copy(S.color),_.opacity.value=S.opacity,_.size.value=S.size*T,_.scale.value=E*.5,S.map&&(_.map.value=S.map,t(S.map,_.uvTransform)),S.alphaMap&&(_.alphaMap.value=S.alphaMap,t(S.alphaMap,_.alphaMapTransform)),S.alphaTest>0&&(_.alphaTest.value=S.alphaTest)}function u(_,S){_.diffuse.value.copy(S.color),_.opacity.value=S.opacity,_.rotation.value=S.rotation,S.map&&(_.map.value=S.map,t(S.map,_.mapTransform)),S.alphaMap&&(_.alphaMap.value=S.alphaMap,t(S.alphaMap,_.alphaMapTransform)),S.alphaTest>0&&(_.alphaTest.value=S.alphaTest)}function c(_,S){_.specular.value.copy(S.specular),_.shininess.value=Math.max(S.shininess,1e-4)}function h(_,S){S.gradientMap&&(_.gradientMap.value=S.gradientMap)}function d(_,S){_.metalness.value=S.metalness,S.metalnessMap&&(_.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,_.metalnessMapTransform)),_.roughness.value=S.roughness,S.roughnessMap&&(_.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,_.roughnessMapTransform)),S.envMap&&(_.envMapIntensity.value=S.envMapIntensity)}function m(_,S,T){_.ior.value=S.ior,S.sheen>0&&(_.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),_.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(_.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,_.sheenColorMapTransform)),S.sheenRoughnessMap&&(_.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,_.sheenRoughnessMapTransform))),S.clearcoat>0&&(_.clearcoat.value=S.clearcoat,_.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(_.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,_.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(_.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===Ns&&_.clearcoatNormalScale.value.negate())),S.dispersion>0&&(_.dispersion.value=S.dispersion),S.iridescence>0&&(_.iridescence.value=S.iridescence,_.iridescenceIOR.value=S.iridescenceIOR,_.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(_.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,_.iridescenceMapTransform)),S.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),S.transmission>0&&(_.transmission.value=S.transmission,_.transmissionSamplerMap.value=T.texture,_.transmissionSamplerSize.value.set(T.width,T.height),S.transmissionMap&&(_.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,_.transmissionMapTransform)),_.thickness.value=S.thickness,S.thicknessMap&&(_.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=S.attenuationDistance,_.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(_.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(_.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=S.specularIntensity,_.specularColor.value.copy(S.specularColor),S.specularColorMap&&(_.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,_.specularColorMapTransform)),S.specularIntensityMap&&(_.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,_.specularIntensityMapTransform))}function g(_,S){S.matcap&&(_.matcap.value=S.matcap)}function x(_,S){const T=e.get(S).light;_.referencePosition.value.setFromMatrixPosition(T.matrixWorld),_.nearDistance.value=T.shadow.camera.near,_.farDistance.value=T.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function y6(r,e,t,n){let i={},s={},o=[];const a=r.getParameter(r.MAX_UNIFORM_BUFFER_BINDINGS);function l(T,E){const C=E.program;n.uniformBlockBinding(T,C)}function u(T,E){let C=i[T.id];C===void 0&&(g(T),C=c(T),i[T.id]=C,T.addEventListener("dispose",_));const R=E.program;n.updateUBOMapping(T,R);const P=e.render.frame;s[T.id]!==P&&(d(T),s[T.id]=P)}function c(T){const E=h();T.__bindingPointIndex=E;const C=r.createBuffer(),R=T.__size,P=T.usage;return r.bindBuffer(r.UNIFORM_BUFFER,C),r.bufferData(r.UNIFORM_BUFFER,R,P),r.bindBuffer(r.UNIFORM_BUFFER,null),r.bindBufferBase(r.UNIFORM_BUFFER,E,C),C}function h(){for(let T=0;T<a;T++)if(o.indexOf(T)===-1)return o.push(T),T;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(T){const E=i[T.id],C=T.uniforms,R=T.__cache;r.bindBuffer(r.UNIFORM_BUFFER,E);for(let P=0,L=C.length;P<L;P++){const F=Array.isArray(C[P])?C[P]:[C[P]];for(let D=0,I=F.length;D<I;D++){const N=F[D];if(m(N,P,D,R)===!0){const V=N.__offset,q=Array.isArray(N.value)?N.value:[N.value];let Q=0;for(let re=0;re<q.length;re++){const ee=q[re],se=x(ee);typeof ee=="number"||typeof ee=="boolean"?(N.__data[0]=ee,r.bufferSubData(r.UNIFORM_BUFFER,V+Q,N.__data)):ee.isMatrix3?(N.__data[0]=ee.elements[0],N.__data[1]=ee.elements[1],N.__data[2]=ee.elements[2],N.__data[3]=0,N.__data[4]=ee.elements[3],N.__data[5]=ee.elements[4],N.__data[6]=ee.elements[5],N.__data[7]=0,N.__data[8]=ee.elements[6],N.__data[9]=ee.elements[7],N.__data[10]=ee.elements[8],N.__data[11]=0):(ee.toArray(N.__data,Q),Q+=se.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(r.UNIFORM_BUFFER,V,N.__data)}}}r.bindBuffer(r.UNIFORM_BUFFER,null)}function m(T,E,C,R){const P=T.value,L=E+"_"+C;if(R[L]===void 0)return typeof P=="number"||typeof P=="boolean"?R[L]=P:R[L]=P.clone(),!0;{const F=R[L];if(typeof P=="number"||typeof P=="boolean"){if(F!==P)return R[L]=P,!0}else if(F.equals(P)===!1)return F.copy(P),!0}return!1}function g(T){const E=T.uniforms;let C=0;const R=16;for(let L=0,F=E.length;L<F;L++){const D=Array.isArray(E[L])?E[L]:[E[L]];for(let I=0,N=D.length;I<N;I++){const V=D[I],q=Array.isArray(V.value)?V.value:[V.value];for(let Q=0,re=q.length;Q<re;Q++){const ee=q[Q],se=x(ee),W=C%R,$=W%se.boundary,j=W+$;C+=$,j!==0&&R-j<se.storage&&(C+=R-j),V.__data=new Float32Array(se.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=C,C+=se.storage}}}const P=C%R;return P>0&&(C+=R-P),T.__size=C,T.__cache={},this}function x(T){const E={boundary:0,storage:0};return typeof T=="number"||typeof T=="boolean"?(E.boundary=4,E.storage=4):T.isVector2?(E.boundary=8,E.storage=8):T.isVector3||T.isColor?(E.boundary=16,E.storage=12):T.isVector4?(E.boundary=16,E.storage=16):T.isMatrix3?(E.boundary=48,E.storage=48):T.isMatrix4?(E.boundary=64,E.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T),E}function _(T){const E=T.target;E.removeEventListener("dispose",_);const C=o.indexOf(E.__bindingPointIndex);o.splice(C,1),r.deleteBuffer(i[E.id]),delete i[E.id],delete s[E.id]}function S(){for(const T in i)r.deleteBuffer(i[T]);o=[],i={},s={}}return{bind:l,update:u,dispose:S}}class mF{constructor(e={}){const{canvas:t=tF(),context:n=null,depth:i=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=o;const m=new Uint32Array(4),g=new Int32Array(4);let x=null,_=null;const S=[],T=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=fa,this.toneMapping=Ul,this.toneMappingExposure=1;const E=this;let C=!1,R=0,P=0,L=null,F=-1,D=null;const I=new gn,N=new gn;let V=null;const q=new yt(0);let Q=0,re=t.width,ee=t.height,se=1,W=null,$=null;const j=new gn(0,0,re,ee),U=new gn(0,0,re,ee);let X=!1;const le=new Ev;let Z=!1,oe=!1;const pe=new Wt,de=new ae,ye=new gn,Ge={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ke=!1;function De(){return L===null?se:1}let K=n;function Pe(ie,Ae){return t.getContext(ie,Ae)}try{const ie={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${bm}`),t.addEventListener("webglcontextlost",Te,!1),t.addEventListener("webglcontextrestored",Oe,!1),t.addEventListener("webglcontextcreationerror",st,!1),K===null){const Ae="webgl2";if(K=Pe(Ae,ie),K===null)throw Pe(Ae)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ie){throw console.error("THREE.WebGLRenderer: "+ie.message),ie}let Be,Xe,ve,et,Ce,We,te,z,me,_e,Ee,we,ut,ke,Ze,lt,Ye,nt,Ct,ht,it,rt,fe,Je;function ce(){Be=new Mz(K),Be.init(),rt=new dF(K,Be),Xe=new xz(K,Be,e,rt),ve=new r6(K),et=new bz(K),Ce=new KV,We=new c6(K,Be,ve,Ce,Xe,rt,et),te=new Sz(E),z=new Tz(E),me=new FG(K),fe=new vz(K,me),_e=new wz(K,me,et,fe),Ee=new Iz(K,_e,me,et),Ct=new Rz(K,Xe,We),lt=new _z(Ce),we=new jV(E,te,z,Be,Xe,fe,lt),ut=new v6(E,Ce),ke=new XV,Ze=new e6(Be),nt=new gz(E,te,z,ve,Ee,d,l),Ye=new i6(E,Ee,Xe),Je=new y6(K,et,Xe,ve),ht=new yz(K,Be,et),it=new Cz(K,Be,et),et.programs=we.programs,E.capabilities=Xe,E.extensions=Be,E.properties=Ce,E.renderLists=ke,E.shadowMap=Ye,E.state=ve,E.info=et}ce();const He=new m6(E,K);this.xr=He,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const ie=Be.get("WEBGL_lose_context");ie&&ie.loseContext()},this.forceContextRestore=function(){const ie=Be.get("WEBGL_lose_context");ie&&ie.restoreContext()},this.getPixelRatio=function(){return se},this.setPixelRatio=function(ie){ie!==void 0&&(se=ie,this.setSize(re,ee,!1))},this.getSize=function(ie){return ie.set(re,ee)},this.setSize=function(ie,Ae,Ue=!0){if(He.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}re=ie,ee=Ae,t.width=Math.floor(ie*se),t.height=Math.floor(Ae*se),Ue===!0&&(t.style.width=ie+"px",t.style.height=Ae+"px"),this.setViewport(0,0,ie,Ae)},this.getDrawingBufferSize=function(ie){return ie.set(re*se,ee*se).floor()},this.setDrawingBufferSize=function(ie,Ae,Ue){re=ie,ee=Ae,se=Ue,t.width=Math.floor(ie*Ue),t.height=Math.floor(Ae*Ue),this.setViewport(0,0,ie,Ae)},this.getCurrentViewport=function(ie){return ie.copy(I)},this.getViewport=function(ie){return ie.copy(j)},this.setViewport=function(ie,Ae,Ue,ze){ie.isVector4?j.set(ie.x,ie.y,ie.z,ie.w):j.set(ie,Ae,Ue,ze),ve.viewport(I.copy(j).multiplyScalar(se).round())},this.getScissor=function(ie){return ie.copy(U)},this.setScissor=function(ie,Ae,Ue,ze){ie.isVector4?U.set(ie.x,ie.y,ie.z,ie.w):U.set(ie,Ae,Ue,ze),ve.scissor(N.copy(U).multiplyScalar(se).round())},this.getScissorTest=function(){return X},this.setScissorTest=function(ie){ve.setScissorTest(X=ie)},this.setOpaqueSort=function(ie){W=ie},this.setTransparentSort=function(ie){$=ie},this.getClearColor=function(ie){return ie.copy(nt.getClearColor())},this.setClearColor=function(){nt.setClearColor.apply(nt,arguments)},this.getClearAlpha=function(){return nt.getClearAlpha()},this.setClearAlpha=function(){nt.setClearAlpha.apply(nt,arguments)},this.clear=function(ie=!0,Ae=!0,Ue=!0){let ze=0;if(ie){let be=!1;if(L!==null){const ft=L.texture.format;be=ft===VS||ft===zS||ft===yv}if(be){const ft=L.texture.type,At=ft===Za||ft===Ju||ft===lm||ft===Zf||ft===NS||ft===GS,Rt=nt.getClearColor(),je=nt.getClearAlpha(),Ot=Rt.r,Vt=Rt.g,Pt=Rt.b;At?(m[0]=Ot,m[1]=Vt,m[2]=Pt,m[3]=je,K.clearBufferuiv(K.COLOR,0,m)):(g[0]=Ot,g[1]=Vt,g[2]=Pt,g[3]=je,K.clearBufferiv(K.COLOR,0,g))}else ze|=K.COLOR_BUFFER_BIT}Ae&&(ze|=K.DEPTH_BUFFER_BIT),Ue&&(ze|=K.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),K.clear(ze)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Te,!1),t.removeEventListener("webglcontextrestored",Oe,!1),t.removeEventListener("webglcontextcreationerror",st,!1),ke.dispose(),Ze.dispose(),Ce.dispose(),te.dispose(),z.dispose(),Ee.dispose(),fe.dispose(),Je.dispose(),we.dispose(),He.dispose(),He.removeEventListener("sessionstart",vn),He.removeEventListener("sessionend",Dn),In.stop()};function Te(ie){ie.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function Oe(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const ie=et.autoReset,Ae=Ye.enabled,Ue=Ye.autoUpdate,ze=Ye.needsUpdate,be=Ye.type;ce(),et.autoReset=ie,Ye.enabled=Ae,Ye.autoUpdate=Ue,Ye.needsUpdate=ze,Ye.type=be}function st(ie){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ie.statusMessage)}function xt(ie){const Ae=ie.target;Ae.removeEventListener("dispose",xt),_t(Ae)}function _t(ie){Ht(ie),Ce.remove(ie)}function Ht(ie){const Ae=Ce.get(ie).programs;Ae!==void 0&&(Ae.forEach(function(Ue){we.releaseProgram(Ue)}),ie.isShaderMaterial&&we.releaseShaderCache(ie))}this.renderBufferDirect=function(ie,Ae,Ue,ze,be,ft){Ae===null&&(Ae=Ge);const At=be.isMesh&&be.matrixWorld.determinant()<0,Rt=uc(ie,Ae,Ue,ze,be);ve.setMaterial(ze,At);let je=Ue.index,Ot=1;if(ze.wireframe===!0){if(je=_e.getWireframeAttribute(Ue),je===void 0)return;Ot=2}const Vt=Ue.drawRange,Pt=Ue.attributes.position;let un=Vt.start*Ot,Un=(Vt.start+Vt.count)*Ot;ft!==null&&(un=Math.max(un,ft.start*Ot),Un=Math.min(Un,(ft.start+ft.count)*Ot)),je!==null?(un=Math.max(un,0),Un=Math.min(Un,je.count)):Pt!=null&&(un=Math.max(un,0),Un=Math.min(Un,Pt.count));const En=Un-un;if(En<0||En===1/0)return;fe.setup(be,ze,Rt,Ue,je);let Bn,wt=ht;if(je!==null&&(Bn=me.get(je),wt=it,wt.setIndex(Bn)),be.isMesh)ze.wireframe===!0?(ve.setLineWidth(ze.wireframeLinewidth*De()),wt.setMode(K.LINES)):wt.setMode(K.TRIANGLES);else if(be.isLine){let mt=ze.linewidth;mt===void 0&&(mt=1),ve.setLineWidth(mt*De()),be.isLineSegments?wt.setMode(K.LINES):be.isLineLoop?wt.setMode(K.LINE_LOOP):wt.setMode(K.LINE_STRIP)}else be.isPoints?wt.setMode(K.POINTS):be.isSprite&&wt.setMode(K.TRIANGLES);if(be.isBatchedMesh)if(be._multiDrawInstances!==null)wt.renderMultiDrawInstances(be._multiDrawStarts,be._multiDrawCounts,be._multiDrawCount,be._multiDrawInstances);else if(Be.get("WEBGL_multi_draw"))wt.renderMultiDraw(be._multiDrawStarts,be._multiDrawCounts,be._multiDrawCount);else{const mt=be._multiDrawStarts,on=be._multiDrawCounts,Kt=be._multiDrawCount,Fn=je?me.get(je).bytesPerElement:1,fr=Ce.get(ze).currentProgram.getUniforms();for(let Nn=0;Nn<Kt;Nn++)fr.setValue(K,"_gl_DrawID",Nn),wt.render(mt[Nn]/Fn,on[Nn])}else if(be.isInstancedMesh)wt.renderInstances(un,En,be.count);else if(Ue.isInstancedBufferGeometry){const mt=Ue._maxInstanceCount!==void 0?Ue._maxInstanceCount:1/0,on=Math.min(Ue.instanceCount,mt);wt.renderInstances(un,En,on)}else wt.render(un,En)};function zt(ie,Ae,Ue){ie.transparent===!0&&ie.side===Lo&&ie.forceSinglePass===!1?(ie.side=Ns,ie.needsUpdate=!0,qi(ie,Ae,Ue),ie.side=Wl,ie.needsUpdate=!0,qi(ie,Ae,Ue),ie.side=Lo):qi(ie,Ae,Ue)}this.compile=function(ie,Ae,Ue=null){Ue===null&&(Ue=ie),_=Ze.get(Ue),_.init(Ae),T.push(_),Ue.traverseVisible(function(be){be.isLight&&be.layers.test(Ae.layers)&&(_.pushLight(be),be.castShadow&&_.pushShadow(be))}),ie!==Ue&&ie.traverseVisible(function(be){be.isLight&&be.layers.test(Ae.layers)&&(_.pushLight(be),be.castShadow&&_.pushShadow(be))}),_.setupLights();const ze=new Set;return ie.traverse(function(be){const ft=be.material;if(ft)if(Array.isArray(ft))for(let At=0;At<ft.length;At++){const Rt=ft[At];zt(Rt,Ue,be),ze.add(Rt)}else zt(ft,Ue,be),ze.add(ft)}),T.pop(),_=null,ze},this.compileAsync=function(ie,Ae,Ue=null){const ze=this.compile(ie,Ae,Ue);return new Promise(be=>{function ft(){if(ze.forEach(function(At){Ce.get(At).currentProgram.isReady()&&ze.delete(At)}),ze.size===0){be(ie);return}setTimeout(ft,10)}Be.get("KHR_parallel_shader_compile")!==null?ft():setTimeout(ft,10)})};let gt=null;function Qt(ie){gt&&gt(ie)}function vn(){In.stop()}function Dn(){In.start()}const In=new lF;In.setAnimationLoop(Qt),typeof self<"u"&&In.setContext(self),this.setAnimationLoop=function(ie){gt=ie,He.setAnimationLoop(ie),ie===null?In.stop():In.start()},He.addEventListener("sessionstart",vn),He.addEventListener("sessionend",Dn),this.render=function(ie,Ae){if(Ae!==void 0&&Ae.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;if(ie.matrixWorldAutoUpdate===!0&&ie.updateMatrixWorld(),Ae.parent===null&&Ae.matrixWorldAutoUpdate===!0&&Ae.updateMatrixWorld(),He.enabled===!0&&He.isPresenting===!0&&(He.cameraAutoUpdate===!0&&He.updateCamera(Ae),Ae=He.getCamera()),ie.isScene===!0&&ie.onBeforeRender(E,ie,Ae,L),_=Ze.get(ie,T.length),_.init(Ae),T.push(_),pe.multiplyMatrices(Ae.projectionMatrix,Ae.matrixWorldInverse),le.setFromProjectionMatrix(pe),oe=this.localClippingEnabled,Z=lt.init(this.clippingPlanes,oe),x=ke.get(ie,S.length),x.init(),S.push(x),He.enabled===!0&&He.isPresenting===!0){const ft=E.xr.getDepthSensingMesh();ft!==null&&xi(ft,Ae,-1/0,E.sortObjects)}xi(ie,Ae,0,E.sortObjects),x.finish(),E.sortObjects===!0&&x.sort(W,$),Ke=He.enabled===!1||He.isPresenting===!1||He.hasDepthSensing()===!1,Ke&&nt.addToRenderList(x,ie),this.info.render.frame++,Z===!0&&lt.beginShadows();const Ue=_.state.shadowsArray;Ye.render(Ue,ie,Ae),Z===!0&&lt.endShadows(),this.info.autoReset===!0&&this.info.reset();const ze=x.opaque,be=x.transmissive;if(_.setupLights(),Ae.isArrayCamera){const ft=Ae.cameras;if(be.length>0)for(let At=0,Rt=ft.length;At<Rt;At++){const je=ft[At];Ri(ze,be,ie,je)}Ke&&nt.render(ie);for(let At=0,Rt=ft.length;At<Rt;At++){const je=ft[At];ns(x,ie,je,je.viewport)}}else be.length>0&&Ri(ze,be,ie,Ae),Ke&&nt.render(ie),ns(x,ie,Ae);L!==null&&(We.updateMultisampleRenderTarget(L),We.updateRenderTargetMipmap(L)),ie.isScene===!0&&ie.onAfterRender(E,ie,Ae),fe.resetDefaultState(),F=-1,D=null,T.pop(),T.length>0?(_=T[T.length-1],Z===!0&&lt.setGlobalState(E.clippingPlanes,_.state.camera)):_=null,S.pop(),S.length>0?x=S[S.length-1]:x=null};function xi(ie,Ae,Ue,ze){if(ie.visible===!1)return;if(ie.layers.test(Ae.layers)){if(ie.isGroup)Ue=ie.renderOrder;else if(ie.isLOD)ie.autoUpdate===!0&&ie.update(Ae);else if(ie.isLight)_.pushLight(ie),ie.castShadow&&_.pushShadow(ie);else if(ie.isSprite){if(!ie.frustumCulled||le.intersectsSprite(ie)){ze&&ye.setFromMatrixPosition(ie.matrixWorld).applyMatrix4(pe);const At=Ee.update(ie),Rt=ie.material;Rt.visible&&x.push(ie,At,Rt,Ue,ye.z,null)}}else if((ie.isMesh||ie.isLine||ie.isPoints)&&(!ie.frustumCulled||le.intersectsObject(ie))){const At=Ee.update(ie),Rt=ie.material;if(ze&&(ie.boundingSphere!==void 0?(ie.boundingSphere===null&&ie.computeBoundingSphere(),ye.copy(ie.boundingSphere.center)):(At.boundingSphere===null&&At.computeBoundingSphere(),ye.copy(At.boundingSphere.center)),ye.applyMatrix4(ie.matrixWorld).applyMatrix4(pe)),Array.isArray(Rt)){const je=At.groups;for(let Ot=0,Vt=je.length;Ot<Vt;Ot++){const Pt=je[Ot],un=Rt[Pt.materialIndex];un&&un.visible&&x.push(ie,At,un,Ue,ye.z,Pt)}}else Rt.visible&&x.push(ie,At,Rt,Ue,ye.z,null)}}const ft=ie.children;for(let At=0,Rt=ft.length;At<Rt;At++)xi(ft[At],Ae,Ue,ze)}function ns(ie,Ae,Ue,ze){const be=ie.opaque,ft=ie.transmissive,At=ie.transparent;_.setupLightsView(Ue),Z===!0&&lt.setGlobalState(E.clippingPlanes,Ue),ze&&ve.viewport(I.copy(ze)),be.length>0&&Ji(be,Ae,Ue),ft.length>0&&Ji(ft,Ae,Ue),At.length>0&&Ji(At,Ae,Ue),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function Ri(ie,Ae,Ue,ze){if((Ue.isScene===!0?Ue.overrideMaterial:null)!==null)return;_.state.transmissionRenderTarget[ze.id]===void 0&&(_.state.transmissionRenderTarget[ze.id]=new el(1,1,{generateMipmaps:!0,type:Be.has("EXT_color_buffer_half_float")||Be.has("EXT_color_buffer_float")?Im:Za,minFilter:da,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:On.workingColorSpace}));const ft=_.state.transmissionRenderTarget[ze.id],At=ze.viewport||I;ft.setSize(At.z,At.w);const Rt=E.getRenderTarget();E.setRenderTarget(ft),E.getClearColor(q),Q=E.getClearAlpha(),Q<1&&E.setClearColor(16777215,.5),E.clear(),Ke&&nt.render(Ue);const je=E.toneMapping;E.toneMapping=Ul;const Ot=ze.viewport;if(ze.viewport!==void 0&&(ze.viewport=void 0),_.setupLightsView(ze),Z===!0&&lt.setGlobalState(E.clippingPlanes,ze),Ji(ie,Ue,ze),We.updateMultisampleRenderTarget(ft),We.updateRenderTargetMipmap(ft),Be.has("WEBGL_multisampled_render_to_texture")===!1){let Vt=!1;for(let Pt=0,un=Ae.length;Pt<un;Pt++){const Un=Ae[Pt],En=Un.object,Bn=Un.geometry,wt=Un.material,mt=Un.group;if(wt.side===Lo&&En.layers.test(ze.layers)){const on=wt.side;wt.side=Ns,wt.needsUpdate=!0,Gi(En,Ue,ze,Bn,wt,mt),wt.side=on,wt.needsUpdate=!0,Vt=!0}}Vt===!0&&(We.updateMultisampleRenderTarget(ft),We.updateRenderTargetMipmap(ft))}E.setRenderTarget(Rt),E.setClearColor(q,Q),Ot!==void 0&&(ze.viewport=Ot),E.toneMapping=je}function Ji(ie,Ae,Ue){const ze=Ae.isScene===!0?Ae.overrideMaterial:null;for(let be=0,ft=ie.length;be<ft;be++){const At=ie[be],Rt=At.object,je=At.geometry,Ot=ze===null?At.material:ze,Vt=At.group;Rt.layers.test(Ue.layers)&&Gi(Rt,Ae,Ue,je,Ot,Vt)}}function Gi(ie,Ae,Ue,ze,be,ft){ie.onBeforeRender(E,Ae,Ue,ze,be,ft),ie.modelViewMatrix.multiplyMatrices(Ue.matrixWorldInverse,ie.matrixWorld),ie.normalMatrix.getNormalMatrix(ie.modelViewMatrix),be.transparent===!0&&be.side===Lo&&be.forceSinglePass===!1?(be.side=Ns,be.needsUpdate=!0,E.renderBufferDirect(Ue,Ae,ze,be,ie,ft),be.side=Wl,be.needsUpdate=!0,E.renderBufferDirect(Ue,Ae,ze,be,ie,ft),be.side=Lo):E.renderBufferDirect(Ue,Ae,ze,be,ie,ft),ie.onAfterRender(E,Ae,Ue,ze,be,ft)}function qi(ie,Ae,Ue){Ae.isScene!==!0&&(Ae=Ge);const ze=Ce.get(ie),be=_.state.lights,ft=_.state.shadowsArray,At=be.state.version,Rt=we.getParameters(ie,be.state,ft,Ae,Ue),je=we.getProgramCacheKey(Rt);let Ot=ze.programs;ze.environment=ie.isMeshStandardMaterial?Ae.environment:null,ze.fog=Ae.fog,ze.envMap=(ie.isMeshStandardMaterial?z:te).get(ie.envMap||ze.environment),ze.envMapRotation=ze.environment!==null&&ie.envMap===null?Ae.environmentRotation:ie.envMapRotation,Ot===void 0&&(ie.addEventListener("dispose",xt),Ot=new Map,ze.programs=Ot);let Vt=Ot.get(je);if(Vt!==void 0){if(ze.currentProgram===Vt&&ze.lightsStateVersion===At)return Hs(ie,Rt),Vt}else Rt.uniforms=we.getUniforms(ie),ie.onBeforeCompile(Rt,E),Vt=we.acquireProgram(Rt,je),Ot.set(je,Vt),ze.uniforms=Rt.uniforms;const Pt=ze.uniforms;return(!ie.isShaderMaterial&&!ie.isRawShaderMaterial||ie.clipping===!0)&&(Pt.clippingPlanes=lt.uniform),Hs(ie,Rt),ze.needsLights=cc(ie),ze.lightsStateVersion=At,ze.needsLights&&(Pt.ambientLightColor.value=be.state.ambient,Pt.lightProbe.value=be.state.probe,Pt.directionalLights.value=be.state.directional,Pt.directionalLightShadows.value=be.state.directionalShadow,Pt.spotLights.value=be.state.spot,Pt.spotLightShadows.value=be.state.spotShadow,Pt.rectAreaLights.value=be.state.rectArea,Pt.ltc_1.value=be.state.rectAreaLTC1,Pt.ltc_2.value=be.state.rectAreaLTC2,Pt.pointLights.value=be.state.point,Pt.pointLightShadows.value=be.state.pointShadow,Pt.hemisphereLights.value=be.state.hemi,Pt.directionalShadowMap.value=be.state.directionalShadowMap,Pt.directionalShadowMatrix.value=be.state.directionalShadowMatrix,Pt.spotShadowMap.value=be.state.spotShadowMap,Pt.spotLightMatrix.value=be.state.spotLightMatrix,Pt.spotLightMap.value=be.state.spotLightMap,Pt.pointShadowMap.value=be.state.pointShadowMap,Pt.pointShadowMatrix.value=be.state.pointShadowMatrix),ze.currentProgram=Vt,ze.uniformsList=null,Vt}function Ii(ie){if(ie.uniformsList===null){const Ae=ie.currentProgram.getUniforms();ie.uniformsList=i_.seqWithValue(Ae.seq,ie.uniforms)}return ie.uniformsList}function Hs(ie,Ae){const Ue=Ce.get(ie);Ue.outputColorSpace=Ae.outputColorSpace,Ue.batching=Ae.batching,Ue.batchingColor=Ae.batchingColor,Ue.instancing=Ae.instancing,Ue.instancingColor=Ae.instancingColor,Ue.instancingMorph=Ae.instancingMorph,Ue.skinning=Ae.skinning,Ue.morphTargets=Ae.morphTargets,Ue.morphNormals=Ae.morphNormals,Ue.morphColors=Ae.morphColors,Ue.morphTargetsCount=Ae.morphTargetsCount,Ue.numClippingPlanes=Ae.numClippingPlanes,Ue.numIntersection=Ae.numClipIntersection,Ue.vertexAlphas=Ae.vertexAlphas,Ue.vertexTangents=Ae.vertexTangents,Ue.toneMapping=Ae.toneMapping}function uc(ie,Ae,Ue,ze,be){Ae.isScene!==!0&&(Ae=Ge),We.resetTextureUnits();const ft=Ae.fog,At=ze.isMeshStandardMaterial?Ae.environment:null,Rt=L===null?E.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:ic,je=(ze.isMeshStandardMaterial?z:te).get(ze.envMap||At),Ot=ze.vertexColors===!0&&!!Ue.attributes.color&&Ue.attributes.color.itemSize===4,Vt=!!Ue.attributes.tangent&&(!!ze.normalMap||ze.anisotropy>0),Pt=!!Ue.morphAttributes.position,un=!!Ue.morphAttributes.normal,Un=!!Ue.morphAttributes.color;let En=Ul;ze.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(En=E.toneMapping);const Bn=Ue.morphAttributes.position||Ue.morphAttributes.normal||Ue.morphAttributes.color,wt=Bn!==void 0?Bn.length:0,mt=Ce.get(ze),on=_.state.lights;if(Z===!0&&(oe===!0||ie!==D)){const _i=ie===D&&ze.id===F;lt.setState(ze,ie,_i)}let Kt=!1;ze.version===mt.__version?(mt.needsLights&&mt.lightsStateVersion!==on.state.version||mt.outputColorSpace!==Rt||be.isBatchedMesh&&mt.batching===!1||!be.isBatchedMesh&&mt.batching===!0||be.isBatchedMesh&&mt.batchingColor===!0&&be.colorTexture===null||be.isBatchedMesh&&mt.batchingColor===!1&&be.colorTexture!==null||be.isInstancedMesh&&mt.instancing===!1||!be.isInstancedMesh&&mt.instancing===!0||be.isSkinnedMesh&&mt.skinning===!1||!be.isSkinnedMesh&&mt.skinning===!0||be.isInstancedMesh&&mt.instancingColor===!0&&be.instanceColor===null||be.isInstancedMesh&&mt.instancingColor===!1&&be.instanceColor!==null||be.isInstancedMesh&&mt.instancingMorph===!0&&be.morphTexture===null||be.isInstancedMesh&&mt.instancingMorph===!1&&be.morphTexture!==null||mt.envMap!==je||ze.fog===!0&&mt.fog!==ft||mt.numClippingPlanes!==void 0&&(mt.numClippingPlanes!==lt.numPlanes||mt.numIntersection!==lt.numIntersection)||mt.vertexAlphas!==Ot||mt.vertexTangents!==Vt||mt.morphTargets!==Pt||mt.morphNormals!==un||mt.morphColors!==Un||mt.toneMapping!==En||mt.morphTargetsCount!==wt)&&(Kt=!0):(Kt=!0,mt.__version=ze.version);let Fn=mt.currentProgram;Kt===!0&&(Fn=qi(ze,Ae,be));let fr=!1,Nn=!1,qn=!1;const yn=Fn.getUniforms(),Qi=mt.uniforms;if(ve.useProgram(Fn.program)&&(fr=!0,Nn=!0,qn=!0),ze.id!==F&&(F=ze.id,Nn=!0),fr||D!==ie){yn.setValue(K,"projectionMatrix",ie.projectionMatrix),yn.setValue(K,"viewMatrix",ie.matrixWorldInverse);const _i=yn.map.cameraPosition;_i!==void 0&&_i.setValue(K,de.setFromMatrixPosition(ie.matrixWorld)),Xe.logarithmicDepthBuffer&&yn.setValue(K,"logDepthBufFC",2/(Math.log(ie.far+1)/Math.LN2)),(ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshLambertMaterial||ze.isMeshBasicMaterial||ze.isMeshStandardMaterial||ze.isShaderMaterial)&&yn.setValue(K,"isOrthographic",ie.isOrthographicCamera===!0),D!==ie&&(D=ie,Nn=!0,qn=!0)}if(be.isSkinnedMesh){yn.setOptional(K,be,"bindMatrix"),yn.setOptional(K,be,"bindMatrixInverse");const _i=be.skeleton;_i&&(_i.boneTexture===null&&_i.computeBoneTexture(),yn.setValue(K,"boneTexture",_i.boneTexture,We))}be.isBatchedMesh&&(yn.setOptional(K,be,"batchingTexture"),yn.setValue(K,"batchingTexture",be._matricesTexture,We),yn.setOptional(K,be,"batchingIdTexture"),yn.setValue(K,"batchingIdTexture",be._indirectTexture,We),yn.setOptional(K,be,"batchingColorTexture"),be._colorsTexture!==null&&yn.setValue(K,"batchingColorTexture",be._colorsTexture,We));const jo=Ue.morphAttributes;if((jo.position!==void 0||jo.normal!==void 0||jo.color!==void 0)&&Ct.update(be,Ue,Fn),(Nn||mt.receiveShadow!==be.receiveShadow)&&(mt.receiveShadow=be.receiveShadow,yn.setValue(K,"receiveShadow",be.receiveShadow)),ze.isMeshGouraudMaterial&&ze.envMap!==null&&(Qi.envMap.value=je,Qi.flipEnvMap.value=je.isCubeTexture&&je.isRenderTargetTexture===!1?-1:1),ze.isMeshStandardMaterial&&ze.envMap===null&&Ae.environment!==null&&(Qi.envMapIntensity.value=Ae.environmentIntensity),Nn&&(yn.setValue(K,"toneMappingExposure",E.toneMappingExposure),mt.needsLights&&Ss(Qi,qn),ft&&ze.fog===!0&&ut.refreshFogUniforms(Qi,ft),ut.refreshMaterialUniforms(Qi,ze,se,ee,_.state.transmissionRenderTarget[ie.id]),i_.upload(K,Ii(mt),Qi,We)),ze.isShaderMaterial&&ze.uniformsNeedUpdate===!0&&(i_.upload(K,Ii(mt),Qi,We),ze.uniformsNeedUpdate=!1),ze.isSpriteMaterial&&yn.setValue(K,"center",be.center),yn.setValue(K,"modelViewMatrix",be.modelViewMatrix),yn.setValue(K,"normalMatrix",be.normalMatrix),yn.setValue(K,"modelMatrix",be.matrixWorld),ze.isShaderMaterial||ze.isRawShaderMaterial){const _i=ze.uniformsGroups;for(let Hi=0,Cr=_i.length;Hi<Cr;Hi++){const fo=_i[Hi];Je.update(fo,Fn),Je.bind(fo,Fn)}}return Fn}function Ss(ie,Ae){ie.ambientLightColor.needsUpdate=Ae,ie.lightProbe.needsUpdate=Ae,ie.directionalLights.needsUpdate=Ae,ie.directionalLightShadows.needsUpdate=Ae,ie.pointLights.needsUpdate=Ae,ie.pointLightShadows.needsUpdate=Ae,ie.spotLights.needsUpdate=Ae,ie.spotLightShadows.needsUpdate=Ae,ie.rectAreaLights.needsUpdate=Ae,ie.hemisphereLights.needsUpdate=Ae}function cc(ie){return ie.isMeshLambertMaterial||ie.isMeshToonMaterial||ie.isMeshPhongMaterial||ie.isMeshStandardMaterial||ie.isShadowMaterial||ie.isShaderMaterial&&ie.lights===!0}this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(ie,Ae,Ue){Ce.get(ie.texture).__webglTexture=Ae,Ce.get(ie.depthTexture).__webglTexture=Ue;const ze=Ce.get(ie);ze.__hasExternalTextures=!0,ze.__autoAllocateDepthBuffer=Ue===void 0,ze.__autoAllocateDepthBuffer||Be.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ze.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(ie,Ae){const Ue=Ce.get(ie);Ue.__webglFramebuffer=Ae,Ue.__useDefaultFramebuffer=Ae===void 0},this.setRenderTarget=function(ie,Ae=0,Ue=0){L=ie,R=Ae,P=Ue;let ze=!0,be=null,ft=!1,At=!1;if(ie){const je=Ce.get(ie);je.__useDefaultFramebuffer!==void 0?(ve.bindFramebuffer(K.FRAMEBUFFER,null),ze=!1):je.__webglFramebuffer===void 0?We.setupRenderTarget(ie):je.__hasExternalTextures&&We.rebindTextures(ie,Ce.get(ie.texture).__webglTexture,Ce.get(ie.depthTexture).__webglTexture);const Ot=ie.texture;(Ot.isData3DTexture||Ot.isDataArrayTexture||Ot.isCompressedArrayTexture)&&(At=!0);const Vt=Ce.get(ie).__webglFramebuffer;ie.isWebGLCubeRenderTarget?(Array.isArray(Vt[Ae])?be=Vt[Ae][Ue]:be=Vt[Ae],ft=!0):ie.samples>0&&We.useMultisampledRTT(ie)===!1?be=Ce.get(ie).__webglMultisampledFramebuffer:Array.isArray(Vt)?be=Vt[Ue]:be=Vt,I.copy(ie.viewport),N.copy(ie.scissor),V=ie.scissorTest}else I.copy(j).multiplyScalar(se).floor(),N.copy(U).multiplyScalar(se).floor(),V=X;if(ve.bindFramebuffer(K.FRAMEBUFFER,be)&&ze&&ve.drawBuffers(ie,be),ve.viewport(I),ve.scissor(N),ve.setScissorTest(V),ft){const je=Ce.get(ie.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,je.__webglTexture,Ue)}else if(At){const je=Ce.get(ie.texture),Ot=Ae||0;K.framebufferTextureLayer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,je.__webglTexture,Ue||0,Ot)}F=-1},this.readRenderTargetPixels=function(ie,Ae,Ue,ze,be,ft,At){if(!(ie&&ie.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Rt=Ce.get(ie).__webglFramebuffer;if(ie.isWebGLCubeRenderTarget&&At!==void 0&&(Rt=Rt[At]),Rt){ve.bindFramebuffer(K.FRAMEBUFFER,Rt);try{const je=ie.texture,Ot=je.format,Vt=je.type;if(!Xe.textureFormatReadable(Ot)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Xe.textureTypeReadable(Vt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ae>=0&&Ae<=ie.width-ze&&Ue>=0&&Ue<=ie.height-be&&K.readPixels(Ae,Ue,ze,be,rt.convert(Ot),rt.convert(Vt),ft)}finally{const je=L!==null?Ce.get(L).__webglFramebuffer:null;ve.bindFramebuffer(K.FRAMEBUFFER,je)}}},this.readRenderTargetPixelsAsync=async function(ie,Ae,Ue,ze,be,ft,At){if(!(ie&&ie.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Rt=Ce.get(ie).__webglFramebuffer;if(ie.isWebGLCubeRenderTarget&&At!==void 0&&(Rt=Rt[At]),Rt){ve.bindFramebuffer(K.FRAMEBUFFER,Rt);try{const je=ie.texture,Ot=je.format,Vt=je.type;if(!Xe.textureFormatReadable(Ot))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Xe.textureTypeReadable(Vt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(Ae>=0&&Ae<=ie.width-ze&&Ue>=0&&Ue<=ie.height-be){const Pt=K.createBuffer();K.bindBuffer(K.PIXEL_PACK_BUFFER,Pt),K.bufferData(K.PIXEL_PACK_BUFFER,ft.byteLength,K.STREAM_READ),K.readPixels(Ae,Ue,ze,be,rt.convert(Ot),rt.convert(Vt),0),K.flush();const un=K.fenceSync(K.SYNC_GPU_COMMANDS_COMPLETE,0);await oG(K,un,4);try{K.bindBuffer(K.PIXEL_PACK_BUFFER,Pt),K.getBufferSubData(K.PIXEL_PACK_BUFFER,0,ft)}finally{K.deleteBuffer(Pt),K.deleteSync(un)}return ft}}finally{const je=L!==null?Ce.get(L).__webglFramebuffer:null;ve.bindFramebuffer(K.FRAMEBUFFER,je)}}},this.copyFramebufferToTexture=function(ie,Ae=null,Ue=0){ie.isTexture!==!0&&(Qp("WebGLRenderer: copyFramebufferToTexture function signature has changed."),Ae=arguments[0]||null,ie=arguments[1]);const ze=Math.pow(2,-Ue),be=Math.floor(ie.image.width*ze),ft=Math.floor(ie.image.height*ze),At=Ae!==null?Ae.x:0,Rt=Ae!==null?Ae.y:0;We.setTexture2D(ie,0),K.copyTexSubImage2D(K.TEXTURE_2D,Ue,0,0,At,Rt,be,ft),ve.unbindTexture()},this.copyTextureToTexture=function(ie,Ae,Ue=null,ze=null,be=0){ie.isTexture!==!0&&(Qp("WebGLRenderer: copyTextureToTexture function signature has changed."),ze=arguments[0]||null,ie=arguments[1],Ae=arguments[2],be=arguments[3]||0,Ue=null);let ft,At,Rt,je,Ot,Vt;Ue!==null?(ft=Ue.max.x-Ue.min.x,At=Ue.max.y-Ue.min.y,Rt=Ue.min.x,je=Ue.min.y):(ft=ie.image.width,At=ie.image.height,Rt=0,je=0),ze!==null?(Ot=ze.x,Vt=ze.y):(Ot=0,Vt=0);const Pt=rt.convert(Ae.format),un=rt.convert(Ae.type);We.setTexture2D(Ae,0),K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,Ae.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ae.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,Ae.unpackAlignment);const Un=K.getParameter(K.UNPACK_ROW_LENGTH),En=K.getParameter(K.UNPACK_IMAGE_HEIGHT),Bn=K.getParameter(K.UNPACK_SKIP_PIXELS),wt=K.getParameter(K.UNPACK_SKIP_ROWS),mt=K.getParameter(K.UNPACK_SKIP_IMAGES),on=ie.isCompressedTexture?ie.mipmaps[be]:ie.image;K.pixelStorei(K.UNPACK_ROW_LENGTH,on.width),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,on.height),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Rt),K.pixelStorei(K.UNPACK_SKIP_ROWS,je),ie.isDataTexture?K.texSubImage2D(K.TEXTURE_2D,be,Ot,Vt,ft,At,Pt,un,on.data):ie.isCompressedTexture?K.compressedTexSubImage2D(K.TEXTURE_2D,be,Ot,Vt,on.width,on.height,Pt,on.data):K.texSubImage2D(K.TEXTURE_2D,be,Ot,Vt,ft,At,Pt,un,on),K.pixelStorei(K.UNPACK_ROW_LENGTH,Un),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,En),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Bn),K.pixelStorei(K.UNPACK_SKIP_ROWS,wt),K.pixelStorei(K.UNPACK_SKIP_IMAGES,mt),be===0&&Ae.generateMipmaps&&K.generateMipmap(K.TEXTURE_2D),ve.unbindTexture()},this.copyTextureToTexture3D=function(ie,Ae,Ue=null,ze=null,be=0){ie.isTexture!==!0&&(Qp("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Ue=arguments[0]||null,ze=arguments[1]||null,ie=arguments[2],Ae=arguments[3],be=arguments[4]||0);let ft,At,Rt,je,Ot,Vt,Pt,un,Un;const En=ie.isCompressedTexture?ie.mipmaps[be]:ie.image;Ue!==null?(ft=Ue.max.x-Ue.min.x,At=Ue.max.y-Ue.min.y,Rt=Ue.max.z-Ue.min.z,je=Ue.min.x,Ot=Ue.min.y,Vt=Ue.min.z):(ft=En.width,At=En.height,Rt=En.depth,je=0,Ot=0,Vt=0),ze!==null?(Pt=ze.x,un=ze.y,Un=ze.z):(Pt=0,un=0,Un=0);const Bn=rt.convert(Ae.format),wt=rt.convert(Ae.type);let mt;if(Ae.isData3DTexture)We.setTexture3D(Ae,0),mt=K.TEXTURE_3D;else if(Ae.isDataArrayTexture||Ae.isCompressedArrayTexture)We.setTexture2DArray(Ae,0),mt=K.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,Ae.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ae.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,Ae.unpackAlignment);const on=K.getParameter(K.UNPACK_ROW_LENGTH),Kt=K.getParameter(K.UNPACK_IMAGE_HEIGHT),Fn=K.getParameter(K.UNPACK_SKIP_PIXELS),fr=K.getParameter(K.UNPACK_SKIP_ROWS),Nn=K.getParameter(K.UNPACK_SKIP_IMAGES);K.pixelStorei(K.UNPACK_ROW_LENGTH,En.width),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,En.height),K.pixelStorei(K.UNPACK_SKIP_PIXELS,je),K.pixelStorei(K.UNPACK_SKIP_ROWS,Ot),K.pixelStorei(K.UNPACK_SKIP_IMAGES,Vt),ie.isDataTexture||ie.isData3DTexture?K.texSubImage3D(mt,be,Pt,un,Un,ft,At,Rt,Bn,wt,En.data):Ae.isCompressedArrayTexture?K.compressedTexSubImage3D(mt,be,Pt,un,Un,ft,At,Rt,Bn,En.data):K.texSubImage3D(mt,be,Pt,un,Un,ft,At,Rt,Bn,wt,En),K.pixelStorei(K.UNPACK_ROW_LENGTH,on),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,Kt),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Fn),K.pixelStorei(K.UNPACK_SKIP_ROWS,fr),K.pixelStorei(K.UNPACK_SKIP_IMAGES,Nn),be===0&&Ae.generateMipmaps&&K.generateMipmap(mt),ve.unbindTexture()},this.initRenderTarget=function(ie){Ce.get(ie).__webglFramebuffer===void 0&&We.setupRenderTarget(ie)},this.initTexture=function(ie){ie.isCubeTexture?We.setTextureCube(ie,0):ie.isData3DTexture?We.setTexture3D(ie,0):ie.isDataArrayTexture||ie.isCompressedArrayTexture?We.setTexture2DArray(ie,0):We.setTexture2D(ie,0),ve.unbindTexture()},this.resetState=function(){R=0,P=0,L=null,ve.reset(),fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Dl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===jS?"display-p3":"srgb",t.unpackColorSpace=On.workingColorSpace===xv?"display-p3":"srgb"}}class JS{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new yt(e),this.density=t}clone(){return new JS(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class qS{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new yt(e),this.near=t,this.far=n}clone(){return new qS(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class pw extends An{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new No,this.environmentIntensity=1,this.environmentRotation=new No,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Tv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=W0,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ko()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Qp("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ko()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ko()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Bs=new ae;class oo{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Bs.fromBufferAttribute(this,t),Bs.applyMatrix4(e),this.setXYZ(t,Bs.x,Bs.y,Bs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Bs.fromBufferAttribute(this,t),Bs.applyNormalMatrix(e),this.setXYZ(t,Bs.x,Bs.y,Bs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Bs.fromBufferAttribute(this,t),Bs.transformDirection(e),this.setXYZ(t,Bs.x,Bs.y,Bs.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Os(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=fn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=fn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=fn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=fn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=fn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Os(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Os(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Os(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Os(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array),i=fn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=fn(t,this.array),n=fn(n,this.array),i=fn(i,this.array),s=fn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Pn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new oo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class mw extends Tr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new yt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ep;const Fg=new ae,Tp=new ae,Mp=new ae,wp=new Qe,kg=new Qe,gF=new Wt,ex=new ae,Og=new ae,tx=new ae,ZR=new Qe,z1=new Qe,eI=new Qe;class vF extends An{constructor(e=new mw){if(super(),this.isSprite=!0,this.type="Sprite",Ep===void 0){Ep=new dn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Tv(t,5);Ep.setIndex([0,1,2,0,2,3]),Ep.setAttribute("position",new oo(n,3,0,!1)),Ep.setAttribute("uv",new oo(n,2,3,!1))}this.geometry=Ep,this.material=e,this.center=new Qe(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Tp.setFromMatrixScale(this.matrixWorld),gF.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Mp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Tp.multiplyScalar(-Mp.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const o=this.center;nx(ex.set(-.5,-.5,0),Mp,o,Tp,i,s),nx(Og.set(.5,-.5,0),Mp,o,Tp,i,s),nx(tx.set(.5,.5,0),Mp,o,Tp,i,s),ZR.set(0,0),z1.set(1,0),eI.set(1,1);let a=e.ray.intersectTriangle(ex,Og,tx,!1,Fg);if(a===null&&(nx(Og.set(-.5,.5,0),Mp,o,Tp,i,s),z1.set(0,1),a=e.ray.intersectTriangle(ex,tx,Og,!1,Fg),a===null))return;const l=e.ray.origin.distanceTo(Fg);l<e.near||l>e.far||t.push({distance:l,point:Fg.clone(),uv:Po.getInterpolation(Fg,ex,Og,tx,ZR,z1,eI,new Qe),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function nx(r,e,t,n,i,s){wp.subVectors(r,t).addScalar(.5).multiply(n),i!==void 0?(kg.x=s*wp.x-i*wp.y,kg.y=i*wp.x+s*wp.y):kg.copy(wp),r.copy(e),r.x+=kg.x,r.y+=kg.y,r.applyMatrix4(gF)}const ix=new ae,tI=new ae;class yF extends An{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ix.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(ix);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ix.setFromMatrixPosition(e.matrixWorld),tI.setFromMatrixPosition(this.matrixWorld);const n=ix.distanceTo(tI)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),n>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,s=n.length;i<s;i++){const o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const nI=new ae,iI=new gn,rI=new gn,x6=new ae,sI=new Wt,rx=new ae,V1=new Yi,oI=new Wt,W1=new ld;class gw extends ui{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=MT,this.bindMatrix=new Wt,this.bindMatrixInverse=new Wt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ni),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,rx),this.boundingBox.expandByPoint(rx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Yi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,rx),this.boundingSphere.expandByPoint(rx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),V1.copy(this.boundingSphere),V1.applyMatrix4(i),e.ray.intersectsSphere(V1)!==!1&&(oI.copy(i).invert(),W1.copy(e.ray).applyMatrix4(oI),!(this.boundingBox!==null&&W1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,W1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===MT?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===GB?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;iI.fromBufferAttribute(i.attributes.skinIndex,e),rI.fromBufferAttribute(i.attributes.skinWeight,e),nI.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=rI.getComponent(s);if(o!==0){const a=iI.getComponent(s);sI.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(x6.copy(nI).applyMatrix4(sI),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class QS extends An{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Nl extends ci{constructor(e=null,t=1,n=1,i,s,o,a,l,u=Er,c=Er,h,d){super(null,o,a,l,u,c,i,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const aI=new Wt,_6=new Wt;class Mv{constructor(e=[],t=[]){this.uuid=ko(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Wt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Wt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:_6;aI.multiplyMatrices(a,t[s]),aI.toArray(n,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new Mv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Nl(t,e,e,ms,ro);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const s=e.bones[n];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new QS),this.bones.push(o),this.boneInverses.push(new Wt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=n[i];e.boneInverses.push(a.toArray())}return e}}class fh extends Pn{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Cp=new Wt,lI=new Wt,sx=[],uI=new Ni,S6=new Wt,Ug=new ui,Ng=new Yi;class vw extends ui{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new fh(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,S6)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ni),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Cp),uI.copy(e.boundingBox).applyMatrix4(Cp),this.boundingBox.union(uI)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Yi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Cp),Ng.copy(e.boundingSphere).applyMatrix4(Cp),this.boundingSphere.union(Ng)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let a=0;a<n.length;a++)n[a]=i[o+a]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Ug.geometry=this.geometry,Ug.material=this.material,Ug.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ng.copy(this.boundingSphere),Ng.applyMatrix4(n),e.ray.intersectsSphere(Ng)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,Cp),lI.multiplyMatrices(n,Cp),Ug.matrixWorld=lI,Ug.raycast(e,sx);for(let o=0,a=sx.length;o<a;o++){const l=sx[o];l.instanceId=s,l.object=this,t.push(l)}sx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new fh(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new Nl(new Float32Array(i*this.count),i,this.count,HS,ro));const s=this.morphTexture.source.data.data;let o=0;for(let u=0;u<n.length;u++)o+=n[u];const a=this.geometry.morphTargetsRelative?1:1-o,l=i*e;s[l]=a,s.set(n,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function A6(r,e){return r.z-e.z}function E6(r,e){return e.z-r.z}class T6{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n){const i=this.pool,s=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const o=i[this.index];s.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=t,o.index=n}reset(){this.list.length=0,this.index=0}}const $c=new Wt,j1=new Wt,M6=new Wt,w6=new yt(1,1,1),cI=new Wt,K1=new Ev,ox=new Ni,uf=new Yi,Gg=new ae,hI=new ae,C6=new ae,$1=new T6,fs=new ui,ax=[];function b6(r,e,t=0){const n=e.itemSize;if(r.isInterleavedBufferAttribute||r.array.constructor!==e.array.constructor){const i=r.count;for(let s=0;s<i;s++)for(let o=0;o<n;o++)e.setComponent(s+t,o,r.getComponent(s,o))}else e.array.set(r.array,t*n);e.needsUpdate=!0}class xF extends ui{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,n=t*2,i){super(new dn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Nl(t,e,e,ms,ro);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Nl(t,e,e,yv,Ju);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxIndexCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Nl(t,e,e,ms,ro);n.colorSpace=On.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:a,itemSize:l,normalized:u}=o,c=new a.constructor(n*l),h=new Pn(c,l,u);t.setAttribute(s,h)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Pn(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),s=t.getAttribute(n);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ni);const e=this._geometryCount,t=this.boundingBox,n=this._drawInfo;t.makeEmpty();for(let i=0;i<e;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,$c),this.getBoundingBoxAt(s,ox).applyMatrix4($c),t.union(ox)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yi);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,$c),this.getBoundingSphereAt(s,uf).applyMatrix4($c),e.union(uf)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const t=this._drawInfo.length-1,n=this._matricesTexture,i=n.image.data;M6.toArray(i,t*16),n.needsUpdate=!0;const s=this._colorsTexture;return s&&(w6.toArray(s.image.data,t*4),s.needsUpdate=!0),t}addGeometry(e,t=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const u=e.getIndex(),c=u!==null;if(c&&(n===-1?i.indexCount=u.count:i.indexCount=n,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const h=this._geometryCount;return this._geometryCount++,o.push(i),a.push({start:c?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Ni,sphereInitialized:!1,sphere:new Yi}),this.setGeometryAt(h,e),h}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,s=n.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,u=a.vertexCount;for(const m in n.attributes){const g=t.getAttribute(m),x=n.getAttribute(m);b6(g,x,l);const _=g.itemSize;for(let S=g.count,T=u;S<T;S++){const E=l+S;for(let C=0;C<_;C++)x.setComponent(E,C,0)}x.needsUpdate=!0,x.addUpdateRange(l*_,u*_)}if(i){const m=a.indexStart;for(let g=0;g<o.count;g++)s.setX(m+g,l+o.getX(g));for(let g=o.count,x=a.indexCount;g<x;g++)s.setX(m+g,l);s.needsUpdate=!0,s.addUpdateRange(m,a.indexCount)}const c=this._bounds[e];t.boundingBox!==null?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,t.boundingSphere!==null?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;const h=this._drawRanges[e],d=t.getAttribute("position");return h.count=i?o.count:d.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this._bounds[e],i=n.box,s=this.geometry;if(n.boxInitialized===!1){i.makeEmpty();const o=s.index,a=s.attributes.position,l=this._drawRanges[e];for(let u=l.start,c=l.start+l.count;u<c;u++){let h=u;o&&(h=o.getX(h)),i.expandByPoint(Gg.fromBufferAttribute(a,h))}n.boxInitialized=!0}return t.copy(i),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this._bounds[e],i=n.sphere,s=this.geometry;if(n.sphereInitialized===!1){i.makeEmpty(),this.getBoundingBoxAt(e,ox),ox.getCenter(i.center);const o=s.index,a=s.attributes.position,l=this._drawRanges[e];let u=0;for(let c=l.start,h=l.start+l.count;c<h;c++){let d=c;o&&(d=o.getX(d)),Gg.fromBufferAttribute(a,d),u=Math.max(u,i.center.distanceToSquared(Gg))}i.radius=Math.sqrt(u),n.sphereInitialized=!0}return t.copy(i),t}setMatrixAt(e,t){const n=this._drawInfo,i=this._matricesTexture,s=this._matricesTexture.image.data;return e>=n.length||n[e].active===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const n=this._drawInfo,i=this._matricesTexture.image.data;return e>=n.length||n[e].active===!1?null:t.fromArray(i,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();const n=this._colorsTexture,i=this._colorsTexture.image.data,s=this._drawInfo;return e>=s.length||s[e].active===!1?this:(t.toArray(i,e*4),n.needsUpdate=!0,this)}getColorAt(e,t){const n=this._colorsTexture.image.data,i=this._drawInfo;return e>=i.length||i[e].active===!1?null:t.fromArray(n,e*4)}setVisibleAt(e,t){const n=this._drawInfo;return e>=n.length||n[e].active===!1||n[e].visible===t?this:(n[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}raycast(e,t){const n=this._drawInfo,i=this._drawRanges,s=this.matrixWorld,o=this.geometry;fs.material=this.material,fs.geometry.index=o.index,fs.geometry.attributes=o.attributes,fs.geometry.boundingBox===null&&(fs.geometry.boundingBox=new Ni),fs.geometry.boundingSphere===null&&(fs.geometry.boundingSphere=new Yi);for(let a=0,l=n.length;a<l;a++){if(!n[a].visible||!n[a].active)continue;const u=n[a].geometryIndex,c=i[u];fs.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(a,fs.matrixWorld).premultiply(s),this.getBoundingBoxAt(u,fs.geometry.boundingBox),this.getBoundingSphereAt(u,fs.geometry.boundingSphere),fs.raycast(e,ax);for(let h=0,d=ax.length;h<d;h++){const m=ax[h];m.object=this,m.batchId=a,t.push(m)}ax.length=0}fs.material=null,fs.geometry.index=null,fs.geometry.attributes={},fs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,n,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._drawInfo,u=this._multiDrawStarts,c=this._multiDrawCounts,h=this._drawRanges,d=this.perObjectFrustumCulled,m=this._indirectTexture,g=m.image.data;d&&(cI.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),K1.setFromProjectionMatrix(cI,e.coordinateSystem));let x=0;if(this.sortObjects){j1.copy(this.matrixWorld).invert(),Gg.setFromMatrixPosition(n.matrixWorld).applyMatrix4(j1),hI.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(j1);for(let T=0,E=l.length;T<E;T++)if(l[T].visible&&l[T].active){const C=l[T].geometryIndex;this.getMatrixAt(T,$c),this.getBoundingSphereAt(C,uf).applyMatrix4($c);let R=!1;if(d&&(R=!K1.intersectsSphere(uf)),!R){const P=C6.subVectors(uf.center,Gg).dot(hI);$1.push(h[C],P,T)}}const _=$1.list,S=this.customSort;S===null?_.sort(s.transparent?E6:A6):S.call(this,_,n);for(let T=0,E=_.length;T<E;T++){const C=_[T];u[x]=C.start*a,c[x]=C.count,g[x]=C.index,x++}$1.reset()}else for(let _=0,S=l.length;_<S;_++)if(l[_].visible&&l[_].active){const T=l[_].geometryIndex;let E=!1;if(d&&(this.getMatrixAt(_,$c),this.getBoundingSphereAt(T,uf).applyMatrix4($c),E=!K1.intersectsSphere(uf)),!E){const C=h[T];u[x]=C.start*a,c[x]=C.count,g[x]=_,x++}}m.needsUpdate=!0,this._multiDrawCount=x,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class xs extends Tr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new yt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Z_=new ae,eS=new ae,fI=new Wt,Hg=new ld,lx=new Yi,X1=new ae,dI=new ae;let qu=class extends An{constructor(e=new dn,t=new xs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,s=t.count;i<s;i++)Z_.fromBufferAttribute(t,i-1),eS.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Z_.distanceTo(eS);e.setAttribute("lineDistance",new Ft(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),lx.copy(n.boundingSphere),lx.applyMatrix4(i),lx.radius+=s,e.ray.intersectsSphere(lx)===!1)return;fI.copy(i).invert(),Hg.copy(e.ray).applyMatrix4(fI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=this.isLineSegments?2:1,c=n.index,d=n.attributes.position;if(c!==null){const m=Math.max(0,o.start),g=Math.min(c.count,o.start+o.count);for(let x=m,_=g-1;x<_;x+=u){const S=c.getX(x),T=c.getX(x+1),E=ux(this,e,Hg,l,S,T);E&&t.push(E)}if(this.isLineLoop){const x=c.getX(g-1),_=c.getX(m),S=ux(this,e,Hg,l,x,_);S&&t.push(S)}}else{const m=Math.max(0,o.start),g=Math.min(d.count,o.start+o.count);for(let x=m,_=g-1;x<_;x+=u){const S=ux(this,e,Hg,l,x,x+1);S&&t.push(S)}if(this.isLineLoop){const x=ux(this,e,Hg,l,g-1,m);x&&t.push(x)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function ux(r,e,t,n,i,s){const o=r.geometry.attributes.position;if(Z_.fromBufferAttribute(o,i),eS.fromBufferAttribute(o,s),t.distanceSqToSegment(Z_,eS,X1,dI)>n)return;X1.applyMatrix4(r.matrixWorld);const l=e.ray.origin.distanceTo(X1);if(!(l<e.near||l>e.far))return{distance:l,point:dI.clone().applyMatrix4(r.matrixWorld),index:i,face:null,faceIndex:null,object:r}}const pI=new ae,mI=new ae;class il extends qu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,s=t.count;i<s;i+=2)pI.fromBufferAttribute(t,i),mI.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+pI.distanceTo(mI);e.setAttribute("lineDistance",new Ft(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class yw extends qu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class ZS extends Tr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new yt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const gI=new Wt,LT=new ld,cx=new Yi,hx=new ae;class xw extends An{constructor(e=new dn,t=new ZS){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cx.copy(n.boundingSphere),cx.applyMatrix4(i),cx.radius+=s,e.ray.intersectsSphere(cx)===!1)return;gI.copy(i).invert(),LT.copy(e.ray).applyMatrix4(gI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=n.index,h=n.attributes.position;if(u!==null){const d=Math.max(0,o.start),m=Math.min(u.count,o.start+o.count);for(let g=d,x=m;g<x;g++){const _=u.getX(g);hx.fromBufferAttribute(h,_),vI(hx,_,l,i,e,t,this)}}else{const d=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);for(let g=d,x=m;g<x;g++)hx.fromBufferAttribute(h,g),vI(hx,g,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function vI(r,e,t,n,i,s,o){const a=LT.distanceSqToPoint(r);if(a<t){const l=new ae;LT.closestPointToPoint(r,l),l.applyMatrix4(n);const u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class _F extends ci{constructor(e,t,n,i,s,o,a,l,u){super(e,t,n,i,s,o,a,l,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:vi,this.magFilter=s!==void 0?s:vi,this.generateMipmaps=!1;const c=this;function h(){c.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class R6 extends ci{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Er,this.minFilter=Er,this.generateMipmaps=!1,this.needsUpdate=!0}}class eA extends ci{constructor(e,t,n,i,s,o,a,l,u,c,h,d){super(null,o,a,l,u,c,i,s,h,d),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class I6 extends eA{constructor(e,t,n,i,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Bo,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class L6 extends eA{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Yu),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class P6 extends ci{constructor(e,t,n,i,s,o,a,l,u){super(e,t,n,i,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class rl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let a=0,l=s-1,u;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),u=n[i]-o,u<0)a=i+1;else if(u>0)l=i-1;else{l=i;break}if(i=l,n[i]===o)return i/(s-1);const c=n[i],d=n[i+1]-c,m=(o-c)/d;return(i+m)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Qe:new ae);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new ae,i=[],s=[],o=[],a=new ae,l=new Wt;for(let m=0;m<=e;m++){const g=m/e;i[m]=this.getTangentAt(g,new ae)}s[0]=new ae,o[0]=new ae;let u=Number.MAX_VALUE;const c=Math.abs(i[0].x),h=Math.abs(i[0].y),d=Math.abs(i[0].z);c<=u&&(u=c,n.set(1,0,0)),h<=u&&(u=h,n.set(0,1,0)),d<=u&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(i[m-1],i[m]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(Oi(i[m-1].dot(i[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,g))}o[m].crossVectors(i[m],s[m])}if(t===!0){let m=Math.acos(Oi(s[0].dot(s[e]),-1,1));m/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(i[g],m*g)),o[g].crossVectors(i[g],s[g])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class tA extends rl{constructor(e=0,t=0,n=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new Qe){const n=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,m=u-this.aY;l=d*c-m*h+this.aX,u=d*h+m*c+this.aY}return n.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class SF extends tA{constructor(e,t,n,i,s,o){super(e,t,n,n,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function _w(){let r=0,e=0,t=0,n=0;function i(s,o,a,l){r=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){i(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,c,h){let d=(o-s)/u-(a-s)/(u+c)+(a-o)/c,m=(a-o)/c-(l-o)/(c+h)+(l-a)/h;d*=c,m*=c,i(o,a,d,m)},calc:function(s){const o=s*s,a=o*s;return r+e*s+t*o+n*a}}}const fx=new ae,Y1=new _w,J1=new _w,q1=new _w;class AF extends rl{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new ae){const n=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,c;this.closed||a>0?u=i[(a-1)%s]:(fx.subVectors(i[0],i[1]).add(i[0]),u=fx);const h=i[a%s],d=i[(a+1)%s];if(this.closed||a+2<s?c=i[(a+2)%s]:(fx.subVectors(i[s-1],i[s-2]).add(i[s-1]),c=fx),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let g=Math.pow(u.distanceToSquared(h),m),x=Math.pow(h.distanceToSquared(d),m),_=Math.pow(d.distanceToSquared(c),m);x<1e-4&&(x=1),g<1e-4&&(g=x),_<1e-4&&(_=x),Y1.initNonuniformCatmullRom(u.x,h.x,d.x,c.x,g,x,_),J1.initNonuniformCatmullRom(u.y,h.y,d.y,c.y,g,x,_),q1.initNonuniformCatmullRom(u.z,h.z,d.z,c.z,g,x,_)}else this.curveType==="catmullrom"&&(Y1.initCatmullRom(u.x,h.x,d.x,c.x,this.tension),J1.initCatmullRom(u.y,h.y,d.y,c.y,this.tension),q1.initCatmullRom(u.z,h.z,d.z,c.z,this.tension));return n.set(Y1.calc(l),J1.calc(l),q1.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new ae().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function yI(r,e,t,n,i){const s=(n-e)*.5,o=(i-t)*.5,a=r*r,l=r*a;return(2*t-2*n+s+o)*l+(-3*t+3*n-2*s-o)*a+s*r+t}function D6(r,e){const t=1-r;return t*t*e}function B6(r,e){return 2*(1-r)*r*e}function F6(r,e){return r*r*e}function x0(r,e,t,n){return D6(r,e)+B6(r,t)+F6(r,n)}function k6(r,e){const t=1-r;return t*t*t*e}function O6(r,e){const t=1-r;return 3*t*t*r*e}function U6(r,e){return 3*(1-r)*r*r*e}function N6(r,e){return r*r*r*e}function _0(r,e,t,n,i){return k6(r,e)+O6(r,t)+U6(r,n)+N6(r,i)}class Sw extends rl{constructor(e=new Qe,t=new Qe,n=new Qe,i=new Qe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Qe){const n=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(_0(e,i.x,s.x,o.x,a.x),_0(e,i.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class EF extends rl{constructor(e=new ae,t=new ae,n=new ae,i=new ae){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ae){const n=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(_0(e,i.x,s.x,o.x,a.x),_0(e,i.y,s.y,o.y,a.y),_0(e,i.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Aw extends rl{constructor(e=new Qe,t=new Qe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Qe){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Qe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class TF extends rl{constructor(e=new ae,t=new ae){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ae){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ae){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ew extends rl{constructor(e=new Qe,t=new Qe,n=new Qe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Qe){const n=t,i=this.v0,s=this.v1,o=this.v2;return n.set(x0(e,i.x,s.x,o.x),x0(e,i.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Tw extends rl{constructor(e=new ae,t=new ae,n=new ae){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ae){const n=t,i=this.v0,s=this.v1,o=this.v2;return n.set(x0(e,i.x,s.x,o.x),x0(e,i.y,s.y,o.y),x0(e,i.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Mw extends rl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Qe){const n=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],u=i[o],c=i[o>i.length-2?i.length-1:o+1],h=i[o>i.length-3?i.length-1:o+2];return n.set(yI(a,l.x,u.x,c.x,h.x),yI(a,l.y,u.y,c.y,h.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Qe().fromArray(i))}return this}}var tS=Object.freeze({__proto__:null,ArcCurve:SF,CatmullRomCurve3:AF,CubicBezierCurve:Sw,CubicBezierCurve3:EF,EllipseCurve:tA,LineCurve:Aw,LineCurve3:TF,QuadraticBezierCurve:Ew,QuadraticBezierCurve3:Tw,SplineCurve:Mw});class MF extends rl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new tS[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const o=i[s]-n,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const c=l[u];n&&n.equals(c)||(t.push(c),n=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new tS[i.type]().fromJSON(i))}return this}}class X0 extends MF{constructor(e){super(),this.type="Path",this.currentPoint=new Qe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Aw(this.currentPoint.clone(),new Qe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new Ew(this.currentPoint.clone(),new Qe(e,t),new Qe(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,o){const a=new Sw(this.currentPoint.clone(),new Qe(e,t),new Qe(n,i),new Qe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Mw(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,i,s,o),this}absarc(e,t,n,i,s,o){return this.absellipse(e,t,n,n,i,s,o),this}ellipse(e,t,n,i,s,o,a,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,n,i,s,o,a,l),this}absellipse(e,t,n,i,s,o,a,l){const u=new tA(e,t,n,i,s,o,a,l);if(this.curves.length>0){const h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class wv extends dn{constructor(e=[new Qe(0,-.5),new Qe(.5,0),new Qe(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Oi(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],u=[],c=1/t,h=new ae,d=new Qe,m=new ae,g=new ae,x=new ae;let _=0,S=0;for(let T=0;T<=e.length-1;T++)switch(T){case 0:_=e[T+1].x-e[T].x,S=e[T+1].y-e[T].y,m.x=S*1,m.y=-_,m.z=S*0,x.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(x.x,x.y,x.z);break;default:_=e[T+1].x-e[T].x,S=e[T+1].y-e[T].y,m.x=S*1,m.y=-_,m.z=S*0,g.copy(m),m.x+=x.x,m.y+=x.y,m.z+=x.z,m.normalize(),l.push(m.x,m.y,m.z),x.copy(g)}for(let T=0;T<=t;T++){const E=n+T*c*i,C=Math.sin(E),R=Math.cos(E);for(let P=0;P<=e.length-1;P++){h.x=e[P].x*C,h.y=e[P].y,h.z=e[P].x*R,o.push(h.x,h.y,h.z),d.x=T/t,d.y=P/(e.length-1),a.push(d.x,d.y);const L=l[3*P+0]*C,F=l[3*P+1],D=l[3*P+0]*R;u.push(L,F,D)}}for(let T=0;T<t;T++)for(let E=0;E<e.length-1;E++){const C=E+T*e.length,R=C,P=C+e.length,L=C+e.length+1,F=C+1;s.push(R,P,F),s.push(L,F,P)}this.setIndex(s),this.setAttribute("position",new Ft(o,3)),this.setAttribute("uv",new Ft(a,2)),this.setAttribute("normal",new Ft(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wv(e.points,e.segments,e.phiStart,e.phiLength)}}class nA extends wv{constructor(e=1,t=1,n=4,i=8){const s=new X0;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new nA(e.radius,e.length,e.capSegments,e.radialSegments)}}class iA extends dn{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new ae,c=new Qe;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,d=3;h<=t;h++,d+=3){const m=n+h/t*i;u.x=e*Math.cos(m),u.y=e*Math.sin(m),o.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(o[d]/e+1)/2,c.y=(o[d+1]/e+1)/2,l.push(c.x,c.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Ft(o,3)),this.setAttribute("normal",new Ft(a,3)),this.setAttribute("uv",new Ft(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iA(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Pm extends dn{constructor(e=1,t=1,n=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;i=Math.floor(i),s=Math.floor(s);const c=[],h=[],d=[],m=[];let g=0;const x=[],_=n/2;let S=0;T(),o===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(c),this.setAttribute("position",new Ft(h,3)),this.setAttribute("normal",new Ft(d,3)),this.setAttribute("uv",new Ft(m,2));function T(){const C=new ae,R=new ae;let P=0;const L=(t-e)/n;for(let F=0;F<=s;F++){const D=[],I=F/s,N=I*(t-e)+e;for(let V=0;V<=i;V++){const q=V/i,Q=q*l+a,re=Math.sin(Q),ee=Math.cos(Q);R.x=N*re,R.y=-I*n+_,R.z=N*ee,h.push(R.x,R.y,R.z),C.set(re,L,ee).normalize(),d.push(C.x,C.y,C.z),m.push(q,1-I),D.push(g++)}x.push(D)}for(let F=0;F<i;F++)for(let D=0;D<s;D++){const I=x[D][F],N=x[D+1][F],V=x[D+1][F+1],q=x[D][F+1];c.push(I,N,q),c.push(N,V,q),P+=6}u.addGroup(S,P,0),S+=P}function E(C){const R=g,P=new Qe,L=new ae;let F=0;const D=C===!0?e:t,I=C===!0?1:-1;for(let V=1;V<=i;V++)h.push(0,_*I,0),d.push(0,I,0),m.push(.5,.5),g++;const N=g;for(let V=0;V<=i;V++){const Q=V/i*l+a,re=Math.cos(Q),ee=Math.sin(Q);L.x=D*ee,L.y=_*I,L.z=D*re,h.push(L.x,L.y,L.z),d.push(0,I,0),P.x=re*.5+.5,P.y=ee*.5*I+.5,m.push(P.x,P.y),g++}for(let V=0;V<i;V++){const q=R+V,Q=N+V;C===!0?c.push(Q,Q+1,q):c.push(Q+1,Q,q),F+=3}u.addGroup(S,F,C===!0?1:2),S+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pm(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class rA extends Pm{constructor(e=1,t=1,n=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,n,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new rA(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class yh extends dn{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const s=[],o=[];a(i),u(n),c(),this.setAttribute("position",new Ft(s,3)),this.setAttribute("normal",new Ft(s.slice(),3)),this.setAttribute("uv",new Ft(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(T){const E=new ae,C=new ae,R=new ae;for(let P=0;P<t.length;P+=3)m(t[P+0],E),m(t[P+1],C),m(t[P+2],R),l(E,C,R,T)}function l(T,E,C,R){const P=R+1,L=[];for(let F=0;F<=P;F++){L[F]=[];const D=T.clone().lerp(C,F/P),I=E.clone().lerp(C,F/P),N=P-F;for(let V=0;V<=N;V++)V===0&&F===P?L[F][V]=D:L[F][V]=D.clone().lerp(I,V/N)}for(let F=0;F<P;F++)for(let D=0;D<2*(P-F)-1;D++){const I=Math.floor(D/2);D%2===0?(d(L[F][I+1]),d(L[F+1][I]),d(L[F][I])):(d(L[F][I+1]),d(L[F+1][I+1]),d(L[F+1][I]))}}function u(T){const E=new ae;for(let C=0;C<s.length;C+=3)E.x=s[C+0],E.y=s[C+1],E.z=s[C+2],E.normalize().multiplyScalar(T),s[C+0]=E.x,s[C+1]=E.y,s[C+2]=E.z}function c(){const T=new ae;for(let E=0;E<s.length;E+=3){T.x=s[E+0],T.y=s[E+1],T.z=s[E+2];const C=_(T)/2/Math.PI+.5,R=S(T)/Math.PI+.5;o.push(C,1-R)}g(),h()}function h(){for(let T=0;T<o.length;T+=6){const E=o[T+0],C=o[T+2],R=o[T+4],P=Math.max(E,C,R),L=Math.min(E,C,R);P>.9&&L<.1&&(E<.2&&(o[T+0]+=1),C<.2&&(o[T+2]+=1),R<.2&&(o[T+4]+=1))}}function d(T){s.push(T.x,T.y,T.z)}function m(T,E){const C=T*3;E.x=e[C+0],E.y=e[C+1],E.z=e[C+2]}function g(){const T=new ae,E=new ae,C=new ae,R=new ae,P=new Qe,L=new Qe,F=new Qe;for(let D=0,I=0;D<s.length;D+=9,I+=6){T.set(s[D+0],s[D+1],s[D+2]),E.set(s[D+3],s[D+4],s[D+5]),C.set(s[D+6],s[D+7],s[D+8]),P.set(o[I+0],o[I+1]),L.set(o[I+2],o[I+3]),F.set(o[I+4],o[I+5]),R.copy(T).add(E).add(C).divideScalar(3);const N=_(R);x(P,I+0,T,N),x(L,I+2,E,N),x(F,I+4,C,N)}}function x(T,E,C,R){R<0&&T.x===1&&(o[E]=T.x-1),C.x===0&&C.z===0&&(o[E]=R/2/Math.PI+.5)}function _(T){return Math.atan2(T.z,-T.x)}function S(T){return Math.atan2(-T.y,Math.sqrt(T.x*T.x+T.z*T.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yh(e.vertices,e.indices,e.radius,e.details)}}class sA extends yh{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sA(e.radius,e.detail)}}const dx=new ae,px=new ae,Q1=new ae,mx=new Po;class wF extends dn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Hf*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,u=[0,0,0],c=["a","b","c"],h=new Array(3),d={},m=[];for(let g=0;g<l;g+=3){o?(u[0]=o.getX(g),u[1]=o.getX(g+1),u[2]=o.getX(g+2)):(u[0]=g,u[1]=g+1,u[2]=g+2);const{a:x,b:_,c:S}=mx;if(x.fromBufferAttribute(a,u[0]),_.fromBufferAttribute(a,u[1]),S.fromBufferAttribute(a,u[2]),mx.getNormal(Q1),h[0]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,h[1]=`${Math.round(_.x*i)},${Math.round(_.y*i)},${Math.round(_.z*i)}`,h[2]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let T=0;T<3;T++){const E=(T+1)%3,C=h[T],R=h[E],P=mx[c[T]],L=mx[c[E]],F=`${C}_${R}`,D=`${R}_${C}`;D in d&&d[D]?(Q1.dot(d[D].normal)<=s&&(m.push(P.x,P.y,P.z),m.push(L.x,L.y,L.z)),d[D]=null):F in d||(d[F]={index0:u[T],index1:u[E],normal:Q1.clone()})}}for(const g in d)if(d[g]){const{index0:x,index1:_}=d[g];dx.fromBufferAttribute(a,x),px.fromBufferAttribute(a,_),m.push(dx.x,dx.y,dx.z),m.push(px.x,px.y,px.z)}this.setAttribute("position",new Ft(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Vf extends X0{constructor(e){super(e),this.uuid=ko(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new X0().fromJSON(i))}return this}}const G6={triangulate:function(r,e,t=2){const n=e&&e.length,i=n?e[0]*t:r.length;let s=CF(r,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,c,h,d,m;if(n&&(s=j6(r,e,s,t)),r.length>80*t){a=u=r[0],l=c=r[1];for(let g=t;g<i;g+=t)h=r[g],d=r[g+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);m=Math.max(u-a,c-l),m=m!==0?32767/m:0}return Y0(s,o,t,a,l,m,0),o}};function CF(r,e,t,n,i){let s,o;if(i===n9(r,e,t,n)>0)for(s=e;s<t;s+=n)o=xI(s,r[s],r[s+1],o);else for(s=t-n;s>=e;s-=n)o=xI(s,r[s],r[s+1],o);return o&&oA(o,o.next)&&(q0(o),o=o.next),o}function td(r,e){if(!r)return r;e||(e=r);let t=r,n;do if(n=!1,!t.steiner&&(oA(t,t.next)||Mi(t.prev,t,t.next)===0)){if(q0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Y0(r,e,t,n,i,s,o){if(!r)return;!o&&s&&J6(r,n,i,s);let a=r,l,u;for(;r.prev!==r.next;){if(l=r.prev,u=r.next,s?z6(r,n,i,s):H6(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(u.i/t|0),q0(r),r=u.next,a=u.next;continue}if(r=u,r===a){o?o===1?(r=V6(td(r),e,t),Y0(r,e,t,n,i,s,2)):o===2&&W6(r,e,t,n,i,s):Y0(td(r),e,t,n,i,s,1);break}}}function H6(r){const e=r.prev,t=r,n=r.next;if(Mi(e,t,n)>=0)return!1;const i=e.x,s=t.x,o=n.x,a=e.y,l=t.y,u=n.y,c=i<s?i<o?i:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=i>s?i>o?i:o:s>o?s:o,m=a>l?a>u?a:u:l>u?l:u;let g=n.next;for(;g!==e;){if(g.x>=c&&g.x<=d&&g.y>=h&&g.y<=m&&Gp(i,a,s,l,o,u,g.x,g.y)&&Mi(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function z6(r,e,t,n){const i=r.prev,s=r,o=r.next;if(Mi(i,s,o)>=0)return!1;const a=i.x,l=s.x,u=o.x,c=i.y,h=s.y,d=o.y,m=a<l?a<u?a:u:l<u?l:u,g=c<h?c<d?c:d:h<d?h:d,x=a>l?a>u?a:u:l>u?l:u,_=c>h?c>d?c:d:h>d?h:d,S=PT(m,g,e,t,n),T=PT(x,_,e,t,n);let E=r.prevZ,C=r.nextZ;for(;E&&E.z>=S&&C&&C.z<=T;){if(E.x>=m&&E.x<=x&&E.y>=g&&E.y<=_&&E!==i&&E!==o&&Gp(a,c,l,h,u,d,E.x,E.y)&&Mi(E.prev,E,E.next)>=0||(E=E.prevZ,C.x>=m&&C.x<=x&&C.y>=g&&C.y<=_&&C!==i&&C!==o&&Gp(a,c,l,h,u,d,C.x,C.y)&&Mi(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;E&&E.z>=S;){if(E.x>=m&&E.x<=x&&E.y>=g&&E.y<=_&&E!==i&&E!==o&&Gp(a,c,l,h,u,d,E.x,E.y)&&Mi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;C&&C.z<=T;){if(C.x>=m&&C.x<=x&&C.y>=g&&C.y<=_&&C!==i&&C!==o&&Gp(a,c,l,h,u,d,C.x,C.y)&&Mi(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function V6(r,e,t){let n=r;do{const i=n.prev,s=n.next.next;!oA(i,s)&&bF(i,n,n.next,s)&&J0(i,s)&&J0(s,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),q0(n),q0(n.next),n=r=s),n=n.next}while(n!==r);return td(n)}function W6(r,e,t,n,i,s){let o=r;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Z6(o,a)){let l=RF(o,a);o=td(o,o.next),l=td(l,l.next),Y0(o,e,t,n,i,s,0),Y0(l,e,t,n,i,s,0);return}a=a.next}o=o.next}while(o!==r)}function j6(r,e,t,n){const i=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:r.length,u=CF(r,a,l,n,!1),u===u.next&&(u.steiner=!0),i.push(Q6(u));for(i.sort(K6),s=0;s<i.length;s++)t=$6(i[s],t);return t}function K6(r,e){return r.x-e.x}function $6(r,e){const t=X6(r,e);if(!t)return e;const n=RF(t,r);return td(n,n.next),td(t,t.next)}function X6(r,e){let t=e,n=-1/0,i;const s=r.x,o=r.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>n&&(n=d,i=t.x<t.next.x?t:t.next,d===s))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,u=i.y;let c=1/0,h;t=i;do s>=t.x&&t.x>=l&&s!==t.x&&Gp(o<u?s:n,o,l,u,o<u?n:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),J0(t,r)&&(h<c||h===c&&(t.x>i.x||t.x===i.x&&Y6(i,t)))&&(i=t,c=h)),t=t.next;while(t!==a);return i}function Y6(r,e){return Mi(r.prev,r,e.prev)<0&&Mi(e.next,r,r.next)<0}function J6(r,e,t,n){let i=r;do i.z===0&&(i.z=PT(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,q6(i)}function q6(r){let e,t,n,i,s,o,a,l,u=1;do{for(t=r,r=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<u&&(a++,n=n.nextZ,!!n);e++);for(l=u;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;t=n}s.nextZ=null,u*=2}while(o>1);return r}function PT(r,e,t,n,i){return r=(r-t)*i|0,e=(e-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function Q6(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function Gp(r,e,t,n,i,s,o,a){return(i-o)*(e-a)>=(r-o)*(s-a)&&(r-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(n-a)}function Z6(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!e9(r,e)&&(J0(r,e)&&J0(e,r)&&t9(r,e)&&(Mi(r.prev,r,e.prev)||Mi(r,e.prev,e))||oA(r,e)&&Mi(r.prev,r,r.next)>0&&Mi(e.prev,e,e.next)>0)}function Mi(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function oA(r,e){return r.x===e.x&&r.y===e.y}function bF(r,e,t,n){const i=vx(Mi(r,e,t)),s=vx(Mi(r,e,n)),o=vx(Mi(t,n,r)),a=vx(Mi(t,n,e));return!!(i!==s&&o!==a||i===0&&gx(r,t,e)||s===0&&gx(r,n,e)||o===0&&gx(t,r,n)||a===0&&gx(t,e,n))}function gx(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function vx(r){return r>0?1:r<0?-1:0}function e9(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&bF(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function J0(r,e){return Mi(r.prev,r,r.next)<0?Mi(r,e,r.next)>=0&&Mi(r,r.prev,e)>=0:Mi(r,e,r.prev)<0||Mi(r,r.next,e)<0}function t9(r,e){let t=r,n=!1;const i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function RF(r,e){const t=new DT(r.i,r.x,r.y),n=new DT(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function xI(r,e,t,n){const i=new DT(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function q0(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function DT(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function n9(r,e,t,n){let i=0;for(let s=e,o=t-n;s<t;s+=n)i+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return i}class Gl{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return n*.5}static isClockWise(e){return Gl.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];_I(e),SI(n,e);let o=e.length;t.forEach(_I);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,SI(n,t[l]);const a=G6.triangulate(n,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function _I(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function SI(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class aA extends dn{constructor(e=new Vf([new Qe(.5,.5),new Qe(-.5,.5),new Qe(-.5,-.5),new Qe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new Ft(i,3)),this.setAttribute("uv",new Ft(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1;let d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:m-.1,x=t.bevelOffset!==void 0?t.bevelOffset:0,_=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,T=t.UVGenerator!==void 0?t.UVGenerator:i9;let E,C=!1,R,P,L,F;S&&(E=S.getSpacedPoints(c),C=!0,d=!1,R=S.computeFrenetFrames(c,!1),P=new ae,L=new ae,F=new ae),d||(_=0,m=0,g=0,x=0);const D=a.extractPoints(u);let I=D.shape;const N=D.holes;if(!Gl.isClockWise(I)){I=I.reverse();for(let K=0,Pe=N.length;K<Pe;K++){const Be=N[K];Gl.isClockWise(Be)&&(N[K]=Be.reverse())}}const q=Gl.triangulateShape(I,N),Q=I;for(let K=0,Pe=N.length;K<Pe;K++){const Be=N[K];I=I.concat(Be)}function re(K,Pe,Be){return Pe||console.error("THREE.ExtrudeGeometry: vec does not exist"),K.clone().addScaledVector(Pe,Be)}const ee=I.length,se=q.length;function W(K,Pe,Be){let Xe,ve,et;const Ce=K.x-Pe.x,We=K.y-Pe.y,te=Be.x-K.x,z=Be.y-K.y,me=Ce*Ce+We*We,_e=Ce*z-We*te;if(Math.abs(_e)>Number.EPSILON){const Ee=Math.sqrt(me),we=Math.sqrt(te*te+z*z),ut=Pe.x-We/Ee,ke=Pe.y+Ce/Ee,Ze=Be.x-z/we,lt=Be.y+te/we,Ye=((Ze-ut)*z-(lt-ke)*te)/(Ce*z-We*te);Xe=ut+Ce*Ye-K.x,ve=ke+We*Ye-K.y;const nt=Xe*Xe+ve*ve;if(nt<=2)return new Qe(Xe,ve);et=Math.sqrt(nt/2)}else{let Ee=!1;Ce>Number.EPSILON?te>Number.EPSILON&&(Ee=!0):Ce<-Number.EPSILON?te<-Number.EPSILON&&(Ee=!0):Math.sign(We)===Math.sign(z)&&(Ee=!0),Ee?(Xe=-We,ve=Ce,et=Math.sqrt(me)):(Xe=Ce,ve=We,et=Math.sqrt(me/2))}return new Qe(Xe/et,ve/et)}const $=[];for(let K=0,Pe=Q.length,Be=Pe-1,Xe=K+1;K<Pe;K++,Be++,Xe++)Be===Pe&&(Be=0),Xe===Pe&&(Xe=0),$[K]=W(Q[K],Q[Be],Q[Xe]);const j=[];let U,X=$.concat();for(let K=0,Pe=N.length;K<Pe;K++){const Be=N[K];U=[];for(let Xe=0,ve=Be.length,et=ve-1,Ce=Xe+1;Xe<ve;Xe++,et++,Ce++)et===ve&&(et=0),Ce===ve&&(Ce=0),U[Xe]=W(Be[Xe],Be[et],Be[Ce]);j.push(U),X=X.concat(U)}for(let K=0;K<_;K++){const Pe=K/_,Be=m*Math.cos(Pe*Math.PI/2),Xe=g*Math.sin(Pe*Math.PI/2)+x;for(let ve=0,et=Q.length;ve<et;ve++){const Ce=re(Q[ve],$[ve],Xe);de(Ce.x,Ce.y,-Be)}for(let ve=0,et=N.length;ve<et;ve++){const Ce=N[ve];U=j[ve];for(let We=0,te=Ce.length;We<te;We++){const z=re(Ce[We],U[We],Xe);de(z.x,z.y,-Be)}}}const le=g+x;for(let K=0;K<ee;K++){const Pe=d?re(I[K],X[K],le):I[K];C?(L.copy(R.normals[0]).multiplyScalar(Pe.x),P.copy(R.binormals[0]).multiplyScalar(Pe.y),F.copy(E[0]).add(L).add(P),de(F.x,F.y,F.z)):de(Pe.x,Pe.y,0)}for(let K=1;K<=c;K++)for(let Pe=0;Pe<ee;Pe++){const Be=d?re(I[Pe],X[Pe],le):I[Pe];C?(L.copy(R.normals[K]).multiplyScalar(Be.x),P.copy(R.binormals[K]).multiplyScalar(Be.y),F.copy(E[K]).add(L).add(P),de(F.x,F.y,F.z)):de(Be.x,Be.y,h/c*K)}for(let K=_-1;K>=0;K--){const Pe=K/_,Be=m*Math.cos(Pe*Math.PI/2),Xe=g*Math.sin(Pe*Math.PI/2)+x;for(let ve=0,et=Q.length;ve<et;ve++){const Ce=re(Q[ve],$[ve],Xe);de(Ce.x,Ce.y,h+Be)}for(let ve=0,et=N.length;ve<et;ve++){const Ce=N[ve];U=j[ve];for(let We=0,te=Ce.length;We<te;We++){const z=re(Ce[We],U[We],Xe);C?de(z.x,z.y+E[c-1].y,E[c-1].x+Be):de(z.x,z.y,h+Be)}}}Z(),oe();function Z(){const K=i.length/3;if(d){let Pe=0,Be=ee*Pe;for(let Xe=0;Xe<se;Xe++){const ve=q[Xe];ye(ve[2]+Be,ve[1]+Be,ve[0]+Be)}Pe=c+_*2,Be=ee*Pe;for(let Xe=0;Xe<se;Xe++){const ve=q[Xe];ye(ve[0]+Be,ve[1]+Be,ve[2]+Be)}}else{for(let Pe=0;Pe<se;Pe++){const Be=q[Pe];ye(Be[2],Be[1],Be[0])}for(let Pe=0;Pe<se;Pe++){const Be=q[Pe];ye(Be[0]+ee*c,Be[1]+ee*c,Be[2]+ee*c)}}n.addGroup(K,i.length/3-K,0)}function oe(){const K=i.length/3;let Pe=0;pe(Q,Pe),Pe+=Q.length;for(let Be=0,Xe=N.length;Be<Xe;Be++){const ve=N[Be];pe(ve,Pe),Pe+=ve.length}n.addGroup(K,i.length/3-K,1)}function pe(K,Pe){let Be=K.length;for(;--Be>=0;){const Xe=Be;let ve=Be-1;ve<0&&(ve=K.length-1);for(let et=0,Ce=c+_*2;et<Ce;et++){const We=ee*et,te=ee*(et+1),z=Pe+Xe+We,me=Pe+ve+We,_e=Pe+ve+te,Ee=Pe+Xe+te;Ge(z,me,_e,Ee)}}}function de(K,Pe,Be){l.push(K),l.push(Pe),l.push(Be)}function ye(K,Pe,Be){Ke(K),Ke(Pe),Ke(Be);const Xe=i.length/3,ve=T.generateTopUV(n,i,Xe-3,Xe-2,Xe-1);De(ve[0]),De(ve[1]),De(ve[2])}function Ge(K,Pe,Be,Xe){Ke(K),Ke(Pe),Ke(Xe),Ke(Pe),Ke(Be),Ke(Xe);const ve=i.length/3,et=T.generateSideWallUV(n,i,ve-6,ve-3,ve-2,ve-1);De(et[0]),De(et[1]),De(et[3]),De(et[1]),De(et[2]),De(et[3])}function Ke(K){i.push(l[K*3+0]),i.push(l[K*3+1]),i.push(l[K*3+2])}function De(K){s.push(K.x),s.push(K.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return r9(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];n.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new tS[i.type]().fromJSON(i)),new aA(n,e.options)}}const i9={generateTopUV:function(r,e,t,n,i){const s=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],u=e[i*3],c=e[i*3+1];return[new Qe(s,o),new Qe(a,l),new Qe(u,c)]},generateSideWallUV:function(r,e,t,n,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[n*3],c=e[n*3+1],h=e[n*3+2],d=e[i*3],m=e[i*3+1],g=e[i*3+2],x=e[s*3],_=e[s*3+1],S=e[s*3+2];return Math.abs(a-c)<Math.abs(o-u)?[new Qe(o,1-l),new Qe(u,1-h),new Qe(d,1-g),new Qe(x,1-S)]:[new Qe(a,1-l),new Qe(c,1-h),new Qe(m,1-g),new Qe(_,1-S)]}};function r9(r,e,t){if(t.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];t.shapes.push(s.uuid)}else t.shapes.push(r.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class lA extends yh{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new lA(e.radius,e.detail)}}class Cv extends yh{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Cv(e.radius,e.detail)}}class uA extends dn{constructor(e=.5,t=1,n=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:s,thetaLength:o},n=Math.max(3,n),i=Math.max(1,i);const a=[],l=[],u=[],c=[];let h=e;const d=(t-e)/i,m=new ae,g=new Qe;for(let x=0;x<=i;x++){for(let _=0;_<=n;_++){const S=s+_/n*o;m.x=h*Math.cos(S),m.y=h*Math.sin(S),l.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,c.push(g.x,g.y)}h+=d}for(let x=0;x<i;x++){const _=x*(n+1);for(let S=0;S<n;S++){const T=S+_,E=T,C=T+n+1,R=T+n+2,P=T+1;a.push(E,C,P),a.push(C,R,P)}}this.setIndex(a),this.setAttribute("position",new Ft(l,3)),this.setAttribute("normal",new Ft(u,3)),this.setAttribute("uv",new Ft(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uA(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class cA extends dn{constructor(e=new Vf([new Qe(0,.5),new Qe(-.5,-.5),new Qe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let c=0;c<e.length;c++)u(e[c]),this.addGroup(a,l,c),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new Ft(i,3)),this.setAttribute("normal",new Ft(s,3)),this.setAttribute("uv",new Ft(o,2));function u(c){const h=i.length/3,d=c.extractPoints(t);let m=d.shape;const g=d.holes;Gl.isClockWise(m)===!1&&(m=m.reverse());for(let _=0,S=g.length;_<S;_++){const T=g[_];Gl.isClockWise(T)===!0&&(g[_]=T.reverse())}const x=Gl.triangulateShape(m,g);for(let _=0,S=g.length;_<S;_++){const T=g[_];m=m.concat(T)}for(let _=0,S=m.length;_<S;_++){const T=m[_];i.push(T.x,T.y,0),s.push(0,0,1),o.push(T.x,T.y)}for(let _=0,S=x.length;_<S;_++){const T=x[_],E=T[0]+h,C=T[1]+h,R=T[2]+h;n.push(E,C,R),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return s9(t,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];n.push(o)}return new cA(n,e.curveSegments)}}function s9(r,e){if(e.shapes=[],Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const i=r[t];e.shapes.push(i.uuid)}else e.shapes.push(r.uuid);return e}class bv extends dn{constructor(e=1,t=32,n=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let u=0;const c=[],h=new ae,d=new ae,m=[],g=[],x=[],_=[];for(let S=0;S<=n;S++){const T=[],E=S/n;let C=0;S===0&&o===0?C=.5/t:S===n&&l===Math.PI&&(C=-.5/t);for(let R=0;R<=t;R++){const P=R/t;h.x=-e*Math.cos(i+P*s)*Math.sin(o+E*a),h.y=e*Math.cos(o+E*a),h.z=e*Math.sin(i+P*s)*Math.sin(o+E*a),g.push(h.x,h.y,h.z),d.copy(h).normalize(),x.push(d.x,d.y,d.z),_.push(P+C,1-E),T.push(u++)}c.push(T)}for(let S=0;S<n;S++)for(let T=0;T<t;T++){const E=c[S][T+1],C=c[S][T],R=c[S+1][T],P=c[S+1][T+1];(S!==0||o>0)&&m.push(E,C,P),(S!==n-1||l<Math.PI)&&m.push(C,R,P)}this.setIndex(m),this.setAttribute("position",new Ft(g,3)),this.setAttribute("normal",new Ft(x,3)),this.setAttribute("uv",new Ft(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bv(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class hA extends yh{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hA(e.radius,e.detail)}}class fA extends dn{constructor(e=1,t=.4,n=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:s},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],u=[],c=new ae,h=new ae,d=new ae;for(let m=0;m<=n;m++)for(let g=0;g<=i;g++){const x=g/i*s,_=m/n*Math.PI*2;h.x=(e+t*Math.cos(_))*Math.cos(x),h.y=(e+t*Math.cos(_))*Math.sin(x),h.z=t*Math.sin(_),a.push(h.x,h.y,h.z),c.x=e*Math.cos(x),c.y=e*Math.sin(x),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(g/i),u.push(m/n)}for(let m=1;m<=n;m++)for(let g=1;g<=i;g++){const x=(i+1)*m+g-1,_=(i+1)*(m-1)+g-1,S=(i+1)*(m-1)+g,T=(i+1)*m+g;o.push(x,_,T),o.push(_,S,T)}this.setIndex(o),this.setAttribute("position",new Ft(a,3)),this.setAttribute("normal",new Ft(l,3)),this.setAttribute("uv",new Ft(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fA(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class dA extends dn{constructor(e=1,t=.4,n=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:s,q:o},n=Math.floor(n),i=Math.floor(i);const a=[],l=[],u=[],c=[],h=new ae,d=new ae,m=new ae,g=new ae,x=new ae,_=new ae,S=new ae;for(let E=0;E<=n;++E){const C=E/n*s*Math.PI*2;T(C,s,o,e,m),T(C+.01,s,o,e,g),_.subVectors(g,m),S.addVectors(g,m),x.crossVectors(_,S),S.crossVectors(x,_),x.normalize(),S.normalize();for(let R=0;R<=i;++R){const P=R/i*Math.PI*2,L=-t*Math.cos(P),F=t*Math.sin(P);h.x=m.x+(L*S.x+F*x.x),h.y=m.y+(L*S.y+F*x.y),h.z=m.z+(L*S.z+F*x.z),l.push(h.x,h.y,h.z),d.subVectors(h,m).normalize(),u.push(d.x,d.y,d.z),c.push(E/n),c.push(R/i)}}for(let E=1;E<=n;E++)for(let C=1;C<=i;C++){const R=(i+1)*(E-1)+(C-1),P=(i+1)*E+(C-1),L=(i+1)*E+C,F=(i+1)*(E-1)+C;a.push(R,P,F),a.push(P,L,F)}this.setIndex(a),this.setAttribute("position",new Ft(l,3)),this.setAttribute("normal",new Ft(u,3)),this.setAttribute("uv",new Ft(c,2));function T(E,C,R,P,L){const F=Math.cos(E),D=Math.sin(E),I=R/C*E,N=Math.cos(I);L.x=P*(2+N)*.5*F,L.y=P*(2+N)*D*.5,L.z=P*Math.sin(I)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dA(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class pA extends dn{constructor(e=new Tw(new ae(-1,-1,0),new ae(-1,1,0),new ae(1,1,0)),t=64,n=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ae,l=new ae,u=new Qe;let c=new ae;const h=[],d=[],m=[],g=[];x(),this.setIndex(g),this.setAttribute("position",new Ft(h,3)),this.setAttribute("normal",new Ft(d,3)),this.setAttribute("uv",new Ft(m,2));function x(){for(let E=0;E<t;E++)_(E);_(s===!1?t:0),T(),S()}function _(E){c=e.getPointAt(E/t,c);const C=o.normals[E],R=o.binormals[E];for(let P=0;P<=i;P++){const L=P/i*Math.PI*2,F=Math.sin(L),D=-Math.cos(L);l.x=D*C.x+F*R.x,l.y=D*C.y+F*R.y,l.z=D*C.z+F*R.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=c.x+n*l.x,a.y=c.y+n*l.y,a.z=c.z+n*l.z,h.push(a.x,a.y,a.z)}}function S(){for(let E=1;E<=t;E++)for(let C=1;C<=i;C++){const R=(i+1)*(E-1)+(C-1),P=(i+1)*E+(C-1),L=(i+1)*E+C,F=(i+1)*(E-1)+C;g.push(R,P,F),g.push(P,L,F)}}function T(){for(let E=0;E<=t;E++)for(let C=0;C<=i;C++)u.x=E/t,u.y=C/i,m.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new pA(new tS[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class ww extends dn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new ae,s=new ae;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,c=l.length;u<c;++u){const h=l[u],d=h.start,m=h.count;for(let g=d,x=d+m;g<x;g+=3)for(let _=0;_<3;_++){const S=a.getX(g+_),T=a.getX(g+(_+1)%3);i.fromBufferAttribute(o,S),s.fromBufferAttribute(o,T),AI(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const c=3*a+u,h=3*a+(u+1)%3;i.fromBufferAttribute(o,c),s.fromBufferAttribute(o,h),AI(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ft(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function AI(r,e,t){const n=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var EI=Object.freeze({__proto__:null,BoxGeometry:ud,CapsuleGeometry:nA,CircleGeometry:iA,ConeGeometry:rA,CylinderGeometry:Pm,DodecahedronGeometry:sA,EdgesGeometry:wF,ExtrudeGeometry:aA,IcosahedronGeometry:lA,LatheGeometry:wv,OctahedronGeometry:Cv,PlaneGeometry:sc,PolyhedronGeometry:yh,RingGeometry:uA,ShapeGeometry:cA,SphereGeometry:bv,TetrahedronGeometry:hA,TorusGeometry:fA,TorusKnotGeometry:dA,TubeGeometry:pA,WireframeGeometry:ww});class IF extends Tr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new yt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class LF extends Go{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Rv extends Tr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new yt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vh,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new No,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class va extends Rv{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Qe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Oi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new yt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new yt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new yt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class PF extends Tr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new yt(16777215),this.specular=new yt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vh,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new No,this.combine=vv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class DF extends Tr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new yt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vh,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class BF extends Tr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vh,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class FF extends Tr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new yt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vh,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new No,this.combine=vv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class kF extends Tr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new yt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vh,this.normalScale=new Qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class OF extends xs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Bf(r,e,t){return!r||!t&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function UF(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function NF(r){function e(i,s){return r[i]-r[s]}const t=r.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function BT(r,e,t){const n=r.length,i=new r.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=r[a+l]}return i}function Cw(r,e,t,n){let i=1,s=r[0];for(;s!==void 0&&s[n]===void 0;)s=r[i++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=r[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=r[i++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=r[i++];while(s!==void 0)}function o9(r,e,t,n,i=30){const s=r.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],c=u.getValueSize(),h=[],d=[];for(let m=0;m<u.times.length;++m){const g=u.times[m]*i;if(!(g<t||g>=n)){h.push(u.times[m]);for(let x=0;x<c;++x)d.push(u.values[m*c+x])}}h.length!==0&&(u.times=Bf(h,u.times.constructor),u.values=Bf(d,u.values.constructor),o.push(u))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function a9(r,e=0,t=r,n=30){n<=0&&(n=30);const i=t.tracks.length,s=e/n;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const u=r.tracks.find(function(S){return S.name===a.name&&S.ValueTypeName===l});if(u===void 0)continue;let c=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=h/3);let d=0;const m=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);const g=a.times.length-1;let x;if(s<=a.times[0]){const S=c,T=h-c;x=a.values.slice(S,T)}else if(s>=a.times[g]){const S=g*h+c,T=S+h-c;x=a.values.slice(S,T)}else{const S=a.createInterpolant(),T=c,E=h-c;S.evaluate(s),x=S.resultBuffer.slice(T,E)}l==="quaternion"&&new Nr().fromArray(x).normalize().conjugate().toArray(x);const _=u.times.length;for(let S=0;S<_;++S){const T=S*m+d;if(l==="quaternion")Nr.multiplyQuaternionsFlat(u.values,T,x,0,u.values,T);else{const E=m-d*2;for(let C=0;C<E;++C)u.values[T+C]-=x[C]}}}return r.blendMode=rw,r}const l9={convertArray:Bf,isTypedArray:UF,getKeyframeOrder:NF,sortedArray:BT,flattenJSON:Cw,subclip:o9,makeClipAdditive:a9};class Dm{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<i)){for(let a=n+2;;){if(i===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=i,i=t[++n],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(i=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(i=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class GF extends Dm{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Lf,endingEnd:Lf}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case Pf:s=e,a=2*t-n;break;case G0:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case Pf:o=e,l=2*n-t;break;case G0:o=1,l=n+i[1]-i[0];break;default:o=e-1,l=t}const u=(n-t)*.5,c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-n),this._offsetPrev=s*c,this._offsetNext=o*c}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,m=this._weightNext,g=(n-t)/(i-t),x=g*g,_=x*g,S=-d*_+2*d*x-d*g,T=(1+d)*_+(-1.5-2*d)*x+(-.5+d)*g+1,E=(-1-m)*_+(1.5+m)*x+.5*g,C=m*_-m*x;for(let R=0;R!==a;++R)s[R]=S*o[c+R]+T*o[u+R]+E*o[l+R]+C*o[h+R];return s}}class bw extends Dm{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=(n-t)/(i-t),h=1-c;for(let d=0;d!==a;++d)s[d]=o[u+d]*h+o[l+d]*c;return s}}class HF extends Dm{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class sl{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Bf(t,this.TimeBufferType),this.values=Bf(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Bf(e.times,Array),values:Bf(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new HF(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new bw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new GF(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case um:t=this.InterpolantFactoryMethodDiscrete;break;case cm:t=this.InterpolantFactoryMethodLinear;break;case n_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return um;case this.InterpolantFactoryMethodLinear:return cm;case this.InterpolantFactoryMethodSmooth:return n_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,o=i-1;for(;s!==i&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&UF(i))for(let a=0,l=i.length;a!==l;++a){const u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===n_,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],c=e[a+1];if(u!==c&&(a!==1||u!==e[0]))if(i)l=!0;else{const h=a*n,d=h-n,m=h+n;for(let g=0;g!==n;++g){const x=t[h+g];if(x!==t[d+g]||x!==t[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*n,d=o*n;for(let m=0;m!==n;++m)t[d+m]=t[h+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,u=0;u!==n;++u)t[l+u]=t[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}sl.prototype.TimeBufferType=Float32Array;sl.prototype.ValueBufferType=Float32Array;sl.prototype.DefaultInterpolation=cm;class cd extends sl{constructor(e,t,n){super(e,t,n)}}cd.prototype.ValueTypeName="bool";cd.prototype.ValueBufferType=Array;cd.prototype.DefaultInterpolation=um;cd.prototype.InterpolantFactoryMethodLinear=void 0;cd.prototype.InterpolantFactoryMethodSmooth=void 0;class Rw extends sl{}Rw.prototype.ValueTypeName="color";class nd extends sl{}nd.prototype.ValueTypeName="number";class zF extends Dm{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(i-t);let u=e*a;for(let c=u+a;u!==c;u+=4)Nr.slerpFlat(s,0,o,u-a,o,u,l);return s}}class id extends sl{InterpolantFactoryMethodLinear(e){return new zF(this.times,this.values,this.getValueSize(),e)}}id.prototype.ValueTypeName="quaternion";id.prototype.InterpolantFactoryMethodSmooth=void 0;class hd extends sl{constructor(e,t,n){super(e,t,n)}}hd.prototype.ValueTypeName="string";hd.prototype.ValueBufferType=Array;hd.prototype.DefaultInterpolation=um;hd.prototype.InterpolantFactoryMethodLinear=void 0;hd.prototype.InterpolantFactoryMethodSmooth=void 0;class rd extends sl{}rd.prototype.ValueTypeName="vector";class dm{constructor(e="",t=-1,n=[],i=WS){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=ko(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(c9(n[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(sl.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const c=NF(l);l=BT(l,1,c),u=BT(u,1,c),!i&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new nd(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],c=u.name.match(s);if(c&&c.length>1){const h=c[1];let d=i[h];d||(i[h]=d=[]),d.push(u)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(h,d,m,g,x){if(m.length!==0){const _=[],S=[];Cw(m,_,S,g),_.length!==0&&x.push(new h(d,_,S))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let h=0;h<u.length;h++){const d=u[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const m={};let g;for(g=0;g<d.length;g++)if(d[g].morphTargets)for(let x=0;x<d[g].morphTargets.length;x++)m[d[g].morphTargets[x]]=-1;for(const x in m){const _=[],S=[];for(let T=0;T!==d[g].morphTargets.length;++T){const E=d[g];_.push(E.time),S.push(E.morphTarget===x?1:0)}i.push(new nd(".morphTargetInfluence["+x+"]",_,S))}l=m.length*o}else{const m=".bones["+t[h].name+"]";n(rd,m+".position",d,"pos",i),n(id,m+".quaternion",d,"rot",i),n(rd,m+".scale",d,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function u9(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nd;case"vector":case"vector2":case"vector3":case"vector4":return rd;case"color":return Rw;case"quaternion":return id;case"bool":case"boolean":return cd;case"string":return hd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function c9(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=u9(r.type);if(r.times===void 0){const t=[],n=[];Cw(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const Hu={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class Iw{constructor(e,t,n){const i=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(c){a++,s===!1&&i.onStart!==void 0&&i.onStart(c,o,a),s=!0},this.itemEnd=function(c){o++,i.onProgress!==void 0&&i.onProgress(c,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,d=u.length;h<d;h+=2){const m=u[h],g=u[h+1];if(m.global&&(m.lastIndex=0),m.test(c))return g}return null}}}const Hp=new Iw;class _s{constructor(e){this.manager=e!==void 0?e:Hp,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,s){n.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}_s.DEFAULT_MATERIAL_NAME="__DEFAULT";const bu={};class h9 extends Error{constructor(e,t){super(e),this.response=t}}class Ho extends _s{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Hu.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(bu[e]!==void 0){bu[e].push({onLoad:t,onProgress:n,onError:i});return}bu[e]=[],bu[e].push({onLoad:t,onProgress:n,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=bu[e],h=u.body.getReader(),d=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),m=d?parseInt(d):0,g=m!==0;let x=0;const _=new ReadableStream({start(S){T();function T(){h.read().then(({done:E,value:C})=>{if(E)S.close();else{x+=C.byteLength;const R=new ProgressEvent("progress",{lengthComputable:g,loaded:x,total:m});for(let P=0,L=c.length;P<L;P++){const F=c[P];F.onProgress&&F.onProgress(R)}S.enqueue(C),T()}},E=>{S.error(E)})}}});return new Response(_)}else throw new h9(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return u.json();default:if(a===void 0)return u.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,m=new TextDecoder(d);return u.arrayBuffer().then(g=>m.decode(g))}}}).then(u=>{Hu.add(e,u);const c=bu[e];delete bu[e];for(let h=0,d=c.length;h<d;h++){const m=c[h];m.onLoad&&m.onLoad(u)}}).catch(u=>{const c=bu[e];if(c===void 0)throw this.manager.itemError(e),u;delete bu[e];for(let h=0,d=c.length;h<d;h++){const m=c[h];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class f9 extends _s{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Ho(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=dm.parse(e[n]);t.push(i)}return t}}class d9 extends _s{constructor(e){super(e)}load(e,t,n,i){const s=this,o=[],a=new eA,l=new Ho(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function c(h){l.load(e[h],function(d){const m=s.parse(d,!0);o[h]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},u+=1,u===6&&(m.mipmapCount===1&&(a.minFilter=vi),a.image=o,a.format=m.format,a.needsUpdate=!0,t&&t(a))},n,i)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)c(h);else l.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const m=d.mipmaps.length/d.mipmapCount;for(let g=0;g<m;g++){o[g]={mipmaps:[]};for(let x=0;x<d.mipmapCount;x++)o[g].mipmaps.push(d.mipmaps[g*d.mipmapCount+x]),o[g].format=d.format,o[g].width=d.width,o[g].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=vi),a.format=d.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}class Q0 extends _s{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Hu.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=K0("img");function l(){c(),Hu.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(h){c(),i&&i(h),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class p9 extends _s{constructor(e){super(e)}load(e,t,n,i){const s=new Av;s.colorSpace=fa;const o=new Q0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(u){o.load(e[u],function(c){s.images[u]=c,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let u=0;u<e.length;++u)l(u);return s}}class m9 extends _s{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Nl,a=new Ho(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let u;try{u=s.parse(l)}catch(c){if(i!==void 0)i(c);else{console.error(c);return}}u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:Bo,o.wrapT=u.wrapT!==void 0?u.wrapT:Bo,o.magFilter=u.magFilter!==void 0?u.magFilter:vi,o.minFilter=u.minFilter!==void 0?u.minFilter:vi,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(o.colorSpace=u.colorSpace),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=da),u.mipmapCount===1&&(o.minFilter=vi),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,t&&t(o,u)},n,i),o}}class VF extends _s{constructor(e){super(e)}load(e,t,n,i){const s=new ci,o=new Q0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,i),s}}class xh extends An{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new yt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class WF extends xh{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(An.DEFAULT_UP),this.updateMatrix(),this.groundColor=new yt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Z1=new Wt,TI=new ae,MI=new ae;class Lw{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Qe(512,512),this.map=null,this.mapPass=null,this.matrix=new Wt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ev,this._frameExtents=new Qe(1,1),this._viewportCount=1,this._viewports=[new gn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;TI.setFromMatrixPosition(e.matrixWorld),t.position.copy(TI),MI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(MI),t.updateMatrixWorld(),Z1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Z1),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Z1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class g9 extends Lw{constructor(){super(new mi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=hm*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Pw extends xh{constructor(e,t,n=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(An.DEFAULT_UP),this.updateMatrix(),this.target=new An,this.distance=n,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new g9}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const wI=new Wt,zg=new ae,eE=new ae;class v9 extends Lw{constructor(){super(new mi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Qe(4,2),this._viewportCount=6,this._viewports=[new gn(2,1,1,1),new gn(0,1,1,1),new gn(3,1,1,1),new gn(1,1,1,1),new gn(3,0,1,1),new gn(1,0,1,1)],this._cubeDirections=[new ae(1,0,0),new ae(-1,0,0),new ae(0,0,1),new ae(0,0,-1),new ae(0,1,0),new ae(0,-1,0)],this._cubeUps=[new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,0,1),new ae(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),zg.setFromMatrixPosition(e.matrixWorld),n.position.copy(zg),eE.copy(n.position),eE.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(eE),n.updateMatrixWorld(),i.makeTranslation(-zg.x,-zg.y,-zg.z),wI.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wI)}}class Dw extends xh{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new v9}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class y9 extends Lw{constructor(){super(new Qa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Bw extends xh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(An.DEFAULT_UP),this.updateMatrix(),this.target=new An,this.shadow=new y9}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class jF extends xh{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class KF extends xh{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class $F{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ae)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}class XF extends xh{constructor(e=new $F,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class mA extends _s{constructor(e){super(e),this.textures={}}load(e,t,n,i){const s=this,o=new Ho(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=mA.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new yt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=n(o.value);break;case"c":i.uniforms[s].value=new yt().setHex(o.value);break;case"v2":i.uniforms[s].value=new Qe().fromArray(o.value);break;case"v3":i.uniforms[s].value=new ae().fromArray(o.value);break;case"v4":i.uniforms[s].value=new gn().fromArray(o.value);break;case"m3":i.uniforms[s].value=new ln().fromArray(o.value);break;case"m4":i.uniforms[s].value=new Wt().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Qe().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Qe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:IF,SpriteMaterial:mw,RawShaderMaterial:LF,ShaderMaterial:Go,PointsMaterial:ZS,MeshPhysicalMaterial:va,MeshStandardMaterial:Rv,MeshPhongMaterial:PF,MeshToonMaterial:DF,MeshNormalMaterial:BF,MeshLambertMaterial:FF,MeshDepthMaterial:XS,MeshDistanceMaterial:YS,MeshBasicMaterial:so,MeshMatcapMaterial:kF,LineDashedMaterial:OF,LineBasicMaterial:xs,Material:Tr};return new t[e]}}class ah{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class gA extends dn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class YF extends _s{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Ho(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(m,g){if(t[g]!==void 0)return t[g];const _=m.interleavedBuffers[g],S=s(m,_.buffer),T=Up(_.type,S),E=new Tv(T,_.stride);return E.uuid=_.uuid,t[g]=E,E}function s(m,g){if(n[g]!==void 0)return n[g];const _=m.arrayBuffers[g],S=new Uint32Array(_).buffer;return n[g]=S,S}const o=e.isInstancedBufferGeometry?new gA:new dn,a=e.data.index;if(a!==void 0){const m=Up(a.type,a.array);o.setIndex(new Pn(m,1))}const l=e.data.attributes;for(const m in l){const g=l[m];let x;if(g.isInterleavedBufferAttribute){const _=i(e.data,g.data);x=new oo(_,g.itemSize,g.offset,g.normalized)}else{const _=Up(g.type,g.array),S=g.isInstancedBufferAttribute?fh:Pn;x=new S(_,g.itemSize,g.normalized)}g.name!==void 0&&(x.name=g.name),g.usage!==void 0&&x.setUsage(g.usage),o.setAttribute(m,x)}const u=e.data.morphAttributes;if(u)for(const m in u){const g=u[m],x=[];for(let _=0,S=g.length;_<S;_++){const T=g[_];let E;if(T.isInterleavedBufferAttribute){const C=i(e.data,T.data);E=new oo(C,T.itemSize,T.offset,T.normalized)}else{const C=Up(T.type,T.array);E=new Pn(C,T.itemSize,T.normalized)}T.name!==void 0&&(E.name=T.name),x.push(E)}o.morphAttributes[m]=x}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let m=0,g=h.length;m!==g;++m){const x=h[m];o.addGroup(x.start,x.count,x.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const m=new ae;d.center!==void 0&&m.fromArray(d.center),o.boundingSphere=new Yi(m,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class x9 extends _s{constructor(e){super(e)}load(e,t,n,i){const s=this,o=this.path===""?ah.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Ho(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(h){i!==void 0&&i(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const c=u.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?ah.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Ho(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(u)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,s,l,a,n),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),this.bindLightTargets(u),t!==void 0){let h=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){h=!0;break}h===!1&&t(u)}return u}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const s=new Vf().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new Mv().fromJSON(e[s],i);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new YF;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in EI?a=EI[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const s=new mA;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),i[l.uuid]=n[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],s=dm.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const n=this,i={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const u=l,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:n.resourcePath+u;return o(c)}else return l.data?{data:Up(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new Iw(t);s=new Q0(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,c=e.length;u<c;u++){const h=e[u],d=h.url;if(Array.isArray(d)){const m=[];for(let g=0,x=d.length;g<x;g++){const _=d[g],S=a(_);S!==null&&(S instanceof HTMLImageElement?m.push(S):m.push(new Nl(S.data,S.width,S.height)))}i[h.uuid]=new Df(m)}else{const m=a(h.url);i[h.uuid]=new Df(m)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:Up(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new Q0(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],u=l.url;if(Array.isArray(u)){const c=[];for(let h=0,d=u.length;h<d;h++){const m=u[h],g=await s(m);g!==null&&(g instanceof HTMLImageElement?c.push(g):c.push(new Nl(g.data,g.width,g.height)))}n[l.uuid]=new Df(c)}else{const c=await s(l.url);n[l.uuid]=new Df(c)}}}return n}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],u=l.data;let c;Array.isArray(u)?(c=new Av,u.length===6&&(c.needsUpdate=!0)):(u&&u.data?c=new Nl:c=new ci,u&&(c.needsUpdate=!0)),c.source=l,c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.mapping!==void 0&&(c.mapping=n(a.mapping,_9)),a.channel!==void 0&&(c.channel=a.channel),a.offset!==void 0&&c.offset.fromArray(a.offset),a.repeat!==void 0&&c.repeat.fromArray(a.repeat),a.center!==void 0&&c.center.fromArray(a.center),a.rotation!==void 0&&(c.rotation=a.rotation),a.wrap!==void 0&&(c.wrapS=n(a.wrap[0],CI),c.wrapT=n(a.wrap[1],CI)),a.format!==void 0&&(c.format=a.format),a.internalFormat!==void 0&&(c.internalFormat=a.internalFormat),a.type!==void 0&&(c.type=a.type),a.colorSpace!==void 0&&(c.colorSpace=a.colorSpace),a.minFilter!==void 0&&(c.minFilter=n(a.minFilter,bI)),a.magFilter!==void 0&&(c.magFilter=n(a.magFilter,bI)),a.anisotropy!==void 0&&(c.anisotropy=a.anisotropy),a.flipY!==void 0&&(c.flipY=a.flipY),a.generateMipmaps!==void 0&&(c.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(c.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(c.compareFunction=a.compareFunction),a.userData!==void 0&&(c.userData=a.userData),i[a.uuid]=c}return i}parseObject(e,t,n,i,s){let o;function a(d){return t[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const m=[];for(let g=0,x=d.length;g<x;g++){const _=d[g];n[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),m.push(n[_])}return m}return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),n[d]}}function u(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),i[d]}let c,h;switch(e.type){case"Scene":o=new pw,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new yt(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new qS(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new JS(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new mi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Qa(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new jF(e.color,e.intensity);break;case"DirectionalLight":o=new Bw(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Dw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new KF(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Pw(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new WF(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new XF().fromJSON(e);break;case"SkinnedMesh":c=a(e.geometry),h=l(e.material),o=new gw(c,h),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":c=a(e.geometry),h=l(e.material),o=new ui(c,h);break;case"InstancedMesh":c=a(e.geometry),h=l(e.material);const d=e.count,m=e.instanceMatrix,g=e.instanceColor;o=new vw(c,h,d),o.instanceMatrix=new fh(new Float32Array(m.array),16),g!==void 0&&(o.instanceColor=new fh(new Float32Array(g.array),g.itemSize));break;case"BatchedMesh":c=a(e.geometry),h=l(e.material),o=new xF(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,h),o.geometry=c,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(x=>{const _=new Ni;_.min.fromArray(x.boxMin),_.max.fromArray(x.boxMax);const S=new Yi;return S.radius=x.sphereRadius,S.center.fromArray(x.sphereCenter),{boxInitialized:x.boxInitialized,box:_,sphereInitialized:x.sphereInitialized,sphere:S}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=u(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=u(e.colorsTexture.uuid));break;case"LOD":o=new yF;break;case"Line":o=new qu(a(e.geometry),l(e.material));break;case"LineLoop":o=new yw(a(e.geometry),l(e.material));break;case"LineSegments":o=new il(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new xw(a(e.geometry),l(e.material));break;case"Sprite":o=new vF(l(e.material));break;case"Group":o=new Gu;break;case"Bone":o=new QS;break;default:o=new An}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let m=0;m<d.length;m++)o.add(this.parseObject(d[m],t,n,i,s))}if(e.animations!==void 0){const d=e.animations;for(let m=0;m<d.length;m++){const g=d[m];o.animations.push(s[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let m=0;m<d.length;m++){const g=d[m],x=o.getObjectByProperty("uuid",g.object);x!==void 0&&o.addLevel(x,g.distance,g.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);i!==void 0?t.target=i:t.target=new An}})}}const _9={UVMapping:kS,CubeReflectionMapping:Yu,CubeRefractionMapping:ch,EquirectangularReflectionMapping:U0,EquirectangularRefractionMapping:N0,CubeUVReflectionMapping:Rm},CI={RepeatWrapping:hh,ClampToEdgeWrapping:Bo,MirroredRepeatWrapping:am},bI={NearestFilter:Er,NearestMipmapNearestFilter:OS,NearestMipmapLinearFilter:If,LinearFilter:vi,LinearMipmapNearestFilter:qp,LinearMipmapLinearFilter:da};class JF extends _s{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Hu.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(u=>{t&&t(u),s.manager.itemEnd(e)}).catch(u=>{i&&i(u)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return Hu.add(e,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){i&&i(u),Hu.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Hu.add(e,l),s.manager.itemStart(e)}}let yx;class Fw{static getContext(){return yx===void 0&&(yx=new(window.AudioContext||window.webkitAudioContext)),yx}static setContext(e){yx=e}}class S9 extends _s{constructor(e){super(e)}load(e,t,n,i){const s=this,o=new Ho(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const u=l.slice(0);Fw.getContext().decodeAudioData(u,function(h){t(h)}).catch(a)}catch(u){a(u)}},n,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const RI=new Wt,II=new Wt,cf=new Wt;class A9{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new mi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new mi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,cf.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(Hf*t.fov*.5)/t.zoom;let a,l;II.elements[12]=-i,RI.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,cf.elements[0]=2*t.near/(l-a),cf.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(cf),a=-o*t.aspect-s,l=o*t.aspect-s,cf.elements[0]=2*t.near/(l-a),cf.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(cf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(II),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(RI)}}class kw{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=LI(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=LI();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function LI(){return(typeof performance>"u"?Date:performance).now()}const hf=new ae,PI=new Nr,E9=new ae,ff=new ae;class T9 extends An{constructor(){super(),this.type="AudioListener",this.context=Fw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new kw}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(hf,PI,E9),ff.set(0,0,-1).applyQuaternion(PI),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(hf.x,i),t.positionY.linearRampToValueAtTime(hf.y,i),t.positionZ.linearRampToValueAtTime(hf.z,i),t.forwardX.linearRampToValueAtTime(ff.x,i),t.forwardY.linearRampToValueAtTime(ff.y,i),t.forwardZ.linearRampToValueAtTime(ff.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(hf.x,hf.y,hf.z),t.setOrientation(ff.x,ff.y,ff.z,n.x,n.y,n.z)}}class qF extends An{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const df=new ae,DI=new Nr,M9=new ae,pf=new ae;class w9 extends qF{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(df,DI,M9),pf.set(0,0,1).applyQuaternion(DI);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(df.x,n),t.positionY.linearRampToValueAtTime(df.y,n),t.positionZ.linearRampToValueAtTime(df.z,n),t.orientationX.linearRampToValueAtTime(pf.x,n),t.orientationY.linearRampToValueAtTime(pf.y,n),t.orientationZ.linearRampToValueAtTime(pf.z,n)}else t.setPosition(df.x,df.y,df.z),t.setOrientation(pf.x,pf.y,pf.z)}}class C9{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class QF{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)n[s+a]=n[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(n,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(n,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let l=t,u=t+t;l!==u;++l)if(n[l]!==n[l+t]){a.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let s=n,o=i;s!==o;++s)t[s]=t[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,i){Nr.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const o=this._workIndex*s;Nr.multiplyQuaternionsFlat(e,o,e,t,e,n),Nr.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*i}}_lerpAdditive(e,t,n,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*i}}}const Ow="\\[\\]\\.:\\/",b9=new RegExp("["+Ow+"]","g"),Uw="[^"+Ow+"]",R9="[^"+Ow.replace("\\.","")+"]",I9=/((?:WC+[\/:])*)/.source.replace("WC",Uw),L9=/(WCOD+)?/.source.replace("WCOD",R9),P9=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Uw),D9=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Uw),B9=new RegExp("^"+I9+L9+P9+D9+"$"),F9=["material","materials","bones","map"];class k9{constructor(e,t,n){const i=n||Rn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Rn{constructor(e,t,n){this.path=t,this.parsedPath=n||Rn.parseTrackName(t),this.node=Rn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Rn.Composite(e,t,n):new Rn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(b9,"")}static parseTrackName(e){const t=B9.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);F9.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=n(a.children);if(l)return l}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Rn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let u=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[i];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Rn.Composite=k9;Rn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Rn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Rn.prototype.GetterByBindingType=[Rn.prototype._getValue_direct,Rn.prototype._getValue_array,Rn.prototype._getValue_arrayElement,Rn.prototype._getValue_toArray];Rn.prototype.SetterByBindingTypeAndVersioning=[[Rn.prototype._setValue_direct,Rn.prototype._setValue_direct_setNeedsUpdate,Rn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Rn.prototype._setValue_array,Rn.prototype._setValue_array_setNeedsUpdate,Rn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Rn.prototype._setValue_arrayElement,Rn.prototype._setValue_arrayElement_setNeedsUpdate,Rn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Rn.prototype._setValue_fromArray,Rn.prototype._setValue_fromArray_setNeedsUpdate,Rn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class O9{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ko(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,u=this.nCachedObjects_;for(let c=0,h=arguments.length;c!==h;++c){const d=arguments[c],m=d.uuid;let g=t[m];if(g===void 0){g=l++,t[m]=g,e.push(d);for(let x=0,_=o;x!==_;++x)s[x].push(new Rn(d,n[x],i[x]))}else if(g<u){a=e[g];const x=--u,_=e[x];t[_.uuid]=g,e[g]=_,t[m]=x,e[x]=d;for(let S=0,T=o;S!==T;++S){const E=s[S],C=E[x];let R=E[g];E[g]=C,R===void 0&&(R=new Rn(d,n[S],i[S])),E[x]=R}}else e[g]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],u=l.uuid,c=t[u];if(c!==void 0&&c>=s){const h=s++,d=e[h];t[d.uuid]=c,e[c]=d,t[u]=h,e[h]=l;for(let m=0,g=i;m!==g;++m){const x=n[m],_=x[h],S=x[c];x[c]=_,x[h]=S}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],c=u.uuid,h=t[c];if(h!==void 0)if(delete t[c],h<s){const d=--s,m=e[d],g=--o,x=e[g];t[m.uuid]=h,e[h]=m,t[x.uuid]=d,e[d]=x,e.pop();for(let _=0,S=i;_!==S;++_){const T=n[_],E=T[d],C=T[g];T[h]=E,T[d]=C,T.pop()}}else{const d=--o,m=e[d];d>0&&(t[m.uuid]=h),e[h]=m,e.pop();for(let g=0,x=i;g!==x;++g){const _=n[g];_[h]=_[d],_.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,u=l.length,c=this.nCachedObjects_,h=new Array(u);i=s.length,n[e]=i,o.push(e),a.push(t),s.push(h);for(let d=c,m=l.length;d!==m;++d){const g=l[d];h[d]=new Rn(g,e,t)}return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],u=e[a];t[u]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),i[n]=i[a],i.pop()}}}class ZF{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Lf,endingEnd:Lf};for(let u=0;u!==o;++u){const c=s[u].createInterpolant(null);a[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=zB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+n,u[0]=e/o,u[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;l<0||n===0?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case rw:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(a);break;case WS:default:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const o=n===VB;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(n===HB){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Pf,i.endingEnd=Pf):(e?i.endingStart=this.zeroSlopeAtStart?Pf:Lf:i.endingStart=G0,t?i.endingEnd=this.zeroSlopeAtEnd?Pf:Lf:i.endingEnd=G0)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=n,this}}const U9=new Float32Array(1);class ek extends rc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,u=this._bindingsByRootAndName;let c=u[l];c===void 0&&(c={},u[l]=c);for(let h=0;h!==s;++h){const d=i[h],m=d.name;let g=c[m];if(g!==void 0)++g.referenceCount,o[h]=g;else{if(g=o[h],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,l,m));continue}const x=t&&t._propertyBindings[h].binding.parsedPath;g=new QF(Rn.create(n,m,x),d.ValueTypeName,d.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,m),o[h]=g}a[h].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,l[c]=u,l.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],u=e._cacheIndex;l._cacheIndex=u,t[u]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new bw(new Float32Array(2),new Float32Array(2),1,U9),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?dm.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(n===void 0&&(o!==null?n=o.blendMode:n=WS),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===n)return h;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const c=new ZF(this,o,t,n);return this._bindAction(c,u),this._addInactiveAction(c,a,s),c}existingAction(e,t){const n=t||this._root,i=n.uuid,s=typeof e=="string"?dm.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==n;++u)t[u]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const c=u._cacheIndex,h=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=c,t[c]=h,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Nw{constructor(e){this.value=e}clone(){return new Nw(this.value.clone===void 0?this.value:this.value.clone())}}let N9=0;class G9 extends rc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:N9++}),this.name="",this.usage=W0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class nS extends Tv{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class H9{constructor(e,t,n,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const BI=new Wt;class tk{constructor(e,t,n=0,i=1/0){this.ray=new ld(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new zf,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return BI.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(BI),this}intersectObject(e,t=!0,n=[]){return FT(e,this,n,t),n.sort(FI),n}intersectObjects(e,t=!0,n=[]){for(let i=0,s=e.length;i<s;i++)FT(e[i],this,n,t);return n.sort(FI),n}}function FI(r,e){return r.distance-e.distance}function FT(r,e,t,n){let i=!0;if(r.layers.test(e.layers)&&r.raycast(e,t)===!1&&(i=!1),i===!0&&n===!0){const s=r.children;for(let o=0,a=s.length;o<a;o++)FT(s[o],e,t,!0)}}class kT{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Oi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class z9{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class Gw{constructor(e,t,n,i){Gw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=i,this}}const kI=new Qe;class V9{constructor(e=new Qe(1/0,1/0),t=new Qe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=kI.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,kI).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const OI=new ae,xx=new ae;class nk{constructor(e=new ae,t=new ae){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){OI.subVectors(e,this.start),xx.subVectors(this.end,this.start);const n=xx.dot(xx);let s=xx.dot(OI)/n;return t&&(s=Oi(s,0,1)),s}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const UI=new ae;class W9 extends An{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new dn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const u=o/l*Math.PI*2,c=a/l*Math.PI*2;i.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}n.setAttribute("position",new Ft(i,3));const s=new xs({fog:!1,toneMapped:!1});this.cone=new il(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),UI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(UI),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Xc=new ae,_x=new Wt,tE=new Wt;class j9 extends il{constructor(e){const t=ik(e),n=new dn,i=[],s=[],o=new yt(0,0,1),a=new yt(0,1,0);for(let u=0;u<t.length;u++){const c=t[u];c.parent&&c.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new Ft(i,3)),n.setAttribute("color",new Ft(s,3));const l=new xs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");tE.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(_x.multiplyMatrices(tE,a.matrixWorld),Xc.setFromMatrixPosition(_x),i.setXYZ(o,Xc.x,Xc.y,Xc.z),_x.multiplyMatrices(tE,a.parent.matrixWorld),Xc.setFromMatrixPosition(_x),i.setXYZ(o+1,Xc.x,Xc.y,Xc.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function ik(r){const e=[];r.isBone===!0&&e.push(r);for(let t=0;t<r.children.length;t++)e.push.apply(e,ik(r.children[t]));return e}class K9 extends ui{constructor(e,t,n){const i=new bv(t,4,2),s=new so({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const $9=new ae,NI=new yt,GI=new yt;class X9 extends An{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Cv(t);i.rotateY(Math.PI*.5),this.material=new so({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new Pn(o,3)),this.add(new ui(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");NI.copy(this.light.color),GI.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const s=n<i/2?NI:GI;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt($9.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Y9 extends il{constructor(e=10,t=10,n=4473924,i=8947848){n=new yt(n),i=new yt(i);const s=t/2,o=e/t,a=e/2,l=[],u=[];for(let d=0,m=0,g=-a;d<=t;d++,g+=o){l.push(-a,0,g,a,0,g),l.push(g,0,-a,g,0,a);const x=d===s?n:i;x.toArray(u,m),m+=3,x.toArray(u,m),m+=3,x.toArray(u,m),m+=3,x.toArray(u,m),m+=3}const c=new dn;c.setAttribute("position",new Ft(l,3)),c.setAttribute("color",new Ft(u,3));const h=new xs({vertexColors:!0,toneMapped:!1});super(c,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class J9 extends il{constructor(e=10,t=16,n=8,i=64,s=4473924,o=8947848){s=new yt(s),o=new yt(o);const a=[],l=[];if(t>1)for(let h=0;h<t;h++){const d=h/t*(Math.PI*2),m=Math.sin(d)*e,g=Math.cos(d)*e;a.push(0,0,0),a.push(m,0,g);const x=h&1?s:o;l.push(x.r,x.g,x.b),l.push(x.r,x.g,x.b)}for(let h=0;h<n;h++){const d=h&1?s:o,m=e-e/n*h;for(let g=0;g<i;g++){let x=g/i*(Math.PI*2),_=Math.sin(x)*m,S=Math.cos(x)*m;a.push(_,0,S),l.push(d.r,d.g,d.b),x=(g+1)/i*(Math.PI*2),_=Math.sin(x)*m,S=Math.cos(x)*m,a.push(_,0,S),l.push(d.r,d.g,d.b)}}const u=new dn;u.setAttribute("position",new Ft(a,3)),u.setAttribute("color",new Ft(l,3));const c=new xs({vertexColors:!0,toneMapped:!1});super(u,c),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const HI=new ae,Sx=new ae,zI=new ae;class q9 extends An{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new dn;i.setAttribute("position",new Ft([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new xs({fog:!1,toneMapped:!1});this.lightPlane=new qu(i,s),this.add(this.lightPlane),i=new dn,i.setAttribute("position",new Ft([0,0,0,0,0,1],3)),this.targetLine=new qu(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),HI.setFromMatrixPosition(this.light.matrixWorld),Sx.setFromMatrixPosition(this.light.target.matrixWorld),zI.subVectors(Sx,HI),this.lightPlane.lookAt(Sx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Sx),this.targetLine.scale.z=zI.length()}}const Ax=new ae,Fi=new Sv;class Q9 extends il{constructor(e){const t=new dn,n=new xs({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(g,x){l(g),l(x)}function l(g){i.push(0,0,0),s.push(0,0,0),o[g]===void 0&&(o[g]=[]),o[g].push(i.length/3-1)}t.setAttribute("position",new Ft(i,3)),t.setAttribute("color",new Ft(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new yt(16755200),c=new yt(16711680),h=new yt(43775),d=new yt(16777215),m=new yt(3355443);this.setColors(u,c,h,d,m)}setColors(e,t,n,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;Fi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ki("c",t,e,Fi,0,0,-1),Ki("t",t,e,Fi,0,0,1),Ki("n1",t,e,Fi,-1,-1,-1),Ki("n2",t,e,Fi,n,-1,-1),Ki("n3",t,e,Fi,-1,i,-1),Ki("n4",t,e,Fi,n,i,-1),Ki("f1",t,e,Fi,-1,-1,1),Ki("f2",t,e,Fi,n,-1,1),Ki("f3",t,e,Fi,-1,i,1),Ki("f4",t,e,Fi,n,i,1),Ki("u1",t,e,Fi,n*.7,i*1.1,-1),Ki("u2",t,e,Fi,-1*.7,i*1.1,-1),Ki("u3",t,e,Fi,0,i*2,-1),Ki("cf1",t,e,Fi,-1,0,1),Ki("cf2",t,e,Fi,n,0,1),Ki("cf3",t,e,Fi,0,-1,1),Ki("cf4",t,e,Fi,0,i,1),Ki("cn1",t,e,Fi,-1,0,-1),Ki("cn2",t,e,Fi,n,0,-1),Ki("cn3",t,e,Fi,0,-1,-1),Ki("cn4",t,e,Fi,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ki(r,e,t,n,i,s,o){Ax.set(i,s,o).unproject(n);const a=e[r];if(a!==void 0){const l=t.getAttribute("position");for(let u=0,c=a.length;u<c;u++)l.setXYZ(a[u],Ax.x,Ax.y,Ax.z)}}const Ex=new Ni;class Z9 extends il{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new dn;s.setIndex(new Pn(n,1)),s.setAttribute("position",new Pn(i,3)),super(s,new xs({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Ex.setFromObject(this.object),Ex.isEmpty())return;const t=Ex.min,n=Ex.max,i=this.geometry.attributes.position,s=i.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class eW extends il{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new dn;s.setIndex(new Pn(n,1)),s.setAttribute("position",new Ft(i,3)),super(s,new xs({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class tW extends qu{constructor(e,t=1,n=16776960){const i=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new dn;o.setAttribute("position",new Ft(s,3)),o.computeBoundingSphere(),super(o,new xs({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new dn;l.setAttribute("position",new Ft(a,3)),l.computeBoundingSphere(),this.add(new ui(l,new so({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const VI=new ae;let Tx,nE;class nW extends An{constructor(e=new ae(0,0,1),t=new ae(0,0,0),n=1,i=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",Tx===void 0&&(Tx=new dn,Tx.setAttribute("position",new Ft([0,0,0,0,1,0],3)),nE=new Pm(0,.5,1,5,1),nE.translate(0,-.5,0)),this.position.copy(t),this.line=new qu(Tx,new xs({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ui(nE,new so({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{VI.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(VI,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class iW extends il{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new dn;i.setAttribute("position",new Ft(t,3)),i.setAttribute("color",new Ft(n,3));const s=new xs({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,n){const i=new yt,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class rW{constructor(){this.type="ShapePath",this.color=new yt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new X0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,s,o){return this.currentPath.bezierCurveTo(e,t,n,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const T=[];for(let E=0,C=S.length;E<C;E++){const R=S[E],P=new Vf;P.curves=R.curves,T.push(P)}return T}function n(S,T){const E=T.length;let C=!1;for(let R=E-1,P=0;P<E;R=P++){let L=T[R],F=T[P],D=F.x-L.x,I=F.y-L.y;if(Math.abs(I)>Number.EPSILON){if(I<0&&(L=T[P],D=-D,F=T[R],I=-I),S.y<L.y||S.y>F.y)continue;if(S.y===L.y){if(S.x===L.x)return!0}else{const N=I*(S.x-L.x)-D*(S.y-L.y);if(N===0)return!0;if(N<0)continue;C=!C}}else{if(S.y!==L.y)continue;if(F.x<=S.x&&S.x<=L.x||L.x<=S.x&&S.x<=F.x)return!0}}return C}const i=Gl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new Vf,l.curves=a.curves,u.push(l),u;let c=!i(s[0].getPoints());c=e?!c:c;const h=[],d=[];let m=[],g=0,x;d[g]=void 0,m[g]=[];for(let S=0,T=s.length;S<T;S++)a=s[S],x=a.getPoints(),o=i(x),o=e?!o:o,o?(!c&&d[g]&&g++,d[g]={s:new Vf,p:x},d[g].s.curves=a.curves,c&&g++,m[g]=[]):m[g].push({h:a,p:x[0]});if(!d[0])return t(s);if(d.length>1){let S=!1,T=0;for(let E=0,C=d.length;E<C;E++)h[E]=[];for(let E=0,C=d.length;E<C;E++){const R=m[E];for(let P=0;P<R.length;P++){const L=R[P];let F=!0;for(let D=0;D<d.length;D++)n(L.p,d[D].p)&&(E!==D&&T++,F?(F=!1,h[D].push(L)):S=!0);F&&h[E].push(L)}}T>0&&S===!1&&(m=h)}let _;for(let S=0,T=d.length;S<T;S++){l=d[S].s,u.push(l),_=m[S];for(let E=0,C=_.length;E<C;E++)l.holes.push(_[E].h)}return u}}class sW extends el{constructor(e=1,t=1,n=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...i,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:bm}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=bm);const oW=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:XM,AddEquation:ih,AddOperation:DB,AdditiveAnimationBlendMode:rw,AdditiveBlending:AT,AgXToneMapping:UB,AlphaFormat:QM,AlwaysCompare:ZB,AlwaysDepth:wB,AlwaysStencilFunc:wT,AmbientLight:jF,AnimationAction:ZF,AnimationClip:dm,AnimationLoader:f9,AnimationMixer:ek,AnimationObjectGroup:O9,AnimationUtils:l9,ArcCurve:SF,ArrayCamera:pF,ArrowHelper:nW,AttachedBindMode:MT,Audio:qF,AudioAnalyser:C9,AudioContext:Fw,AudioListener:T9,AudioLoader:S9,AxesHelper:iW,BackSide:Ns,BasicDepthPacking:jB,BasicShadowMap:oB,BatchedMesh:xF,Bone:QS,BooleanKeyframeTrack:cd,Box2:V9,Box3:Ni,Box3Helper:eW,BoxGeometry:ud,BoxHelper:Z9,BufferAttribute:Pn,BufferGeometry:dn,BufferGeometryLoader:YF,ByteType:YM,Cache:Hu,Camera:Sv,CameraHelper:Q9,CanvasTexture:P6,CapsuleGeometry:nA,CatmullRomCurve3:AF,CineonToneMapping:kB,CircleGeometry:iA,ClampToEdgeWrapping:Bo,Clock:kw,Color:yt,ColorKeyframeTrack:Rw,ColorManagement:On,CompressedArrayTexture:I6,CompressedCubeTexture:L6,CompressedTexture:eA,CompressedTextureLoader:d9,ConeGeometry:rA,ConstantAlphaFactor:EB,ConstantColorFactor:SB,CubeCamera:oF,CubeReflectionMapping:Yu,CubeRefractionMapping:ch,CubeTexture:Av,CubeTextureLoader:p9,CubeUVReflectionMapping:Rm,CubicBezierCurve:Sw,CubicBezierCurve3:EF,CubicInterpolant:GF,CullFaceBack:ST,CullFaceFront:sB,CullFaceFrontBack:f5,CullFaceNone:rB,Curve:rl,CurvePath:MF,CustomBlending:aB,CustomToneMapping:OB,CylinderGeometry:Pm,Cylindrical:z9,Data3DTexture:uw,DataArrayTexture:KS,DataTexture:Nl,DataTextureLoader:m9,DataUtils:SG,DecrementStencilOp:E5,DecrementWrapStencilOp:M5,DefaultLoadingManager:Hp,DepthFormat:Gf,DepthStencilFormat:ed,DepthTexture:dw,DetachedBindMode:GB,DirectionalLight:Bw,DirectionalLightHelper:q9,DiscreteInterpolant:HF,DisplayP3ColorSpace:jS,DodecahedronGeometry:sA,DoubleSide:Lo,DstAlphaFactor:gB,DstColorFactor:yB,DynamicCopyUsage:G5,DynamicDrawUsage:B5,DynamicReadUsage:O5,EdgesGeometry:wF,EllipseCurve:tA,EqualCompare:YB,EqualDepth:bB,EqualStencilFunc:R5,EquirectangularReflectionMapping:U0,EquirectangularRefractionMapping:N0,Euler:No,EventDispatcher:rc,ExtrudeGeometry:aA,FileLoader:Ho,Float16BufferAttribute:CG,Float32BufferAttribute:Ft,FloatType:ro,Fog:qS,FogExp2:JS,FramebufferTexture:R6,FrontSide:Wl,Frustum:Ev,GLBufferAttribute:H9,GLSL1:z5,GLSL3:CT,GreaterCompare:JB,GreaterDepth:IB,GreaterEqualCompare:QB,GreaterEqualDepth:RB,GreaterEqualStencilFunc:D5,GreaterStencilFunc:L5,GridHelper:Y9,Group:Gu,HalfFloatType:Im,HemisphereLight:WF,HemisphereLightHelper:X9,IcosahedronGeometry:lA,ImageBitmapLoader:JF,ImageLoader:Q0,ImageUtils:nF,IncrementStencilOp:A5,IncrementWrapStencilOp:T5,InstancedBufferAttribute:fh,InstancedBufferGeometry:gA,InstancedInterleavedBuffer:nS,InstancedMesh:vw,Int16BufferAttribute:MG,Int32BufferAttribute:wG,Int8BufferAttribute:AG,IntType:US,InterleavedBuffer:Tv,InterleavedBufferAttribute:oo,Interpolant:Dm,InterpolateDiscrete:um,InterpolateLinear:cm,InterpolateSmooth:n_,InvertStencilOp:w5,KeepStencilOp:Ef,KeyframeTrack:sl,LOD:yF,LatheGeometry:wv,Layers:zf,LessCompare:XB,LessDepth:CB,LessEqualCompare:aw,LessEqualDepth:O0,LessEqualStencilFunc:I5,LessStencilFunc:b5,Light:xh,LightProbe:XF,Line:qu,Line3:nk,LineBasicMaterial:xs,LineCurve:Aw,LineCurve3:TF,LineDashedMaterial:OF,LineLoop:yw,LineSegments:il,LinearDisplayP3ColorSpace:xv,LinearFilter:vi,LinearInterpolant:bw,LinearMipMapLinearFilter:g5,LinearMipMapNearestFilter:m5,LinearMipmapLinearFilter:da,LinearMipmapNearestFilter:qp,LinearSRGBColorSpace:ic,LinearToneMapping:BB,LinearTransfer:H0,Loader:_s,LoaderUtils:ah,LoadingManager:Iw,LoopOnce:HB,LoopPingPong:VB,LoopRepeat:zB,LuminanceAlphaFormat:tw,LuminanceFormat:ew,MOUSE:Sf,Material:Tr,MaterialLoader:mA,MathUtils:_v,Matrix2:Gw,Matrix3:ln,Matrix4:Wt,MaxEquation:hB,Mesh:ui,MeshBasicMaterial:so,MeshDepthMaterial:XS,MeshDistanceMaterial:YS,MeshLambertMaterial:FF,MeshMatcapMaterial:kF,MeshNormalMaterial:BF,MeshPhongMaterial:PF,MeshPhysicalMaterial:va,MeshStandardMaterial:Rv,MeshToonMaterial:DF,MinEquation:cB,MirroredRepeatWrapping:am,MixOperation:PB,MultiplyBlending:TT,MultiplyOperation:vv,NearestFilter:Er,NearestMipMapLinearFilter:p5,NearestMipMapNearestFilter:d5,NearestMipmapLinearFilter:If,NearestMipmapNearestFilter:OS,NeutralToneMapping:NB,NeverCompare:$B,NeverDepth:MB,NeverStencilFunc:C5,NoBlending:Wu,NoColorSpace:Ou,NoToneMapping:Ul,NormalAnimationBlendMode:WS,NormalBlending:Nf,NotEqualCompare:qB,NotEqualDepth:LB,NotEqualStencilFunc:P5,NumberKeyframeTrack:nd,Object3D:An,ObjectLoader:x9,ObjectSpaceNormalMap:KB,OctahedronGeometry:Cv,OneFactor:dB,OneMinusConstantAlphaFactor:TB,OneMinusConstantColorFactor:AB,OneMinusDstAlphaFactor:vB,OneMinusDstColorFactor:xB,OneMinusSrcAlphaFactor:M_,OneMinusSrcColorFactor:mB,OrthographicCamera:Qa,P3Primaries:V0,PCFShadowMap:FS,PCFSoftShadowMap:f0,PMREMGenerator:bT,Path:X0,PerspectiveCamera:mi,Plane:Fu,PlaneGeometry:sc,PlaneHelper:tW,PointLight:Dw,PointLightHelper:K9,Points:xw,PointsMaterial:ZS,PolarGridHelper:J9,PolyhedronGeometry:yh,PositionalAudio:w9,PropertyBinding:Rn,PropertyMixer:QF,QuadraticBezierCurve:Ew,QuadraticBezierCurve3:Tw,Quaternion:Nr,QuaternionKeyframeTrack:id,QuaternionLinearInterpolant:zF,RED_GREEN_RGTC2_Format:J_,RED_RGTC1_Format:iw,REVISION:bm,RGBADepthPacking:ow,RGBAFormat:ms,RGBAIntegerFormat:VS,RGBA_ASTC_10x10_Format:W_,RGBA_ASTC_10x5_Format:H_,RGBA_ASTC_10x6_Format:z_,RGBA_ASTC_10x8_Format:V_,RGBA_ASTC_12x10_Format:j_,RGBA_ASTC_12x12_Format:K_,RGBA_ASTC_4x4_Format:D_,RGBA_ASTC_5x4_Format:B_,RGBA_ASTC_5x5_Format:F_,RGBA_ASTC_6x5_Format:k_,RGBA_ASTC_6x6_Format:O_,RGBA_ASTC_8x5_Format:U_,RGBA_ASTC_8x6_Format:N_,RGBA_ASTC_8x8_Format:G_,RGBA_BPTC_Format:v0,RGBA_ETC2_EAC_Format:P_,RGBA_PVRTC_2BPPV1_Format:R_,RGBA_PVRTC_4BPPV1_Format:b_,RGBA_S3TC_DXT1_Format:p0,RGBA_S3TC_DXT3_Format:m0,RGBA_S3TC_DXT5_Format:g0,RGBDepthPacking:y5,RGBFormat:ZM,RGBIntegerFormat:v5,RGB_BPTC_SIGNED_Format:$_,RGB_BPTC_UNSIGNED_Format:X_,RGB_ETC1_Format:I_,RGB_ETC2_Format:L_,RGB_PVRTC_2BPPV1_Format:C_,RGB_PVRTC_4BPPV1_Format:w_,RGB_S3TC_DXT1_Format:d0,RGDepthPacking:x5,RGFormat:nw,RGIntegerFormat:zS,RawShaderMaterial:LF,Ray:ld,Raycaster:tk,Rec709Primaries:z0,RectAreaLight:KF,RedFormat:HS,RedIntegerFormat:yv,ReinhardToneMapping:FB,RenderTarget:iF,RepeatWrapping:hh,ReplaceStencilOp:S5,ReverseSubtractEquation:uB,RingGeometry:uA,SIGNED_RED_GREEN_RGTC2_Format:q_,SIGNED_RED_RGTC1_Format:Y_,SRGBColorSpace:fa,SRGBTransfer:ri,Scene:pw,ShaderChunk:hn,ShaderLib:Ja,ShaderMaterial:Go,ShadowMaterial:IF,Shape:Vf,ShapeGeometry:cA,ShapePath:rW,ShapeUtils:Gl,ShortType:JM,Skeleton:Mv,SkeletonHelper:j9,SkinnedMesh:gw,Source:Df,Sphere:Yi,SphereGeometry:bv,Spherical:kT,SphericalHarmonics3:$F,SplineCurve:Mw,SpotLight:Pw,SpotLightHelper:W9,Sprite:vF,SpriteMaterial:mw,SrcAlphaFactor:T_,SrcAlphaSaturateFactor:_B,SrcColorFactor:pB,StaticCopyUsage:N5,StaticDrawUsage:W0,StaticReadUsage:k5,StereoCamera:A9,StreamCopyUsage:H5,StreamDrawUsage:F5,StreamReadUsage:U5,StringKeyframeTrack:hd,SubtractEquation:lB,SubtractiveBlending:ET,TOUCH:Af,TangentSpaceNormalMap:vh,TetrahedronGeometry:hA,Texture:ci,TextureLoader:VF,TextureUtils:u6,TorusGeometry:fA,TorusKnotGeometry:dA,Triangle:Po,TriangleFanDrawMode:Q_,TriangleStripDrawMode:sw,TrianglesDrawMode:WB,TubeGeometry:pA,UVMapping:kS,Uint16BufferAttribute:cw,Uint32BufferAttribute:hw,Uint8BufferAttribute:EG,Uint8ClampedBufferAttribute:TG,Uniform:Nw,UniformsGroup:G9,UniformsLib:St,UniformsUtils:$0,UnsignedByteType:Za,UnsignedInt248Type:Zf,UnsignedInt5999Type:qM,UnsignedIntType:Ju,UnsignedShort4444Type:NS,UnsignedShort5551Type:GS,UnsignedShortType:lm,VSMShadowMap:Ya,Vector2:Qe,Vector3:ae,Vector4:gn,VectorKeyframeTrack:rd,VideoTexture:_F,WebGL3DRenderTarget:hG,WebGLArrayRenderTarget:cG,WebGLCoordinateSystem:Dl,WebGLCubeRenderTarget:aF,WebGLMultipleRenderTargets:sW,WebGLRenderTarget:el,WebGLRenderer:mF,WebGLUtils:dF,WebGPUCoordinateSystem:j0,WireframeGeometry:ww,WrapAroundEnding:G0,ZeroCurvatureEnding:Lf,ZeroFactor:fB,ZeroSlopeEnding:Pf,ZeroStencilOp:_5,createCanvasElement:tF},Symbol.toStringTag,{value:"Module"}));var iE={exports:{}},Yc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WI;function aW(){return WI||(WI=1,Yc.ConcurrentRoot=1,Yc.ContinuousEventPriority=4,Yc.DefaultEventPriority=16,Yc.DiscreteEventPriority=1,Yc.IdleEventPriority=536870912,Yc.LegacyRoot=0),Yc}var jI;function lW(){return jI||(jI=1,iE.exports=aW()),iE.exports}var zp=lW();function uW(r){let e;const t=new Set,n=(u,c)=>{const h=typeof u=="function"?u(e):u;if(h!==e){const d=e;e=c?h:Object.assign({},e,h),t.forEach(m=>m(e,d))}},i=()=>e,s=(u,c=i,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=c(e);function m(){const g=c(e);if(!h(d,g)){const x=d;u(d=g,x)}}return t.add(m),()=>t.delete(m)},l={setState:n,getState:i,subscribe:(u,c,h)=>c||h?s(u,c,h):(t.add(u),()=>t.delete(u)),destroy:()=>t.clear()};return e=r(n,i,l),l}const cW=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),KI=cW?ne.useEffect:ne.useLayoutEffect;function hW(r){const e=typeof r=="function"?uW(r):r,t=(n=e.getState,i=Object.is)=>{const[,s]=ne.useReducer(_=>_+1,0),o=e.getState(),a=ne.useRef(o),l=ne.useRef(n),u=ne.useRef(i),c=ne.useRef(!1),h=ne.useRef();h.current===void 0&&(h.current=n(o));let d,m=!1;(a.current!==o||l.current!==n||u.current!==i||c.current)&&(d=n(o),m=!i(h.current,d)),KI(()=>{m&&(h.current=d),a.current=o,l.current=n,u.current=i,c.current=!1});const g=ne.useRef(o);KI(()=>{const _=()=>{try{const T=e.getState(),E=l.current(T);u.current(h.current,E)||(a.current=T,h.current=E,s())}catch{c.current=!0,s()}},S=e.subscribe(_);return e.getState()!==g.current&&_(),S},[]);const x=m?d:h.current;return ne.useDebugValue(x),x};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const i=n.length<=0;return{value:n.shift(),done:i}}}},t}const fW=r=>typeof r=="object"&&typeof r.then=="function",Ff=[];function rk(r,e,t=(n,i)=>n===i){if(r===e)return!0;if(!r||!e)return!1;const n=r.length;if(e.length!==n)return!1;for(let i=0;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function sk(r,e=null,t=!1,n={}){e===null&&(e=[r]);for(const s of Ff)if(rk(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:n.equal,remove:()=>{const s=Ff.indexOf(i);s!==-1&&Ff.splice(s,1)},promise:(fW(r)?r:r(...e)).then(s=>{i.response=s,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(s=>i.error=s)};if(Ff.push(i),!t)throw i.promise}const Hw=(r,e,t)=>sk(r,e,!1,t),dW=(r,e,t)=>void sk(r,e,!0,t),pW=r=>{if(r===void 0||r.length===0)Ff.splice(0,Ff.length);else{const e=Ff.find(t=>rk(r,t.keys,t.equal));e&&e.remove()}};var rE={exports:{}},sE={exports:{}},oE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $I;function mW(){return $I||($I=1,function(r){function e(W,$){var j=W.length;W.push($);e:for(;0<j;){var U=j-1>>>1,X=W[U];if(0<i(X,$))W[U]=$,W[j]=X,j=U;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var $=W[0],j=W.pop();if(j!==$){W[0]=j;e:for(var U=0,X=W.length,le=X>>>1;U<le;){var Z=2*(U+1)-1,oe=W[Z],pe=Z+1,de=W[pe];if(0>i(oe,j))pe<X&&0>i(de,oe)?(W[U]=de,W[pe]=j,U=pe):(W[U]=oe,W[Z]=j,U=Z);else if(pe<X&&0>i(de,j))W[U]=de,W[pe]=j,U=pe;else break e}}return $}function i(W,$){var j=W.sortIndex-$.sortIndex;return j!==0?j:W.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,m=!1,g=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var $=t(u);$!==null;){if($.callback===null)n(u);else if($.startTime<=W)n(u),$.sortIndex=$.expirationTime,e(l,$);else break;$=t(u)}}function C(W){if(x=!1,E(W),!g)if(t(l)!==null)g=!0,ee(R);else{var $=t(u);$!==null&&se(C,$.startTime-W)}}function R(W,$){g=!1,x&&(x=!1,S(F),F=-1),m=!0;var j=d;try{for(E($),h=t(l);h!==null&&(!(h.expirationTime>$)||W&&!N());){var U=h.callback;if(typeof U=="function"){h.callback=null,d=h.priorityLevel;var X=U(h.expirationTime<=$);$=r.unstable_now(),typeof X=="function"?h.callback=X:h===t(l)&&n(l),E($)}else n(l);h=t(l)}if(h!==null)var le=!0;else{var Z=t(u);Z!==null&&se(C,Z.startTime-$),le=!1}return le}finally{h=null,d=j,m=!1}}var P=!1,L=null,F=-1,D=5,I=-1;function N(){return!(r.unstable_now()-I<D)}function V(){if(L!==null){var W=r.unstable_now();I=W;var $=!0;try{$=L(!0,W)}finally{$?q():(P=!1,L=null)}}else P=!1}var q;if(typeof T=="function")q=function(){T(V)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,re=Q.port2;Q.port1.onmessage=V,q=function(){re.postMessage(null)}}else q=function(){_(V,0)};function ee(W){L=W,P||(P=!0,q())}function se(W,$){F=_(function(){W(r.unstable_now())},$)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(W){W.callback=null},r.unstable_continueExecution=function(){g||m||(g=!0,ee(R))},r.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},r.unstable_getCurrentPriorityLevel=function(){return d},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(W){switch(d){case 1:case 2:case 3:var $=3;break;default:$=d}var j=d;d=$;try{return W()}finally{d=j}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(W,$){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var j=d;d=W;try{return $()}finally{d=j}},r.unstable_scheduleCallback=function(W,$,j){var U=r.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?U+j:U):j=U,W){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=j+X,W={id:c++,callback:$,priorityLevel:W,startTime:j,expirationTime:X,sortIndex:-1},j>U?(W.sortIndex=j,e(u,W),t(l)===null&&W===t(u)&&(x?(S(F),F=-1):x=!0,se(C,j-U))):(W.sortIndex=X,e(l,W),g||m||(g=!0,ee(R))),W},r.unstable_shouldYield=N,r.unstable_wrapCallback=function(W){var $=d;return function(){var j=d;d=$;try{return W.apply(this,arguments)}finally{d=j}}}}(oE)),oE}var XI;function ok(){return XI||(XI=1,sE.exports=mW()),sE.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE,YI;function gW(){return YI||(YI=1,aE=function(e){var t={},n=BS(),i=ok(),s=Object.assign;function o(v){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+v,M=1;M<arguments.length;M++)y+="&args[]="+encodeURIComponent(arguments[M]);return"Minified React error #"+v+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),g=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),R=Symbol.iterator;function P(v){return v===null||typeof v!="object"?null:(v=R&&v[R]||v["@@iterator"],typeof v=="function"?v:null)}function L(v){if(v==null)return null;if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v;switch(v){case c:return"Fragment";case u:return"Portal";case d:return"Profiler";case h:return"StrictMode";case _:return"Suspense";case S:return"SuspenseList"}if(typeof v=="object")switch(v.$$typeof){case g:return(v.displayName||"Context")+".Consumer";case m:return(v._context.displayName||"Context")+".Provider";case x:var y=v.render;return v=v.displayName,v||(v=y.displayName||y.name||"",v=v!==""?"ForwardRef("+v+")":"ForwardRef"),v;case T:return y=v.displayName||null,y!==null?y:L(v.type)||"Memo";case E:y=v._payload,v=v._init;try{return L(v(y))}catch{}}return null}function F(v){var y=v.type;switch(v.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return v=y.render,v=v.displayName||v.name||"",y.displayName||(v!==""?"ForwardRef("+v+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return L(y);case 8:return y===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function D(v){var y=v,M=v;if(v.alternate)for(;y.return;)y=y.return;else{v=y;do y=v,(y.flags&4098)!==0&&(M=y.return),v=y.return;while(v)}return y.tag===3?M:null}function I(v){if(D(v)!==v)throw Error(o(188))}function N(v){var y=v.alternate;if(!y){if(y=D(v),y===null)throw Error(o(188));return y!==v?null:v}for(var M=v,b=y;;){var k=M.return;if(k===null)break;var G=k.alternate;if(G===null){if(b=k.return,b!==null){M=b;continue}break}if(k.child===G.child){for(G=k.child;G;){if(G===M)return I(k),v;if(G===b)return I(k),y;G=G.sibling}throw Error(o(188))}if(M.return!==b.return)M=k,b=G;else{for(var ue=!1,Se=k.child;Se;){if(Se===M){ue=!0,M=k,b=G;break}if(Se===b){ue=!0,b=k,M=G;break}Se=Se.sibling}if(!ue){for(Se=G.child;Se;){if(Se===M){ue=!0,M=G,b=k;break}if(Se===b){ue=!0,b=G,M=k;break}Se=Se.sibling}if(!ue)throw Error(o(189))}}if(M.alternate!==b)throw Error(o(190))}if(M.tag!==3)throw Error(o(188));return M.stateNode.current===M?v:y}function V(v){return v=N(v),v!==null?q(v):null}function q(v){if(v.tag===5||v.tag===6)return v;for(v=v.child;v!==null;){var y=q(v);if(y!==null)return y;v=v.sibling}return null}function Q(v){if(v.tag===5||v.tag===6)return v;for(v=v.child;v!==null;){if(v.tag!==4){var y=Q(v);if(y!==null)return y}v=v.sibling}return null}var re=Array.isArray,ee=e.getPublicInstance,se=e.getRootHostContext,W=e.getChildHostContext,$=e.prepareForCommit,j=e.resetAfterCommit,U=e.createInstance,X=e.appendInitialChild,le=e.finalizeInitialChildren,Z=e.prepareUpdate,oe=e.shouldSetTextContent,pe=e.createTextInstance,de=e.scheduleTimeout,ye=e.cancelTimeout,Ge=e.noTimeout,Ke=e.isPrimaryRenderer,De=e.supportsMutation,K=e.supportsPersistence,Pe=e.supportsHydration,Be=e.getInstanceFromNode,Xe=e.preparePortalMount,ve=e.getCurrentEventPriority,et=e.detachDeletedInstance,Ce=e.supportsMicrotasks,We=e.scheduleMicrotask,te=e.supportsTestSelectors,z=e.findFiberRoot,me=e.getBoundingRect,_e=e.getTextContent,Ee=e.isHiddenSubtree,we=e.matchAccessibilityRole,ut=e.setFocusIfFocusable,ke=e.setupIntersectionObserver,Ze=e.appendChild,lt=e.appendChildToContainer,Ye=e.commitTextUpdate,nt=e.commitMount,Ct=e.commitUpdate,ht=e.insertBefore,it=e.insertInContainerBefore,rt=e.removeChild,fe=e.removeChildFromContainer,Je=e.resetTextContent,ce=e.hideInstance,He=e.hideTextInstance,Te=e.unhideInstance,Oe=e.unhideTextInstance,st=e.clearContainer,xt=e.cloneInstance,_t=e.createContainerChildSet,Ht=e.appendChildToContainerChildSet,zt=e.finalizeContainerChildren,gt=e.replaceContainerChildren,Qt=e.cloneHiddenInstance,vn=e.cloneHiddenTextInstance,Dn=e.canHydrateInstance,In=e.canHydrateTextInstance,xi=e.canHydrateSuspenseInstance,ns=e.isSuspenseInstancePending,Ri=e.isSuspenseInstanceFallback,Ji=e.registerSuspenseInstanceRetry,Gi=e.getNextHydratableSibling,qi=e.getFirstHydratableChild,Ii=e.getFirstHydratableChildWithinContainer,Hs=e.getFirstHydratableChildWithinSuspenseInstance,uc=e.hydrateInstance,Ss=e.hydrateTextInstance,cc=e.hydrateSuspenseInstance,ie=e.getNextHydratableInstanceAfterSuspenseInstance,Ae=e.commitHydratedContainer,Ue=e.commitHydratedSuspenseInstance,ze=e.clearSuspenseBoundary,be=e.clearSuspenseBoundaryFromContainer,ft=e.shouldDeleteUnhydratedTailInstances,At=e.didNotMatchHydratedContainerTextInstance,Rt=e.didNotMatchHydratedTextInstance,je;function Ot(v){if(je===void 0)try{throw Error()}catch(M){var y=M.stack.trim().match(/\n( *(at )?)/);je=y&&y[1]||""}return`
`+je+v}var Vt=!1;function Pt(v,y){if(!v||Vt)return"";Vt=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(dt){var b=dt}Reflect.construct(v,[],y)}else{try{y.call()}catch(dt){b=dt}v.call(y.prototype)}else{try{throw Error()}catch(dt){b=dt}v()}}catch(dt){if(dt&&b&&typeof dt.stack=="string"){for(var k=dt.stack.split(`
`),G=b.stack.split(`
`),ue=k.length-1,Se=G.length-1;1<=ue&&0<=Se&&k[ue]!==G[Se];)Se--;for(;1<=ue&&0<=Se;ue--,Se--)if(k[ue]!==G[Se]){if(ue!==1||Se!==1)do if(ue--,Se--,0>Se||k[ue]!==G[Se]){var qe=`
`+k[ue].replace(" at new "," at ");return v.displayName&&qe.includes("<anonymous>")&&(qe=qe.replace("<anonymous>",v.displayName)),qe}while(1<=ue&&0<=Se);break}}}finally{Vt=!1,Error.prepareStackTrace=M}return(v=v?v.displayName||v.name:"")?Ot(v):""}var un=Object.prototype.hasOwnProperty,Un=[],En=-1;function Bn(v){return{current:v}}function wt(v){0>En||(v.current=Un[En],Un[En]=null,En--)}function mt(v,y){En++,Un[En]=v.current,v.current=y}var on={},Kt=Bn(on),Fn=Bn(!1),fr=on;function Nn(v,y){var M=v.type.contextTypes;if(!M)return on;var b=v.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===y)return b.__reactInternalMemoizedMaskedChildContext;var k={},G;for(G in M)k[G]=y[G];return b&&(v=v.stateNode,v.__reactInternalMemoizedUnmaskedChildContext=y,v.__reactInternalMemoizedMaskedChildContext=k),k}function qn(v){return v=v.childContextTypes,v!=null}function yn(){wt(Fn),wt(Kt)}function Qi(v,y,M){if(Kt.current!==on)throw Error(o(168));mt(Kt,y),mt(Fn,M)}function jo(v,y,M){var b=v.stateNode;if(y=y.childContextTypes,typeof b.getChildContext!="function")return M;b=b.getChildContext();for(var k in b)if(!(k in y))throw Error(o(108,F(v)||"Unknown",k));return s({},M,b)}function _i(v){return v=(v=v.stateNode)&&v.__reactInternalMemoizedMergedChildContext||on,fr=Kt.current,mt(Kt,v),mt(Fn,Fn.current),!0}function Hi(v,y,M){var b=v.stateNode;if(!b)throw Error(o(169));M?(v=jo(v,y,fr),b.__reactInternalMemoizedMergedChildContext=v,wt(Fn),wt(Kt),mt(Kt,v)):wt(Fn),mt(Fn,M)}var Cr=Math.clz32?Math.clz32:gd,fo=Math.log,po=Math.LN2;function gd(v){return v>>>=0,v===0?32:31-(fo(v)/po|0)|0}var mo=64,mn=4194304;function Ko(v){switch(v&-v){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return v&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return v}}function ol(v,y){var M=v.pendingLanes;if(M===0)return 0;var b=0,k=v.suspendedLanes,G=v.pingedLanes,ue=M&268435455;if(ue!==0){var Se=ue&~k;Se!==0?b=Ko(Se):(G&=ue,G!==0&&(b=Ko(G)))}else ue=M&~k,ue!==0?b=Ko(ue):G!==0&&(b=Ko(G));if(b===0)return 0;if(y!==0&&y!==b&&(y&k)===0&&(k=b&-b,G=y&-y,k>=G||k===16&&(G&4194240)!==0))return y;if((b&4)!==0&&(b|=M&16),y=v.entangledLanes,y!==0)for(v=v.entanglements,y&=b;0<y;)M=31-Cr(y),k=1<<M,b|=v[M],y&=~k;return b}function hc(v,y){switch(v){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fc(v,y){for(var M=v.suspendedLanes,b=v.pingedLanes,k=v.expirationTimes,G=v.pendingLanes;0<G;){var ue=31-Cr(G),Se=1<<ue,qe=k[ue];qe===-1?((Se&M)===0||(Se&b)!==0)&&(k[ue]=hc(Se,y)):qe<=y&&(v.expiredLanes|=Se),G&=~Se}}function $o(v){return v=v.pendingLanes&-1073741825,v!==0?v:v&1073741824?1073741824:0}function Yl(v){for(var y=[],M=0;31>M;M++)y.push(v);return y}function zs(v,y,M){v.pendingLanes|=y,y!==536870912&&(v.suspendedLanes=0,v.pingedLanes=0),v=v.eventTimes,y=31-Cr(y),v[y]=M}function go(v,y){var M=v.pendingLanes&~y;v.pendingLanes=y,v.suspendedLanes=0,v.pingedLanes=0,v.expiredLanes&=y,v.mutableReadLanes&=y,v.entangledLanes&=y,y=v.entanglements;var b=v.eventTimes;for(v=v.expirationTimes;0<M;){var k=31-Cr(M),G=1<<k;y[k]=0,b[k]=-1,v[k]=-1,M&=~G}}function dr(v,y){var M=v.entangledLanes|=y;for(v=v.entanglements;M;){var b=31-Cr(M),k=1<<b;k&y|v[b]&y&&(v[b]|=y),M&=~k}}var Zt=0;function Vs(v){return v&=-v,1<v?4<v?(v&268435455)!==0?16:536870912:4:1}var As=i.unstable_scheduleCallback,Xo=i.unstable_cancelCallback,Ws=i.unstable_shouldYield,vd=i.unstable_requestPaint,ti=i.unstable_now,vo=i.unstable_ImmediatePriority,yd=i.unstable_UserBlockingPriority,br=i.unstable_NormalPriority,al=i.unstable_IdlePriority,ll=null,Es=null;function ya(v){if(Es&&typeof Es.onCommitFiberRoot=="function")try{Es.onCommitFiberRoot(ll,v,void 0,(v.current.flags&128)===128)}catch{}}function ul(v,y){return v===y&&(v!==0||1/v===1/y)||v!==v&&y!==y}var Zi=typeof Object.is=="function"?Object.is:ul,er=null,Yo=!1,js=!1;function Jl(v){er===null?er=[v]:er.push(v)}function cl(v){Yo=!0,Jl(v)}function Rr(){if(!js&&er!==null){js=!0;var v=0,y=Zt;try{var M=er;for(Zt=1;v<M.length;v++){var b=M[v];do b=b(!0);while(b!==null)}er=null,Yo=!1}catch(k){throw er!==null&&(er=er.slice(v+1)),As(vo,Rr),k}finally{Zt=y,js=!1}}return null}var hl=a.ReactCurrentBatchConfig;function is(v,y){if(Zi(v,y))return!0;if(typeof v!="object"||v===null||typeof y!="object"||y===null)return!1;var M=Object.keys(v),b=Object.keys(y);if(M.length!==b.length)return!1;for(b=0;b<M.length;b++){var k=M[b];if(!un.call(y,k)||!Zi(v[k],y[k]))return!1}return!0}function xa(v){switch(v.tag){case 5:return Ot(v.type);case 16:return Ot("Lazy");case 13:return Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 2:case 15:return v=Pt(v.type,!1),v;case 11:return v=Pt(v.type.render,!1),v;case 1:return v=Pt(v.type,!0),v;default:return""}}function tr(v,y){if(v&&v.defaultProps){y=s({},y),v=v.defaultProps;for(var M in v)y[M]===void 0&&(y[M]=v[M]);return y}return y}var zi=Bn(null),_a=null,rs=null,Sa=null;function nr(){Sa=rs=_a=null}function Aa(v,y,M){Ke?(mt(zi,y._currentValue),y._currentValue=M):(mt(zi,y._currentValue2),y._currentValue2=M)}function Li(v){var y=zi.current;wt(zi),Ke?v._currentValue=y:v._currentValue2=y}function Vi(v,y,M){for(;v!==null;){var b=v.alternate;if((v.childLanes&y)!==y?(v.childLanes|=y,b!==null&&(b.childLanes|=y)):b!==null&&(b.childLanes&y)!==y&&(b.childLanes|=y),v===M)break;v=v.return}}function Si(v,y){_a=v,Sa=rs=null,v=v.dependencies,v!==null&&v.firstContext!==null&&((v.lanes&y)!==0&&(or=!0),v.firstContext=null)}function oi(v){var y=Ke?v._currentValue:v._currentValue2;if(Sa!==v)if(v={context:v,memoizedValue:y,next:null},rs===null){if(_a===null)throw Error(o(308));rs=v,_a.dependencies={lanes:0,firstContext:v}}else rs=rs.next=v;return y}var Hr=null,Ks=!1;function dc(v){v.updateQueue={baseState:v.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Um(v,y){v=v.updateQueue,y.updateQueue===v&&(y.updateQueue={baseState:v.baseState,firstBaseUpdate:v.firstBaseUpdate,lastBaseUpdate:v.lastBaseUpdate,shared:v.shared,effects:v.effects})}function Ea(v,y){return{eventTime:v,lane:y,tag:0,payload:null,callback:null,next:null}}function fl(v,y){var M=v.updateQueue;M!==null&&(M=M.shared,Ei!==null&&(v.mode&1)!==0&&(an&2)===0?(v=M.interleaved,v===null?(y.next=y,Hr===null?Hr=[M]:Hr.push(M)):(y.next=v.next,v.next=y),M.interleaved=y):(v=M.pending,v===null?y.next=y:(y.next=v.next,v.next=y),M.pending=y))}function xd(v,y,M){if(y=y.updateQueue,y!==null&&(y=y.shared,(M&4194240)!==0)){var b=y.lanes;b&=v.pendingLanes,M|=b,y.lanes=M,dr(v,M)}}function _d(v,y){var M=v.updateQueue,b=v.alternate;if(b!==null&&(b=b.updateQueue,M===b)){var k=null,G=null;if(M=M.firstBaseUpdate,M!==null){do{var ue={eventTime:M.eventTime,lane:M.lane,tag:M.tag,payload:M.payload,callback:M.callback,next:null};G===null?k=G=ue:G=G.next=ue,M=M.next}while(M!==null);G===null?k=G=y:G=G.next=y}else k=G=y;M={baseState:b.baseState,firstBaseUpdate:k,lastBaseUpdate:G,shared:b.shared,effects:b.effects},v.updateQueue=M;return}v=M.lastBaseUpdate,v===null?M.firstBaseUpdate=y:v.next=y,M.lastBaseUpdate=y}function Sd(v,y,M,b){var k=v.updateQueue;Ks=!1;var G=k.firstBaseUpdate,ue=k.lastBaseUpdate,Se=k.shared.pending;if(Se!==null){k.shared.pending=null;var qe=Se,dt=qe.next;qe.next=null,ue===null?G=dt:ue.next=dt,ue=qe;var It=v.alternate;It!==null&&(It=It.updateQueue,Se=It.lastBaseUpdate,Se!==ue&&(Se===null?It.firstBaseUpdate=dt:Se.next=dt,It.lastBaseUpdate=qe))}if(G!==null){var tn=k.baseState;ue=0,It=dt=qe=null,Se=G;do{var jt=Se.lane,cn=Se.eventTime;if((b&jt)===jt){It!==null&&(It=It.next={eventTime:cn,lane:0,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null});e:{var Tt=v,xr=Se;switch(jt=y,cn=M,xr.tag){case 1:if(Tt=xr.payload,typeof Tt=="function"){tn=Tt.call(cn,tn,jt);break e}tn=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=xr.payload,jt=typeof Tt=="function"?Tt.call(cn,tn,jt):Tt,jt==null)break e;tn=s({},tn,jt);break e;case 2:Ks=!0}}Se.callback!==null&&Se.lane!==0&&(v.flags|=64,jt=k.effects,jt===null?k.effects=[Se]:jt.push(Se))}else cn={eventTime:cn,lane:jt,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null},It===null?(dt=It=cn,qe=tn):It=It.next=cn,ue|=jt;if(Se=Se.next,Se===null){if(Se=k.shared.pending,Se===null)break;jt=Se,Se=jt.next,jt.next=null,k.lastBaseUpdate=jt,k.shared.pending=null}}while(!0);if(It===null&&(qe=tn),k.baseState=qe,k.firstBaseUpdate=dt,k.lastBaseUpdate=It,y=k.shared.interleaved,y!==null){k=y;do ue|=k.lane,k=k.next;while(k!==y)}else G===null&&(k.shared.lanes=0);Zo|=ue,v.lanes=ue,v.memoizedState=tn}}function zv(v,y,M){if(v=y.effects,y.effects=null,v!==null)for(y=0;y<v.length;y++){var b=v[y],k=b.callback;if(k!==null){if(b.callback=null,b=M,typeof k!="function")throw Error(o(191,k));k.call(b)}}}var Vv=new n.Component().refs;function Nm(v,y,M,b){y=v.memoizedState,M=M(b,y),M=M==null?y:s({},y,M),v.memoizedState=M,v.lanes===0&&(v.updateQueue.baseState=M)}var Ad={isMounted:function(v){return(v=v._reactInternals)?D(v)===v:!1},enqueueSetState:function(v,y,M){v=v._reactInternals;var b=bn(),k=To(v),G=Ea(b,k);G.payload=y,M!=null&&(G.callback=M),fl(v,G),y=Pr(v,k,b),y!==null&&xd(y,v,k)},enqueueReplaceState:function(v,y,M){v=v._reactInternals;var b=bn(),k=To(v),G=Ea(b,k);G.tag=1,G.payload=y,M!=null&&(G.callback=M),fl(v,G),y=Pr(v,k,b),y!==null&&xd(y,v,k)},enqueueForceUpdate:function(v,y){v=v._reactInternals;var M=bn(),b=To(v),k=Ea(M,b);k.tag=2,y!=null&&(k.callback=y),fl(v,k),y=Pr(v,b,M),y!==null&&xd(y,v,b)}};function Gm(v,y,M,b,k,G,ue){return v=v.stateNode,typeof v.shouldComponentUpdate=="function"?v.shouldComponentUpdate(b,G,ue):y.prototype&&y.prototype.isPureReactComponent?!is(M,b)||!is(k,G):!0}function Wv(v,y,M){var b=!1,k=on,G=y.contextType;return typeof G=="object"&&G!==null?G=oi(G):(k=qn(y)?fr:Kt.current,b=y.contextTypes,G=(b=b!=null)?Nn(v,k):on),y=new y(M,G),v.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ad,v.stateNode=y,y._reactInternals=v,b&&(v=v.stateNode,v.__reactInternalMemoizedUnmaskedChildContext=k,v.__reactInternalMemoizedMaskedChildContext=G),y}function jv(v,y,M,b){v=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(M,b),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(M,b),y.state!==v&&Ad.enqueueReplaceState(y,y.state,null)}function Hm(v,y,M,b){var k=v.stateNode;k.props=M,k.state=v.memoizedState,k.refs=Vv,dc(v);var G=y.contextType;typeof G=="object"&&G!==null?k.context=oi(G):(G=qn(y)?fr:Kt.current,k.context=Nn(v,G)),k.state=v.memoizedState,G=y.getDerivedStateFromProps,typeof G=="function"&&(Nm(v,y,G,M),k.state=v.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(y=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),y!==k.state&&Ad.enqueueReplaceState(k,k.state,null),Sd(v,M,k,b),k.state=v.memoizedState),typeof k.componentDidMount=="function"&&(v.flags|=4194308)}var pc=[],dl=0,Ed=null,Td=0,$s=[],Ts=0,ql=null,Ta=1,Ma="";function Ql(v,y){pc[dl++]=Td,pc[dl++]=Ed,Ed=v,Td=y}function Kv(v,y,M){$s[Ts++]=Ta,$s[Ts++]=Ma,$s[Ts++]=ql,ql=v;var b=Ta;v=Ma;var k=32-Cr(b)-1;b&=~(1<<k),M+=1;var G=32-Cr(y)+k;if(30<G){var ue=k-k%5;G=(b&(1<<ue)-1).toString(32),b>>=ue,k-=ue,Ta=1<<32-Cr(y)+k|M<<k|b,Ma=G+v}else Ta=1<<G|M<<k|b,Ma=v}function zm(v){v.return!==null&&(Ql(v,1),Kv(v,1,0))}function Vm(v){for(;v===Ed;)Ed=pc[--dl],pc[dl]=null,Td=pc[--dl],pc[dl]=null;for(;v===ql;)ql=$s[--Ts],$s[Ts]=null,Ma=$s[--Ts],$s[Ts]=null,Ta=$s[--Ts],$s[Ts]=null}var zr=null,pr=null,ni=!1,mc=!1,Xs=null;function Wm(v,y){var M=Ls(5,null,null,0);M.elementType="DELETED",M.stateNode=y,M.return=v,y=v.deletions,y===null?(v.deletions=[M],v.flags|=16):y.push(M)}function jm(v,y){switch(v.tag){case 5:return y=Dn(y,v.type,v.pendingProps),y!==null?(v.stateNode=y,zr=v,pr=qi(y),!0):!1;case 6:return y=In(y,v.pendingProps),y!==null?(v.stateNode=y,zr=v,pr=null,!0):!1;case 13:if(y=xi(y),y!==null){var M=ql!==null?{id:Ta,overflow:Ma}:null;return v.memoizedState={dehydrated:y,treeContext:M,retryLane:1073741824},M=Ls(18,null,null,0),M.stateNode=y,M.return=v,v.child=M,zr=v,pr=null,!0}return!1;default:return!1}}function Md(v){return(v.mode&1)!==0&&(v.flags&128)===0}function pl(v){if(ni){var y=pr;if(y){var M=y;if(!jm(v,y)){if(Md(v))throw Error(o(418));y=Gi(M);var b=zr;y&&jm(v,y)?Wm(b,M):(v.flags=v.flags&-4097|2,ni=!1,zr=v)}}else{if(Md(v))throw Error(o(418));v.flags=v.flags&-4097|2,ni=!1,zr=v}}}function $v(v){for(v=v.return;v!==null&&v.tag!==5&&v.tag!==3&&v.tag!==13;)v=v.return;zr=v}function Eh(v){if(!Pe||v!==zr)return!1;if(!ni)return $v(v),ni=!0,!1;if(v.tag!==3&&(v.tag!==5||ft(v.type)&&!oe(v.type,v.memoizedProps))){var y=pr;if(y){if(Md(v)){for(v=pr;v;)v=Gi(v);throw Error(o(418))}for(;y;)Wm(v,y),y=Gi(y)}}if($v(v),v.tag===13){if(!Pe)throw Error(o(316));if(v=v.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(o(317));pr=ie(v)}else pr=zr?Gi(v.stateNode):null;return!0}function gc(){Pe&&(pr=zr=null,mc=ni=!1)}function wd(v){Xs===null?Xs=[v]:Xs.push(v)}function vc(v,y,M){if(v=M.ref,v!==null&&typeof v!="function"&&typeof v!="object"){if(M._owner){if(M=M._owner,M){if(M.tag!==1)throw Error(o(309));var b=M.stateNode}if(!b)throw Error(o(147,v));var k=b,G=""+v;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===G?y.ref:(y=function(ue){var Se=k.refs;Se===Vv&&(Se=k.refs={}),ue===null?delete Se[G]:Se[G]=ue},y._stringRef=G,y)}if(typeof v!="string")throw Error(o(284));if(!M._owner)throw Error(o(290,v))}return v}function ml(v,y){throw v=Object.prototype.toString.call(y),Error(o(31,v==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":v))}function yc(v){var y=v._init;return y(v._payload)}function Xv(v){function y(Ne,Me){if(v){var $e=Ne.deletions;$e===null?(Ne.deletions=[Me],Ne.flags|=16):$e.push(Me)}}function M(Ne,Me){if(!v)return null;for(;Me!==null;)y(Ne,Me),Me=Me.sibling;return null}function b(Ne,Me){for(Ne=new Map;Me!==null;)Me.key!==null?Ne.set(Me.key,Me):Ne.set(Me.index,Me),Me=Me.sibling;return Ne}function k(Ne,Me){return Ne=Na(Ne,Me),Ne.index=0,Ne.sibling=null,Ne}function G(Ne,Me,$e){return Ne.index=$e,v?($e=Ne.alternate,$e!==null?($e=$e.index,$e<Me?(Ne.flags|=2,Me):$e):(Ne.flags|=2,Me)):(Ne.flags|=1048576,Me)}function ue(Ne){return v&&Ne.alternate===null&&(Ne.flags|=2),Ne}function Se(Ne,Me,$e,Et){return Me===null||Me.tag!==6?(Me=Zd($e,Ne.mode,Et),Me.return=Ne,Me):(Me=k(Me,$e),Me.return=Ne,Me)}function qe(Ne,Me,$e,Et){var Ut=$e.type;return Ut===c?It(Ne,Me,$e.props.children,Et,$e.key):Me!==null&&(Me.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===E&&yc(Ut)===Me.type)?(Et=k(Me,$e.props),Et.ref=vc(Ne,Me,$e),Et.return=Ne,Et):(Et=Qd($e.type,$e.key,$e.props,null,Ne.mode,Et),Et.ref=vc(Ne,Me,$e),Et.return=Ne,Et)}function dt(Ne,Me,$e,Et){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==$e.containerInfo||Me.stateNode.implementation!==$e.implementation?(Me=ep($e,Ne.mode,Et),Me.return=Ne,Me):(Me=k(Me,$e.children||[]),Me.return=Ne,Me)}function It(Ne,Me,$e,Et,Ut){return Me===null||Me.tag!==7?(Me=_u($e,Ne.mode,Et,Ut),Me.return=Ne,Me):(Me=k(Me,$e),Me.return=Ne,Me)}function tn(Ne,Me,$e){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Me=Zd(""+Me,Ne.mode,$e),Me.return=Ne,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case l:return $e=Qd(Me.type,Me.key,Me.props,null,Ne.mode,$e),$e.ref=vc(Ne,null,Me),$e.return=Ne,$e;case u:return Me=ep(Me,Ne.mode,$e),Me.return=Ne,Me;case E:var Et=Me._init;return tn(Ne,Et(Me._payload),$e)}if(re(Me)||P(Me))return Me=_u(Me,Ne.mode,$e,null),Me.return=Ne,Me;ml(Ne,Me)}return null}function jt(Ne,Me,$e,Et){var Ut=Me!==null?Me.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number")return Ut!==null?null:Se(Ne,Me,""+$e,Et);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case l:return $e.key===Ut?qe(Ne,Me,$e,Et):null;case u:return $e.key===Ut?dt(Ne,Me,$e,Et):null;case E:return Ut=$e._init,jt(Ne,Me,Ut($e._payload),Et)}if(re($e)||P($e))return Ut!==null?null:It(Ne,Me,$e,Et,null);ml(Ne,$e)}return null}function cn(Ne,Me,$e,Et,Ut){if(typeof Et=="string"&&Et!==""||typeof Et=="number")return Ne=Ne.get($e)||null,Se(Me,Ne,""+Et,Ut);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case l:return Ne=Ne.get(Et.key===null?$e:Et.key)||null,qe(Me,Ne,Et,Ut);case u:return Ne=Ne.get(Et.key===null?$e:Et.key)||null,dt(Me,Ne,Et,Ut);case E:var rn=Et._init;return cn(Ne,Me,$e,rn(Et._payload),Ut)}if(re(Et)||P(Et))return Ne=Ne.get($e)||null,It(Me,Ne,Et,Ut,null);ml(Me,Et)}return null}function Tt(Ne,Me,$e,Et){for(var Ut=null,rn=null,nn=Me,Mn=Me=0,Di=null;nn!==null&&Mn<$e.length;Mn++){nn.index>Mn?(Di=nn,nn=null):Di=nn.sibling;var Tn=jt(Ne,nn,$e[Mn],Et);if(Tn===null){nn===null&&(nn=Di);break}v&&nn&&Tn.alternate===null&&y(Ne,nn),Me=G(Tn,Me,Mn),rn===null?Ut=Tn:rn.sibling=Tn,rn=Tn,nn=Di}if(Mn===$e.length)return M(Ne,nn),ni&&Ql(Ne,Mn),Ut;if(nn===null){for(;Mn<$e.length;Mn++)nn=tn(Ne,$e[Mn],Et),nn!==null&&(Me=G(nn,Me,Mn),rn===null?Ut=nn:rn.sibling=nn,rn=nn);return ni&&Ql(Ne,Mn),Ut}for(nn=b(Ne,nn);Mn<$e.length;Mn++)Di=cn(nn,Ne,Mn,$e[Mn],Et),Di!==null&&(v&&Di.alternate!==null&&nn.delete(Di.key===null?Mn:Di.key),Me=G(Di,Me,Mn),rn===null?Ut=Di:rn.sibling=Di,rn=Di);return v&&nn.forEach(function(Ga){return y(Ne,Ga)}),ni&&Ql(Ne,Mn),Ut}function xr(Ne,Me,$e,Et){var Ut=P($e);if(typeof Ut!="function")throw Error(o(150));if($e=Ut.call($e),$e==null)throw Error(o(151));for(var rn=Ut=null,nn=Me,Mn=Me=0,Di=null,Tn=$e.next();nn!==null&&!Tn.done;Mn++,Tn=$e.next()){nn.index>Mn?(Di=nn,nn=null):Di=nn.sibling;var Ga=jt(Ne,nn,Tn.value,Et);if(Ga===null){nn===null&&(nn=Di);break}v&&nn&&Ga.alternate===null&&y(Ne,nn),Me=G(Ga,Me,Mn),rn===null?Ut=Ga:rn.sibling=Ga,rn=Ga,nn=Di}if(Tn.done)return M(Ne,nn),ni&&Ql(Ne,Mn),Ut;if(nn===null){for(;!Tn.done;Mn++,Tn=$e.next())Tn=tn(Ne,Tn.value,Et),Tn!==null&&(Me=G(Tn,Me,Mn),rn===null?Ut=Tn:rn.sibling=Tn,rn=Tn);return ni&&Ql(Ne,Mn),Ut}for(nn=b(Ne,nn);!Tn.done;Mn++,Tn=$e.next())Tn=cn(nn,Ne,Mn,Tn.value,Et),Tn!==null&&(v&&Tn.alternate!==null&&nn.delete(Tn.key===null?Mn:Tn.key),Me=G(Tn,Me,Mn),rn===null?Ut=Tn:rn.sibling=Tn,rn=Tn);return v&&nn.forEach(function(Ag){return y(Ne,Ag)}),ni&&Ql(Ne,Mn),Ut}function Ps(Ne,Me,$e,Et){if(typeof $e=="object"&&$e!==null&&$e.type===c&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case l:e:{for(var Ut=$e.key,rn=Me;rn!==null;){if(rn.key===Ut){if(Ut=$e.type,Ut===c){if(rn.tag===7){M(Ne,rn.sibling),Me=k(rn,$e.props.children),Me.return=Ne,Ne=Me;break e}}else if(rn.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===E&&yc(Ut)===rn.type){M(Ne,rn.sibling),Me=k(rn,$e.props),Me.ref=vc(Ne,rn,$e),Me.return=Ne,Ne=Me;break e}M(Ne,rn);break}else y(Ne,rn);rn=rn.sibling}$e.type===c?(Me=_u($e.props.children,Ne.mode,Et,$e.key),Me.return=Ne,Ne=Me):(Et=Qd($e.type,$e.key,$e.props,null,Ne.mode,Et),Et.ref=vc(Ne,Me,$e),Et.return=Ne,Ne=Et)}return ue(Ne);case u:e:{for(rn=$e.key;Me!==null;){if(Me.key===rn)if(Me.tag===4&&Me.stateNode.containerInfo===$e.containerInfo&&Me.stateNode.implementation===$e.implementation){M(Ne,Me.sibling),Me=k(Me,$e.children||[]),Me.return=Ne,Ne=Me;break e}else{M(Ne,Me);break}else y(Ne,Me);Me=Me.sibling}Me=ep($e,Ne.mode,Et),Me.return=Ne,Ne=Me}return ue(Ne);case E:return rn=$e._init,Ps(Ne,Me,rn($e._payload),Et)}if(re($e))return Tt(Ne,Me,$e,Et);if(P($e))return xr(Ne,Me,$e,Et);ml(Ne,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"?($e=""+$e,Me!==null&&Me.tag===6?(M(Ne,Me.sibling),Me=k(Me,$e),Me.return=Ne,Ne=Me):(M(Ne,Me),Me=Zd($e,Ne.mode,Et),Me.return=Ne,Ne=Me),ue(Ne)):M(Ne,Me)}return Ps}var wa=Xv(!0),Yv=Xv(!1),xc={},ss=Bn(xc),Zl=Bn(xc),eu=Bn(xc);function yo(v){if(v===xc)throw Error(o(174));return v}function Cd(v,y){mt(eu,y),mt(Zl,v),mt(ss,xc),v=se(y),wt(ss),mt(ss,v)}function _c(){wt(ss),wt(Zl),wt(eu)}function Jv(v){var y=yo(eu.current),M=yo(ss.current);y=W(M,v.type,y),M!==y&&(mt(Zl,v),mt(ss,y))}function Km(v){Zl.current===v&&(wt(ss),wt(Zl))}var ai=Bn(0);function bd(v){for(var y=v;y!==null;){if(y.tag===13){var M=y.memoizedState;if(M!==null&&(M=M.dehydrated,M===null||ns(M)||Ri(M)))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===v)break;for(;y.sibling===null;){if(y.return===null||y.return===v)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var Ms=[];function tu(){for(var v=0;v<Ms.length;v++){var y=Ms[v];Ke?y._workInProgressVersionPrimary=null:y._workInProgressVersionSecondary=null}Ms.length=0}var Th=a.ReactCurrentDispatcher,ws=a.ReactCurrentBatchConfig,nu=0,li=null,ir=null,rr=null,Rd=!1,Jo=!1,iu=0,Mh=0;function sr(){throw Error(o(321))}function Id(v,y){if(y===null)return!1;for(var M=0;M<y.length&&M<v.length;M++)if(!Zi(v[M],y[M]))return!1;return!0}function Sc(v,y,M,b,k,G){if(nu=G,li=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,Th.current=v===null||v.memoizedState===null?Qm:Zm,v=M(b,k),Jo){G=0;do{if(Jo=!1,iu=0,25<=G)throw Error(o(301));G+=1,rr=ir=null,y.updateQueue=null,Th.current=eg,v=M(b,k)}while(Jo)}if(Th.current=Mc,y=ir!==null&&ir.next!==null,nu=0,rr=ir=li=null,Rd=!1,y)throw Error(o(300));return v}function gl(){var v=iu!==0;return iu=0,v}function xo(){var v={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?li.memoizedState=rr=v:rr=rr.next=v,rr}function _o(){if(ir===null){var v=li.alternate;v=v!==null?v.memoizedState:null}else v=ir.next;var y=rr===null?li.memoizedState:rr.next;if(y!==null)rr=y,ir=v;else{if(v===null)throw Error(o(310));ir=v,v={memoizedState:ir.memoizedState,baseState:ir.baseState,baseQueue:ir.baseQueue,queue:ir.queue,next:null},rr===null?li.memoizedState=rr=v:rr=rr.next=v}return rr}function qo(v,y){return typeof y=="function"?y(v):y}function wh(v){var y=_o(),M=y.queue;if(M===null)throw Error(o(311));M.lastRenderedReducer=v;var b=ir,k=b.baseQueue,G=M.pending;if(G!==null){if(k!==null){var ue=k.next;k.next=G.next,G.next=ue}b.baseQueue=k=G,M.pending=null}if(k!==null){G=k.next,b=b.baseState;var Se=ue=null,qe=null,dt=G;do{var It=dt.lane;if((nu&It)===It)qe!==null&&(qe=qe.next={lane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),b=dt.hasEagerState?dt.eagerState:v(b,dt.action);else{var tn={lane:It,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null};qe===null?(Se=qe=tn,ue=b):qe=qe.next=tn,li.lanes|=It,Zo|=It}dt=dt.next}while(dt!==null&&dt!==G);qe===null?ue=b:qe.next=Se,Zi(b,y.memoizedState)||(or=!0),y.memoizedState=b,y.baseState=ue,y.baseQueue=qe,M.lastRenderedState=b}if(v=M.interleaved,v!==null){k=v;do G=k.lane,li.lanes|=G,Zo|=G,k=k.next;while(k!==v)}else k===null&&(M.lanes=0);return[y.memoizedState,M.dispatch]}function Ch(v){var y=_o(),M=y.queue;if(M===null)throw Error(o(311));M.lastRenderedReducer=v;var b=M.dispatch,k=M.pending,G=y.memoizedState;if(k!==null){M.pending=null;var ue=k=k.next;do G=v(G,ue.action),ue=ue.next;while(ue!==k);Zi(G,y.memoizedState)||(or=!0),y.memoizedState=G,y.baseQueue===null&&(y.baseState=G),M.lastRenderedState=G}return[G,b]}function $m(){}function Xm(v,y){var M=li,b=_o(),k=y(),G=!Zi(b.memoizedState,k);if(G&&(b.memoizedState=k,or=!0),b=b.queue,Ac(Ca.bind(null,M,b,v),[v]),b.getSnapshot!==y||G||rr!==null&&rr.memoizedState.tag&1){if(M.flags|=2048,Rh(9,Jm.bind(null,M,b,k,y),void 0,null),Ei===null)throw Error(o(349));(nu&30)!==0||Ym(M,y,k)}return k}function Ym(v,y,M){v.flags|=16384,v={getSnapshot:y,value:M},y=li.updateQueue,y===null?(y={lastEffect:null,stores:null},li.updateQueue=y,y.stores=[v]):(M=y.stores,M===null?y.stores=[v]:M.push(v))}function Jm(v,y,M,b){y.value=M,y.getSnapshot=b,Ld(y)&&Pr(v,1,-1)}function Ca(v,y,M){return M(function(){Ld(y)&&Pr(v,1,-1)})}function Ld(v){var y=v.getSnapshot;v=v.value;try{var M=y();return!Zi(v,M)}catch{return!0}}function bh(v){var y=xo();return typeof v=="function"&&(v=v()),y.memoizedState=y.baseState=v,v={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:v},y.queue=v,v=v.dispatch=NA.bind(null,li,v),[y.memoizedState,v]}function Rh(v,y,M,b){return v={tag:v,create:y,destroy:M,deps:b,next:null},y=li.updateQueue,y===null?(y={lastEffect:null,stores:null},li.updateQueue=y,y.lastEffect=v.next=v):(M=y.lastEffect,M===null?y.lastEffect=v.next=v:(b=M.next,M.next=v,v.next=b,y.lastEffect=v)),v}function qv(){return _o().memoizedState}function vl(v,y,M,b){var k=xo();li.flags|=v,k.memoizedState=Rh(1|y,M,void 0,b===void 0?null:b)}function Pd(v,y,M,b){var k=_o();b=b===void 0?null:b;var G=void 0;if(ir!==null){var ue=ir.memoizedState;if(G=ue.destroy,b!==null&&Id(b,ue.deps)){k.memoizedState=Rh(y,M,G,b);return}}li.flags|=v,k.memoizedState=Rh(1|y,M,G,b)}function Dd(v,y){return vl(8390656,8,v,y)}function Ac(v,y){return Pd(2048,8,v,y)}function Xn(v,y){return Pd(4,2,v,y)}function Bd(v,y){return Pd(4,4,v,y)}function Ih(v,y){if(typeof y=="function")return v=v(),y(v),function(){y(null)};if(y!=null)return v=v(),y.current=v,function(){y.current=null}}function Ec(v,y,M){return M=M!=null?M.concat([v]):null,Pd(4,4,Ih.bind(null,y,v),M)}function Fd(){}function kd(v,y){var M=_o();y=y===void 0?null:y;var b=M.memoizedState;return b!==null&&y!==null&&Id(y,b[1])?b[0]:(M.memoizedState=[v,y],v)}function Tc(v,y){var M=_o();y=y===void 0?null:y;var b=M.memoizedState;return b!==null&&y!==null&&Id(y,b[1])?b[0]:(v=v(),M.memoizedState=[v,y],v)}function Od(v,y){var M=Zt;Zt=M!==0&&4>M?M:4,v(!0);var b=ws.transition;ws.transition={};try{v(!1),y()}finally{Zt=M,ws.transition=b}}function ru(){return _o().memoizedState}function Qv(v,y,M){var b=To(v);M={lane:b,action:M,hasEagerState:!1,eagerState:null,next:null},Zv(v)?qm(y,M):(Lh(v,y,M),M=bn(),v=Pr(v,b,M),v!==null&&Ph(v,y,b))}function NA(v,y,M){var b=To(v),k={lane:b,action:M,hasEagerState:!1,eagerState:null,next:null};if(Zv(v))qm(y,k);else{Lh(v,y,k);var G=v.alternate;if(v.lanes===0&&(G===null||G.lanes===0)&&(G=y.lastRenderedReducer,G!==null))try{var ue=y.lastRenderedState,Se=G(ue,M);if(k.hasEagerState=!0,k.eagerState=Se,Zi(Se,ue))return}catch{}finally{}M=bn(),v=Pr(v,b,M),v!==null&&Ph(v,y,b)}}function Zv(v){var y=v.alternate;return v===li||y!==null&&y===li}function qm(v,y){Jo=Rd=!0;var M=v.pending;M===null?y.next=y:(y.next=M.next,M.next=y),v.pending=y}function Lh(v,y,M){Ei!==null&&(v.mode&1)!==0&&(an&2)===0?(v=y.interleaved,v===null?(M.next=M,Hr===null?Hr=[y]:Hr.push(y)):(M.next=v.next,v.next=M),y.interleaved=M):(v=y.pending,v===null?M.next=M:(M.next=v.next,v.next=M),y.pending=M)}function Ph(v,y,M){if((M&4194240)!==0){var b=y.lanes;b&=v.pendingLanes,M|=b,y.lanes=M,dr(v,M)}}var Mc={readContext:oi,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useInsertionEffect:sr,useLayoutEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useMutableSource:sr,useSyncExternalStore:sr,useId:sr,unstable_isNewReconciler:!1},Qm={readContext:oi,useCallback:function(v,y){return xo().memoizedState=[v,y===void 0?null:y],v},useContext:oi,useEffect:Dd,useImperativeHandle:function(v,y,M){return M=M!=null?M.concat([v]):null,vl(4194308,4,Ih.bind(null,y,v),M)},useLayoutEffect:function(v,y){return vl(4194308,4,v,y)},useInsertionEffect:function(v,y){return vl(4,2,v,y)},useMemo:function(v,y){var M=xo();return y=y===void 0?null:y,v=v(),M.memoizedState=[v,y],v},useReducer:function(v,y,M){var b=xo();return y=M!==void 0?M(y):y,b.memoizedState=b.baseState=y,v={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:v,lastRenderedState:y},b.queue=v,v=v.dispatch=Qv.bind(null,li,v),[b.memoizedState,v]},useRef:function(v){var y=xo();return v={current:v},y.memoizedState=v},useState:bh,useDebugValue:Fd,useDeferredValue:function(v){var y=bh(v),M=y[0],b=y[1];return Dd(function(){var k=ws.transition;ws.transition={};try{b(v)}finally{ws.transition=k}},[v]),M},useTransition:function(){var v=bh(!1),y=v[0];return v=Od.bind(null,v[1]),xo().memoizedState=v,[y,v]},useMutableSource:function(){},useSyncExternalStore:function(v,y,M){var b=li,k=xo();if(ni){if(M===void 0)throw Error(o(407));M=M()}else{if(M=y(),Ei===null)throw Error(o(349));(nu&30)!==0||Ym(b,y,M)}k.memoizedState=M;var G={value:M,getSnapshot:y};return k.queue=G,Dd(Ca.bind(null,b,G,v),[v]),b.flags|=2048,Rh(9,Jm.bind(null,b,G,M,y),void 0,null),M},useId:function(){var v=xo(),y=Ei.identifierPrefix;if(ni){var M=Ma,b=Ta;M=(b&~(1<<32-Cr(b)-1)).toString(32)+M,y=":"+y+"R"+M,M=iu++,0<M&&(y+="H"+M.toString(32)),y+=":"}else M=Mh++,y=":"+y+"r"+M.toString(32)+":";return v.memoizedState=y},unstable_isNewReconciler:!1},Zm={readContext:oi,useCallback:kd,useContext:oi,useEffect:Ac,useImperativeHandle:Ec,useInsertionEffect:Xn,useLayoutEffect:Bd,useMemo:Tc,useReducer:wh,useRef:qv,useState:function(){return wh(qo)},useDebugValue:Fd,useDeferredValue:function(v){var y=wh(qo),M=y[0],b=y[1];return Ac(function(){var k=ws.transition;ws.transition={};try{b(v)}finally{ws.transition=k}},[v]),M},useTransition:function(){var v=wh(qo)[0],y=_o().memoizedState;return[v,y]},useMutableSource:$m,useSyncExternalStore:Xm,useId:ru,unstable_isNewReconciler:!1},eg={readContext:oi,useCallback:kd,useContext:oi,useEffect:Ac,useImperativeHandle:Ec,useInsertionEffect:Xn,useLayoutEffect:Bd,useMemo:Tc,useReducer:Ch,useRef:qv,useState:function(){return Ch(qo)},useDebugValue:Fd,useDeferredValue:function(v){var y=Ch(qo),M=y[0],b=y[1];return Ac(function(){var k=ws.transition;ws.transition={};try{b(v)}finally{ws.transition=k}},[v]),M},useTransition:function(){var v=Ch(qo)[0],y=_o().memoizedState;return[v,y]},useMutableSource:$m,useSyncExternalStore:Xm,useId:ru,unstable_isNewReconciler:!1};function tg(v,y){try{var M="",b=y;do M+=xa(b),b=b.return;while(b);var k=M}catch(G){k=`
Error generating stack: `+G.message+`
`+G.stack}return{value:v,source:y,stack:k}}function Ud(v,y){try{console.error(y.value)}catch(M){setTimeout(function(){throw M})}}var GA=typeof WeakMap=="function"?WeakMap:Map;function ey(v,y,M){M=Ea(-1,M),M.tag=3,M.payload={element:null};var b=y.value;return M.callback=function(){Lc||(Lc=!0,Zn=b),Ud(v,y)},M}function Nd(v,y,M){M=Ea(-1,M),M.tag=3;var b=v.type.getDerivedStateFromError;if(typeof b=="function"){var k=y.value;M.payload=function(){return b(k)},M.callback=function(){Ud(v,y)}}var G=v.stateNode;return G!==null&&typeof G.componentDidCatch=="function"&&(M.callback=function(){Ud(v,y),typeof b!="function"&&(Eo===null?Eo=new Set([this]):Eo.add(this));var ue=y.stack;this.componentDidCatch(y.value,{componentStack:ue!==null?ue:""})}),M}function ba(v,y,M){var b=v.pingCache;if(b===null){b=v.pingCache=new GA;var k=new Set;b.set(y,k)}else k=b.get(y),k===void 0&&(k=new Set,b.set(y,k));k.has(M)||(k.add(M),v=xg.bind(null,v,y,M),y.then(v,v))}function ng(v){do{var y;if((y=v.tag===13)&&(y=v.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return v;v=v.return}while(v!==null);return null}function su(v,y,M,b,k){return(v.mode&1)===0?(v===y?v.flags|=65536:(v.flags|=128,M.flags|=131072,M.flags&=-52805,M.tag===1&&(M.alternate===null?M.tag=17:(y=Ea(-1,1),y.tag=2,fl(M,y))),M.lanes|=1),v):(v.flags|=65536,v.lanes=k,v)}function Wi(v){v.flags|=4}function wc(v,y){if(v!==null&&v.child===y.child)return!0;if((y.flags&16)!==0)return!1;for(v=y.child;v!==null;){if((v.flags&12854)!==0||(v.subtreeFlags&12854)!==0)return!1;v=v.sibling}return!0}var Cs,ou,Gd,Hd;if(De)Cs=function(v,y){for(var M=y.child;M!==null;){if(M.tag===5||M.tag===6)X(v,M.stateNode);else if(M.tag!==4&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===y)break;for(;M.sibling===null;){if(M.return===null||M.return===y)return;M=M.return}M.sibling.return=M.return,M=M.sibling}},ou=function(){},Gd=function(v,y,M,b,k){if(v=v.memoizedProps,v!==b){var G=y.stateNode,ue=yo(ss.current);M=Z(G,M,v,b,k,ue),(y.updateQueue=M)&&Wi(y)}},Hd=function(v,y,M,b){M!==b&&Wi(y)};else if(K){Cs=function(v,y,M,b){for(var k=y.child;k!==null;){if(k.tag===5){var G=k.stateNode;M&&b&&(G=Qt(G,k.type,k.memoizedProps,k)),X(v,G)}else if(k.tag===6)G=k.stateNode,M&&b&&(G=vn(G,k.memoizedProps,k)),X(v,G);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)G=k.child,G!==null&&(G.return=k),Cs(v,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===y)break;for(;k.sibling===null;){if(k.return===null||k.return===y)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};var yl=function(v,y,M,b){for(var k=y.child;k!==null;){if(k.tag===5){var G=k.stateNode;M&&b&&(G=Qt(G,k.type,k.memoizedProps,k)),Ht(v,G)}else if(k.tag===6)G=k.stateNode,M&&b&&(G=vn(G,k.memoizedProps,k)),Ht(v,G);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)G=k.child,G!==null&&(G.return=k),yl(v,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===y)break;for(;k.sibling===null;){if(k.return===null||k.return===y)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};ou=function(v,y){var M=y.stateNode;if(!wc(v,y)){v=M.containerInfo;var b=_t(v);yl(b,y,!1,!1),M.pendingChildren=b,Wi(y),zt(v,b)}},Gd=function(v,y,M,b,k){var G=v.stateNode,ue=v.memoizedProps;if((v=wc(v,y))&&ue===b)y.stateNode=G;else{var Se=y.stateNode,qe=yo(ss.current),dt=null;ue!==b&&(dt=Z(Se,M,ue,b,k,qe)),v&&dt===null?y.stateNode=G:(G=xt(G,dt,M,ue,b,y,v,Se),le(G,M,b,k,qe)&&Wi(y),y.stateNode=G,v?Wi(y):Cs(G,y,!1,!1))}},Hd=function(v,y,M,b){M!==b?(v=yo(eu.current),M=yo(ss.current),y.stateNode=pe(b,v,M,y),Wi(y)):y.stateNode=v.stateNode}}else ou=function(){},Gd=function(){},Hd=function(){};function Ra(v,y){if(!ni)switch(v.tailMode){case"hidden":y=v.tail;for(var M=null;y!==null;)y.alternate!==null&&(M=y),y=y.sibling;M===null?v.tail=null:M.sibling=null;break;case"collapsed":M=v.tail;for(var b=null;M!==null;)M.alternate!==null&&(b=M),M=M.sibling;b===null?y||v.tail===null?v.tail=null:v.tail.sibling=null:b.sibling=null}}function Ai(v){var y=v.alternate!==null&&v.alternate.child===v.child,M=0,b=0;if(y)for(var k=v.child;k!==null;)M|=k.lanes|k.childLanes,b|=k.subtreeFlags&14680064,b|=k.flags&14680064,k.return=v,k=k.sibling;else for(k=v.child;k!==null;)M|=k.lanes|k.childLanes,b|=k.subtreeFlags,b|=k.flags,k.return=v,k=k.sibling;return v.subtreeFlags|=b,v.childLanes=M,y}function zd(v,y,M){var b=y.pendingProps;switch(Vm(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ai(y),null;case 1:return qn(y.type)&&yn(),Ai(y),null;case 3:return b=y.stateNode,_c(),wt(Fn),wt(Kt),tu(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(v===null||v.child===null)&&(Eh(y)?Wi(y):v===null||v.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,Xs!==null&&(jh(Xs),Xs=null))),ou(v,y),Ai(y),null;case 5:Km(y),M=yo(eu.current);var k=y.type;if(v!==null&&y.stateNode!=null)Gd(v,y,k,b,M),v.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!b){if(y.stateNode===null)throw Error(o(166));return Ai(y),null}if(v=yo(ss.current),Eh(y)){if(!Pe)throw Error(o(175));v=uc(y.stateNode,y.type,y.memoizedProps,M,v,y,!mc),y.updateQueue=v,v!==null&&Wi(y)}else{var G=U(k,b,M,v,y);Cs(G,y,!1,!1),y.stateNode=G,le(G,k,b,M,v)&&Wi(y)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return Ai(y),null;case 6:if(v&&y.stateNode!=null)Hd(v,y,v.memoizedProps,b);else{if(typeof b!="string"&&y.stateNode===null)throw Error(o(166));if(v=yo(eu.current),M=yo(ss.current),Eh(y)){if(!Pe)throw Error(o(176));if(v=y.stateNode,b=y.memoizedProps,(M=Ss(v,b,y,!mc))&&(k=zr,k!==null))switch(G=(k.mode&1)!==0,k.tag){case 3:At(k.stateNode.containerInfo,v,b,G);break;case 5:Rt(k.type,k.memoizedProps,k.stateNode,v,b,G)}M&&Wi(y)}else y.stateNode=pe(b,v,M,y)}return Ai(y),null;case 13:if(wt(ai),b=y.memoizedState,ni&&pr!==null&&(y.mode&1)!==0&&(y.flags&128)===0){for(v=pr;v;)v=Gi(v);return gc(),y.flags|=98560,y}if(b!==null&&b.dehydrated!==null){if(b=Eh(y),v===null){if(!b)throw Error(o(318));if(!Pe)throw Error(o(344));if(v=y.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(o(317));cc(v,y)}else gc(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;return Ai(y),null}return Xs!==null&&(jh(Xs),Xs=null),(y.flags&128)!==0?(y.lanes=M,y):(b=b!==null,M=!1,v===null?Eh(y):M=v.memoizedState!==null,b&&!M&&(y.child.flags|=8192,(y.mode&1)!==0&&(v===null||(ai.current&1)!==0?fi===0&&(fi=3):Yd())),y.updateQueue!==null&&(y.flags|=4),Ai(y),null);case 4:return _c(),ou(v,y),v===null&&Xe(y.stateNode.containerInfo),Ai(y),null;case 10:return Li(y.type._context),Ai(y),null;case 17:return qn(y.type)&&yn(),Ai(y),null;case 19:if(wt(ai),k=y.memoizedState,k===null)return Ai(y),null;if(b=(y.flags&128)!==0,G=k.rendering,G===null)if(b)Ra(k,!1);else{if(fi!==0||v!==null&&(v.flags&128)!==0)for(v=y.child;v!==null;){if(G=bd(v),G!==null){for(y.flags|=128,Ra(k,!1),v=G.updateQueue,v!==null&&(y.updateQueue=v,y.flags|=4),y.subtreeFlags=0,v=M,b=y.child;b!==null;)M=b,k=v,M.flags&=14680066,G=M.alternate,G===null?(M.childLanes=0,M.lanes=k,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=G.childLanes,M.lanes=G.lanes,M.child=G.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=G.memoizedProps,M.memoizedState=G.memoizedState,M.updateQueue=G.updateQueue,M.type=G.type,k=G.dependencies,M.dependencies=k===null?null:{lanes:k.lanes,firstContext:k.firstContext}),b=b.sibling;return mt(ai,ai.current&1|2),y.child}v=v.sibling}k.tail!==null&&ti()>Sl&&(y.flags|=128,b=!0,Ra(k,!1),y.lanes=4194304)}else{if(!b)if(v=bd(G),v!==null){if(y.flags|=128,b=!0,v=v.updateQueue,v!==null&&(y.updateQueue=v,y.flags|=4),Ra(k,!0),k.tail===null&&k.tailMode==="hidden"&&!G.alternate&&!ni)return Ai(y),null}else 2*ti()-k.renderingStartTime>Sl&&M!==1073741824&&(y.flags|=128,b=!0,Ra(k,!1),y.lanes=4194304);k.isBackwards?(G.sibling=y.child,y.child=G):(v=k.last,v!==null?v.sibling=G:y.child=G,k.last=G)}return k.tail!==null?(y=k.tail,k.rendering=y,k.tail=y.sibling,k.renderingStartTime=ti(),y.sibling=null,v=ai.current,mt(ai,b?v&1|2:v&1),y):(Ai(y),null);case 22:case 23:return Kh(),b=y.memoizedState!==null,v!==null&&v.memoizedState!==null!==b&&(y.flags|=8192),b&&(y.mode&1)!==0?(Lr&1073741824)!==0&&(Ai(y),De&&y.subtreeFlags&6&&(y.flags|=8192)):Ai(y),null;case 24:return null;case 25:return null}throw Error(o(156,y.tag))}var ig=a.ReactCurrentOwner,or=!1;function hi(v,y,M,b){y.child=v===null?Yv(y,null,M,b):wa(y,v.child,M,b)}function Yn(v,y,M,b,k){M=M.render;var G=y.ref;return Si(y,k),b=Sc(v,y,M,b,G,k),M=gl(),v!==null&&!or?(y.updateQueue=v.updateQueue,y.flags&=-2053,v.lanes&=~k,os(v,y,k)):(ni&&M&&zm(y),y.flags|=1,hi(v,y,b,k),y.child)}function jn(v,y,M,b,k){if(v===null){var G=M.type;return typeof G=="function"&&!qd(G)&&G.defaultProps===void 0&&M.compare===null&&M.defaultProps===void 0?(y.tag=15,y.type=G,Ia(v,y,G,b,k)):(v=Qd(M.type,null,b,y,y.mode,k),v.ref=y.ref,v.return=y,y.child=v)}if(G=v.child,(v.lanes&k)===0){var ue=G.memoizedProps;if(M=M.compare,M=M!==null?M:is,M(ue,b)&&v.ref===y.ref)return os(v,y,k)}return y.flags|=1,v=Na(G,b),v.ref=y.ref,v.return=y,y.child=v}function Ia(v,y,M,b,k){if(v!==null&&is(v.memoizedProps,b)&&v.ref===y.ref)if(or=!1,(v.lanes&k)!==0)(v.flags&131072)!==0&&(or=!0);else return y.lanes=v.lanes,os(v,y,k);return La(v,y,M,b,k)}function mr(v,y,M){var b=y.pendingProps,k=b.children,G=v!==null?v.memoizedState:null;if(b.mode==="hidden")if((y.mode&1)===0)y.memoizedState={baseLanes:0,cachePool:null},mt(mu,Lr),Lr|=M;else if((M&1073741824)!==0)y.memoizedState={baseLanes:0,cachePool:null},b=G!==null?G.baseLanes:M,mt(mu,Lr),Lr|=b;else return v=G!==null?G.baseLanes|M:M,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:v,cachePool:null},y.updateQueue=null,mt(mu,Lr),Lr|=v,null;else G!==null?(b=G.baseLanes|M,y.memoizedState=null):b=M,mt(mu,Lr),Lr|=b;return hi(v,y,k,M),y.child}function Vr(v,y){var M=y.ref;(v===null&&M!==null||v!==null&&v.ref!==M)&&(y.flags|=512,y.flags|=2097152)}function La(v,y,M,b,k){var G=qn(M)?fr:Kt.current;return G=Nn(y,G),Si(y,k),M=Sc(v,y,M,b,G,k),b=gl(),v!==null&&!or?(y.updateQueue=v.updateQueue,y.flags&=-2053,v.lanes&=~k,os(v,y,k)):(ni&&b&&zm(y),y.flags|=1,hi(v,y,M,k),y.child)}function au(v,y,M,b,k){if(qn(M)){var G=!0;_i(y)}else G=!1;if(Si(y,k),y.stateNode===null)v!==null&&(v.alternate=null,y.alternate=null,y.flags|=2),Wv(y,M,b),Hm(y,M,b,k),b=!0;else if(v===null){var ue=y.stateNode,Se=y.memoizedProps;ue.props=Se;var qe=ue.context,dt=M.contextType;typeof dt=="object"&&dt!==null?dt=oi(dt):(dt=qn(M)?fr:Kt.current,dt=Nn(y,dt));var It=M.getDerivedStateFromProps,tn=typeof It=="function"||typeof ue.getSnapshotBeforeUpdate=="function";tn||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Se!==b||qe!==dt)&&jv(y,ue,b,dt),Ks=!1;var jt=y.memoizedState;ue.state=jt,Sd(y,b,ue,k),qe=y.memoizedState,Se!==b||jt!==qe||Fn.current||Ks?(typeof It=="function"&&(Nm(y,M,It,b),qe=y.memoizedState),(Se=Ks||Gm(y,M,Se,b,jt,qe,dt))?(tn||typeof ue.UNSAFE_componentWillMount!="function"&&typeof ue.componentWillMount!="function"||(typeof ue.componentWillMount=="function"&&ue.componentWillMount(),typeof ue.UNSAFE_componentWillMount=="function"&&ue.UNSAFE_componentWillMount()),typeof ue.componentDidMount=="function"&&(y.flags|=4194308)):(typeof ue.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=b,y.memoizedState=qe),ue.props=b,ue.state=qe,ue.context=dt,b=Se):(typeof ue.componentDidMount=="function"&&(y.flags|=4194308),b=!1)}else{ue=y.stateNode,Um(v,y),Se=y.memoizedProps,dt=y.type===y.elementType?Se:tr(y.type,Se),ue.props=dt,tn=y.pendingProps,jt=ue.context,qe=M.contextType,typeof qe=="object"&&qe!==null?qe=oi(qe):(qe=qn(M)?fr:Kt.current,qe=Nn(y,qe));var cn=M.getDerivedStateFromProps;(It=typeof cn=="function"||typeof ue.getSnapshotBeforeUpdate=="function")||typeof ue.UNSAFE_componentWillReceiveProps!="function"&&typeof ue.componentWillReceiveProps!="function"||(Se!==tn||jt!==qe)&&jv(y,ue,b,qe),Ks=!1,jt=y.memoizedState,ue.state=jt,Sd(y,b,ue,k);var Tt=y.memoizedState;Se!==tn||jt!==Tt||Fn.current||Ks?(typeof cn=="function"&&(Nm(y,M,cn,b),Tt=y.memoizedState),(dt=Ks||Gm(y,M,dt,b,jt,Tt,qe)||!1)?(It||typeof ue.UNSAFE_componentWillUpdate!="function"&&typeof ue.componentWillUpdate!="function"||(typeof ue.componentWillUpdate=="function"&&ue.componentWillUpdate(b,Tt,qe),typeof ue.UNSAFE_componentWillUpdate=="function"&&ue.UNSAFE_componentWillUpdate(b,Tt,qe)),typeof ue.componentDidUpdate=="function"&&(y.flags|=4),typeof ue.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof ue.componentDidUpdate!="function"||Se===v.memoizedProps&&jt===v.memoizedState||(y.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||Se===v.memoizedProps&&jt===v.memoizedState||(y.flags|=1024),y.memoizedProps=b,y.memoizedState=Tt),ue.props=b,ue.state=Tt,ue.context=qe,b=dt):(typeof ue.componentDidUpdate!="function"||Se===v.memoizedProps&&jt===v.memoizedState||(y.flags|=4),typeof ue.getSnapshotBeforeUpdate!="function"||Se===v.memoizedProps&&jt===v.memoizedState||(y.flags|=1024),b=!1)}return Ir(v,y,M,b,G,k)}function Ir(v,y,M,b,k,G){Vr(v,y);var ue=(y.flags&128)!==0;if(!b&&!ue)return k&&Hi(y,M,!1),os(v,y,G);b=y.stateNode,ig.current=y;var Se=ue&&typeof M.getDerivedStateFromError!="function"?null:b.render();return y.flags|=1,v!==null&&ue?(y.child=wa(y,v.child,null,G),y.child=wa(y,null,Se,G)):hi(v,y,Se,G),y.memoizedState=b.state,k&&Hi(y,M,!0),y.child}function Dh(v){var y=v.stateNode;y.pendingContext?Qi(v,y.pendingContext,y.pendingContext!==y.context):y.context&&Qi(v,y.context,!1),Cd(v,y.containerInfo)}function rg(v,y,M,b,k){return gc(),wd(k),y.flags|=256,hi(v,y,M,b),y.child}var Bh={dehydrated:null,treeContext:null,retryLane:0};function lu(v){return{baseLanes:v,cachePool:null}}function sg(v,y,M){var b=y.pendingProps,k=ai.current,G=!1,ue=(y.flags&128)!==0,Se;if((Se=ue)||(Se=v!==null&&v.memoizedState===null?!1:(k&2)!==0),Se?(G=!0,y.flags&=-129):(v===null||v.memoizedState!==null)&&(k|=1),mt(ai,k&1),v===null)return pl(y),v=y.memoizedState,v!==null&&(v=v.dehydrated,v!==null)?((y.mode&1)===0?y.lanes=1:Ri(v)?y.lanes=8:y.lanes=1073741824,null):(k=b.children,v=b.fallback,G?(b=y.mode,G=y.child,k={mode:"hidden",children:k},(b&1)===0&&G!==null?(G.childLanes=0,G.pendingProps=k):G=Yh(k,b,0,null),v=_u(v,b,M,null),G.return=y,v.return=y,G.sibling=v,y.child=G,y.child.memoizedState=lu(M),y.memoizedState=Bh,v):So(y,k));if(k=v.memoizedState,k!==null){if(Se=k.dehydrated,Se!==null){if(ue)return y.flags&256?(y.flags&=-257,kh(v,y,M,Error(o(422)))):y.memoizedState!==null?(y.child=v.child,y.flags|=128,null):(G=b.fallback,k=y.mode,b=Yh({mode:"visible",children:b.children},k,0,null),G=_u(G,k,M,null),G.flags|=2,b.return=y,G.return=y,b.sibling=G,y.child=b,(y.mode&1)!==0&&wa(y,v.child,null,M),y.child.memoizedState=lu(M),y.memoizedState=Bh,G);if((y.mode&1)===0)y=kh(v,y,M,null);else if(Ri(Se))y=kh(v,y,M,Error(o(419)));else if(b=(M&v.childLanes)!==0,or||b){if(b=Ei,b!==null){switch(M&-M){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}b=(G&(b.suspendedLanes|M))!==0?0:G,b!==0&&b!==k.retryLane&&(k.retryLane=b,Pr(v,b,-1))}Yd(),y=kh(v,y,M,Error(o(421)))}else ns(Se)?(y.flags|=128,y.child=v.child,y=sy.bind(null,v),Ji(Se,y),y=null):(M=k.treeContext,Pe&&(pr=Hs(Se),zr=y,ni=!0,Xs=null,mc=!1,M!==null&&($s[Ts++]=Ta,$s[Ts++]=Ma,$s[Ts++]=ql,Ta=M.id,Ma=M.overflow,ql=y)),y=So(y,y.pendingProps.children),y.flags|=4096);return y}return G?(b=Vd(v,y,b.children,b.fallback,M),G=y.child,k=v.child.memoizedState,G.memoizedState=k===null?lu(M):{baseLanes:k.baseLanes|M,cachePool:null},G.childLanes=v.childLanes&~M,y.memoizedState=Bh,b):(M=Fh(v,y,b.children,M),y.memoizedState=null,M)}return G?(b=Vd(v,y,b.children,b.fallback,M),G=y.child,k=v.child.memoizedState,G.memoizedState=k===null?lu(M):{baseLanes:k.baseLanes|M,cachePool:null},G.childLanes=v.childLanes&~M,y.memoizedState=Bh,b):(M=Fh(v,y,b.children,M),y.memoizedState=null,M)}function So(v,y){return y=Yh({mode:"visible",children:y},v.mode,0,null),y.return=v,v.child=y}function Fh(v,y,M,b){var k=v.child;return v=k.sibling,M=Na(k,{mode:"visible",children:M}),(y.mode&1)===0&&(M.lanes=b),M.return=y,M.sibling=null,v!==null&&(b=y.deletions,b===null?(y.deletions=[v],y.flags|=16):b.push(v)),y.child=M}function Vd(v,y,M,b,k){var G=y.mode;v=v.child;var ue=v.sibling,Se={mode:"hidden",children:M};return(G&1)===0&&y.child!==v?(M=y.child,M.childLanes=0,M.pendingProps=Se,y.deletions=null):(M=Na(v,Se),M.subtreeFlags=v.subtreeFlags&14680064),ue!==null?b=Na(ue,b):(b=_u(b,G,k,null),b.flags|=2),b.return=y,M.return=y,M.sibling=b,y.child=M,b}function kh(v,y,M,b){return b!==null&&wd(b),wa(y,v.child,null,M),v=So(y,y.pendingProps.children),v.flags|=2,y.memoizedState=null,v}function ty(v,y,M){v.lanes|=y;var b=v.alternate;b!==null&&(b.lanes|=y),Vi(v.return,y,M)}function Qo(v,y,M,b,k){var G=v.memoizedState;G===null?v.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:b,tail:M,tailMode:k}:(G.isBackwards=y,G.rendering=null,G.renderingStartTime=0,G.last=b,G.tail=M,G.tailMode=k)}function uu(v,y,M){var b=y.pendingProps,k=b.revealOrder,G=b.tail;if(hi(v,y,b.children,M),b=ai.current,(b&2)!==0)b=b&1|2,y.flags|=128;else{if(v!==null&&(v.flags&128)!==0)e:for(v=y.child;v!==null;){if(v.tag===13)v.memoizedState!==null&&ty(v,M,y);else if(v.tag===19)ty(v,M,y);else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===y)break e;for(;v.sibling===null;){if(v.return===null||v.return===y)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}b&=1}if(mt(ai,b),(y.mode&1)===0)y.memoizedState=null;else switch(k){case"forwards":for(M=y.child,k=null;M!==null;)v=M.alternate,v!==null&&bd(v)===null&&(k=M),M=M.sibling;M=k,M===null?(k=y.child,y.child=null):(k=M.sibling,M.sibling=null),Qo(y,!1,k,M,G);break;case"backwards":for(M=null,k=y.child,y.child=null;k!==null;){if(v=k.alternate,v!==null&&bd(v)===null){y.child=k;break}v=k.sibling,k.sibling=M,M=k,k=v}Qo(y,!0,M,null,G);break;case"together":Qo(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function os(v,y,M){if(v!==null&&(y.dependencies=v.dependencies),Zo|=y.lanes,(M&y.childLanes)===0)return null;if(v!==null&&y.child!==v.child)throw Error(o(153));if(y.child!==null){for(v=y.child,M=Na(v,v.pendingProps),y.child=M,M.return=y;v.sibling!==null;)v=v.sibling,M=M.sibling=Na(v,v.pendingProps),M.return=y;M.sibling=null}return y.child}function Wd(v,y,M){switch(y.tag){case 3:Dh(y),gc();break;case 5:Jv(y);break;case 1:qn(y.type)&&_i(y);break;case 4:Cd(y,y.stateNode.containerInfo);break;case 10:Aa(y,y.type._context,y.memoizedProps.value);break;case 13:var b=y.memoizedState;if(b!==null)return b.dehydrated!==null?(mt(ai,ai.current&1),y.flags|=128,null):(M&y.child.childLanes)!==0?sg(v,y,M):(mt(ai,ai.current&1),v=os(v,y,M),v!==null?v.sibling:null);mt(ai,ai.current&1);break;case 19:if(b=(M&y.childLanes)!==0,(v.flags&128)!==0){if(b)return uu(v,y,M);y.flags|=128}var k=y.memoizedState;if(k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),mt(ai,ai.current),b)break;return null;case 22:case 23:return y.lanes=0,mr(v,y,M)}return os(v,y,M)}function jd(v,y){switch(Vm(y),y.tag){case 1:return qn(y.type)&&yn(),v=y.flags,v&65536?(y.flags=v&-65537|128,y):null;case 3:return _c(),wt(Fn),wt(Kt),tu(),v=y.flags,(v&65536)!==0&&(v&128)===0?(y.flags=v&-65537|128,y):null;case 5:return Km(y),null;case 13:if(wt(ai),v=y.memoizedState,v!==null&&v.dehydrated!==null){if(y.alternate===null)throw Error(o(340));gc()}return v=y.flags,v&65536?(y.flags=v&-65537|128,y):null;case 19:return wt(ai),null;case 4:return _c(),null;case 10:return Li(y.type._context),null;case 22:case 23:return Kh(),null;case 24:return null;default:return null}}var Wr=!1,ar=!1,cu=typeof WeakSet=="function"?WeakSet:Set,vt=null;function Ys(v,y){var M=v.ref;if(M!==null)if(typeof M=="function")try{M(null)}catch(b){Kr(v,y,b)}else M.current=null}function Pa(v,y,M){try{M()}catch(b){Kr(v,y,b)}}var og=!1;function ag(v,y){for($(v.containerInfo),vt=y;vt!==null;)if(v=vt,y=v.child,(v.subtreeFlags&1028)!==0&&y!==null)y.return=v,vt=y;else for(;vt!==null;){v=vt;try{var M=v.alternate;if((v.flags&1024)!==0)switch(v.tag){case 0:case 11:case 15:break;case 1:if(M!==null){var b=M.memoizedProps,k=M.memoizedState,G=v.stateNode,ue=G.getSnapshotBeforeUpdate(v.elementType===v.type?b:tr(v.type,b),k);G.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:De&&st(v.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Se){Kr(v,v.return,Se)}if(y=v.sibling,y!==null){y.return=v.return,vt=y;break}vt=v.return}return M=og,og=!1,M}function Da(v,y,M){var b=y.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var k=b=b.next;do{if((k.tag&v)===v){var G=k.destroy;k.destroy=void 0,G!==void 0&&Pa(y,M,G)}k=k.next}while(k!==b)}}function gr(v,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var M=y=y.next;do{if((M.tag&v)===v){var b=M.create;M.destroy=b()}M=M.next}while(M!==y)}}function jr(v){var y=v.ref;if(y!==null){var M=v.stateNode;switch(v.tag){case 5:v=ee(M);break;default:v=M}typeof y=="function"?y(v):y.current=v}}function Qn(v,y,M){if(Es&&typeof Es.onCommitFiberUnmount=="function")try{Es.onCommitFiberUnmount(ll,y)}catch{}switch(y.tag){case 0:case 11:case 14:case 15:if(v=y.updateQueue,v!==null&&(v=v.lastEffect,v!==null)){var b=v=v.next;do{var k=b,G=k.destroy;k=k.tag,G!==void 0&&((k&2)!==0||(k&4)!==0)&&Pa(y,M,G),b=b.next}while(b!==v)}break;case 1:if(Ys(y,M),v=y.stateNode,typeof v.componentWillUnmount=="function")try{v.props=y.memoizedProps,v.state=y.memoizedState,v.componentWillUnmount()}catch(ue){Kr(y,M,ue)}break;case 5:Ys(y,M);break;case 4:De?cg(v,y,M):K&&K&&(y=y.stateNode.containerInfo,M=_t(y),gt(y,M))}}function Js(v,y,M){for(var b=y;;)if(Qn(v,b,M),b.child===null||De&&b.tag===4){if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else b.child.return=b,b=b.child}function lg(v){var y=v.alternate;y!==null&&(v.alternate=null,lg(y)),v.child=null,v.deletions=null,v.sibling=null,v.tag===5&&(y=v.stateNode,y!==null&&et(y)),v.stateNode=null,v.return=null,v.dependencies=null,v.memoizedProps=null,v.memoizedState=null,v.pendingProps=null,v.stateNode=null,v.updateQueue=null}function ug(v){return v.tag===5||v.tag===3||v.tag===4}function Kd(v){e:for(;;){for(;v.sibling===null;){if(v.return===null||ug(v.return))return null;v=v.return}for(v.sibling.return=v.return,v=v.sibling;v.tag!==5&&v.tag!==6&&v.tag!==18;){if(v.flags&2||v.child===null||v.tag===4)continue e;v.child.return=v,v=v.child}if(!(v.flags&2))return v.stateNode}}function $d(v){if(De){e:{for(var y=v.return;y!==null;){if(ug(y))break e;y=y.return}throw Error(o(160))}var M=y;switch(M.tag){case 5:y=M.stateNode,M.flags&32&&(Je(y),M.flags&=-33),M=Kd(v),Cc(v,M,y);break;case 3:case 4:y=M.stateNode.containerInfo,M=Kd(v),Xd(v,M,y);break;default:throw Error(o(161))}}}function Xd(v,y,M){var b=v.tag;if(b===5||b===6)v=v.stateNode,y?it(M,v,y):lt(M,v);else if(b!==4&&(v=v.child,v!==null))for(Xd(v,y,M),v=v.sibling;v!==null;)Xd(v,y,M),v=v.sibling}function Cc(v,y,M){var b=v.tag;if(b===5||b===6)v=v.stateNode,y?ht(M,v,y):Ze(M,v);else if(b!==4&&(v=v.child,v!==null))for(Cc(v,y,M),v=v.sibling;v!==null;)Cc(v,y,M),v=v.sibling}function cg(v,y,M){for(var b=y,k=!1,G,ue;;){if(!k){k=b.return;e:for(;;){if(k===null)throw Error(o(160));switch(G=k.stateNode,k.tag){case 5:ue=!1;break e;case 3:G=G.containerInfo,ue=!0;break e;case 4:G=G.containerInfo,ue=!0;break e}k=k.return}k=!0}if(b.tag===5||b.tag===6)Js(v,b,M),ue?fe(G,b.stateNode):rt(G,b.stateNode);else if(b.tag===18)ue?be(G,b.stateNode):ze(G,b.stateNode);else if(b.tag===4){if(b.child!==null){G=b.stateNode.containerInfo,ue=!0,b.child.return=b,b=b.child;continue}}else if(Qn(v,b,M),b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return;b=b.return,b.tag===4&&(k=!1)}b.sibling.return=b.return,b=b.sibling}}function xl(v,y){if(De){switch(y.tag){case 0:case 11:case 14:case 15:Da(3,y,y.return),gr(3,y),Da(5,y,y.return);return;case 1:return;case 5:var M=y.stateNode;if(M!=null){var b=y.memoizedProps;v=v!==null?v.memoizedProps:b;var k=y.type,G=y.updateQueue;y.updateQueue=null,G!==null&&Ct(M,G,k,v,b,y)}return;case 6:if(y.stateNode===null)throw Error(o(162));M=y.memoizedProps,Ye(y.stateNode,v!==null?v.memoizedProps:M,M);return;case 3:Pe&&v!==null&&v.memoizedState.isDehydrated&&Ae(y.stateNode.containerInfo);return;case 12:return;case 13:bc(y);return;case 19:bc(y);return;case 17:return}throw Error(o(163))}switch(y.tag){case 0:case 11:case 14:case 15:Da(3,y,y.return),gr(3,y),Da(5,y,y.return);return;case 12:return;case 13:bc(y);return;case 19:bc(y);return;case 3:Pe&&v!==null&&v.memoizedState.isDehydrated&&Ae(y.stateNode.containerInfo);break;case 22:case 23:return}e:if(K){switch(y.tag){case 1:case 5:case 6:break e;case 3:case 4:y=y.stateNode,gt(y.containerInfo,y.pendingChildren);break e}throw Error(o(163))}}function bc(v){var y=v.updateQueue;if(y!==null){v.updateQueue=null;var M=v.stateNode;M===null&&(M=v.stateNode=new cu),y.forEach(function(b){var k=oy.bind(null,v,b);M.has(b)||(M.add(b),b.then(k,k))})}}function HA(v,y){for(vt=y;vt!==null;){y=vt;var M=y.deletions;if(M!==null)for(var b=0;b<M.length;b++){var k=M[b];try{var G=v;De?cg(G,k,y):Js(G,k,y);var ue=k.alternate;ue!==null&&(ue.return=null),k.return=null}catch(Ut){Kr(k,y,Ut)}}if(M=y.child,(y.subtreeFlags&12854)!==0&&M!==null)M.return=y,vt=M;else for(;vt!==null;){y=vt;try{var Se=y.flags;if(Se&32&&De&&Je(y.stateNode),Se&512){var qe=y.alternate;if(qe!==null){var dt=qe.ref;dt!==null&&(typeof dt=="function"?dt(null):dt.current=null)}}if(Se&8192)switch(y.tag){case 13:if(y.memoizedState!==null){var It=y.alternate;(It===null||It.memoizedState===null)&&(Vh=ti())}break;case 22:var tn=y.memoizedState!==null,jt=y.alternate,cn=jt!==null&&jt.memoizedState!==null;if(M=y,De){e:if(b=M,k=tn,G=null,De)for(var Tt=b;;){if(Tt.tag===5){if(G===null){G=Tt;var xr=Tt.stateNode;k?ce(xr):Te(Tt.stateNode,Tt.memoizedProps)}}else if(Tt.tag===6){if(G===null){var Ps=Tt.stateNode;k?He(Ps):Oe(Ps,Tt.memoizedProps)}}else if((Tt.tag!==22&&Tt.tag!==23||Tt.memoizedState===null||Tt===b)&&Tt.child!==null){Tt.child.return=Tt,Tt=Tt.child;continue}if(Tt===b)break;for(;Tt.sibling===null;){if(Tt.return===null||Tt.return===b)break e;G===Tt&&(G=null),Tt=Tt.return}G===Tt&&(G=null),Tt.sibling.return=Tt.return,Tt=Tt.sibling}}if(tn&&!cn&&(M.mode&1)!==0){vt=M;for(var Ne=M.child;Ne!==null;){for(M=vt=Ne;vt!==null;){b=vt;var Me=b.child;switch(b.tag){case 0:case 11:case 14:case 15:Da(4,b,b.return);break;case 1:Ys(b,b.return);var $e=b.stateNode;if(typeof $e.componentWillUnmount=="function"){var Et=b.return;try{$e.props=b.memoizedProps,$e.state=b.memoizedState,$e.componentWillUnmount()}catch(Ut){Kr(b,Et,Ut)}}break;case 5:Ys(b,b.return);break;case 22:if(b.memoizedState!==null){fg(M);continue}}Me!==null?(Me.return=b,vt=Me):fg(M)}Ne=Ne.sibling}}}switch(Se&4102){case 2:$d(y),y.flags&=-3;break;case 6:$d(y),y.flags&=-3,xl(y.alternate,y);break;case 4096:y.flags&=-4097;break;case 4100:y.flags&=-4097,xl(y.alternate,y);break;case 4:xl(y.alternate,y)}}catch(Ut){Kr(y,y.return,Ut)}if(M=y.sibling,M!==null){M.return=y.return,vt=M;break}vt=y.return}}}function Oh(v,y,M){vt=v,Uh(v)}function Uh(v,y,M){for(var b=(v.mode&1)!==0;vt!==null;){var k=vt,G=k.child;if(k.tag===22&&b){var ue=k.memoizedState!==null||Wr;if(!ue){var Se=k.alternate,qe=Se!==null&&Se.memoizedState!==null||ar;Se=Wr;var dt=ar;if(Wr=ue,(ar=qe)&&!dt)for(vt=k;vt!==null;)ue=vt,qe=ue.child,ue.tag===22&&ue.memoizedState!==null?hu(k):qe!==null?(qe.return=ue,vt=qe):hu(k);for(;G!==null;)vt=G,Uh(G),G=G.sibling;vt=k,Wr=Se,ar=dt}hg(v)}else(k.subtreeFlags&8772)!==0&&G!==null?(G.return=k,vt=G):hg(v)}}function hg(v){for(;vt!==null;){var y=vt;if((y.flags&8772)!==0){var M=y.alternate;try{if((y.flags&8772)!==0)switch(y.tag){case 0:case 11:case 15:ar||gr(5,y);break;case 1:var b=y.stateNode;if(y.flags&4&&!ar)if(M===null)b.componentDidMount();else{var k=y.elementType===y.type?M.memoizedProps:tr(y.type,M.memoizedProps);b.componentDidUpdate(k,M.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var G=y.updateQueue;G!==null&&zv(y,G,b);break;case 3:var ue=y.updateQueue;if(ue!==null){if(M=null,y.child!==null)switch(y.child.tag){case 5:M=ee(y.child.stateNode);break;case 1:M=y.child.stateNode}zv(y,ue,M)}break;case 5:var Se=y.stateNode;M===null&&y.flags&4&&nt(Se,y.type,y.memoizedProps,y);break;case 6:break;case 4:break;case 12:break;case 13:if(Pe&&y.memoizedState===null){var qe=y.alternate;if(qe!==null){var dt=qe.memoizedState;if(dt!==null){var It=dt.dehydrated;It!==null&&Ue(It)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}ar||y.flags&512&&jr(y)}catch(tn){Kr(y,y.return,tn)}}if(y===v){vt=null;break}if(M=y.sibling,M!==null){M.return=y.return,vt=M;break}vt=y.return}}function fg(v){for(;vt!==null;){var y=vt;if(y===v){vt=null;break}var M=y.sibling;if(M!==null){M.return=y.return,vt=M;break}vt=y.return}}function hu(v){for(;vt!==null;){var y=vt;try{switch(y.tag){case 0:case 11:case 15:var M=y.return;try{gr(4,y)}catch(qe){Kr(y,M,qe)}break;case 1:var b=y.stateNode;if(typeof b.componentDidMount=="function"){var k=y.return;try{b.componentDidMount()}catch(qe){Kr(y,k,qe)}}var G=y.return;try{jr(y)}catch(qe){Kr(y,G,qe)}break;case 5:var ue=y.return;try{jr(y)}catch(qe){Kr(y,ue,qe)}}}catch(qe){Kr(y,y.return,qe)}if(y===v){vt=null;break}var Se=y.sibling;if(Se!==null){Se.return=y.return,vt=Se;break}vt=y.return}}var Nh=0,fu=1,du=2,Ba=3,Rc=4;if(typeof Symbol=="function"&&Symbol.for){var pu=Symbol.for;Nh=pu("selector.component"),fu=pu("selector.has_pseudo_class"),du=pu("selector.role"),Ba=pu("selector.test_id"),Rc=pu("selector.text")}function Gh(v){var y=Be(v);if(y!=null){if(typeof y.memoizedProps["data-testname"]!="string")throw Error(o(364));return y}if(v=z(v),v===null)throw Error(o(362));return v.stateNode.current}function Hh(v,y){switch(y.$$typeof){case Nh:if(v.type===y.value)return!0;break;case fu:e:{y=y.value,v=[v,0];for(var M=0;M<v.length;){var b=v[M++],k=v[M++],G=y[k];if(b.tag!==5||!Ee(b)){for(;G!=null&&Hh(b,G);)k++,G=y[k];if(k===y.length){y=!0;break e}else for(b=b.child;b!==null;)v.push(b,k),b=b.sibling}}y=!1}return y;case du:if(v.tag===5&&we(v.stateNode,y.value))return!0;break;case Rc:if((v.tag===5||v.tag===6)&&(v=_e(v),v!==null&&0<=v.indexOf(y.value)))return!0;break;case Ba:if(v.tag===5&&(v=v.memoizedProps["data-testname"],typeof v=="string"&&v.toLowerCase()===y.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function _l(v){switch(v.$$typeof){case Nh:return"<"+(L(v.value)||"Unknown")+">";case fu:return":has("+(_l(v)||"")+")";case du:return'[role="'+v.value+'"]';case Rc:return'"'+v.value+'"';case Ba:return'[data-testname="'+v.value+'"]';default:throw Error(o(365))}}function bs(v,y){var M=[];v=[v,0];for(var b=0;b<v.length;){var k=v[b++],G=v[b++],ue=y[G];if(k.tag!==5||!Ee(k)){for(;ue!=null&&Hh(k,ue);)G++,ue=y[G];if(G===y.length)M.push(k);else for(k=k.child;k!==null;)v.push(k,G),k=k.sibling}}return M}function Fa(v,y){if(!te)throw Error(o(363));v=Gh(v),v=bs(v,y),y=[],v=Array.from(v);for(var M=0;M<v.length;){var b=v[M++];if(b.tag===5)Ee(b)||y.push(b.stateNode);else for(b=b.child;b!==null;)v.push(b),b=b.sibling}return y}var dg=Math.ceil,zh=a.ReactCurrentDispatcher,Ao=a.ReactCurrentOwner,zn=a.ReactCurrentBatchConfig,an=0,Ei=null,Vn=null,ii=0,Lr=0,mu=Bn(0),fi=0,Ic=null,Zo=0,Rs=0,gu=0,ka=null,Pi=null,Vh=0,Sl=1/0;function vu(){Sl=ti()+500}var Lc=!1,Zn=null,Eo=null,Pc=!1,ea=null,yu=0,xu=0,Oa=null,Jn=-1,di=0;function bn(){return(an&6)!==0?ti():Jn!==-1?Jn:Jn=ti()}function To(v){return(v.mode&1)===0?1:(an&2)!==0&&ii!==0?ii&-ii:hl.transition!==null?(di===0&&(v=mo,mo<<=1,(mo&4194240)===0&&(mo=64),di=v),di):(v=Zt,v!==0?v:ve())}function Pr(v,y,M){if(50<xu)throw xu=0,Oa=null,Error(o(185));var b=Al(v,y);return b===null?null:(zs(b,y,M),((an&2)===0||b!==Ei)&&(b===Ei&&((an&2)===0&&(Rs|=y),fi===4&&yr(b,ii)),as(b,M),y===1&&an===0&&(v.mode&1)===0&&(vu(),Yo&&Rr())),b)}function Al(v,y){v.lanes|=y;var M=v.alternate;for(M!==null&&(M.lanes|=y),M=v,v=v.return;v!==null;)v.childLanes|=y,M=v.alternate,M!==null&&(M.childLanes|=y),M=v,v=v.return;return M.tag===3?M.stateNode:null}function as(v,y){var M=v.callbackNode;fc(v,y);var b=ol(v,v===Ei?ii:0);if(b===0)M!==null&&Xo(M),v.callbackNode=null,v.callbackPriority=0;else if(y=b&-b,v.callbackPriority!==y){if(M!=null&&Xo(M),y===1)v.tag===0?cl(Is.bind(null,v)):Jl(Is.bind(null,v)),Ce?We(function(){an===0&&Rr()}):As(vo,Rr),M=null;else{switch(Vs(b)){case 1:M=vo;break;case 4:M=yd;break;case 16:M=br;break;case 536870912:M=al;break;default:M=br}M=Jd(M,vr.bind(null,v))}v.callbackPriority=y,v.callbackNode=M}}function vr(v,y){if(Jn=-1,di=0,(an&6)!==0)throw Error(o(327));var M=v.callbackNode;if(ta()&&v.callbackNode!==M)return null;var b=ol(v,v===Ei?ii:0);if(b===0)return null;if((b&30)!==0||(b&v.expiredLanes)!==0||y)y=$h(v,b);else{y=b;var k=an;an|=2;var G=gg();(Ei!==v||ii!==y)&&(vu(),Ua(v,y));do try{iy();break}catch(Se){mg(v,Se)}while(!0);nr(),zh.current=G,an=k,Vn!==null?y=0:(Ei=null,ii=0,y=fi)}if(y!==0){if(y===2&&(k=$o(v),k!==0&&(b=k,y=Wh(v,k))),y===1)throw M=Ic,Ua(v,0),yr(v,b),as(v,ti()),M;if(y===6)yr(v,b);else{if(k=v.current.alternate,(b&30)===0&&!pg(k)&&(y=$h(v,b),y===2&&(G=$o(v),G!==0&&(b=G,y=Wh(v,G))),y===1))throw M=Ic,Ua(v,0),yr(v,b),as(v,ti()),M;switch(v.finishedWork=k,v.finishedLanes=b,y){case 0:case 1:throw Error(o(345));case 2:Mo(v,Pi);break;case 3:if(yr(v,b),(b&130023424)===b&&(y=Vh+500-ti(),10<y)){if(ol(v,0)!==0)break;if(k=v.suspendedLanes,(k&b)!==b){bn(),v.pingedLanes|=v.suspendedLanes&k;break}v.timeoutHandle=de(Mo.bind(null,v,Pi),y);break}Mo(v,Pi);break;case 4:if(yr(v,b),(b&4194240)===b)break;for(y=v.eventTimes,k=-1;0<b;){var ue=31-Cr(b);G=1<<ue,ue=y[ue],ue>k&&(k=ue),b&=~G}if(b=k,b=ti()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*dg(b/1960))-b,10<b){v.timeoutHandle=de(Mo.bind(null,v,Pi),b);break}Mo(v,Pi);break;case 5:Mo(v,Pi);break;default:throw Error(o(329))}}}return as(v,ti()),v.callbackNode===M?vr.bind(null,v):null}function Wh(v,y){var M=ka;return v.current.memoizedState.isDehydrated&&(Ua(v,y).flags|=256),v=$h(v,y),v!==2&&(y=Pi,Pi=M,y!==null&&jh(y)),v}function jh(v){Pi===null?Pi=v:Pi.push.apply(Pi,v)}function pg(v){for(var y=v;;){if(y.flags&16384){var M=y.updateQueue;if(M!==null&&(M=M.stores,M!==null))for(var b=0;b<M.length;b++){var k=M[b],G=k.getSnapshot;k=k.value;try{if(!Zi(G(),k))return!1}catch{return!1}}}if(M=y.child,y.subtreeFlags&16384&&M!==null)M.return=y,y=M;else{if(y===v)break;for(;y.sibling===null;){if(y.return===null||y.return===v)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function yr(v,y){for(y&=~gu,y&=~Rs,v.suspendedLanes|=y,v.pingedLanes&=~y,v=v.expirationTimes;0<y;){var M=31-Cr(y),b=1<<M;v[M]=-1,y&=~b}}function Is(v){if((an&6)!==0)throw Error(o(327));ta();var y=ol(v,0);if((y&1)===0)return as(v,ti()),null;var M=$h(v,y);if(v.tag!==0&&M===2){var b=$o(v);b!==0&&(y=b,M=Wh(v,b))}if(M===1)throw M=Ic,Ua(v,0),yr(v,y),as(v,ti()),M;if(M===6)throw Error(o(345));return v.finishedWork=v.current.alternate,v.finishedLanes=y,Mo(v,Pi),as(v,ti()),null}function Dc(v){ea!==null&&ea.tag===0&&(an&6)===0&&ta();var y=an;an|=1;var M=zn.transition,b=Zt;try{if(zn.transition=null,Zt=1,v)return v()}finally{Zt=b,zn.transition=M,an=y,(an&6)===0&&Rr()}}function Kh(){Lr=mu.current,wt(mu)}function Ua(v,y){v.finishedWork=null,v.finishedLanes=0;var M=v.timeoutHandle;if(M!==Ge&&(v.timeoutHandle=Ge,ye(M)),Vn!==null)for(M=Vn.return;M!==null;){var b=M;switch(Vm(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&yn();break;case 3:_c(),wt(Fn),wt(Kt),tu();break;case 5:Km(b);break;case 4:_c();break;case 13:wt(ai);break;case 19:wt(ai);break;case 10:Li(b.type._context);break;case 22:case 23:Kh()}M=M.return}if(Ei=v,Vn=v=Na(v.current,null),ii=Lr=y,fi=0,Ic=null,gu=Rs=Zo=0,Pi=ka=null,Hr!==null){for(y=0;y<Hr.length;y++)if(M=Hr[y],b=M.interleaved,b!==null){M.interleaved=null;var k=b.next,G=M.pending;if(G!==null){var ue=G.next;G.next=k,b.next=ue}M.pending=b}Hr=null}return v}function mg(v,y){do{var M=Vn;try{if(nr(),Th.current=Mc,Rd){for(var b=li.memoizedState;b!==null;){var k=b.queue;k!==null&&(k.pending=null),b=b.next}Rd=!1}if(nu=0,rr=ir=li=null,Jo=!1,iu=0,Ao.current=null,M===null||M.return===null){fi=1,Ic=y,Vn=null;break}e:{var G=v,ue=M.return,Se=M,qe=y;if(y=ii,Se.flags|=32768,qe!==null&&typeof qe=="object"&&typeof qe.then=="function"){var dt=qe,It=Se,tn=It.tag;if((It.mode&1)===0&&(tn===0||tn===11||tn===15)){var jt=It.alternate;jt?(It.updateQueue=jt.updateQueue,It.memoizedState=jt.memoizedState,It.lanes=jt.lanes):(It.updateQueue=null,It.memoizedState=null)}var cn=ng(ue);if(cn!==null){cn.flags&=-257,su(cn,ue,Se,G,y),cn.mode&1&&ba(G,dt,y),y=cn,qe=dt;var Tt=y.updateQueue;if(Tt===null){var xr=new Set;xr.add(qe),y.updateQueue=xr}else Tt.add(qe);break e}else{if((y&1)===0){ba(G,dt,y),Yd();break e}qe=Error(o(426))}}else if(ni&&Se.mode&1){var Ps=ng(ue);if(Ps!==null){(Ps.flags&65536)===0&&(Ps.flags|=256),su(Ps,ue,Se,G,y),wd(qe);break e}}G=qe,fi!==4&&(fi=2),ka===null?ka=[G]:ka.push(G),qe=tg(qe,Se),Se=ue;do{switch(Se.tag){case 3:Se.flags|=65536,y&=-y,Se.lanes|=y;var Ne=ey(Se,qe,y);_d(Se,Ne);break e;case 1:G=qe;var Me=Se.type,$e=Se.stateNode;if((Se.flags&128)===0&&(typeof Me.getDerivedStateFromError=="function"||$e!==null&&typeof $e.componentDidCatch=="function"&&(Eo===null||!Eo.has($e)))){Se.flags|=65536,y&=-y,Se.lanes|=y;var Et=Nd(Se,G,y);_d(Se,Et);break e}}Se=Se.return}while(Se!==null)}yg(M)}catch(Ut){y=Ut,Vn===M&&M!==null&&(Vn=M=M.return);continue}break}while(!0)}function gg(){var v=zh.current;return zh.current=Mc,v===null?Mc:v}function Yd(){(fi===0||fi===3||fi===2)&&(fi=4),Ei===null||(Zo&268435455)===0&&(Rs&268435455)===0||yr(Ei,ii)}function $h(v,y){var M=an;an|=2;var b=gg();Ei===v&&ii===y||Ua(v,y);do try{ny();break}catch(k){mg(v,k)}while(!0);if(nr(),an=M,zh.current=b,Vn!==null)throw Error(o(261));return Ei=null,ii=0,fi}function ny(){for(;Vn!==null;)vg(Vn)}function iy(){for(;Vn!==null&&!Ws();)vg(Vn)}function vg(v){var y=Sg(v.alternate,v,Lr);v.memoizedProps=v.pendingProps,y===null?yg(v):Vn=y,Ao.current=null}function yg(v){var y=v;do{var M=y.alternate;if(v=y.return,(y.flags&32768)===0){if(M=zd(M,y,Lr),M!==null){Vn=M;return}}else{if(M=jd(M,y),M!==null){M.flags&=32767,Vn=M;return}if(v!==null)v.flags|=32768,v.subtreeFlags=0,v.deletions=null;else{fi=6,Vn=null;return}}if(y=y.sibling,y!==null){Vn=y;return}Vn=y=v}while(y!==null);fi===0&&(fi=5)}function Mo(v,y){var M=Zt,b=zn.transition;try{zn.transition=null,Zt=1,ry(v,y,M)}finally{zn.transition=b,Zt=M}return null}function ry(v,y,M){do ta();while(ea!==null);if((an&6)!==0)throw Error(o(327));var b=v.finishedWork,k=v.finishedLanes;if(b===null)return null;if(v.finishedWork=null,v.finishedLanes=0,b===v.current)throw Error(o(177));v.callbackNode=null,v.callbackPriority=0;var G=b.lanes|b.childLanes;if(go(v,G),v===Ei&&(Vn=Ei=null,ii=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||Pc||(Pc=!0,Jd(br,function(){return ta(),null})),G=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||G){G=zn.transition,zn.transition=null;var ue=Zt;Zt=1;var Se=an;an|=4,Ao.current=null,ag(v,b),HA(v,b),j(v.containerInfo),v.current=b,Oh(b),vd(),an=Se,Zt=ue,zn.transition=G}else v.current=b;if(Pc&&(Pc=!1,ea=v,yu=k),G=v.pendingLanes,G===0&&(Eo=null),ya(b.stateNode),as(v,ti()),y!==null)for(M=v.onRecoverableError,b=0;b<y.length;b++)M(y[b]);if(Lc)throw Lc=!1,v=Zn,Zn=null,v;return(yu&1)!==0&&v.tag!==0&&ta(),G=v.pendingLanes,(G&1)!==0?v===Oa?xu++:(xu=0,Oa=v):xu=0,Rr(),null}function ta(){if(ea!==null){var v=Vs(yu),y=zn.transition,M=Zt;try{if(zn.transition=null,Zt=16>v?16:v,ea===null)var b=!1;else{if(v=ea,ea=null,yu=0,(an&6)!==0)throw Error(o(331));var k=an;for(an|=4,vt=v.current;vt!==null;){var G=vt,ue=G.child;if((vt.flags&16)!==0){var Se=G.deletions;if(Se!==null){for(var qe=0;qe<Se.length;qe++){var dt=Se[qe];for(vt=dt;vt!==null;){var It=vt;switch(It.tag){case 0:case 11:case 15:Da(8,It,G)}var tn=It.child;if(tn!==null)tn.return=It,vt=tn;else for(;vt!==null;){It=vt;var jt=It.sibling,cn=It.return;if(lg(It),It===dt){vt=null;break}if(jt!==null){jt.return=cn,vt=jt;break}vt=cn}}}var Tt=G.alternate;if(Tt!==null){var xr=Tt.child;if(xr!==null){Tt.child=null;do{var Ps=xr.sibling;xr.sibling=null,xr=Ps}while(xr!==null)}}vt=G}}if((G.subtreeFlags&2064)!==0&&ue!==null)ue.return=G,vt=ue;else e:for(;vt!==null;){if(G=vt,(G.flags&2048)!==0)switch(G.tag){case 0:case 11:case 15:Da(9,G,G.return)}var Ne=G.sibling;if(Ne!==null){Ne.return=G.return,vt=Ne;break e}vt=G.return}}var Me=v.current;for(vt=Me;vt!==null;){ue=vt;var $e=ue.child;if((ue.subtreeFlags&2064)!==0&&$e!==null)$e.return=ue,vt=$e;else e:for(ue=Me;vt!==null;){if(Se=vt,(Se.flags&2048)!==0)try{switch(Se.tag){case 0:case 11:case 15:gr(9,Se)}}catch(Ut){Kr(Se,Se.return,Ut)}if(Se===ue){vt=null;break e}var Et=Se.sibling;if(Et!==null){Et.return=Se.return,vt=Et;break e}vt=Se.return}}if(an=k,Rr(),Es&&typeof Es.onPostCommitFiberRoot=="function")try{Es.onPostCommitFiberRoot(ll,v)}catch{}b=!0}return b}finally{Zt=M,zn.transition=y}}return!1}function Xh(v,y,M){y=tg(M,y),y=ey(v,y,1),fl(v,y),y=bn(),v=Al(v,1),v!==null&&(zs(v,1,y),as(v,y))}function Kr(v,y,M){if(v.tag===3)Xh(v,v,M);else for(;y!==null;){if(y.tag===3){Xh(y,v,M);break}else if(y.tag===1){var b=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(Eo===null||!Eo.has(b))){v=tg(M,v),v=Nd(y,v,1),fl(y,v),v=bn(),y=Al(y,1),y!==null&&(zs(y,1,v),as(y,v));break}}y=y.return}}function xg(v,y,M){var b=v.pingCache;b!==null&&b.delete(y),y=bn(),v.pingedLanes|=v.suspendedLanes&M,Ei===v&&(ii&M)===M&&(fi===4||fi===3&&(ii&130023424)===ii&&500>ti()-Vh?Ua(v,0):gu|=M),as(v,y)}function _g(v,y){y===0&&((v.mode&1)===0?y=1:(y=mn,mn<<=1,(mn&130023424)===0&&(mn=4194304)));var M=bn();v=Al(v,y),v!==null&&(zs(v,y,M),as(v,M))}function sy(v){var y=v.memoizedState,M=0;y!==null&&(M=y.retryLane),_g(v,M)}function oy(v,y){var M=0;switch(v.tag){case 13:var b=v.stateNode,k=v.memoizedState;k!==null&&(M=k.retryLane);break;case 19:b=v.stateNode;break;default:throw Error(o(314))}b!==null&&b.delete(y),_g(v,M)}var Sg;Sg=function(v,y,M){if(v!==null)if(v.memoizedProps!==y.pendingProps||Fn.current)or=!0;else{if((v.lanes&M)===0&&(y.flags&128)===0)return or=!1,Wd(v,y,M);or=(v.flags&131072)!==0}else or=!1,ni&&(y.flags&1048576)!==0&&Kv(y,Td,y.index);switch(y.lanes=0,y.tag){case 2:var b=y.type;v!==null&&(v.alternate=null,y.alternate=null,y.flags|=2),v=y.pendingProps;var k=Nn(y,Kt.current);Si(y,M),k=Sc(null,y,b,v,k,M);var G=gl();return y.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,qn(b)?(G=!0,_i(y)):G=!1,y.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,dc(y),k.updater=Ad,y.stateNode=k,k._reactInternals=y,Hm(y,b,v,M),y=Ir(null,y,b,!0,G,M)):(y.tag=0,ni&&G&&zm(y),hi(null,y,k,M),y=y.child),y;case 16:b=y.elementType;e:{switch(v!==null&&(v.alternate=null,y.alternate=null,y.flags|=2),v=y.pendingProps,k=b._init,b=k(b._payload),y.type=b,k=y.tag=zA(b),v=tr(b,v),k){case 0:y=La(null,y,b,v,M);break e;case 1:y=au(null,y,b,v,M);break e;case 11:y=Yn(null,y,b,v,M);break e;case 14:y=jn(null,y,b,tr(b.type,v),M);break e}throw Error(o(306,b,""))}return y;case 0:return b=y.type,k=y.pendingProps,k=y.elementType===b?k:tr(b,k),La(v,y,b,k,M);case 1:return b=y.type,k=y.pendingProps,k=y.elementType===b?k:tr(b,k),au(v,y,b,k,M);case 3:e:{if(Dh(y),v===null)throw Error(o(387));b=y.pendingProps,G=y.memoizedState,k=G.element,Um(v,y),Sd(y,b,null,M);var ue=y.memoizedState;if(b=ue.element,Pe&&G.isDehydrated)if(G={element:b,isDehydrated:!1,cache:ue.cache,transitions:ue.transitions},y.updateQueue.baseState=G,y.memoizedState=G,y.flags&256){k=Error(o(423)),y=rg(v,y,b,M,k);break e}else if(b!==k){k=Error(o(424)),y=rg(v,y,b,M,k);break e}else for(Pe&&(pr=Ii(y.stateNode.containerInfo),zr=y,ni=!0,Xs=null,mc=!1),M=Yv(y,null,b,M),y.child=M;M;)M.flags=M.flags&-3|4096,M=M.sibling;else{if(gc(),b===k){y=os(v,y,M);break e}hi(v,y,b,M)}y=y.child}return y;case 5:return Jv(y),v===null&&pl(y),b=y.type,k=y.pendingProps,G=v!==null?v.memoizedProps:null,ue=k.children,oe(b,k)?ue=null:G!==null&&oe(b,G)&&(y.flags|=32),Vr(v,y),hi(v,y,ue,M),y.child;case 6:return v===null&&pl(y),null;case 13:return sg(v,y,M);case 4:return Cd(y,y.stateNode.containerInfo),b=y.pendingProps,v===null?y.child=wa(y,null,b,M):hi(v,y,b,M),y.child;case 11:return b=y.type,k=y.pendingProps,k=y.elementType===b?k:tr(b,k),Yn(v,y,b,k,M);case 7:return hi(v,y,y.pendingProps,M),y.child;case 8:return hi(v,y,y.pendingProps.children,M),y.child;case 12:return hi(v,y,y.pendingProps.children,M),y.child;case 10:e:{if(b=y.type._context,k=y.pendingProps,G=y.memoizedProps,ue=k.value,Aa(y,b,ue),G!==null)if(Zi(G.value,ue)){if(G.children===k.children&&!Fn.current){y=os(v,y,M);break e}}else for(G=y.child,G!==null&&(G.return=y);G!==null;){var Se=G.dependencies;if(Se!==null){ue=G.child;for(var qe=Se.firstContext;qe!==null;){if(qe.context===b){if(G.tag===1){qe=Ea(-1,M&-M),qe.tag=2;var dt=G.updateQueue;if(dt!==null){dt=dt.shared;var It=dt.pending;It===null?qe.next=qe:(qe.next=It.next,It.next=qe),dt.pending=qe}}G.lanes|=M,qe=G.alternate,qe!==null&&(qe.lanes|=M),Vi(G.return,M,y),Se.lanes|=M;break}qe=qe.next}}else if(G.tag===10)ue=G.type===y.type?null:G.child;else if(G.tag===18){if(ue=G.return,ue===null)throw Error(o(341));ue.lanes|=M,Se=ue.alternate,Se!==null&&(Se.lanes|=M),Vi(ue,M,y),ue=G.sibling}else ue=G.child;if(ue!==null)ue.return=G;else for(ue=G;ue!==null;){if(ue===y){ue=null;break}if(G=ue.sibling,G!==null){G.return=ue.return,ue=G;break}ue=ue.return}G=ue}hi(v,y,k.children,M),y=y.child}return y;case 9:return k=y.type,b=y.pendingProps.children,Si(y,M),k=oi(k),b=b(k),y.flags|=1,hi(v,y,b,M),y.child;case 14:return b=y.type,k=tr(b,y.pendingProps),k=tr(b.type,k),jn(v,y,b,k,M);case 15:return Ia(v,y,y.type,y.pendingProps,M);case 17:return b=y.type,k=y.pendingProps,k=y.elementType===b?k:tr(b,k),v!==null&&(v.alternate=null,y.alternate=null,y.flags|=2),y.tag=1,qn(b)?(v=!0,_i(y)):v=!1,Si(y,M),Wv(y,b,k),Hm(y,b,k,M),Ir(null,y,b,!0,v,M);case 19:return uu(v,y,M);case 22:return mr(v,y,M)}throw Error(o(156,y.tag))};function Jd(v,y){return As(v,y)}function ay(v,y,M,b){this.tag=v,this.key=M,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ls(v,y,M,b){return new ay(v,y,M,b)}function qd(v){return v=v.prototype,!(!v||!v.isReactComponent)}function zA(v){if(typeof v=="function")return qd(v)?1:0;if(v!=null){if(v=v.$$typeof,v===x)return 11;if(v===T)return 14}return 2}function Na(v,y){var M=v.alternate;return M===null?(M=Ls(v.tag,y,v.key,v.mode),M.elementType=v.elementType,M.type=v.type,M.stateNode=v.stateNode,M.alternate=v,v.alternate=M):(M.pendingProps=y,M.type=v.type,M.flags=0,M.subtreeFlags=0,M.deletions=null),M.flags=v.flags&14680064,M.childLanes=v.childLanes,M.lanes=v.lanes,M.child=v.child,M.memoizedProps=v.memoizedProps,M.memoizedState=v.memoizedState,M.updateQueue=v.updateQueue,y=v.dependencies,M.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},M.sibling=v.sibling,M.index=v.index,M.ref=v.ref,M}function Qd(v,y,M,b,k,G){var ue=2;if(b=v,typeof v=="function")qd(v)&&(ue=1);else if(typeof v=="string")ue=5;else e:switch(v){case c:return _u(M.children,k,G,y);case h:ue=8,k|=8;break;case d:return v=Ls(12,M,y,k|2),v.elementType=d,v.lanes=G,v;case _:return v=Ls(13,M,y,k),v.elementType=_,v.lanes=G,v;case S:return v=Ls(19,M,y,k),v.elementType=S,v.lanes=G,v;case C:return Yh(M,k,G,y);default:if(typeof v=="object"&&v!==null)switch(v.$$typeof){case m:ue=10;break e;case g:ue=9;break e;case x:ue=11;break e;case T:ue=14;break e;case E:ue=16,b=null;break e}throw Error(o(130,v==null?v:typeof v,""))}return y=Ls(ue,M,y,k),y.elementType=v,y.type=b,y.lanes=G,y}function _u(v,y,M,b){return v=Ls(7,v,b,y),v.lanes=M,v}function Yh(v,y,M,b){return v=Ls(22,v,b,y),v.elementType=C,v.lanes=M,v.stateNode={},v}function Zd(v,y,M){return v=Ls(6,v,null,y),v.lanes=M,v}function ep(v,y,M){return y=Ls(4,v.children!==null?v.children:[],v.key,y),y.lanes=M,y.stateNode={containerInfo:v.containerInfo,pendingChildren:null,implementation:v.implementation},y}function tp(v,y,M,b,k){this.tag=y,this.containerInfo=v,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ge,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yl(0),this.expirationTimes=Yl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yl(0),this.identifierPrefix=b,this.onRecoverableError=k,Pe&&(this.mutableSourceEagerHydrationData=null)}function ly(v,y,M,b,k,G,ue,Se,qe){return v=new tp(v,y,M,Se,qe),y===1?(y=1,G===!0&&(y|=8)):y=0,G=Ls(3,null,null,y),v.current=G,G.stateNode=v,G.memoizedState={element:b,isDehydrated:M,cache:null,transitions:null},dc(G),v}function uy(v){if(!v)return on;v=v._reactInternals;e:{if(D(v)!==v||v.tag!==1)throw Error(o(170));var y=v;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(qn(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(o(171))}if(v.tag===1){var M=v.type;if(qn(M))return jo(v,M,y)}return y}function cy(v){var y=v._reactInternals;if(y===void 0)throw typeof v.render=="function"?Error(o(188)):(v=Object.keys(v).join(","),Error(o(268,v)));return v=V(y),v===null?null:v.stateNode}function qs(v,y){if(v=v.memoizedState,v!==null&&v.dehydrated!==null){var M=v.retryLane;v.retryLane=M!==0&&M<y?M:y}}function Jh(v,y){qs(v,y),(v=v.alternate)&&qs(v,y)}function np(v){return v=V(v),v===null?null:v.stateNode}function hy(){return null}return t.attemptContinuousHydration=function(v){if(v.tag===13){var y=bn();Pr(v,134217728,y),Jh(v,134217728)}},t.attemptHydrationAtCurrentPriority=function(v){if(v.tag===13){var y=bn(),M=To(v);Pr(v,M,y),Jh(v,M)}},t.attemptSynchronousHydration=function(v){switch(v.tag){case 3:var y=v.stateNode;if(y.current.memoizedState.isDehydrated){var M=Ko(y.pendingLanes);M!==0&&(dr(y,M|1),as(y,ti()),(an&6)===0&&(vu(),Rr()))}break;case 13:var b=bn();Dc(function(){return Pr(v,1,b)}),Jh(v,1)}},t.batchedUpdates=function(v,y){var M=an;an|=1;try{return v(y)}finally{an=M,an===0&&(vu(),Yo&&Rr())}},t.createComponentSelector=function(v){return{$$typeof:Nh,value:v}},t.createContainer=function(v,y,M,b,k,G,ue){return ly(v,y,!1,null,M,b,k,G,ue)},t.createHasPseudoClassSelector=function(v){return{$$typeof:fu,value:v}},t.createHydrationContainer=function(v,y,M,b,k,G,ue,Se,qe){return v=ly(M,b,!0,v,k,G,ue,Se,qe),v.context=uy(null),M=v.current,b=bn(),k=To(M),G=Ea(b,k),G.callback=y??null,fl(M,G),v.current.lanes=k,zs(v,k,b),as(v,b),v},t.createPortal=function(v,y,M){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:b==null?null:""+b,children:v,containerInfo:y,implementation:M}},t.createRoleSelector=function(v){return{$$typeof:du,value:v}},t.createTestNameSelector=function(v){return{$$typeof:Ba,value:v}},t.createTextSelector=function(v){return{$$typeof:Rc,value:v}},t.deferredUpdates=function(v){var y=Zt,M=zn.transition;try{return zn.transition=null,Zt=16,v()}finally{Zt=y,zn.transition=M}},t.discreteUpdates=function(v,y,M,b,k){var G=Zt,ue=zn.transition;try{return zn.transition=null,Zt=1,v(y,M,b,k)}finally{Zt=G,zn.transition=ue,an===0&&vu()}},t.findAllNodes=Fa,t.findBoundingRects=function(v,y){if(!te)throw Error(o(363));y=Fa(v,y),v=[];for(var M=0;M<y.length;M++)v.push(me(y[M]));for(y=v.length-1;0<y;y--){M=v[y];for(var b=M.x,k=b+M.width,G=M.y,ue=G+M.height,Se=y-1;0<=Se;Se--)if(y!==Se){var qe=v[Se],dt=qe.x,It=dt+qe.width,tn=qe.y,jt=tn+qe.height;if(b>=dt&&G>=tn&&k<=It&&ue<=jt){v.splice(y,1);break}else if(b!==dt||M.width!==qe.width||jt<G||tn>ue){if(!(G!==tn||M.height!==qe.height||It<b||dt>k)){dt>b&&(qe.width+=dt-b,qe.x=b),It<k&&(qe.width=k-dt),v.splice(y,1);break}}else{tn>G&&(qe.height+=tn-G,qe.y=G),jt<ue&&(qe.height=ue-tn),v.splice(y,1);break}}}return v},t.findHostInstance=cy,t.findHostInstanceWithNoPortals=function(v){return v=N(v),v=v!==null?Q(v):null,v===null?null:v.stateNode},t.findHostInstanceWithWarning=function(v){return cy(v)},t.flushControlled=function(v){var y=an;an|=1;var M=zn.transition,b=Zt;try{zn.transition=null,Zt=1,v()}finally{Zt=b,zn.transition=M,an=y,an===0&&(vu(),Rr())}},t.flushPassiveEffects=ta,t.flushSync=Dc,t.focusWithin=function(v,y){if(!te)throw Error(o(363));for(v=Gh(v),y=bs(v,y),y=Array.from(y),v=0;v<y.length;){var M=y[v++];if(!Ee(M)){if(M.tag===5&&ut(M.stateNode))return!0;for(M=M.child;M!==null;)y.push(M),M=M.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Zt},t.getFindAllNodesFailureDescription=function(v,y){if(!te)throw Error(o(363));var M=0,b=[];v=[Gh(v),0];for(var k=0;k<v.length;){var G=v[k++],ue=v[k++],Se=y[ue];if((G.tag!==5||!Ee(G))&&(Hh(G,Se)&&(b.push(_l(Se)),ue++,ue>M&&(M=ue)),ue<y.length))for(G=G.child;G!==null;)v.push(G,ue),G=G.sibling}if(M<y.length){for(v=[];M<y.length;M++)v.push(_l(y[M]));return`findAllNodes was able to match part of the selector:
  `+(b.join(" > ")+`

No matching component was found for:
  `)+v.join(" > ")}return null},t.getPublicRootInstance=function(v){if(v=v.current,!v.child)return null;switch(v.child.tag){case 5:return ee(v.child.stateNode);default:return v.child.stateNode}},t.injectIntoDevTools=function(v){if(v={bundleType:v.bundleType,version:v.version,rendererPackageName:v.rendererPackageName,rendererConfig:v.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:np,findFiberByHostInstance:v.findFiberByHostInstance||hy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")v=!1;else{var y=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(y.isDisabled||!y.supportsFiber)v=!0;else{try{ll=y.inject(v),Es=y}catch{}v=!!y.checkDCE}}return v},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(v,y,M,b){if(!te)throw Error(o(363));v=Fa(v,y);var k=ke(v,M,b).disconnect;return{disconnect:function(){k()}}},t.registerMutableSourceForHydration=function(v,y){var M=y._getVersion;M=M(y._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[y,M]:v.mutableSourceEagerHydrationData.push(y,M)},t.runWithPriority=function(v,y){var M=Zt;try{return Zt=v,y()}finally{Zt=M}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(v,y,M,b){var k=y.current,G=bn(),ue=To(k);return M=uy(M),y.context===null?y.context=M:y.pendingContext=M,y=Ea(G,ue),y.payload={element:v},b=b===void 0?null:b,b!==null&&(y.callback=b),fl(k,y),v=Pr(k,ue,G),v!==null&&xd(v,k,ue),ue},t}),aE}var JI;function vW(){return JI||(JI=1,rE.exports=gW()),rE.exports}var yW=vW();const xW=nB(yW);var qI=ok();const zw={},ak=r=>void Object.assign(zw,r);function _W(r,e){function t(c,{args:h=[],attach:d,...m},g){let x=`${c[0].toUpperCase()}${c.slice(1)}`,_;if(c==="primitive"){if(m.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const S=m.object;_=kp(S,{type:c,root:g,attach:d,primitive:!0})}else{const S=zw[x];if(!S)throw new Error(`R3F: ${x} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(h))throw new Error("R3F: The args prop must be an array!");_=kp(new S(...h),{type:c,root:g,attach:d,memoizedProps:{args:h}})}return _.__r3f.attach===void 0&&(_.isBufferGeometry?_.__r3f.attach="geometry":_.isMaterial&&(_.__r3f.attach="material")),x!=="inject"&&cE(_,m),_}function n(c,h){let d=!1;if(h){var m,g;(m=h.__r3f)!=null&&m.attach?uE(c,h,h.__r3f.attach):h.isObject3D&&c.isObject3D&&(c.add(h),d=!0),d||(g=c.__r3f)==null||g.objects.push(h),h.__r3f||kp(h,{}),h.__r3f.parent=c,UT(h),Op(h)}}function i(c,h,d){let m=!1;if(h){var g,x;if((g=h.__r3f)!=null&&g.attach)uE(c,h,h.__r3f.attach);else if(h.isObject3D&&c.isObject3D){h.parent=c,h.dispatchEvent({type:"added"}),c.dispatchEvent({type:"childadded",child:h});const _=c.children.filter(T=>T!==h),S=_.indexOf(d);c.children=[..._.slice(0,S),h,..._.slice(S)],m=!0}m||(x=c.__r3f)==null||x.objects.push(h),h.__r3f||kp(h,{}),h.__r3f.parent=c,UT(h),Op(h)}}function s(c,h,d=!1){c&&[...c].forEach(m=>o(h,m,d))}function o(c,h,d){if(h){var m,g,x;if(h.__r3f&&(h.__r3f.parent=null),(m=c.__r3f)!=null&&m.objects&&(c.__r3f.objects=c.__r3f.objects.filter(C=>C!==h)),(g=h.__r3f)!=null&&g.attach)nL(c,h,h.__r3f.attach);else if(h.isObject3D&&c.isObject3D){var _;c.remove(h),(_=h.__r3f)!=null&&_.root&&bW(r_(h),h)}const T=(x=h.__r3f)==null?void 0:x.primitive,E=!T&&(d===void 0?h.dispose!==null:d);if(!T){var S;s((S=h.__r3f)==null?void 0:S.objects,h,E),s(h.children,h,E)}if(delete h.__r3f,E&&h.dispose&&h.type!=="Scene"){const C=()=>{try{h.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?qI.unstable_scheduleCallback(qI.unstable_IdlePriority,C):C()}Op(c)}}function a(c,h,d,m){var g;const x=(g=c.__r3f)==null?void 0:g.parent;if(!x)return;const _=t(h,d,c.__r3f.root);if(c.children){for(const S of c.children)S.__r3f&&n(_,S);c.children=c.children.filter(S=>!S.__r3f)}c.__r3f.objects.forEach(S=>n(_,S)),c.__r3f.objects=[],c.__r3f.autoRemovedBeforeAppend||o(x,c),_.parent&&(_.__r3f.autoRemovedBeforeAppend=!0),n(x,_),_.raycast&&_.__r3f.eventCount&&r_(_).getState().internal.interaction.push(_),[m,m.alternate].forEach(S=>{S!==null&&(S.stateNode=_,S.ref&&(typeof S.ref=="function"?S.ref(_):S.ref.current=_))})}const l=()=>{};return{reconciler:xW({createInstance:t,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(c,h)=>{if(!h)return;const d=c.getState().scene;d.__r3f&&(d.__r3f.root=c,n(d,h))},removeChildFromContainer:(c,h)=>{h&&o(c.getState().scene,h)},insertInContainerBefore:(c,h,d)=>{if(!h||!d)return;const m=c.getState().scene;m.__r3f&&i(m,h,d)},getRootHostContext:()=>null,getChildHostContext:c=>c,finalizeInitialChildren(c){var h;return!!((h=c==null?void 0:c.__r3f)!=null?h:{}).handlers},prepareUpdate(c,h,d,m){var g;if(((g=c==null?void 0:c.__r3f)!=null?g:{}).primitive&&m.object&&m.object!==c)return[!0];{const{args:_=[],children:S,...T}=m,{args:E=[],children:C,...R}=d;if(!Array.isArray(_))throw new Error("R3F: the args prop must be an array!");if(_.some((L,F)=>L!==E[F]))return[!0];const P=pk(c,T,R,!0);return P.changes.length?[!1,P]:null}},commitUpdate(c,[h,d],m,g,x,_){h?a(c,m,x,_):cE(c,d)},commitMount(c,h,d,m){var g;const x=(g=c.__r3f)!=null?g:{};c.raycast&&x.handlers&&x.eventCount&&r_(c).getState().internal.interaction.push(c)},getPublicInstance:c=>c,prepareForCommit:()=>null,preparePortalMount:c=>kp(c.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(c){var h;const{attach:d,parent:m}=(h=c.__r3f)!=null?h:{};d&&m&&nL(m,c,d),c.isObject3D&&(c.visible=!1),Op(c)},unhideInstance(c,h){var d;const{attach:m,parent:g}=(d=c.__r3f)!=null?d:{};m&&g&&uE(g,c,m),(c.isObject3D&&h.visible==null||h.visible)&&(c.visible=!0),Op(c)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():zp.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&si.fun(performance.now)?performance.now:si.fun(Date.now)?Date.now:()=>0,scheduleTimeout:si.fun(setTimeout)?setTimeout:void 0,cancelTimeout:si.fun(clearTimeout)?clearTimeout:void 0}),applyProps:cE}}var QI,ZI;const lE=r=>"colorSpace"in r||"outputColorSpace"in r,lk=()=>{var r;return(r=zw.ColorManagement)!=null?r:null},uk=r=>r&&r.isOrthographicCamera,SW=r=>r&&r.hasOwnProperty("current"),Iv=typeof window<"u"&&((QI=window.document)!=null&&QI.createElement||((ZI=window.navigator)==null?void 0:ZI.product)==="ReactNative")?ne.useLayoutEffect:ne.useEffect;function ck(r){const e=ne.useRef(r);return Iv(()=>void(e.current=r),[r]),e}function AW({set:r}){return Iv(()=>(r(new Promise(()=>null)),()=>r(!1)),[r]),null}class hk extends ne.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}hk.getDerivedStateFromError=()=>({error:!0});const fk="__default",eL=new Map,EW=r=>r&&!!r.memoized&&!!r.changes;function dk(r){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(r)?Math.min(Math.max(r[0],t),r[1]):r}const Vg=r=>{var e;return(e=r.__r3f)==null?void 0:e.root.getState()};function r_(r){let e=r.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const si={obj:r=>r===Object(r)&&!si.arr(r)&&typeof r!="function",fun:r=>typeof r=="function",str:r=>typeof r=="string",num:r=>typeof r=="number",boo:r=>typeof r=="boolean",und:r=>r===void 0,arr:r=>Array.isArray(r),equ(r,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof r!=typeof e||!!r!=!!e)return!1;if(si.str(r)||si.num(r)||si.boo(r))return r===e;const s=si.obj(r);if(s&&n==="reference")return r===e;const o=si.arr(r);if(o&&t==="reference")return r===e;if((o||s)&&r===e)return!0;let a;for(a in r)if(!(a in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(a in i?e:r)if(!si.equ(r[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:r)if(r[a]!==e[a])return!1;if(si.und(a)){if(o&&r.length===0&&e.length===0||s&&Object.keys(r).length===0&&Object.keys(e).length===0)return!0;if(r!==e)return!1}return!0}};function TW(r){const e={nodes:{},materials:{}};return r&&r.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function MW(r){r.dispose&&r.type!=="Scene"&&r.dispose();for(const e in r)e.dispose==null||e.dispose(),delete r[e]}function kp(r,e){const t=r;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},r}function OT(r,e){let t=r;if(e.includes("-")){const n=e.split("-"),i=n.pop();return t=n.reduce((s,o)=>s[o],r),{target:t,key:i}}else return{target:t,key:e}}const tL=/-\d+$/;function uE(r,e,t){if(si.str(t)){if(tL.test(t)){const s=t.replace(tL,""),{target:o,key:a}=OT(r,s);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:i}=OT(r,t);e.__r3f.previousAttach=n[i],n[i]=e}else e.__r3f.previousAttach=t(r,e)}function nL(r,e,t){var n,i;if(si.str(t)){const{target:s,key:o}=OT(r,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(r,e);(i=e.__r3f)==null||delete i.previousAttach}function pk(r,{children:e,key:t,ref:n,...i},{children:s,key:o,ref:a,...l}={},u=!1){const c=r.__r3f,h=Object.entries(i),d=[];if(u){const g=Object.keys(l);for(let x=0;x<g.length;x++)i.hasOwnProperty(g[x])||h.unshift([g[x],fk+"remove"])}h.forEach(([g,x])=>{var _;if((_=r.__r3f)!=null&&_.primitive&&g==="object"||si.equ(x,l[g]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(g))return d.push([g,x,!0,[]]);let S=[];g.includes("-")&&(S=g.split("-")),d.push([g,x,!1,S]);for(const T in i){const E=i[T];T.startsWith(`${g}-`)&&d.push([T,E,!1,T.split("-")])}});const m={...i};return c!=null&&c.memoizedProps&&c!=null&&c.memoizedProps.args&&(m.args=c.memoizedProps.args),c!=null&&c.memoizedProps&&c!=null&&c.memoizedProps.attach&&(m.attach=c.memoizedProps.attach),{memoized:m,changes:d}}function cE(r,e){var t;const n=r.__r3f,i=n==null?void 0:n.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:o,changes:a}=EW(e)?e:pk(r,e),l=n==null?void 0:n.eventCount;r.__r3f&&(r.__r3f.memoizedProps=o);for(let d=0;d<a.length;d++){let[m,g,x,_]=a[d];if(lE(r)){const C="srgb",R="srgb-linear";m==="encoding"?(m="colorSpace",g=g===3001?C:R):m==="outputEncoding"&&(m="outputColorSpace",g=g===3001?C:R)}let S=r,T=S[m];if(_.length&&(T=_.reduce((E,C)=>E[C],r),!(T&&T.set))){const[E,...C]=_.reverse();S=C.reverse().reduce((R,P)=>R[P],r),m=E}if(g===fk+"remove")if(S.constructor){let E=eL.get(S.constructor);E||(E=new S.constructor,eL.set(S.constructor,E)),g=E[m]}else g=0;if(x&&n)g?n.handlers[m]=g:delete n.handlers[m],n.eventCount=Object.keys(n.handlers).length;else if(T&&T.set&&(T.copy||T instanceof zf)){if(Array.isArray(g))T.fromArray?T.fromArray(g):T.set(...g);else if(T.copy&&g&&g.constructor&&T.constructor===g.constructor)T.copy(g);else if(g!==void 0){var u;const E=(u=T)==null?void 0:u.isColor;!E&&T.setScalar?T.setScalar(g):T instanceof zf&&g instanceof zf?T.mask=g.mask:T.set(g),!lk()&&s&&!s.linear&&E&&T.convertSRGBToLinear()}}else{var c;if(S[m]=g,(c=S[m])!=null&&c.isTexture&&S[m].format===ms&&S[m].type===Za&&s){const E=S[m];lE(E)&&lE(s.gl)?E.colorSpace=s.gl.outputColorSpace:E.encoding=s.gl.outputEncoding}}Op(r)}if(n&&n.parent&&r.raycast&&l!==n.eventCount){const d=r_(r).getState().internal,m=d.interaction.indexOf(r);m>-1&&d.interaction.splice(m,1),n.eventCount&&d.interaction.push(r)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=r.__r3f)!=null&&t.parent&&UT(r),r}function Op(r){var e,t;const n=(e=r.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function UT(r){r.onUpdate==null||r.onUpdate(r)}function wW(r,e){r.manual||(uk(r)?(r.left=e.width/-2,r.right=e.width/2,r.top=e.height/2,r.bottom=e.height/-2):r.aspect=e.width/e.height,r.updateProjectionMatrix(),r.updateMatrixWorld())}function Mx(r){return(r.eventObject||r.object).uuid+"/"+r.index+r.instanceId}function CW(){var r;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return zp.DefaultEventPriority;switch((r=e.event)==null?void 0:r.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return zp.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return zp.ContinuousEventPriority;default:return zp.DefaultEventPriority}}function mk(r,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(r.delete(n),i.target.releasePointerCapture(n)))}function bW(r,e){const{internal:t}=r.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{mk(t.capturedMap,e,n,i)})}function RW(r){function e(l){const{internal:u}=r.getState(),c=l.offsetX-u.initialClick[0],h=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(c*c+h*h))}function t(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(c=>{var h;return(h=u.__r3f)==null?void 0:h.handlers["onPointer"+c]}))}function n(l,u){const c=r.getState(),h=new Set,d=[],m=u?u(c.internal.interaction):c.internal.interaction;for(let S=0;S<m.length;S++){const T=Vg(m[S]);T&&(T.raycaster.camera=void 0)}c.previousRoot||c.events.compute==null||c.events.compute(l,c);function g(S){const T=Vg(S);if(!T||!T.events.enabled||T.raycaster.camera===null)return[];if(T.raycaster.camera===void 0){var E;T.events.compute==null||T.events.compute(l,T,(E=T.previousRoot)==null?void 0:E.getState()),T.raycaster.camera===void 0&&(T.raycaster.camera=null)}return T.raycaster.camera?T.raycaster.intersectObject(S,!0):[]}let x=m.flatMap(g).sort((S,T)=>{const E=Vg(S.object),C=Vg(T.object);return!E||!C?S.distance-T.distance:C.events.priority-E.events.priority||S.distance-T.distance}).filter(S=>{const T=Mx(S);return h.has(T)?!1:(h.add(T),!0)});c.events.filter&&(x=c.events.filter(x,c));for(const S of x){let T=S.object;for(;T;){var _;(_=T.__r3f)!=null&&_.eventCount&&d.push({...S,eventObject:T}),T=T.parent}}if("pointerId"in l&&c.internal.capturedMap.has(l.pointerId))for(let S of c.internal.capturedMap.get(l.pointerId).values())h.has(Mx(S.intersection))||d.push(S.intersection);return d}function i(l,u,c,h){const d=r.getState();if(l.length){const m={stopped:!1};for(const g of l){const x=Vg(g.object)||d,{raycaster:_,pointer:S,camera:T,internal:E}=x,C=new ae(S.x,S.y,0).unproject(T),R=I=>{var N,V;return(N=(V=E.capturedMap.get(I))==null?void 0:V.has(g.eventObject))!=null?N:!1},P=I=>{const N={intersection:g,target:u.target};E.capturedMap.has(I)?E.capturedMap.get(I).set(g.eventObject,N):E.capturedMap.set(I,new Map([[g.eventObject,N]])),u.target.setPointerCapture(I)},L=I=>{const N=E.capturedMap.get(I);N&&mk(E.capturedMap,g.eventObject,N,I)};let F={};for(let I in u){let N=u[I];typeof N!="function"&&(F[I]=N)}let D={...g,...F,pointer:S,intersections:l,stopped:m.stopped,delta:c,unprojectedPoint:C,ray:_.ray,camera:T,stopPropagation(){const I="pointerId"in u&&E.capturedMap.get(u.pointerId);if((!I||I.has(g.eventObject))&&(D.stopped=m.stopped=!0,E.hovered.size&&Array.from(E.hovered.values()).find(N=>N.eventObject===g.eventObject))){const N=l.slice(0,l.indexOf(g));s([...N,g])}},target:{hasPointerCapture:R,setPointerCapture:P,releasePointerCapture:L},currentTarget:{hasPointerCapture:R,setPointerCapture:P,releasePointerCapture:L},nativeEvent:u};if(h(D),m.stopped===!0)break}}return l}function s(l){const{internal:u}=r.getState();for(const c of u.hovered.values())if(!l.length||!l.find(h=>h.object===c.object&&h.index===c.index&&h.instanceId===c.instanceId)){const d=c.eventObject.__r3f,m=d==null?void 0:d.handlers;if(u.hovered.delete(Mx(c)),d!=null&&d.eventCount){const g={...c,intersections:l};m.onPointerOut==null||m.onPointerOut(g),m.onPointerLeave==null||m.onPointerLeave(g)}}}function o(l,u){for(let c=0;c<u.length;c++){const h=u[c].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:c}=r.getState();"pointerId"in u&&c.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{c.capturedMap.has(u.pointerId)&&(c.capturedMap.delete(u.pointerId),s([]))})}}return function(c){const{onPointerMissed:h,internal:d}=r.getState();d.lastEvent.current=c;const m=l==="onPointerMove",g=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",_=n(c,m?t:void 0),S=g?e(c):0;l==="onPointerDown"&&(d.initialClick=[c.offsetX,c.offsetY],d.initialHits=_.map(E=>E.eventObject)),g&&!_.length&&S<=2&&(o(c,d.interaction),h&&h(c)),m&&s(_);function T(E){const C=E.eventObject,R=C.__r3f,P=R==null?void 0:R.handlers;if(R!=null&&R.eventCount)if(m){if(P.onPointerOver||P.onPointerEnter||P.onPointerOut||P.onPointerLeave){const L=Mx(E),F=d.hovered.get(L);F?F.stopped&&E.stopPropagation():(d.hovered.set(L,E),P.onPointerOver==null||P.onPointerOver(E),P.onPointerEnter==null||P.onPointerEnter(E))}P.onPointerMove==null||P.onPointerMove(E)}else{const L=P[l];L?(!g||d.initialHits.includes(C))&&(o(c,d.interaction.filter(F=>!d.initialHits.includes(F))),L(E)):g&&d.initialHits.includes(C)&&o(c,d.interaction.filter(F=>!d.initialHits.includes(F)))}}i(_,c,S,T)}}return{handlePointer:a}}const gk=r=>!!(r!=null&&r.render),vk=ne.createContext(null),IW=(r,e)=>{const t=hW((a,l)=>{const u=new ae,c=new ae,h=new ae;function d(S=l().camera,T=c,E=l().size){const{width:C,height:R,top:P,left:L}=E,F=C/R;T.isVector3?h.copy(T):h.set(...T);const D=S.getWorldPosition(u).distanceTo(h);if(uk(S))return{width:C/S.zoom,height:R/S.zoom,top:P,left:L,factor:1,distance:D,aspect:F};{const I=S.fov*Math.PI/180,N=2*Math.tan(I/2)*D,V=N*(C/R);return{width:V,height:N,top:P,left:L,factor:C/V,distance:D,aspect:F}}}let m;const g=S=>a(T=>({performance:{...T.performance,current:S}})),x=new Qe;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(S=1)=>r(l(),S),advance:(S,T)=>e(S,T,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new kw,pointer:x,mouse:x,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const S=l();m&&clearTimeout(m),S.performance.current!==S.performance.min&&g(S.performance.min),m=setTimeout(()=>g(l().performance.max),S.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:S=>a(T=>({...T,events:{...T.events,...S}})),setSize:(S,T,E,C,R)=>{const P=l().camera,L={width:S,height:T,top:C||0,left:R||0,updateStyle:E};a(F=>({size:L,viewport:{...F.viewport,...d(P,c,L)}}))},setDpr:S=>a(T=>{const E=dk(S);return{viewport:{...T.viewport,dpr:E,initialDpr:T.viewport.initialDpr||E}}}),setFrameloop:(S="always")=>{const T=l().clock;T.stop(),T.elapsedTime=0,S!=="never"&&(T.start(),T.elapsedTime=0),a(()=>({frameloop:S}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ne.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(S,T,E)=>{const C=l().internal;return C.priority=C.priority+(T>0?1:0),C.subscribers.push({ref:S,priority:T,store:E}),C.subscribers=C.subscribers.sort((R,P)=>R.priority-P.priority),()=>{const R=l().internal;R!=null&&R.subscribers&&(R.priority=R.priority-(T>0?1:0),R.subscribers=R.subscribers.filter(P=>P.ref!==S))}}}}}),n=t.getState();let i=n.size,s=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:u,gl:c,set:h}=t.getState();if(l.width!==i.width||l.height!==i.height||u.dpr!==s){var d;i=l,s=u.dpr,wW(a,l),c.setPixelRatio(u.dpr);const m=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&c.domElement instanceof HTMLCanvasElement;c.setSize(l.width,l.height,m)}a!==o&&(o=a,h(m=>({viewport:{...m.viewport,...m.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>r(a)),t};let wx,LW=new Set,PW=new Set,DW=new Set;function hE(r,e){if(r.size)for(const{callback:t}of r.values())t(e)}function Wg(r,e){switch(r){case"before":return hE(LW,e);case"after":return hE(PW,e);case"tail":return hE(DW,e)}}let fE,dE;function pE(r,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof r=="number"&&(n=r-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=r),fE=e.internal.subscribers,wx=0;wx<fE.length;wx++)dE=fE[wx],dE.ref.current(dE.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function BW(r){let e=!1,t=!1,n,i,s;function o(u){i=requestAnimationFrame(o),e=!0,n=0,Wg("before",u),t=!0;for(const h of r.values()){var c;s=h.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((c=s.gl.xr)!=null&&c.isPresenting)&&(n+=pE(u,s))}if(t=!1,Wg("after",u),n===0)return Wg("tail",u),e=!1,cancelAnimationFrame(i)}function a(u,c=1){var h;if(!u)return r.forEach(d=>a(d.store.getState(),c));(h=u.gl.xr)!=null&&h.isPresenting||!u.internal.active||u.frameloop==="never"||(c>1?u.internal.frames=Math.min(60,u.internal.frames+c):t?u.internal.frames=2:u.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(u,c=!0,h,d){if(c&&Wg("before",u),h)pE(u,h,d);else for(const m of r.values())pE(u,m.store.getState());c&&Wg("after",u)}return{loop:o,invalidate:a,advance:l}}function yk(){const r=ne.useContext(vk);if(!r)throw new Error("R3F: Hooks can only be used within the Canvas component!");return r}function Ro(r=t=>t,e){return yk()(r,e)}function _h(r,e=0){const t=yk(),n=t.getState().internal.subscribe,i=ck(r);return Iv(()=>n(i,e,t),[e,n,t]),null}const iL=new WeakMap;function xk(r,e){return function(t,...n){let i=iL.get(t);return i||(i=new t,iL.set(t,i)),r&&r(i),Promise.all(n.map(s=>new Promise((o,a)=>i.load(s,l=>{l.scene&&Object.assign(l,TW(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`))))))}}function Lv(r,e,t,n){const i=Array.isArray(e)?e:[e],s=Hw(xk(t,n),[r,...i],{equal:si.equ});return Array.isArray(e)?s:s[0]}Lv.preload=function(r,e,t){const n=Array.isArray(e)?e:[e];return dW(xk(t),[r,...n])};Lv.clear=function(r,e){const t=Array.isArray(e)?e:[e];return pW([r,...t])};const pm=new Map,{invalidate:rL,advance:sL}=BW(pm),{reconciler:iS,applyProps:bp}=_W(pm,CW),Rp={objects:"shallow",strict:!1},FW=(r,e)=>{const t=typeof r=="function"?r(e):r;return gk(t)?t:new mF({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...r})};function kW(r,e){const t=typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement;if(e){const{width:n,height:i,top:s,left:o,updateStyle:a=t}=e;return{width:n,height:i,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&r.parentElement){const{width:n,height:i,top:s,left:o}=r.parentElement.getBoundingClientRect();return{width:n,height:i,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas)return{width:r.width,height:r.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function OW(r){const e=pm.get(r),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=n||IW(rL,sL),o=t||iS.createContainer(s,zp.ConcurrentRoot,null,!1,null,"",i,null);e||pm.set(r,{fiber:o,store:s});let a,l=!1,u;return{configure(c={}){let{gl:h,size:d,scene:m,events:g,onCreated:x,shadows:_=!1,linear:S=!1,flat:T=!1,legacy:E=!1,orthographic:C=!1,frameloop:R="always",dpr:P=[1,2],performance:L,raycaster:F,camera:D,onPointerMissed:I}=c,N=s.getState(),V=N.gl;N.gl||N.set({gl:V=FW(h,r)});let q=N.raycaster;q||N.set({raycaster:q=new tk});const{params:Q,...re}=F||{};if(si.equ(re,q,Rp)||bp(q,{...re}),si.equ(Q,q.params,Rp)||bp(q,{params:{...q.params,...Q}}),!N.camera||N.camera===u&&!si.equ(u,D,Rp)){u=D;const j=D instanceof Sv,U=j?D:C?new Qa(0,0,0,0,.1,1e3):new mi(75,0,.1,1e3);j||(U.position.z=5,D&&(bp(U,D),("aspect"in D||"left"in D||"right"in D||"bottom"in D||"top"in D)&&(U.manual=!0,U.updateProjectionMatrix())),!N.camera&&!(D!=null&&D.rotation)&&U.lookAt(0,0,0)),N.set({camera:U}),q.camera=U}if(!N.scene){let j;m!=null&&m.isScene?j=m:(j=new pw,m&&bp(j,m)),N.set({scene:kp(j)})}if(!N.xr){var ee;const j=(le,Z)=>{const oe=s.getState();oe.frameloop!=="never"&&sL(le,!0,oe,Z)},U=()=>{const le=s.getState();le.gl.xr.enabled=le.gl.xr.isPresenting,le.gl.xr.setAnimationLoop(le.gl.xr.isPresenting?j:null),le.gl.xr.isPresenting||rL(le)},X={connect(){const le=s.getState().gl;le.xr.addEventListener("sessionstart",U),le.xr.addEventListener("sessionend",U)},disconnect(){const le=s.getState().gl;le.xr.removeEventListener("sessionstart",U),le.xr.removeEventListener("sessionend",U)}};typeof((ee=V.xr)==null?void 0:ee.addEventListener)=="function"&&X.connect(),N.set({xr:X})}if(V.shadowMap){const j=V.shadowMap.enabled,U=V.shadowMap.type;if(V.shadowMap.enabled=!!_,si.boo(_))V.shadowMap.type=f0;else if(si.str(_)){var se;const X={basic:oB,percentage:FS,soft:f0,variance:Ya};V.shadowMap.type=(se=X[_])!=null?se:f0}else si.obj(_)&&Object.assign(V.shadowMap,_);(j!==V.shadowMap.enabled||U!==V.shadowMap.type)&&(V.shadowMap.needsUpdate=!0)}const W=lk();W&&("enabled"in W?W.enabled=!E:"legacyMode"in W&&(W.legacyMode=E)),l||bp(V,{outputEncoding:S?3e3:3001,toneMapping:T?Ul:XM}),N.legacy!==E&&N.set(()=>({legacy:E})),N.linear!==S&&N.set(()=>({linear:S})),N.flat!==T&&N.set(()=>({flat:T})),h&&!si.fun(h)&&!gk(h)&&!si.equ(h,V,Rp)&&bp(V,h),g&&!N.events.handlers&&N.set({events:g(s)});const $=kW(r,d);return si.equ($,N.size,Rp)||N.setSize($.width,$.height,$.updateStyle,$.top,$.left),P&&N.viewport.dpr!==dk(P)&&N.setDpr(P),N.frameloop!==R&&N.setFrameloop(R),N.onPointerMissed||N.set({onPointerMissed:I}),L&&!si.equ(L,N.performance,Rp)&&N.set(j=>({performance:{...j.performance,...L}})),a=x,l=!0,this},render(c){return l||this.configure(),iS.updateContainer(J.jsx(UW,{store:s,children:c,onCreated:a,rootElement:r}),o,null,()=>{}),s},unmount(){_k(r)}}}function UW({store:r,children:e,onCreated:t,rootElement:n}){return Iv(()=>{const i=r.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),r.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),J.jsx(vk.Provider,{value:r,children:e})}function _k(r,e){const t=pm.get(r),n=t==null?void 0:t.fiber;if(n){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),iS.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),MW(i),pm.delete(r)}catch{}},500)})}}iS.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ne.version});const mE={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function NW(r){const{handlePointer:e}=RW(r);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(mE).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=r.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:s}=r.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([o,a])=>{const[l,u]=mE[o];t.addEventListener(l,a,{passive:u})})},disconnect:()=>{const{set:t,events:n}=r.getState();if(n.connected){var i;Object.entries((i=n.handlers)!=null?i:[]).forEach(([s,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=mE[s];n.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function oL(r,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>r(...n),e)}}function GW({debounce:r,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=ne.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=ne.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=r?typeof r=="number"?r:r.scroll:null,u=r?typeof r=="number"?r:r.resize:null,c=ne.useRef(!1);ne.useEffect(()=>(c.current=!0,()=>void(c.current=!1)));const[h,d,m]=ne.useMemo(()=>{const S=()=>{if(!a.current.element)return;const{left:T,top:E,width:C,height:R,bottom:P,right:L,x:F,y:D}=a.current.element.getBoundingClientRect(),I={left:T,top:E,width:C,height:R,bottom:P,right:L,x:F,y:D};a.current.element instanceof HTMLElement&&n&&(I.height=a.current.element.offsetHeight,I.width=a.current.element.offsetWidth),Object.freeze(I),c.current&&!WW(a.current.lastBounds,I)&&o(a.current.lastBounds=I)};return[S,u?oL(S,u):S,l?oL(S,l):S]},[o,n,l,u]);function g(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(S=>S.removeEventListener("scroll",m,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function x(){a.current.element&&(a.current.resizeObserver=new i(m),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(S=>S.addEventListener("scroll",m,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const _=S=>{!S||S===a.current.element||(g(),a.current.element=S,a.current.scrollContainers=Sk(S),x())};return zW(m,!!e),HW(d),ne.useEffect(()=>{g(),x()},[e,m,d]),ne.useEffect(()=>g,[]),[_,s,h]}function HW(r){ne.useEffect(()=>{const e=r;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[r])}function zW(r,e){ne.useEffect(()=>{if(e){const t=r;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[r,e])}function Sk(r){const e=[];if(!r||r===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(r);return[t,n,i].some(s=>s==="auto"||s==="scroll")&&e.push(r),[...e,...Sk(r.parentElement)]}const VW=["x","y","top","bottom","left","right","width","height"],WW=(r,e)=>VW.every(t=>r[t]===e[t]);var jW=Object.defineProperty,KW=Object.defineProperties,$W=Object.getOwnPropertyDescriptors,aL=Object.getOwnPropertySymbols,XW=Object.prototype.hasOwnProperty,YW=Object.prototype.propertyIsEnumerable,lL=(r,e,t)=>e in r?jW(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,uL=(r,e)=>{for(var t in e||(e={}))XW.call(e,t)&&lL(r,t,e[t]);if(aL)for(var t of aL(e))YW.call(e,t)&&lL(r,t,e[t]);return r},JW=(r,e)=>KW(r,$W(e)),cL,hL;typeof window<"u"&&((cL=window.document)!=null&&cL.createElement||((hL=window.navigator)==null?void 0:hL.product)==="ReactNative")?ne.useLayoutEffect:ne.useEffect;function Ak(r,e,t){if(!r)return;if(t(r)===!0)return r;let n=r.child;for(;n;){const i=Ak(n,e,t);if(i)return i;n=n.sibling}}function Ek(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const fL=console.error;console.error=function(){const r=[...arguments].join("");if(r!=null&&r.startsWith("Warning:")&&r.includes("useContext")){console.error=fL;return}return fL.apply(this,arguments)};const Vw=Ek(ne.createContext(null));class Tk extends ne.Component{render(){return ne.createElement(Vw.Provider,{value:this._reactInternals},this.props.children)}}function qW(){const r=ne.useContext(Vw);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ne.useId();return ne.useMemo(()=>{for(const n of[r,r==null?void 0:r.alternate]){if(!n)continue;const i=Ak(n,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[r,e])}function QW(){const r=qW(),[e]=ne.useState(()=>new Map);e.clear();let t=r;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==Vw&&!e.has(i)&&e.set(i,ne.useContext(Ek(i)))}t=t.return}return e}function ZW(){const r=QW();return ne.useMemo(()=>Array.from(r.keys()).reduce((e,t)=>n=>ne.createElement(e,null,ne.createElement(t.Provider,JW(uL({},n),{value:r.get(t)}))),e=>ne.createElement(Tk,uL({},e))),[r])}const ej=ne.forwardRef(function({children:e,fallback:t,resize:n,style:i,gl:s,events:o=NW,eventSource:a,eventPrefix:l,shadows:u,linear:c,flat:h,legacy:d,orthographic:m,frameloop:g,dpr:x,performance:_,raycaster:S,camera:T,scene:E,onPointerMissed:C,onCreated:R,...P},L){ne.useMemo(()=>ak(oW),[]);const F=ZW(),[D,I]=GW({scroll:!0,debounce:{scroll:50,resize:0},...n}),N=ne.useRef(null),V=ne.useRef(null);ne.useImperativeHandle(L,()=>N.current);const q=ck(C),[Q,re]=ne.useState(!1),[ee,se]=ne.useState(!1);if(Q)throw Q;if(ee)throw ee;const W=ne.useRef(null);Iv(()=>{const j=N.current;I.width>0&&I.height>0&&j&&(W.current||(W.current=OW(j)),W.current.configure({gl:s,events:o,shadows:u,linear:c,flat:h,legacy:d,orthographic:m,frameloop:g,dpr:x,performance:_,raycaster:S,camera:T,scene:E,size:I,onPointerMissed:(...U)=>q.current==null?void 0:q.current(...U),onCreated:U=>{U.events.connect==null||U.events.connect(a?SW(a)?a.current:a:V.current),l&&U.setEvents({compute:(X,le)=>{const Z=X[l+"X"],oe=X[l+"Y"];le.pointer.set(Z/le.size.width*2-1,-(oe/le.size.height)*2+1),le.raycaster.setFromCamera(le.pointer,le.camera)}}),R==null||R(U)}}),W.current.render(J.jsx(F,{children:J.jsx(hk,{set:se,children:J.jsx(ne.Suspense,{fallback:J.jsx(AW,{set:re}),children:e??null})})})))}),ne.useEffect(()=>{const j=N.current;if(j)return()=>_k(j)},[]);const $=a?"none":"auto";return J.jsx("div",{ref:V,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:$,...i},...P,children:J.jsx("div",{ref:D,style:{width:"100%",height:"100%"},children:J.jsx("canvas",{ref:N,style:{display:"block"},children:t})})})}),em=ne.forwardRef(function(e,t){return J.jsx(Tk,{children:J.jsx(ej,{...e,ref:t})})});function Qu(){return Qu=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Qu.apply(null,arguments)}const Pv=new ae,Ww=new ae,tj=new ae,dL=new Qe;function nj(r,e,t){const n=Pv.setFromMatrixPosition(r.matrixWorld);n.project(e);const i=t.width/2,s=t.height/2;return[n.x*i+i,-(n.y*s)+s]}function ij(r,e){const t=Pv.setFromMatrixPosition(r.matrixWorld),n=Ww.setFromMatrixPosition(e.matrixWorld),i=t.sub(n),s=e.getWorldDirection(tj);return i.angleTo(s)>Math.PI/2}function rj(r,e,t,n){const i=Pv.setFromMatrixPosition(r.matrixWorld),s=i.clone();s.project(e),dL.set(s.x,s.y),t.setFromCamera(dL,e);const o=t.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return i.distanceTo(t.ray.origin)<a}return!0}function sj(r,e){if(e instanceof Qa)return e.zoom;if(e instanceof mi){const t=Pv.setFromMatrixPosition(r.matrixWorld),n=Ww.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(i/2)*s)}else return 1}function oj(r,e,t){if(e instanceof mi||e instanceof Qa){const n=Pv.setFromMatrixPosition(r.matrixWorld),i=Ww.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(i),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*s+a)}}const NT=r=>Math.abs(r)<1e-10?0:r;function Mk(r,e,t=""){let n="matrix3d(";for(let i=0;i!==16;i++)n+=NT(e[i]*r.elements[i])+(i!==15?",":")");return t+n}const aj=(r=>e=>Mk(e,r))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),lj=(r=>(e,t)=>Mk(e,r(t),"translate(-50%,-50%)"))(r=>[1/r,1/r,1/r,1,-1/r,-1/r,-1/r,-1,1/r,1/r,1/r,1,1,1,1,1]);function uj(r){return r&&typeof r=="object"&&"current"in r}const cj=ne.forwardRef(({children:r,eps:e=.001,style:t,className:n,prepend:i,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:u=!1,transform:c=!1,occlude:h,onOcclude:d,castShadow:m,receiveShadow:g,material:x,geometry:_,zIndexRange:S=[16777271,0],calculatePosition:T=nj,as:E="div",wrapperClass:C,pointerEvents:R="auto",...P},L)=>{const{gl:F,camera:D,scene:I,size:N,raycaster:V,events:q,viewport:Q}=Ro(),[re]=ne.useState(()=>document.createElement(E)),ee=ne.useRef(),se=ne.useRef(null),W=ne.useRef(0),$=ne.useRef([0,0]),j=ne.useRef(null),U=ne.useRef(null),X=(a==null?void 0:a.current)||q.connected||F.domElement.parentNode,le=ne.useRef(null),Z=ne.useRef(!1),oe=ne.useMemo(()=>h&&h!=="blending"||Array.isArray(h)&&h.length&&uj(h[0]),[h]);ne.useLayoutEffect(()=>{const Ke=F.domElement;h&&h==="blending"?(Ke.style.zIndex=`${Math.floor(S[0]/2)}`,Ke.style.position="absolute",Ke.style.pointerEvents="none"):(Ke.style.zIndex=null,Ke.style.position=null,Ke.style.pointerEvents=null)},[h]),ne.useLayoutEffect(()=>{if(se.current){const Ke=ee.current=iB.createRoot(re);if(I.updateMatrixWorld(),c)re.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const De=T(se.current,D,N);re.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${De[0]}px,${De[1]}px,0);transform-origin:0 0;`}return X&&(i?X.prepend(re):X.appendChild(re)),()=>{X&&X.removeChild(re),Ke.unmount()}}},[X,c]),ne.useLayoutEffect(()=>{C&&(re.className=C)},[C]);const pe=ne.useMemo(()=>c?{position:"absolute",top:0,left:0,width:N.width,height:N.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-N.height/2,left:-N.width/2,width:N.width,height:N.height},...t},[t,s,o,N,c]),de=ne.useMemo(()=>({position:"absolute",pointerEvents:R}),[R]);ne.useLayoutEffect(()=>{if(Z.current=!1,c){var Ke;(Ke=ee.current)==null||Ke.render(ne.createElement("div",{ref:j,style:pe},ne.createElement("div",{ref:U,style:de},ne.createElement("div",{ref:L,className:n,style:t,children:r}))))}else{var De;(De=ee.current)==null||De.render(ne.createElement("div",{ref:L,style:pe,className:n,children:r}))}});const ye=ne.useRef(!0);_h(Ke=>{if(se.current){D.updateMatrixWorld(),se.current.updateWorldMatrix(!0,!1);const De=c?$.current:T(se.current,D,N);if(c||Math.abs(W.current-D.zoom)>e||Math.abs($.current[0]-De[0])>e||Math.abs($.current[1]-De[1])>e){const K=ij(se.current,D);let Pe=!1;oe&&(Array.isArray(h)?Pe=h.map(et=>et.current):h!=="blending"&&(Pe=[I]));const Be=ye.current;if(Pe){const et=rj(se.current,D,V,Pe);ye.current=et&&!K}else ye.current=!K;Be!==ye.current&&(d?d(!ye.current):re.style.display=ye.current?"block":"none");const Xe=Math.floor(S[0]/2),ve=h?oe?[S[0],Xe]:[Xe-1,0]:S;if(re.style.zIndex=`${oj(se.current,D,ve)}`,c){const[et,Ce]=[N.width/2,N.height/2],We=D.projectionMatrix.elements[5]*Ce,{isOrthographicCamera:te,top:z,left:me,bottom:_e,right:Ee}=D,we=aj(D.matrixWorldInverse),ut=te?`scale(${We})translate(${NT(-(Ee+me)/2)}px,${NT((z+_e)/2)}px)`:`translateZ(${We}px)`;let ke=se.current.matrixWorld;u&&(ke=D.matrixWorldInverse.clone().transpose().copyPosition(ke).scale(se.current.scale),ke.elements[3]=ke.elements[7]=ke.elements[11]=0,ke.elements[15]=1),re.style.width=N.width+"px",re.style.height=N.height+"px",re.style.perspective=te?"":`${We}px`,j.current&&U.current&&(j.current.style.transform=`${ut}${we}translate(${et}px,${Ce}px)`,U.current.style.transform=lj(ke,1/((l||10)/400)))}else{const et=l===void 0?1:sj(se.current,D)*l;re.style.transform=`translate3d(${De[0]}px,${De[1]}px,0) scale(${et})`}$.current=De,W.current=D.zoom}}if(!oe&&le.current&&!Z.current)if(c){if(j.current){const De=j.current.children[0];if(De!=null&&De.clientWidth&&De!=null&&De.clientHeight){const{isOrthographicCamera:K}=D;if(K||_)P.scale&&(Array.isArray(P.scale)?P.scale instanceof ae?le.current.scale.copy(P.scale.clone().divideScalar(1)):le.current.scale.set(1/P.scale[0],1/P.scale[1],1/P.scale[2]):le.current.scale.setScalar(1/P.scale));else{const Pe=(l||10)/400,Be=De.clientWidth*Pe,Xe=De.clientHeight*Pe;le.current.scale.set(Be,Xe,1)}Z.current=!0}}}else{const De=re.children[0];if(De!=null&&De.clientWidth&&De!=null&&De.clientHeight){const K=1/Q.factor,Pe=De.clientWidth*K,Be=De.clientHeight*K;le.current.scale.set(Pe,Be,1),Z.current=!0}le.current.lookAt(Ke.camera.position)}});const Ge=ne.useMemo(()=>({vertexShader:c?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[c]);return ne.createElement("group",Qu({},P,{ref:se}),h&&!oe&&ne.createElement("mesh",{castShadow:m,receiveShadow:g,ref:le},_||ne.createElement("planeGeometry",null),x||ne.createElement("shaderMaterial",{side:Lo,vertexShader:Ge.vertexShader,fragmentShader:Ge.fragmentShader})))}),pL=r=>{let e;const t=new Set,n=(u,c)=>{const h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){const d=e;e=c??(typeof h!="object"||h===null)?h:Object.assign({},e,h),t.forEach(m=>m(e,d))}},i=()=>e,a={setState:n,getState:i,getInitialState:()=>l,subscribe:u=>(t.add(u),()=>t.delete(u))},l=e=r(n,i,a);return a},hj=r=>r?pL(r):pL,fj=r=>r;function dj(r,e=fj){const t=Vu.useSyncExternalStore(r.subscribe,()=>e(r.getState()),()=>e(r.getInitialState()));return Vu.useDebugValue(t),t}const mL=r=>{const e=hj(r),t=n=>dj(e,n);return Object.assign(t,e),t},pj=r=>r?mL(r):mL;let jg=0;const mj=pj(r=>(Hp.onStart=(e,t,n)=>{r({active:!0,item:e,loaded:t,total:n,progress:(t-jg)/(n-jg)*100})},Hp.onLoad=()=>{r({active:!1})},Hp.onError=e=>r(t=>({errors:[...t.errors,e]})),Hp.onProgress=(e,t,n)=>{t===n&&(jg=n),r({active:!0,item:e,loaded:t,total:n,progress:(t-jg)/(n-jg)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),jw=parseInt(bm.replace(/\D+/g,"")),wk=jw>=125?"uv1":"uv2";function gL(r,e){if(e===WB)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),r;if(e===Q_||e===sw){let t=r.getIndex();if(t===null){const o=[],a=r.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);r.setIndex(o),t=r.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r}const n=t.count-2,i=[];if(t)if(e===Q_)for(let o=1;o<=n;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=r.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),r}var gj=Object.defineProperty,vj=(r,e,t)=>e in r?gj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yj=(r,e,t)=>(vj(r,e+"",t),t);class xj{constructor(){yj(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}var _j=Object.defineProperty,Sj=(r,e,t)=>e in r?_j(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Yt=(r,e,t)=>(Sj(r,typeof e!="symbol"?e+"":e,t),t);const Cx=new ld,vL=new Fu,Aj=Math.cos(70*(Math.PI/180)),yL=(r,e)=>(r%e+e)%e;let Ej=class extends xj{constructor(e,t){super(),Yt(this,"object"),Yt(this,"domElement"),Yt(this,"enabled",!0),Yt(this,"target",new ae),Yt(this,"minDistance",0),Yt(this,"maxDistance",1/0),Yt(this,"minZoom",0),Yt(this,"maxZoom",1/0),Yt(this,"minPolarAngle",0),Yt(this,"maxPolarAngle",Math.PI),Yt(this,"minAzimuthAngle",-1/0),Yt(this,"maxAzimuthAngle",1/0),Yt(this,"enableDamping",!1),Yt(this,"dampingFactor",.05),Yt(this,"enableZoom",!0),Yt(this,"zoomSpeed",1),Yt(this,"enableRotate",!0),Yt(this,"rotateSpeed",1),Yt(this,"enablePan",!0),Yt(this,"panSpeed",1),Yt(this,"screenSpacePanning",!0),Yt(this,"keyPanSpeed",7),Yt(this,"zoomToCursor",!1),Yt(this,"autoRotate",!1),Yt(this,"autoRotateSpeed",2),Yt(this,"reverseOrbit",!1),Yt(this,"reverseHorizontalOrbit",!1),Yt(this,"reverseVerticalOrbit",!1),Yt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Yt(this,"mouseButtons",{LEFT:Sf.ROTATE,MIDDLE:Sf.DOLLY,RIGHT:Sf.PAN}),Yt(this,"touches",{ONE:Af.ROTATE,TWO:Af.DOLLY_PAN}),Yt(this,"target0"),Yt(this,"position0"),Yt(this,"zoom0"),Yt(this,"_domElementKeyEvents",null),Yt(this,"getPolarAngle"),Yt(this,"getAzimuthalAngle"),Yt(this,"setPolarAngle"),Yt(this,"setAzimuthalAngle"),Yt(this,"getDistance"),Yt(this,"getZoomScale"),Yt(this,"listenToKeyEvents"),Yt(this,"stopListenToKeyEvents"),Yt(this,"saveState"),Yt(this,"reset"),Yt(this,"update"),Yt(this,"connect"),Yt(this,"dispose"),Yt(this,"dollyIn"),Yt(this,"dollyOut"),Yt(this,"getScale"),Yt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=fe=>{let Je=yL(fe,2*Math.PI),ce=c.phi;ce<0&&(ce+=2*Math.PI),Je<0&&(Je+=2*Math.PI);let He=Math.abs(Je-ce);2*Math.PI-He<He&&(Je<ce?Je+=2*Math.PI:ce+=2*Math.PI),h.phi=Je-ce,n.update()},this.setAzimuthalAngle=fe=>{let Je=yL(fe,2*Math.PI),ce=c.theta;ce<0&&(ce+=2*Math.PI),Je<0&&(Je+=2*Math.PI);let He=Math.abs(Je-ce);2*Math.PI-He<He&&(Je<ce?Je+=2*Math.PI:ce+=2*Math.PI),h.theta=Je-ce,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=fe=>{fe.addEventListener("keydown",Ze),this._domElementKeyEvents=fe},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ze),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),l=a.NONE},this.update=(()=>{const fe=new ae,Je=new ae(0,1,0),ce=new Nr().setFromUnitVectors(e.up,Je),He=ce.clone().invert(),Te=new ae,Oe=new Nr,st=2*Math.PI;return function(){const _t=n.object.position;ce.setFromUnitVectors(e.up,Je),He.copy(ce).invert(),fe.copy(_t).sub(n.target),fe.applyQuaternion(ce),c.setFromVector3(fe),n.autoRotate&&l===a.NONE&&Q(V()),n.enableDamping?(c.theta+=h.theta*n.dampingFactor,c.phi+=h.phi*n.dampingFactor):(c.theta+=h.theta,c.phi+=h.phi);let Ht=n.minAzimuthAngle,zt=n.maxAzimuthAngle;isFinite(Ht)&&isFinite(zt)&&(Ht<-Math.PI?Ht+=st:Ht>Math.PI&&(Ht-=st),zt<-Math.PI?zt+=st:zt>Math.PI&&(zt-=st),Ht<=zt?c.theta=Math.max(Ht,Math.min(zt,c.theta)):c.theta=c.theta>(Ht+zt)/2?Math.max(Ht,c.theta):Math.min(zt,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(m,n.dampingFactor):n.target.add(m),n.zoomToCursor&&D||n.object.isOrthographicCamera?c.radius=le(c.radius):c.radius=le(c.radius*d),fe.setFromSpherical(c),fe.applyQuaternion(He),_t.copy(n.target).add(fe),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(h.theta*=1-n.dampingFactor,h.phi*=1-n.dampingFactor,m.multiplyScalar(1-n.dampingFactor)):(h.set(0,0,0),m.set(0,0,0));let gt=!1;if(n.zoomToCursor&&D){let Qt=null;if(n.object instanceof mi&&n.object.isPerspectiveCamera){const vn=fe.length();Qt=le(vn*d);const Dn=vn-Qt;n.object.position.addScaledVector(L,Dn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const vn=new ae(F.x,F.y,0);vn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/d)),n.object.updateProjectionMatrix(),gt=!0;const Dn=new ae(F.x,F.y,0);Dn.unproject(n.object),n.object.position.sub(Dn).add(vn),n.object.updateMatrixWorld(),Qt=fe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Qt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Qt).add(n.object.position):(Cx.origin.copy(n.object.position),Cx.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Cx.direction))<Aj?e.lookAt(n.target):(vL.setFromNormalAndCoplanarPoint(n.object.up,n.target),Cx.intersectPlane(vL,n.target))))}else n.object instanceof Qa&&n.object.isOrthographicCamera&&(gt=d!==1,gt&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/d)),n.object.updateProjectionMatrix()));return d=1,D=!1,gt||Te.distanceToSquared(n.object.position)>u||8*(1-Oe.dot(n.object.quaternion))>u?(n.dispatchEvent(i),Te.copy(n.object.position),Oe.copy(n.object.quaternion),gt=!1,!0):!1}})(),this.connect=fe=>{n.domElement=fe,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",nt),n.domElement.addEventListener("pointerdown",me),n.domElement.addEventListener("pointercancel",Ee),n.domElement.addEventListener("wheel",ke)},this.dispose=()=>{var fe,Je,ce,He,Te,Oe;n.domElement&&(n.domElement.style.touchAction="auto"),(fe=n.domElement)==null||fe.removeEventListener("contextmenu",nt),(Je=n.domElement)==null||Je.removeEventListener("pointerdown",me),(ce=n.domElement)==null||ce.removeEventListener("pointercancel",Ee),(He=n.domElement)==null||He.removeEventListener("wheel",ke),(Te=n.domElement)==null||Te.ownerDocument.removeEventListener("pointermove",_e),(Oe=n.domElement)==null||Oe.ownerDocument.removeEventListener("pointerup",Ee),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Ze)};const n=this,i={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const u=1e-6,c=new kT,h=new kT;let d=1;const m=new ae,g=new Qe,x=new Qe,_=new Qe,S=new Qe,T=new Qe,E=new Qe,C=new Qe,R=new Qe,P=new Qe,L=new ae,F=new Qe;let D=!1;const I=[],N={};function V(){return 2*Math.PI/60/60*n.autoRotateSpeed}function q(){return Math.pow(.95,n.zoomSpeed)}function Q(fe){n.reverseOrbit||n.reverseHorizontalOrbit?h.theta+=fe:h.theta-=fe}function re(fe){n.reverseOrbit||n.reverseVerticalOrbit?h.phi+=fe:h.phi-=fe}const ee=(()=>{const fe=new ae;return function(ce,He){fe.setFromMatrixColumn(He,0),fe.multiplyScalar(-ce),m.add(fe)}})(),se=(()=>{const fe=new ae;return function(ce,He){n.screenSpacePanning===!0?fe.setFromMatrixColumn(He,1):(fe.setFromMatrixColumn(He,0),fe.crossVectors(n.object.up,fe)),fe.multiplyScalar(ce),m.add(fe)}})(),W=(()=>{const fe=new ae;return function(ce,He){const Te=n.domElement;if(Te&&n.object instanceof mi&&n.object.isPerspectiveCamera){const Oe=n.object.position;fe.copy(Oe).sub(n.target);let st=fe.length();st*=Math.tan(n.object.fov/2*Math.PI/180),ee(2*ce*st/Te.clientHeight,n.object.matrix),se(2*He*st/Te.clientHeight,n.object.matrix)}else Te&&n.object instanceof Qa&&n.object.isOrthographicCamera?(ee(ce*(n.object.right-n.object.left)/n.object.zoom/Te.clientWidth,n.object.matrix),se(He*(n.object.top-n.object.bottom)/n.object.zoom/Te.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function $(fe){n.object instanceof mi&&n.object.isPerspectiveCamera||n.object instanceof Qa&&n.object.isOrthographicCamera?d=fe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function j(fe){$(d/fe)}function U(fe){$(d*fe)}function X(fe){if(!n.zoomToCursor||!n.domElement)return;D=!0;const Je=n.domElement.getBoundingClientRect(),ce=fe.clientX-Je.left,He=fe.clientY-Je.top,Te=Je.width,Oe=Je.height;F.x=ce/Te*2-1,F.y=-(He/Oe)*2+1,L.set(F.x,F.y,1).unproject(n.object).sub(n.object.position).normalize()}function le(fe){return Math.max(n.minDistance,Math.min(n.maxDistance,fe))}function Z(fe){g.set(fe.clientX,fe.clientY)}function oe(fe){X(fe),C.set(fe.clientX,fe.clientY)}function pe(fe){S.set(fe.clientX,fe.clientY)}function de(fe){x.set(fe.clientX,fe.clientY),_.subVectors(x,g).multiplyScalar(n.rotateSpeed);const Je=n.domElement;Je&&(Q(2*Math.PI*_.x/Je.clientHeight),re(2*Math.PI*_.y/Je.clientHeight)),g.copy(x),n.update()}function ye(fe){R.set(fe.clientX,fe.clientY),P.subVectors(R,C),P.y>0?j(q()):P.y<0&&U(q()),C.copy(R),n.update()}function Ge(fe){T.set(fe.clientX,fe.clientY),E.subVectors(T,S).multiplyScalar(n.panSpeed),W(E.x,E.y),S.copy(T),n.update()}function Ke(fe){X(fe),fe.deltaY<0?U(q()):fe.deltaY>0&&j(q()),n.update()}function De(fe){let Je=!1;switch(fe.code){case n.keys.UP:W(0,n.keyPanSpeed),Je=!0;break;case n.keys.BOTTOM:W(0,-n.keyPanSpeed),Je=!0;break;case n.keys.LEFT:W(n.keyPanSpeed,0),Je=!0;break;case n.keys.RIGHT:W(-n.keyPanSpeed,0),Je=!0;break}Je&&(fe.preventDefault(),n.update())}function K(){if(I.length==1)g.set(I[0].pageX,I[0].pageY);else{const fe=.5*(I[0].pageX+I[1].pageX),Je=.5*(I[0].pageY+I[1].pageY);g.set(fe,Je)}}function Pe(){if(I.length==1)S.set(I[0].pageX,I[0].pageY);else{const fe=.5*(I[0].pageX+I[1].pageX),Je=.5*(I[0].pageY+I[1].pageY);S.set(fe,Je)}}function Be(){const fe=I[0].pageX-I[1].pageX,Je=I[0].pageY-I[1].pageY,ce=Math.sqrt(fe*fe+Je*Je);C.set(0,ce)}function Xe(){n.enableZoom&&Be(),n.enablePan&&Pe()}function ve(){n.enableZoom&&Be(),n.enableRotate&&K()}function et(fe){if(I.length==1)x.set(fe.pageX,fe.pageY);else{const ce=rt(fe),He=.5*(fe.pageX+ce.x),Te=.5*(fe.pageY+ce.y);x.set(He,Te)}_.subVectors(x,g).multiplyScalar(n.rotateSpeed);const Je=n.domElement;Je&&(Q(2*Math.PI*_.x/Je.clientHeight),re(2*Math.PI*_.y/Je.clientHeight)),g.copy(x)}function Ce(fe){if(I.length==1)T.set(fe.pageX,fe.pageY);else{const Je=rt(fe),ce=.5*(fe.pageX+Je.x),He=.5*(fe.pageY+Je.y);T.set(ce,He)}E.subVectors(T,S).multiplyScalar(n.panSpeed),W(E.x,E.y),S.copy(T)}function We(fe){const Je=rt(fe),ce=fe.pageX-Je.x,He=fe.pageY-Je.y,Te=Math.sqrt(ce*ce+He*He);R.set(0,Te),P.set(0,Math.pow(R.y/C.y,n.zoomSpeed)),j(P.y),C.copy(R)}function te(fe){n.enableZoom&&We(fe),n.enablePan&&Ce(fe)}function z(fe){n.enableZoom&&We(fe),n.enableRotate&&et(fe)}function me(fe){var Je,ce;n.enabled!==!1&&(I.length===0&&((Je=n.domElement)==null||Je.ownerDocument.addEventListener("pointermove",_e),(ce=n.domElement)==null||ce.ownerDocument.addEventListener("pointerup",Ee)),Ct(fe),fe.pointerType==="touch"?lt(fe):we(fe))}function _e(fe){n.enabled!==!1&&(fe.pointerType==="touch"?Ye(fe):ut(fe))}function Ee(fe){var Je,ce,He;ht(fe),I.length===0&&((Je=n.domElement)==null||Je.releasePointerCapture(fe.pointerId),(ce=n.domElement)==null||ce.ownerDocument.removeEventListener("pointermove",_e),(He=n.domElement)==null||He.ownerDocument.removeEventListener("pointerup",Ee)),n.dispatchEvent(o),l=a.NONE}function we(fe){let Je;switch(fe.button){case 0:Je=n.mouseButtons.LEFT;break;case 1:Je=n.mouseButtons.MIDDLE;break;case 2:Je=n.mouseButtons.RIGHT;break;default:Je=-1}switch(Je){case Sf.DOLLY:if(n.enableZoom===!1)return;oe(fe),l=a.DOLLY;break;case Sf.ROTATE:if(fe.ctrlKey||fe.metaKey||fe.shiftKey){if(n.enablePan===!1)return;pe(fe),l=a.PAN}else{if(n.enableRotate===!1)return;Z(fe),l=a.ROTATE}break;case Sf.PAN:if(fe.ctrlKey||fe.metaKey||fe.shiftKey){if(n.enableRotate===!1)return;Z(fe),l=a.ROTATE}else{if(n.enablePan===!1)return;pe(fe),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function ut(fe){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;de(fe);break;case a.DOLLY:if(n.enableZoom===!1)return;ye(fe);break;case a.PAN:if(n.enablePan===!1)return;Ge(fe);break}}function ke(fe){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(fe.preventDefault(),n.dispatchEvent(s),Ke(fe),n.dispatchEvent(o))}function Ze(fe){n.enabled===!1||n.enablePan===!1||De(fe)}function lt(fe){switch(it(fe),I.length){case 1:switch(n.touches.ONE){case Af.ROTATE:if(n.enableRotate===!1)return;K(),l=a.TOUCH_ROTATE;break;case Af.PAN:if(n.enablePan===!1)return;Pe(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case Af.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Xe(),l=a.TOUCH_DOLLY_PAN;break;case Af.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ve(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function Ye(fe){switch(it(fe),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;et(fe),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;Ce(fe),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;te(fe),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;z(fe),n.update();break;default:l=a.NONE}}function nt(fe){n.enabled!==!1&&fe.preventDefault()}function Ct(fe){I.push(fe)}function ht(fe){delete N[fe.pointerId];for(let Je=0;Je<I.length;Je++)if(I[Je].pointerId==fe.pointerId){I.splice(Je,1);return}}function it(fe){let Je=N[fe.pointerId];Je===void 0&&(Je=new Qe,N[fe.pointerId]=Je),Je.set(fe.pageX,fe.pageY)}function rt(fe){const Je=fe.pointerId===I[0].pointerId?I[1]:I[0];return N[Je.pointerId]}this.dollyIn=(fe=q())=>{U(fe),n.update()},this.dollyOut=(fe=q())=>{j(fe),n.update()},this.getScale=()=>d,this.setScale=fe=>{$(fe),n.update()},this.getZoomScale=()=>q(),t!==void 0&&this.connect(t),this.update()}};function rS(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let e="";for(let t=0,n=r.length;t<n;t++)e+=String.fromCharCode(r[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const kf="srgb",ju="srgb-linear",xL=3001,Tj=3e3;class Kw extends _s{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Rj(t)}),this.register(function(t){return new Ij(t)}),this.register(function(t){return new Nj(t)}),this.register(function(t){return new Gj(t)}),this.register(function(t){return new Hj(t)}),this.register(function(t){return new Pj(t)}),this.register(function(t){return new Dj(t)}),this.register(function(t){return new Bj(t)}),this.register(function(t){return new Fj(t)}),this.register(function(t){return new bj(t)}),this.register(function(t){return new kj(t)}),this.register(function(t){return new Lj(t)}),this.register(function(t){return new Uj(t)}),this.register(function(t){return new Oj(t)}),this.register(function(t){return new wj(t)}),this.register(function(t){return new zj(t)}),this.register(function(t){return new Vj(t)})}load(e,t,n,i){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const u=ah.extractUrlBase(e);o=ah.resolveURL(u,this.path)}else o=ah.extractUrlBase(e);this.manager.itemStart(e);const a=function(u){i?i(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Ho(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{s.parse(u,o,function(c){t(c),s.manager.itemEnd(e)},a)}catch(c){a(c)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(rS(new Uint8Array(e.slice(0,4)))===Ck){try{o[Sn.KHR_BINARY_GLTF]=new Wj(e)}catch(c){i&&i(c);return}s=JSON.parse(o[Sn.KHR_BINARY_GLTF].content)}else s=JSON.parse(rS(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new iK(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const c=this.pluginCallbacks[u](l);c.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[c.name]=c,o[c.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const c=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(c){case Sn.KHR_MATERIALS_UNLIT:o[c]=new Cj;break;case Sn.KHR_DRACO_MESH_COMPRESSION:o[c]=new jj(s,this.dracoLoader);break;case Sn.KHR_TEXTURE_TRANSFORM:o[c]=new Kj;break;case Sn.KHR_MESH_QUANTIZATION:o[c]=new $j;break;default:h.indexOf(c)>=0&&a[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,s){n.parse(e,t,i,s)})}}function Mj(){let r={};return{get:function(e){return r[e]},add:function(e,t){r[e]=t},remove:function(e){delete r[e]},removeAll:function(){r={}}}}const Sn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class wj{constructor(e){this.parser=e,this.name=Sn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const c=new yt(16777215);l.color!==void 0&&c.setRGB(l.color[0],l.color[1],l.color[2],ju);const h=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new Bw(c),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new Dw(c),u.distance=h;break;case"spot":u=new Pw(c),u.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,Lu(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),i=Promise.resolve(u),t.cache.add(n,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class Cj{constructor(){this.name=Sn.KHR_MATERIALS_UNLIT}getMaterialType(){return so}extendParams(e,t,n){const i=[];e.color=new yt(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],ju),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",s.baseColorTexture,kf))}return Promise.all(i)}}class bj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class Rj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Qe(a,a)}return Promise.all(s)}}class Ij{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class Lj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Pj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new yt(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],ju)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,kf)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Dj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Bj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new yt().setRGB(a[0],a[1],a[2],ju),Promise.all(s)}}class Fj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class kj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new yt().setRGB(a[0],a[1],a[2],ju),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,kf)),Promise.all(s)}}class Oj{constructor(e){this.parser=e,this.name=Sn.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class Uj{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:va}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Nj{constructor(e){this.parser=e,this.name=Sn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Gj{constructor(e){this.parser=e,this.name=Sn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=n.textureLoader;if(a.uri){const u=n.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return n.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Hj{constructor(e){this.parser=e,this.name=Sn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=n.textureLoader;if(a.uri){const u=n.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return n.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class zj{constructor(e){this.name=Sn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=i.byteOffset||0,u=i.byteLength||0,c=i.count,h=i.byteStride,d=new Uint8Array(a,l,u);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(c,h,d,i.mode,i.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(c*h);return o.decodeGltfBuffer(new Uint8Array(m),c,h,d,i.mode,i.filter),m})})}else return null}}class Vj{constructor(e){this.name=Sn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const i=t.meshes[n.mesh];for(const u of i.primitives)if(u.mode!==ua.TRIANGLES&&u.mode!==ua.TRIANGLE_STRIP&&u.mode!==ua.TRIANGLE_FAN&&u.mode!==void 0)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const u in o)a.push(this.parser.getDependency("accessor",o[u]).then(c=>(l[u]=c,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const c=u.pop(),h=c.isGroup?c.children:[c],d=u[0].count,m=[];for(const g of h){const x=new Wt,_=new ae,S=new Nr,T=new ae(1,1,1),E=new vw(g.geometry,g.material,d);for(let C=0;C<d;C++)l.TRANSLATION&&_.fromBufferAttribute(l.TRANSLATION,C),l.ROTATION&&S.fromBufferAttribute(l.ROTATION,C),l.SCALE&&T.fromBufferAttribute(l.SCALE,C),E.setMatrixAt(C,x.compose(_,S,T));for(const C in l)if(C==="_COLOR_0"){const R=l[C];E.instanceColor=new fh(R.array,R.itemSize,R.normalized)}else C!=="TRANSLATION"&&C!=="ROTATION"&&C!=="SCALE"&&g.geometry.setAttribute(C,l[C]);An.prototype.copy.call(E,g),this.parser.assignFinalMaterial(E),m.push(E)}return c.isGroup?(c.clear(),c.add(...m),c):m[0]}))}}const Ck="glTF",Kg=12,_L={JSON:1313821514,BIN:5130562};class Wj{constructor(e){this.name=Sn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Kg);if(this.header={magic:rS(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Ck)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Kg,i=new DataView(e,Kg);let s=0;for(;s<n;){const o=i.getUint32(s,!0);s+=4;const a=i.getUint32(s,!0);if(s+=4,a===_L.JSON){const l=new Uint8Array(e,Kg+s,o);this.content=rS(l)}else if(a===_L.BIN){const l=Kg+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class jj{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Sn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},u={};for(const c in o){const h=GT[c]||c.toLowerCase();a[h]=o[c]}for(const c in e.attributes){const h=GT[c]||c.toLowerCase();if(o[c]!==void 0){const d=n.accessors[e.attributes[c]],m=tm[d.componentType];u[h]=m.name,l[h]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(c){return new Promise(function(h,d){i.decodeDracoFile(c,function(m){for(const g in m.attributes){const x=m.attributes[g],_=l[g];_!==void 0&&(x.normalized=_)}h(m)},a,u,ju,d)})})}}class Kj{constructor(){this.name=Sn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class $j{constructor(){this.name=Sn.KHR_MESH_QUANTIZATION}}class bk extends Dm{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,u=a*3,c=i-t,h=(n-t)/c,d=h*h,m=d*h,g=e*u,x=g-u,_=-2*m+3*d,S=m-d,T=1-_,E=S-d+h;for(let C=0;C!==a;C++){const R=o[x+C+a],P=o[x+C+l]*c,L=o[g+C+a],F=o[g+C]*c;s[C]=T*R+E*P+_*L+S*F}return s}}const Xj=new Nr;class Yj extends bk{interpolate_(e,t,n,i){const s=super.interpolate_(e,t,n,i);return Xj.fromArray(s).normalize().toArray(s),s}}const ua={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},tm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},SL={9728:Er,9729:vi,9984:OS,9985:qp,9986:If,9987:da},AL={33071:Bo,33648:am,10497:hh},gE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},GT={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...jw>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Jc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Jj={CUBICSPLINE:void 0,LINEAR:cm,STEP:um},vE={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function qj(r){return r.DefaultMaterial===void 0&&(r.DefaultMaterial=new Rv({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Wl})),r.DefaultMaterial}function mf(r,e,t){for(const n in t.extensions)r[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Lu(r,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(r.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Qj(r,e,t){let n=!1,i=!1,s=!1;for(let u=0,c=e.length;u<c;u++){const h=e[u];if(h.POSITION!==void 0&&(n=!0),h.NORMAL!==void 0&&(i=!0),h.COLOR_0!==void 0&&(s=!0),n&&i&&s)break}if(!n&&!i&&!s)return Promise.resolve(r);const o=[],a=[],l=[];for(let u=0,c=e.length;u<c;u++){const h=e[u];if(n){const d=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):r.attributes.position;o.push(d)}if(i){const d=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):r.attributes.normal;a.push(d)}if(s){const d=h.COLOR_0!==void 0?t.getDependency("accessor",h.COLOR_0):r.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(u){const c=u[0],h=u[1],d=u[2];return n&&(r.morphAttributes.position=c),i&&(r.morphAttributes.normal=h),s&&(r.morphAttributes.color=d),r.morphTargetsRelative=!0,r})}function Zj(r,e){if(r.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)r.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(r.morphTargetInfluences.length===t.length){r.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)r.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function eK(r){let e;const t=r.extensions&&r.extensions[Sn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+yE(t.attributes):e=r.indices+":"+yE(r.attributes)+":"+r.mode,r.targets!==void 0)for(let n=0,i=r.targets.length;n<i;n++)e+=":"+yE(r.targets[n]);return e}function yE(r){let e="";const t=Object.keys(r).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+r[t[n]]+";";return e}function HT(r){switch(r){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function tK(r){return r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0?"image/jpeg":r.search(/\.webp($|\?)/i)>0||r.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const nK=new Wt;class iK{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Mj,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||i&&s<98?this.textureLoader=new VF(this.options.manager):this.textureLoader=new JF(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ho(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:n,userData:{}};return mf(s,a,i),Lu(a,i),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[u,c]of o.children.entries())s(c,a.children[u])};return s(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Sn.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){n.load(ah.resolveURL(t.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=gE[i.type],a=tm[i.componentType],l=i.normalized===!0,u=new a(i.count*o);return Promise.resolve(new Pn(u,o,l))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=gE[i.type],u=tm[i.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,d=i.byteOffset||0,m=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,g=i.normalized===!0;let x,_;if(m&&m!==h){const S=Math.floor(d/m),T="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+S+":"+i.count;let E=t.cache.get(T);E||(x=new u(a,S*m,i.count*m/c),E=new Tv(x,m/c),t.cache.add(T,E)),_=new oo(E,l,d%m/c,g)}else a===null?x=new u(i.count*l):x=new u(a,d,i.count*l),_=new Pn(x,l,g);if(i.sparse!==void 0){const S=gE.SCALAR,T=tm[i.sparse.indices.componentType],E=i.sparse.indices.byteOffset||0,C=i.sparse.values.byteOffset||0,R=new T(o[1],E,i.sparse.count*S),P=new u(o[2],C,i.sparse.count*l);a!==null&&(_=new Pn(_.array.slice(),_.itemSize,_.normalized));for(let L=0,F=R.length;L<F;L++){const D=R[L];if(_.setX(D,P[L*l]),l>=2&&_.setY(D,P[L*l+1]),l>=3&&_.setZ(D,P[L*l+2]),l>=4&&_.setW(D,P[L*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _})}loadTexture(e){const t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const i=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,n).then(function(c){c.flipY=!1,c.name=o.name||a.name||"",c.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(c.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return c.magFilter=SL[d.magFilter]||vi,c.minFilter=SL[d.minFilter]||da,c.wrapS=AL[d.wrapS]||hh,c.wrapT=AL[d.wrapT]||hh,i.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const n=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",u=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(h){u=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then(function(h){return new Promise(function(d,m){let g=d;t.isImageBitmapLoader===!0&&(g=function(x){const _=new ci(x);_.needsUpdate=!0,d(_)}),t.load(ah.resolveURL(h,s.path),g,void 0,m)})}).then(function(h){return u===!0&&a.revokeObjectURL(l),Lu(h,o),h.userData.mimeType=o.mimeType||tK(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=c,c}assignTexture(e,t,n,i){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[Sn.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[Sn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[Sn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return i!==void 0&&(typeof i=="number"&&(i=i===xL?kf:ju),"colorSpace"in o?o.colorSpace=i:o.encoding=i===kf?xL:Tj),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new ZS,Tr.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new xs,Tr.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(i||s||o){let a="ClonedMaterial:"+n.uuid+":";i&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return Rv}loadMaterial(e){const t=this,n=this.json,i=this.extensions,s=n.materials[e];let o;const a={},l=s.extensions||{},u=[];if(l[Sn.KHR_MATERIALS_UNLIT]){const h=i[Sn.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),u.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new yt(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],ju),a.opacity=d[3]}h.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",h.baseColorTexture,kf)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Lo);const c=s.alphaMode||vE.OPAQUE;if(c===vE.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===vE.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==so&&(u.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Qe(1,1),s.normalTexture.scale!==void 0)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}if(s.occlusionTexture!==void 0&&o!==so&&(u.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==so){const h=s.emissiveFactor;a.emissive=new yt().setRGB(h[0],h[1],h[2],ju)}return s.emissiveTexture!==void 0&&o!==so&&u.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,kf)),Promise.all(u).then(function(){const h=new o(a);return s.name&&(h.name=s.name),Lu(h,s),t.associations.set(h,{materials:e}),s.extensions&&mf(i,h,s),h})}createUniqueName(e){const t=Rn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function s(a){return n[Sn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return EL(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],c=eK(u),h=i[c];if(h)o.push(h.promise);else{let d;u.extensions&&u.extensions[Sn.KHR_DRACO_MESH_COMPRESSION]?d=s(u):d=EL(new dn,u,t),i[c]={primitive:u,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,i=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,u=o.length;l<u;l++){const c=o[l].material===void 0?qj(this.cache):this.getDependency("material",o[l].material);a.push(c)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),c=l[l.length-1],h=[];for(let m=0,g=c.length;m<g;m++){const x=c[m],_=o[m];let S;const T=u[m];if(_.mode===ua.TRIANGLES||_.mode===ua.TRIANGLE_STRIP||_.mode===ua.TRIANGLE_FAN||_.mode===void 0)S=s.isSkinnedMesh===!0?new gw(x,T):new ui(x,T),S.isSkinnedMesh===!0&&S.normalizeSkinWeights(),_.mode===ua.TRIANGLE_STRIP?S.geometry=gL(S.geometry,sw):_.mode===ua.TRIANGLE_FAN&&(S.geometry=gL(S.geometry,Q_));else if(_.mode===ua.LINES)S=new il(x,T);else if(_.mode===ua.LINE_STRIP)S=new qu(x,T);else if(_.mode===ua.LINE_LOOP)S=new yw(x,T);else if(_.mode===ua.POINTS)S=new xw(x,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);Object.keys(S.geometry.morphAttributes).length>0&&Zj(S,s),S.name=t.createUniqueName(s.name||"mesh_"+e),Lu(S,s),_.extensions&&mf(i,S,_),t.assignFinalMaterial(S),h.push(S)}for(let m=0,g=h.length;m<g;m++)t.associations.set(h[m],{meshes:e,primitives:m});if(h.length===1)return s.extensions&&mf(i,h[0],s),h[0];const d=new Gu;s.extensions&&mf(i,d,s),t.associations.set(d,{meshes:e});for(let m=0,g=h.length;m<g;m++)d.add(h[m]);return d})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new mi(_v.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new Qa(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Lu(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,s=t.joints.length;i<s;i++)n.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(i){const s=i.pop(),o=i,a=[],l=[];for(let u=0,c=o.length;u<c;u++){const h=o[u];if(h){a.push(h);const d=new Wt;s!==null&&d.fromArray(s.array,u*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new Mv(a,l)})}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,o=[],a=[],l=[],u=[],c=[];for(let h=0,d=i.channels.length;h<d;h++){const m=i.channels[h],g=i.samplers[m.sampler],x=m.target,_=x.node,S=i.parameters!==void 0?i.parameters[g.input]:g.input,T=i.parameters!==void 0?i.parameters[g.output]:g.output;x.node!==void 0&&(o.push(this.getDependency("node",_)),a.push(this.getDependency("accessor",S)),l.push(this.getDependency("accessor",T)),u.push(g),c.push(x))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(c)]).then(function(h){const d=h[0],m=h[1],g=h[2],x=h[3],_=h[4],S=[];for(let T=0,E=d.length;T<E;T++){const C=d[T],R=m[T],P=g[T],L=x[T],F=_[T];if(C===void 0)continue;C.updateMatrix&&C.updateMatrix();const D=n._createAnimationTracks(C,R,P,L,F);if(D)for(let I=0;I<D.length;I++)S.push(D[I])}return new dm(s,void 0,S)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,u=i.weights.length;l<u;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const t=this.json,n=this,i=t.nodes[e],s=n._loadNodeShallow(e),o=[],a=i.children||[];for(let u=0,c=a.length;u<c;u++)o.push(n.getDependency("node",a[u]));const l=i.skin===void 0?Promise.resolve(null):n.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),l]).then(function(u){const c=u[0],h=u[1],d=u[2];d!==null&&c.traverse(function(m){m.isSkinnedMesh&&m.bind(d,nK)});for(let m=0,g=h.length;m<g;m++)c.add(h[m]);return c})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"",a=[],l=i._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(i.getDependency("camera",s.camera).then(function(u){return i._getNodeRef(i.cameraCache,s.camera,u)})),i._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let c;if(s.isBone===!0?c=new QS:u.length>1?c=new Gu:u.length===1?c=u[0]:c=new An,c!==u[0])for(let h=0,d=u.length;h<d;h++)c.add(u[h]);if(s.name&&(c.userData.name=s.name,c.name=o),Lu(c,s),s.extensions&&mf(n,c,s),s.matrix!==void 0){const h=new Wt;h.fromArray(s.matrix),c.applyMatrix4(h)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);return i.associations.has(c)||i.associations.set(c,{}),i.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,s=new Gu;n.name&&(s.name=i.createUniqueName(n.name)),Lu(s,n),n.extensions&&mf(t,s,n);const o=n.nodes||[],a=[];for(let l=0,u=o.length;l<u;l++)a.push(i.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let c=0,h=l.length;c<h;c++)s.add(l[c]);const u=c=>{const h=new Map;for(const[d,m]of i.associations)(d instanceof Tr||d instanceof ci)&&h.set(d,m);return c.traverse(d=>{const m=i.associations.get(d);m!=null&&h.set(d,m)}),h};return i.associations=u(s),s})}_createAnimationTracks(e,t,n,i,s){const o=[],a=e.name?e.name:e.uuid,l=[];Jc[s.path]===Jc.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let u;switch(Jc[s.path]){case Jc.weights:u=nd;break;case Jc.rotation:u=id;break;case Jc.position:case Jc.scale:u=rd;break;default:switch(n.itemSize){case 1:u=nd;break;case 2:case 3:default:u=rd;break}break}const c=i.interpolation!==void 0?Jj[i.interpolation]:cm,h=this._getArrayFromAccessor(n);for(let d=0,m=l.length;d<m;d++){const g=new u(l[d]+"."+Jc[s.path],t.array,h,c);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),o.push(g)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=HT(t.constructor),i=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)i[s]=t[s]*n;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const i=this instanceof id?Yj:bk;return new i(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function rK(r,e,t){const n=e.attributes,i=new Ni;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],l=a.min,u=a.max;if(l!==void 0&&u!==void 0){if(i.set(new ae(l[0],l[1],l[2]),new ae(u[0],u[1],u[2])),a.normalized){const c=HT(tm[a.componentType]);i.min.multiplyScalar(c),i.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new ae,l=new ae;for(let u=0,c=s.length;u<c;u++){const h=s[u];if(h.POSITION!==void 0){const d=t.json.accessors[h.POSITION],m=d.min,g=d.max;if(m!==void 0&&g!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),d.normalized){const x=HT(tm[d.componentType]);l.multiplyScalar(x)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}r.boundingBox=i;const o=new Yi;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,r.boundingSphere=o}function EL(r,e,t){const n=e.attributes,i=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){r.setAttribute(a,l)})}for(const o in n){const a=GT[o]||o.toLowerCase();a in r.attributes||i.push(s(n[o],a))}if(e.indices!==void 0&&!r.index){const o=t.getDependency("accessor",e.indices).then(function(a){r.setIndex(a)});i.push(o)}return Lu(r,e),rK(r,e,t),Promise.all(i).then(function(){return e.targets!==void 0?Qj(r,e.targets,t):r})}const xE=new WeakMap;class sK extends _s{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const s=new Ho(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(i)},n,i)}decodeDracoFile(e,t,n,i){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const u=t.attributeTypes[l];u.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=u.name)}const n=JSON.stringify(t);if(xE.has(e)){const l=xE.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(i=l,new Promise((u,c)=>{i._callbacks[s]={resolve:u,reject:c},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),xE.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new dn;e.index&&t.setIndex(new Pn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],s=i.name,o=i.array,a=i.itemSize;t.setAttribute(s,new Pn(o,a))}return t}_loadLibrary(e,t){const n=new Ho(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((i,s)=>{n.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const i=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=oK.toString(),o=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const o=s.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function oK(){let r,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":r=a.decoderConfig,e=new Promise(function(c){r.onModuleLoaded=function(h){c({draco:h})},DracoDecoderModule(r)});break;case"decode":const l=a.buffer,u=a.taskConfig;e.then(c=>{const h=c.draco,d=new h.Decoder,m=new h.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{const g=t(h,d,m,u),x=g.attributes.map(_=>_.array.buffer);g.index&&x.push(g.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:g},x)}catch(g){console.error(g),self.postMessage({type:"error",id:a.id,error:g.message})}finally{h.destroy(m),h.destroy(d)}});break}};function t(o,a,l,u){const c=u.attributeIDs,h=u.attributeTypes;let d,m;const g=a.GetEncodedGeometryType(l);if(g===o.TRIANGULAR_MESH)d=new o.Mesh,m=a.DecodeBufferToMesh(l,d);else if(g===o.POINT_CLOUD)d=new o.PointCloud,m=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const x={index:null,attributes:[]};for(const _ in c){const S=self[h[_]];let T,E;if(u.useUniqueIDs)E=c[_],T=a.GetAttributeByUniqueId(d,E);else{if(E=a.GetAttributeId(d,o[c[_]]),E===-1)continue;T=a.GetAttribute(d,E)}x.attributes.push(i(o,a,d,_,S,T))}return g===o.TRIANGULAR_MESH&&(x.index=n(o,a,d)),o.destroy(d),x}function n(o,a,l){const c=l.num_faces()*3,h=c*4,d=o._malloc(h);a.GetTrianglesUInt32Array(l,h,d);const m=new Uint32Array(o.HEAPF32.buffer,d,c).slice();return o._free(d),{array:m,itemSize:1}}function i(o,a,l,u,c,h){const d=h.num_components(),g=l.num_points()*d,x=g*c.BYTES_PER_ELEMENT,_=s(o,c),S=o._malloc(x);a.GetAttributeDataArrayForAllPoints(l,h,_,x,S);const T=new c(o.HEAPF32.buffer,S,g).slice();return o._free(S),{name:u,array:T,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}const TL=new Ni,bx=new ae;class $w extends gA{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new Ft(e,3)),this.setAttribute("uv",new Ft(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new nS(t,6,1);return this.setAttribute("instanceStart",new oo(n,3,0)),this.setAttribute("instanceEnd",new oo(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const i=new nS(n,t*2,1);return this.setAttribute("instanceColorStart",new oo(i,t,0)),this.setAttribute("instanceColorEnd",new oo(i,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new ww(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ni);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),TL.setFromBufferAttribute(t),this.boundingBox.union(TL))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yi),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let s=0,o=e.count;s<o;s++)bx.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(bx)),bx.fromBufferAttribute(t,s),i=Math.max(i,n.distanceToSquared(bx));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class Rk extends $w{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,i=new Float32Array(2*n);if(t===3)for(let s=0;s<n;s+=t)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];else for(let s=0;s<n;s+=t)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5],i[2*s+6]=e[s+6],i[2*s+7]=e[s+7];return super.setColors(i,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Xw extends Go{constructor(e){super({type:"LineMaterial",uniforms:$0.clone($0.merge([St.common,St.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Qe(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${jw>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const _E=new gn,ML=new ae,wL=new ae,Yr=new gn,Jr=new gn,Tl=new gn,SE=new ae,AE=new Wt,Qr=new nk,CL=new ae,Rx=new Ni,Ix=new Yi,Ml=new gn;let Ll,Wf;function bL(r,e,t){return Ml.set(0,0,-e,1).applyMatrix4(r.projectionMatrix),Ml.multiplyScalar(1/Ml.w),Ml.x=Wf/t.width,Ml.y=Wf/t.height,Ml.applyMatrix4(r.projectionMatrixInverse),Ml.multiplyScalar(1/Ml.w),Math.abs(Math.max(Ml.x,Ml.y))}function aK(r,e){const t=r.matrixWorld,n=r.geometry,i=n.attributes.instanceStart,s=n.attributes.instanceEnd,o=Math.min(n.instanceCount,i.count);for(let a=0,l=o;a<l;a++){Qr.start.fromBufferAttribute(i,a),Qr.end.fromBufferAttribute(s,a),Qr.applyMatrix4(t);const u=new ae,c=new ae;Ll.distanceSqToSegment(Qr.start,Qr.end,c,u),c.distanceTo(u)<Wf*.5&&e.push({point:c,pointOnLine:u,distance:Ll.origin.distanceTo(c),object:r,face:null,faceIndex:a,uv:null,[wk]:null})}}function lK(r,e,t){const n=e.projectionMatrix,s=r.material.resolution,o=r.matrixWorld,a=r.geometry,l=a.attributes.instanceStart,u=a.attributes.instanceEnd,c=Math.min(a.instanceCount,l.count),h=-e.near;Ll.at(1,Tl),Tl.w=1,Tl.applyMatrix4(e.matrixWorldInverse),Tl.applyMatrix4(n),Tl.multiplyScalar(1/Tl.w),Tl.x*=s.x/2,Tl.y*=s.y/2,Tl.z=0,SE.copy(Tl),AE.multiplyMatrices(e.matrixWorldInverse,o);for(let d=0,m=c;d<m;d++){if(Yr.fromBufferAttribute(l,d),Jr.fromBufferAttribute(u,d),Yr.w=1,Jr.w=1,Yr.applyMatrix4(AE),Jr.applyMatrix4(AE),Yr.z>h&&Jr.z>h)continue;if(Yr.z>h){const E=Yr.z-Jr.z,C=(Yr.z-h)/E;Yr.lerp(Jr,C)}else if(Jr.z>h){const E=Jr.z-Yr.z,C=(Jr.z-h)/E;Jr.lerp(Yr,C)}Yr.applyMatrix4(n),Jr.applyMatrix4(n),Yr.multiplyScalar(1/Yr.w),Jr.multiplyScalar(1/Jr.w),Yr.x*=s.x/2,Yr.y*=s.y/2,Jr.x*=s.x/2,Jr.y*=s.y/2,Qr.start.copy(Yr),Qr.start.z=0,Qr.end.copy(Jr),Qr.end.z=0;const x=Qr.closestPointToPointParameter(SE,!0);Qr.at(x,CL);const _=_v.lerp(Yr.z,Jr.z,x),S=_>=-1&&_<=1,T=SE.distanceTo(CL)<Wf*.5;if(S&&T){Qr.start.fromBufferAttribute(l,d),Qr.end.fromBufferAttribute(u,d),Qr.start.applyMatrix4(o),Qr.end.applyMatrix4(o);const E=new ae,C=new ae;Ll.distanceSqToSegment(Qr.start,Qr.end,C,E),t.push({point:C,pointOnLine:E,distance:Ll.origin.distanceTo(C),object:r,face:null,faceIndex:d,uv:null,[wk]:null})}}}class Ik extends ui{constructor(e=new $w,t=new Xw({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)ML.fromBufferAttribute(t,o),wL.fromBufferAttribute(n,o),i[a]=a===0?0:i[a-1],i[a+1]=i[a]+ML.distanceTo(wL);const s=new nS(i,2,1);return e.setAttribute("instanceDistanceStart",new oo(s,1,0)),e.setAttribute("instanceDistanceEnd",new oo(s,1,1)),this}raycast(e,t){const n=this.material.worldUnits,i=e.camera;i===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Ll=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;Wf=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),Ix.copy(a.boundingSphere).applyMatrix4(o);let u;if(n)u=Wf*.5;else{const h=Math.max(i.near,Ix.distanceToPoint(Ll.origin));u=bL(i,h,l.resolution)}if(Ix.radius+=u,Ll.intersectsSphere(Ix)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Rx.copy(a.boundingBox).applyMatrix4(o);let c;if(n)c=Wf*.5;else{const h=Math.max(i.near,Rx.distanceToPoint(Ll.origin));c=bL(i,h,l.resolution)}Rx.expandByScalar(c),Ll.intersectsBox(Rx)!==!1&&(n?aK(this,t):lK(this,i,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(_E),this.material.uniforms.resolution.value.set(_E.z,_E.w))}}class uK extends Ik{constructor(e=new Rk,t=new Xw({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}let Lx;const EE=()=>{if(Lx)return Lx;const r="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=r;WebAssembly.validate(t)&&(i=e);let s;const o=WebAssembly.instantiate(a(i),{}).then(h=>{s=h.instance,s.exports.__wasm_call_ctors()});function a(h){const d=new Uint8Array(h.length);for(let g=0;g<h.length;++g){const x=h.charCodeAt(g);d[g]=x>96?x-71:x>64?x-65:x>47?x+4:x>46?63:62}let m=0;for(let g=0;g<h.length;++g)d[m++]=d[g]<60?n[d[g]]:(d[g]-60)*64+d[++g];return d.buffer.slice(0,m)}function l(h,d,m,g,x,_){const S=s.exports.sbrk,T=m+3&-4,E=S(T*g),C=S(x.length),R=new Uint8Array(s.exports.memory.buffer);R.set(x,C);const P=h(E,m,g,C,x.length);if(P===0&&_&&_(E,T,g),d.set(R.subarray(E,E+m*g)),S(E-S(0)),P!==0)throw new Error(`Malformed buffer data: ${P}`)}const u={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},c={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Lx={ready:o,supported:!0,decodeVertexBuffer(h,d,m,g,x){l(s.exports.meshopt_decodeVertexBuffer,h,d,m,g,s.exports[u[x]])},decodeIndexBuffer(h,d,m,g){l(s.exports.meshopt_decodeIndexBuffer,h,d,m,g)},decodeIndexSequence(h,d,m,g){l(s.exports.meshopt_decodeIndexSequence,h,d,m,g)},decodeGltfBuffer(h,d,m,g,x,_){l(s.exports[c[x]],h,d,m,g,s.exports[u[_]])}},Lx},cK=ne.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:i,lineWidth:s,segments:o,dashed:a,...l},u){var c,h;const d=Ro(S=>S.size),m=ne.useMemo(()=>o?new Ik:new uK,[o]),[g]=ne.useState(()=>new Xw),x=(n==null||(c=n[0])==null?void 0:c.length)===4?4:3,_=ne.useMemo(()=>{const S=o?new $w:new Rk,T=e.map(E=>{const C=Array.isArray(E);return E instanceof ae||E instanceof gn?[E.x,E.y,E.z]:E instanceof Qe?[E.x,E.y,0]:C&&E.length===3?[E[0],E[1],E[2]]:C&&E.length===2?[E[0],E[1],0]:E});if(S.setPositions(T.flat()),n){t=16777215;const E=n.map(C=>C instanceof yt?C.toArray():C);S.setColors(E.flat(),x)}return S},[e,o,n,x]);return ne.useLayoutEffect(()=>{m.computeLineDistances()},[e,m]),ne.useLayoutEffect(()=>{a?g.defines.USE_DASH="":delete g.defines.USE_DASH,g.needsUpdate=!0},[a,g]),ne.useEffect(()=>()=>{_.dispose(),g.dispose()},[_]),ne.createElement("primitive",Qu({object:m,ref:u},l),ne.createElement("primitive",{object:_,attach:"geometry"}),ne.createElement("primitive",Qu({object:g,attach:"material",color:t,vertexColors:!!n,resolution:[d.width,d.height],linewidth:(h=i??s)!==null&&h!==void 0?h:1,dashed:a,transparent:x===4},l)))});function hK(){var r=Object.create(null);function e(i,s){var o=i.id,a=i.name,l=i.dependencies;l===void 0&&(l=[]);var u=i.init;u===void 0&&(u=function(){});var c=i.getTransferables;if(c===void 0&&(c=null),!r[o])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(m){if(m instanceof Error)throw m}),d=r[d.id].value),d}),u=n("<"+a+">.init",u),c&&(c=n("<"+a+">.getTransferables",c));var h=null;typeof u=="function"?h=u.apply(void 0,l):console.error("worker module init function failed to rehydrate"),r[o]={id:o,value:h,getTransferables:c},s(h)}catch(d){d&&d.noLog||console.error(d),s(d)}}function t(i,s){var o,a=i.id,l=i.args;(!r[a]||typeof r[a].value!="function")&&s(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var u=(o=r[a]).value.apply(o,l);u&&typeof u.then=="function"?u.then(c,function(h){return s(h instanceof Error?h:new Error(""+h))}):c(u)}catch(h){s(h)}function c(h){try{var d=r[a].getTransferables&&r[a].getTransferables(h);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),s(h,d)}catch(m){console.error(m),s(m)}}}function n(i,s){var o=void 0;self.troikaDefine=function(l){return o=l};var a=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(l){console.error(l)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(i){var s=i.data,o=s.messageId,a=s.action,l=s.data;try{a==="registerModule"&&e(l,function(u){u instanceof Error?postMessage({messageId:o,success:!1,error:u.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof u=="function"}})}),a==="callModule"&&t(l,function(u,c){u instanceof Error?postMessage({messageId:o,success:!1,error:u.message}):postMessage({messageId:o,success:!0,result:u},c||void 0)})}catch(u){postMessage({messageId:o,success:!1,error:u.stack})}})}function fK(r){var e=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=r.dependencies,n=r.init;t=Array.isArray(t)?t.map(function(s){return s&&(s=s.onMainThread||s,s._getInitResult&&(s=s._getInitResult())),s}):[];var i=Promise.all(t).then(function(s){return n.apply(null,s)});return e._getInitResult=function(){return i},i},e}var Lk=function(){var r=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),r=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return Lk=function(){return r},r},dK=0,pK=0,TE=!1,S0=Object.create(null),A0=Object.create(null),zT=Object.create(null);function Bm(r){if((!r||typeof r.init!="function")&&!TE)throw new Error("requires `options.init` function");var e=r.dependencies,t=r.init,n=r.getTransferables,i=r.workerId,s=fK(r);i==null&&(i="#default");var o="workerModule"+ ++dK,a=r.name||o,l=null;e=e&&e.map(function(c){return typeof c=="function"&&!c.workerModuleData&&(TE=!0,c=Bm({workerId:i,name:"<"+a+"> function dependency: "+c.name,init:`function(){return (
`+s_(c)+`
)}`}),TE=!1),c&&c.workerModuleData&&(c=c.workerModuleData),c});function u(){for(var c=[],h=arguments.length;h--;)c[h]=arguments[h];if(!Lk())return s.apply(void 0,c);if(!l){l=RL(i,"registerModule",u.workerModuleData);var d=function(){l=null,A0[i].delete(d)};(A0[i]||(A0[i]=new Set)).add(d)}return l.then(function(m){var g=m.isCallable;if(g)return RL(i,"callModule",{id:o,args:c});throw new Error("Worker module function was called but `init` did not return a callable function")})}return u.workerModuleData={isWorkerModule:!0,id:o,name:a,dependencies:e,init:s_(t),getTransferables:n&&s_(n)},u.onMainThread=s,u}function mK(r){A0[r]&&A0[r].forEach(function(e){e()}),S0[r]&&(S0[r].terminate(),delete S0[r])}function s_(r){var e=r.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function gK(r){var e=S0[r];if(!e){var t=s_(hK);e=S0[r]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+r.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(n){var i=n.data,s=i.messageId,o=zT[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete zT[s],o(i)}}return e}function RL(r,e,t){return new Promise(function(n,i){var s=++pK;zT[s]=function(o){o.success?n(o.result):i(new Error("Error in worker "+e+" call: "+o.error))},gK(r).postMessage({messageId:s,action:e,data:t})})}function Pk(){var r=function(e){function t($,j,U,X,le,Z,oe,pe){var de=1-oe;pe.x=de*de*$+2*de*oe*U+oe*oe*le,pe.y=de*de*j+2*de*oe*X+oe*oe*Z}function n($,j,U,X,le,Z,oe,pe,de,ye){var Ge=1-de;ye.x=Ge*Ge*Ge*$+3*Ge*Ge*de*U+3*Ge*de*de*le+de*de*de*oe,ye.y=Ge*Ge*Ge*j+3*Ge*Ge*de*X+3*Ge*de*de*Z+de*de*de*pe}function i($,j){for(var U=/([MLQCZ])([^MLQCZ]*)/g,X,le,Z,oe,pe;X=U.exec($);){var de=X[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(ye){return parseFloat(ye)});switch(X[1]){case"M":oe=le=de[0],pe=Z=de[1];break;case"L":(de[0]!==oe||de[1]!==pe)&&j("L",oe,pe,oe=de[0],pe=de[1]);break;case"Q":{j("Q",oe,pe,oe=de[2],pe=de[3],de[0],de[1]);break}case"C":{j("C",oe,pe,oe=de[4],pe=de[5],de[0],de[1],de[2],de[3]);break}case"Z":(oe!==le||pe!==Z)&&j("L",oe,pe,le,Z);break}}}function s($,j,U){U===void 0&&(U=16);var X={x:0,y:0};i($,function(le,Z,oe,pe,de,ye,Ge,Ke,De){switch(le){case"L":j(Z,oe,pe,de);break;case"Q":{for(var K=Z,Pe=oe,Be=1;Be<U;Be++)t(Z,oe,ye,Ge,pe,de,Be/(U-1),X),j(K,Pe,X.x,X.y),K=X.x,Pe=X.y;break}case"C":{for(var Xe=Z,ve=oe,et=1;et<U;et++)n(Z,oe,ye,Ge,Ke,De,pe,de,et/(U-1),X),j(Xe,ve,X.x,X.y),Xe=X.x,ve=X.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,u={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function c($,j){var U=$.getContext?$.getContext("webgl",u):$,X=l.get(U);if(!X){let Xe=function(z){var me=Z[z];if(!me&&(me=Z[z]=U.getExtension(z),!me))throw new Error(z+" not supported");return me},ve=function(z,me){var _e=U.createShader(me);return U.shaderSource(_e,z),U.compileShader(_e),_e},et=function(z,me,_e,Ee){if(!oe[z]){var we={},ut={},ke=U.createProgram();U.attachShader(ke,ve(me,U.VERTEX_SHADER)),U.attachShader(ke,ve(_e,U.FRAGMENT_SHADER)),U.linkProgram(ke),oe[z]={program:ke,transaction:function(lt){U.useProgram(ke),lt({setUniform:function(nt,Ct){for(var ht=[],it=arguments.length-2;it-- >0;)ht[it]=arguments[it+2];var rt=ut[Ct]||(ut[Ct]=U.getUniformLocation(ke,Ct));U["uniform"+nt].apply(U,[rt].concat(ht))},setAttribute:function(nt,Ct,ht,it,rt){var fe=we[nt];fe||(fe=we[nt]={buf:U.createBuffer(),loc:U.getAttribLocation(ke,nt),data:null}),U.bindBuffer(U.ARRAY_BUFFER,fe.buf),U.vertexAttribPointer(fe.loc,Ct,U.FLOAT,!1,0,0),U.enableVertexAttribArray(fe.loc),le?U.vertexAttribDivisor(fe.loc,it):Xe("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(fe.loc,it),rt!==fe.data&&(U.bufferData(U.ARRAY_BUFFER,rt,ht),fe.data=rt)}})}}}oe[z].transaction(Ee)},Ce=function(z,me){de++;try{U.activeTexture(U.TEXTURE0+de);var _e=pe[z];_e||(_e=pe[z]=U.createTexture(),U.bindTexture(U.TEXTURE_2D,_e),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.NEAREST),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.NEAREST)),U.bindTexture(U.TEXTURE_2D,_e),me(_e,de)}finally{de--}},We=function(z,me,_e){var Ee=U.createFramebuffer();ye.push(Ee),U.bindFramebuffer(U.FRAMEBUFFER,Ee),U.activeTexture(U.TEXTURE0+me),U.bindTexture(U.TEXTURE_2D,z),U.framebufferTexture2D(U.FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_2D,z,0);try{_e(Ee)}finally{U.deleteFramebuffer(Ee),U.bindFramebuffer(U.FRAMEBUFFER,ye[--ye.length-1]||null)}},te=function(){Z={},oe={},pe={},de=-1,ye.length=0};var Ge=Xe,Ke=ve,De=et,K=Ce,Pe=We,Be=te,le=typeof WebGL2RenderingContext<"u"&&U instanceof WebGL2RenderingContext,Z={},oe={},pe={},de=-1,ye=[];U.canvas.addEventListener("webglcontextlost",function(z){te(),z.preventDefault()},!1),l.set(U,X={gl:U,isWebGL2:le,getExtension:Xe,withProgram:et,withTexture:Ce,withTextureFramebuffer:We,handleContextLoss:te})}j(X)}function h($,j,U,X,le,Z,oe,pe){oe===void 0&&(oe=15),pe===void 0&&(pe=null),c($,function(de){var ye=de.gl,Ge=de.withProgram,Ke=de.withTexture;Ke("copy",function(De,K){ye.texImage2D(ye.TEXTURE_2D,0,ye.RGBA,le,Z,0,ye.RGBA,ye.UNSIGNED_BYTE,j),Ge("copy",o,a,function(Pe){var Be=Pe.setUniform,Xe=Pe.setAttribute;Xe("aUV",2,ye.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),Be("1i","image",K),ye.bindFramebuffer(ye.FRAMEBUFFER,pe||null),ye.disable(ye.BLEND),ye.colorMask(oe&8,oe&4,oe&2,oe&1),ye.viewport(U,X,le,Z),ye.scissor(U,X,le,Z),ye.drawArrays(ye.TRIANGLES,0,3)})})})}function d($,j,U){var X=$.width,le=$.height;c($,function(Z){var oe=Z.gl,pe=new Uint8Array(X*le*4);oe.readPixels(0,0,X,le,oe.RGBA,oe.UNSIGNED_BYTE,pe),$.width=j,$.height=U,h(oe,pe,0,0,X,le)})}var m=Object.freeze({__proto__:null,withWebGLContext:c,renderImageData:h,resizeWebGLCanvasWithoutClearing:d});function g($,j,U,X,le,Z){Z===void 0&&(Z=1);var oe=new Uint8Array($*j),pe=X[2]-X[0],de=X[3]-X[1],ye=[];s(U,function(Xe,ve,et,Ce){ye.push({x1:Xe,y1:ve,x2:et,y2:Ce,minX:Math.min(Xe,et),minY:Math.min(ve,Ce),maxX:Math.max(Xe,et),maxY:Math.max(ve,Ce)})}),ye.sort(function(Xe,ve){return Xe.maxX-ve.maxX});for(var Ge=0;Ge<$;Ge++)for(var Ke=0;Ke<j;Ke++){var De=Pe(X[0]+pe*(Ge+.5)/$,X[1]+de*(Ke+.5)/j),K=Math.pow(1-Math.abs(De)/le,Z)/2;De<0&&(K=1-K),K=Math.max(0,Math.min(255,Math.round(K*255))),oe[Ke*$+Ge]=K}return oe;function Pe(Xe,ve){for(var et=1/0,Ce=1/0,We=ye.length;We--;){var te=ye[We];if(te.maxX+Ce<=Xe)break;if(Xe+Ce>te.minX&&ve-Ce<te.maxY&&ve+Ce>te.minY){var z=S(Xe,ve,te.x1,te.y1,te.x2,te.y2);z<et&&(et=z,Ce=Math.sqrt(et))}}return Be(Xe,ve)&&(Ce=-Ce),Ce}function Be(Xe,ve){for(var et=0,Ce=ye.length;Ce--;){var We=ye[Ce];if(We.maxX<=Xe)break;var te=We.y1>ve!=We.y2>ve&&Xe<(We.x2-We.x1)*(ve-We.y1)/(We.y2-We.y1)+We.x1;te&&(et+=We.y1<We.y2?1:-1)}return et!==0}}function x($,j,U,X,le,Z,oe,pe,de,ye){Z===void 0&&(Z=1),pe===void 0&&(pe=0),de===void 0&&(de=0),ye===void 0&&(ye=0),_($,j,U,X,le,Z,oe,null,pe,de,ye)}function _($,j,U,X,le,Z,oe,pe,de,ye,Ge){Z===void 0&&(Z=1),de===void 0&&(de=0),ye===void 0&&(ye=0),Ge===void 0&&(Ge=0);for(var Ke=g($,j,U,X,le,Z),De=new Uint8Array(Ke.length*4),K=0;K<Ke.length;K++)De[K*4+Ge]=Ke[K];h(oe,De,de,ye,$,j,1<<3-Ge,pe)}function S($,j,U,X,le,Z){var oe=le-U,pe=Z-X,de=oe*oe+pe*pe,ye=de?Math.max(0,Math.min(1,(($-U)*oe+(j-X)*pe)/de)):0,Ge=$-(U+ye*oe),Ke=j-(X+ye*pe);return Ge*Ge+Ke*Ke}var T=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:x,generateIntoFramebuffer:_}),E="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",C="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",R="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",P=new Float32Array([0,0,2,0,0,2]),L=null,F=!1,D={},I=new WeakMap;function N($){if(!F&&!re($))throw new Error("WebGL generation not supported")}function V($,j,U,X,le,Z,oe){if(Z===void 0&&(Z=1),oe===void 0&&(oe=null),!oe&&(oe=L,!oe)){var pe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!pe)throw new Error("OffscreenCanvas or DOM canvas not supported");oe=L=pe.getContext("webgl",{depth:!1})}N(oe);var de=new Uint8Array($*j*4);c(oe,function(De){var K=De.gl,Pe=De.withTexture,Be=De.withTextureFramebuffer;Pe("readable",function(Xe,ve){K.texImage2D(K.TEXTURE_2D,0,K.RGBA,$,j,0,K.RGBA,K.UNSIGNED_BYTE,null),Be(Xe,ve,function(et){Q($,j,U,X,le,Z,K,et,0,0,0),K.readPixels(0,0,$,j,K.RGBA,K.UNSIGNED_BYTE,de)})})});for(var ye=new Uint8Array($*j),Ge=0,Ke=0;Ge<de.length;Ge+=4)ye[Ke++]=de[Ge];return ye}function q($,j,U,X,le,Z,oe,pe,de,ye){Z===void 0&&(Z=1),pe===void 0&&(pe=0),de===void 0&&(de=0),ye===void 0&&(ye=0),Q($,j,U,X,le,Z,oe,null,pe,de,ye)}function Q($,j,U,X,le,Z,oe,pe,de,ye,Ge){Z===void 0&&(Z=1),de===void 0&&(de=0),ye===void 0&&(ye=0),Ge===void 0&&(Ge=0),N(oe);var Ke=[];s(U,function(De,K,Pe,Be){Ke.push(De,K,Pe,Be)}),Ke=new Float32Array(Ke),c(oe,function(De){var K=De.gl,Pe=De.isWebGL2,Be=De.getExtension,Xe=De.withProgram,ve=De.withTexture,et=De.withTextureFramebuffer,Ce=De.handleContextLoss;if(ve("rawDistances",function(We,te){($!==We._lastWidth||j!==We._lastHeight)&&K.texImage2D(K.TEXTURE_2D,0,K.RGBA,We._lastWidth=$,We._lastHeight=j,0,K.RGBA,K.UNSIGNED_BYTE,null),Xe("main",E,C,function(z){var me=z.setAttribute,_e=z.setUniform,Ee=!Pe&&Be("ANGLE_instanced_arrays"),we=!Pe&&Be("EXT_blend_minmax");me("aUV",2,K.STATIC_DRAW,0,P),me("aLineSegment",4,K.DYNAMIC_DRAW,1,Ke),_e.apply(void 0,["4f","uGlyphBounds"].concat(X)),_e("1f","uMaxDistance",le),_e("1f","uExponent",Z),et(We,te,function(ut){K.enable(K.BLEND),K.colorMask(!0,!0,!0,!0),K.viewport(0,0,$,j),K.scissor(0,0,$,j),K.blendFunc(K.ONE,K.ONE),K.blendEquationSeparate(K.FUNC_ADD,Pe?K.MAX:we.MAX_EXT),K.clear(K.COLOR_BUFFER_BIT),Pe?K.drawArraysInstanced(K.TRIANGLES,0,3,Ke.length/4):Ee.drawArraysInstancedANGLE(K.TRIANGLES,0,3,Ke.length/4)})}),Xe("post",o,R,function(z){z.setAttribute("aUV",2,K.STATIC_DRAW,0,P),z.setUniform("1i","tex",te),K.bindFramebuffer(K.FRAMEBUFFER,pe),K.disable(K.BLEND),K.colorMask(Ge===0,Ge===1,Ge===2,Ge===3),K.viewport(de,ye,$,j),K.scissor(de,ye,$,j),K.drawArrays(K.TRIANGLES,0,3)})}),K.isContextLost())throw Ce(),new Error("webgl context lost")})}function re($){var j=!$||$===L?D:$.canvas||$,U=I.get(j);if(U===void 0){F=!0;var X=null;try{var le=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Z=V(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,$);U=Z&&le.length===Z.length&&Z.every(function(oe,pe){return oe===le[pe]}),U||(X="bad trial run results",console.info(le,Z))}catch(oe){U=!1,X=oe.message}X&&console.warn("WebGL SDF generation not supported:",X),F=!1,I.set(j,U)}return U}var ee=Object.freeze({__proto__:null,generate:V,generateIntoCanvas:q,generateIntoFramebuffer:Q,isSupported:re});function se($,j,U,X,le,Z){le===void 0&&(le=Math.max(X[2]-X[0],X[3]-X[1])/2),Z===void 0&&(Z=1);try{return V.apply(ee,arguments)}catch(oe){return console.info("WebGL SDF generation failed, falling back to JS",oe),g.apply(T,arguments)}}function W($,j,U,X,le,Z,oe,pe,de,ye){le===void 0&&(le=Math.max(X[2]-X[0],X[3]-X[1])/2),Z===void 0&&(Z=1),pe===void 0&&(pe=0),de===void 0&&(de=0),ye===void 0&&(ye=0);try{return q.apply(ee,arguments)}catch(Ge){return console.info("WebGL SDF generation failed, falling back to JS",Ge),x.apply(T,arguments)}}return e.forEachPathCommand=i,e.generate=se,e.generateIntoCanvas=W,e.javascript=T,e.pathToLineSegments=s,e.webgl=ee,e.webglUtils=m,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return r}function vK(){var r=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},i={};n.L=1,i[1]="L",Object.keys(t).forEach(function(Ce,We){n[Ce]=1<<We+1,i[n[Ce]]=Ce}),Object.freeze(n);var s=n.LRI|n.RLI|n.FSI,o=n.L|n.R|n.AL,a=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,l=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,u=n.S|n.WS|n.B|s|n.PDI|l,c=null;function h(){if(!c){c=new Map;var Ce=function(te){if(t.hasOwnProperty(te)){var z=0;t[te].split(",").forEach(function(me){var _e=me.split("+"),Ee=_e[0],we=_e[1];Ee=parseInt(Ee,36),we=we?parseInt(we,36):0,c.set(z+=Ee,n[te]);for(var ut=0;ut<we;ut++)c.set(++z,n[te])})}};for(var We in t)Ce(We)}}function d(Ce){return h(),c.get(Ce.codePointAt(0))||n.L}function m(Ce){return i[d(Ce)]}var g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function x(Ce,We){var te=36,z=0,me=new Map,_e=We&&new Map,Ee;return Ce.split(",").forEach(function we(ut){if(ut.indexOf("+")!==-1)for(var ke=+ut;ke--;)we(Ee);else{Ee=ut;var Ze=ut.split(">"),lt=Ze[0],Ye=Ze[1];lt=String.fromCodePoint(z+=parseInt(lt,te)),Ye=String.fromCodePoint(z+=parseInt(Ye,te)),me.set(lt,Ye),We&&_e.set(Ye,lt)}}),{map:me,reverseMap:_e}}var _,S,T;function E(){if(!_){var Ce=x(g.pairs,!0),We=Ce.map,te=Ce.reverseMap;_=We,S=te,T=x(g.canonical,!1).map}}function C(Ce){return E(),_.get(Ce)||null}function R(Ce){return E(),S.get(Ce)||null}function P(Ce){return E(),T.get(Ce)||null}var L=n.L,F=n.R,D=n.EN,I=n.ES,N=n.ET,V=n.AN,q=n.CS,Q=n.B,re=n.S,ee=n.ON,se=n.BN,W=n.NSM,$=n.AL,j=n.LRO,U=n.RLO,X=n.LRE,le=n.RLE,Z=n.PDF,oe=n.LRI,pe=n.RLI,de=n.FSI,ye=n.PDI;function Ge(Ce,We){for(var te=125,z=new Uint32Array(Ce.length),me=0;me<Ce.length;me++)z[me]=d(Ce[me]);var _e=new Map;function Ee(Li,Vi){var Si=z[Li];z[Li]=Vi,_e.set(Si,_e.get(Si)-1),Si&a&&_e.set(a,_e.get(a)-1),_e.set(Vi,(_e.get(Vi)||0)+1),Vi&a&&_e.set(a,(_e.get(a)||0)+1)}for(var we=new Uint8Array(Ce.length),ut=new Map,ke=[],Ze=null,lt=0;lt<Ce.length;lt++)Ze||ke.push(Ze={start:lt,end:Ce.length-1,level:We==="rtl"?1:We==="ltr"?0:nr(lt,!1)}),z[lt]&Q&&(Ze.end=lt,Ze=null);for(var Ye=le|X|U|j|s|ye|Z|Q,nt=function(Li){return Li+(Li&1?1:2)},Ct=function(Li){return Li+(Li&1?2:1)},ht=0;ht<ke.length;ht++){Ze=ke[ht];var it=[{_level:Ze.level,_override:0,_isolate:0}],rt=void 0,fe=0,Je=0,ce=0;_e.clear();for(var He=Ze.start;He<=Ze.end;He++){var Te=z[He];if(rt=it[it.length-1],_e.set(Te,(_e.get(Te)||0)+1),Te&a&&_e.set(a,(_e.get(a)||0)+1),Te&Ye)if(Te&(le|X)){we[He]=rt._level;var Oe=(Te===le?Ct:nt)(rt._level);Oe<=te&&!fe&&!Je?it.push({_level:Oe,_override:0,_isolate:0}):fe||Je++}else if(Te&(U|j)){we[He]=rt._level;var st=(Te===U?Ct:nt)(rt._level);st<=te&&!fe&&!Je?it.push({_level:st,_override:Te&U?F:L,_isolate:0}):fe||Je++}else if(Te&s){Te&de&&(Te=nr(He+1,!0)===1?pe:oe),we[He]=rt._level,rt._override&&Ee(He,rt._override);var xt=(Te===pe?Ct:nt)(rt._level);xt<=te&&fe===0&&Je===0?(ce++,it.push({_level:xt,_override:0,_isolate:1,_isolInitIndex:He})):fe++}else if(Te&ye){if(fe>0)fe--;else if(ce>0){for(Je=0;!it[it.length-1]._isolate;)it.pop();var _t=it[it.length-1]._isolInitIndex;_t!=null&&(ut.set(_t,He),ut.set(He,_t)),it.pop(),ce--}rt=it[it.length-1],we[He]=rt._level,rt._override&&Ee(He,rt._override)}else Te&Z?(fe===0&&(Je>0?Je--:!rt._isolate&&it.length>1&&(it.pop(),rt=it[it.length-1])),we[He]=rt._level):Te&Q&&(we[He]=Ze.level);else we[He]=rt._level,rt._override&&Te!==se&&Ee(He,rt._override)}for(var Ht=[],zt=null,gt=Ze.start;gt<=Ze.end;gt++){var Qt=z[gt];if(!(Qt&l)){var vn=we[gt],Dn=Qt&s,In=Qt===ye;zt&&vn===zt._level?(zt._end=gt,zt._endsWithIsolInit=Dn):Ht.push(zt={_start:gt,_end:gt,_level:vn,_startsWithPDI:In,_endsWithIsolInit:Dn})}}for(var xi=[],ns=0;ns<Ht.length;ns++){var Ri=Ht[ns];if(!Ri._startsWithPDI||Ri._startsWithPDI&&!ut.has(Ri._start)){for(var Ji=[zt=Ri],Gi=void 0;zt&&zt._endsWithIsolInit&&(Gi=ut.get(zt._end))!=null;)for(var qi=ns+1;qi<Ht.length;qi++)if(Ht[qi]._start===Gi){Ji.push(zt=Ht[qi]);break}for(var Ii=[],Hs=0;Hs<Ji.length;Hs++)for(var uc=Ji[Hs],Ss=uc._start;Ss<=uc._end;Ss++)Ii.push(Ss);for(var cc=we[Ii[0]],ie=Ze.level,Ae=Ii[0]-1;Ae>=0;Ae--)if(!(z[Ae]&l)){ie=we[Ae];break}var Ue=Ii[Ii.length-1],ze=we[Ue],be=Ze.level;if(!(z[Ue]&s)){for(var ft=Ue+1;ft<=Ze.end;ft++)if(!(z[ft]&l)){be=we[ft];break}}xi.push({_seqIndices:Ii,_sosType:Math.max(ie,cc)%2?F:L,_eosType:Math.max(be,ze)%2?F:L})}}for(var At=0;At<xi.length;At++){var Rt=xi[At],je=Rt._seqIndices,Ot=Rt._sosType,Vt=Rt._eosType,Pt=we[je[0]]&1?F:L;if(_e.get(W))for(var un=0;un<je.length;un++){var Un=je[un];if(z[Un]&W){for(var En=Ot,Bn=un-1;Bn>=0;Bn--)if(!(z[je[Bn]]&l)){En=z[je[Bn]];break}Ee(Un,En&(s|ye)?ee:En)}}if(_e.get(D))for(var wt=0;wt<je.length;wt++){var mt=je[wt];if(z[mt]&D)for(var on=wt-1;on>=-1;on--){var Kt=on===-1?Ot:z[je[on]];if(Kt&o){Kt===$&&Ee(mt,V);break}}}if(_e.get($))for(var Fn=0;Fn<je.length;Fn++){var fr=je[Fn];z[fr]&$&&Ee(fr,F)}if(_e.get(I)||_e.get(q))for(var Nn=1;Nn<je.length-1;Nn++){var qn=je[Nn];if(z[qn]&(I|q)){for(var yn=0,Qi=0,jo=Nn-1;jo>=0&&(yn=z[je[jo]],!!(yn&l));jo--);for(var _i=Nn+1;_i<je.length&&(Qi=z[je[_i]],!!(Qi&l));_i++);yn===Qi&&(z[qn]===I?yn===D:yn&(D|V))&&Ee(qn,yn)}}if(_e.get(D))for(var Hi=0;Hi<je.length;Hi++){var Cr=je[Hi];if(z[Cr]&D){for(var fo=Hi-1;fo>=0&&z[je[fo]]&(N|l);fo--)Ee(je[fo],D);for(Hi++;Hi<je.length&&z[je[Hi]]&(N|l|D);Hi++)z[je[Hi]]!==D&&Ee(je[Hi],D)}}if(_e.get(N)||_e.get(I)||_e.get(q))for(var po=0;po<je.length;po++){var gd=je[po];if(z[gd]&(N|I|q)){Ee(gd,ee);for(var mo=po-1;mo>=0&&z[je[mo]]&l;mo--)Ee(je[mo],ee);for(var mn=po+1;mn<je.length&&z[je[mn]]&l;mn++)Ee(je[mn],ee)}}if(_e.get(D))for(var Ko=0,ol=Ot;Ko<je.length;Ko++){var hc=je[Ko],fc=z[hc];fc&D?ol===L&&Ee(hc,L):fc&o&&(ol=fc)}if(_e.get(a)){var $o=F|D|V,Yl=$o|L,zs=[];{for(var go=[],dr=0;dr<je.length;dr++)if(z[je[dr]]&a){var Zt=Ce[je[dr]],Vs=void 0;if(C(Zt)!==null)if(go.length<63)go.push({char:Zt,seqIndex:dr});else break;else if((Vs=R(Zt))!==null)for(var As=go.length-1;As>=0;As--){var Xo=go[As].char;if(Xo===Vs||Xo===R(P(Zt))||C(P(Xo))===Zt){zs.push([go[As].seqIndex,dr]),go.length=As;break}}}zs.sort(function(Li,Vi){return Li[0]-Vi[0]})}for(var Ws=0;Ws<zs.length;Ws++){for(var vd=zs[Ws],ti=vd[0],vo=vd[1],yd=!1,br=0,al=ti+1;al<vo;al++){var ll=je[al];if(z[ll]&Yl){yd=!0;var Es=z[ll]&$o?F:L;if(Es===Pt){br=Es;break}}}if(yd&&!br){br=Ot;for(var ya=ti-1;ya>=0;ya--){var ul=je[ya];if(z[ul]&Yl){var Zi=z[ul]&$o?F:L;Zi!==Pt?br=Zi:br=Pt;break}}}if(br){if(z[je[ti]]=z[je[vo]]=br,br!==Pt){for(var er=ti+1;er<je.length;er++)if(!(z[je[er]]&l)){d(Ce[je[er]])&W&&(z[je[er]]=br);break}}if(br!==Pt){for(var Yo=vo+1;Yo<je.length;Yo++)if(!(z[je[Yo]]&l)){d(Ce[je[Yo]])&W&&(z[je[Yo]]=br);break}}}}for(var js=0;js<je.length;js++)if(z[je[js]]&a){for(var Jl=js,cl=js,Rr=Ot,hl=js-1;hl>=0;hl--)if(z[je[hl]]&l)Jl=hl;else{Rr=z[je[hl]]&$o?F:L;break}for(var is=Vt,xa=js+1;xa<je.length;xa++)if(z[je[xa]]&(a|l))cl=xa;else{is=z[je[xa]]&$o?F:L;break}for(var tr=Jl;tr<=cl;tr++)z[je[tr]]=Rr===is?Rr:Pt;js=cl}}}for(var zi=Ze.start;zi<=Ze.end;zi++){var _a=we[zi],rs=z[zi];if(_a&1?rs&(L|D|V)&&we[zi]++:rs&F?we[zi]++:rs&(V|D)&&(we[zi]+=2),rs&l&&(we[zi]=zi===0?Ze.level:we[zi-1]),zi===Ze.end||d(Ce[zi])&(re|Q))for(var Sa=zi;Sa>=0&&d(Ce[Sa])&u;Sa--)we[Sa]=Ze.level}}return{levels:we,paragraphs:ke};function nr(Li,Vi){for(var Si=Li;Si<Ce.length;Si++){var oi=z[Si];if(oi&(F|$))return 1;if(oi&(Q|L)||Vi&&oi===ye)return 0;if(oi&s){var Hr=Aa(Si);Si=Hr===-1?Ce.length:Hr}}return 0}function Aa(Li){for(var Vi=1,Si=Li+1;Si<Ce.length;Si++){var oi=z[Si];if(oi&Q)break;if(oi&ye){if(--Vi===0)return Si}else oi&s&&Vi++}return-1}}var Ke="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",De;function K(){if(!De){var Ce=x(Ke,!0),We=Ce.map,te=Ce.reverseMap;te.forEach(function(z,me){We.set(me,z)}),De=We}}function Pe(Ce){return K(),De.get(Ce)||null}function Be(Ce,We,te,z){var me=Ce.length;te=Math.max(0,te==null?0:+te),z=Math.min(me-1,z==null?me-1:+z);for(var _e=new Map,Ee=te;Ee<=z;Ee++)if(We[Ee]&1){var we=Pe(Ce[Ee]);we!==null&&_e.set(Ee,we)}return _e}function Xe(Ce,We,te,z){var me=Ce.length;te=Math.max(0,te==null?0:+te),z=Math.min(me-1,z==null?me-1:+z);var _e=[];return We.paragraphs.forEach(function(Ee){var we=Math.max(te,Ee.start),ut=Math.min(z,Ee.end);if(we<ut){for(var ke=We.levels.slice(we,ut+1),Ze=ut;Ze>=we&&d(Ce[Ze])&u;Ze--)ke[Ze]=Ee.level;for(var lt=Ee.level,Ye=1/0,nt=0;nt<ke.length;nt++){var Ct=ke[nt];Ct>lt&&(lt=Ct),Ct<Ye&&(Ye=Ct|1)}for(var ht=lt;ht>=Ye;ht--)for(var it=0;it<ke.length;it++)if(ke[it]>=ht){for(var rt=it;it+1<ke.length&&ke[it+1]>=ht;)it++;it>rt&&_e.push([rt+we,it+we])}}}),_e}function ve(Ce,We,te,z){var me=et(Ce,We,te,z),_e=[].concat(Ce);return me.forEach(function(Ee,we){_e[we]=(We.levels[Ee]&1?Pe(Ce[Ee]):null)||Ce[Ee]}),_e.join("")}function et(Ce,We,te,z){for(var me=Xe(Ce,We,te,z),_e=[],Ee=0;Ee<Ce.length;Ee++)_e[Ee]=Ee;return me.forEach(function(we){for(var ut=we[0],ke=we[1],Ze=_e.slice(ut,ke+1),lt=Ze.length;lt--;)_e[ke-lt]=Ze[lt]}),_e}return e.closingToOpeningBracket=R,e.getBidiCharType=d,e.getBidiCharTypeName=m,e.getCanonicalBracket=P,e.getEmbeddingLevels=Ge,e.getMirroredCharacter=Pe,e.getMirroredCharactersMap=Be,e.getReorderSegments=Xe,e.getReorderedIndices=et,e.getReorderedString=ve,e.openingToClosingBracket=C,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return r}const Dk=/\bvoid\s+main\s*\(\s*\)\s*{/g;function VT(r){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(n,i){let s=hn[i];return s?VT(s):n}return r.replace(e,t)}const qr=[];for(let r=0;r<256;r++)qr[r]=(r<16?"0":"")+r.toString(16);function yK(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(qr[r&255]+qr[r>>8&255]+qr[r>>16&255]+qr[r>>24&255]+"-"+qr[e&255]+qr[e>>8&255]+"-"+qr[e>>16&15|64]+qr[e>>24&255]+"-"+qr[t&63|128]+qr[t>>8&255]+"-"+qr[t>>16&255]+qr[t>>24&255]+qr[n&255]+qr[n>>8&255]+qr[n>>16&255]+qr[n>>24&255]).toUpperCase()}const gf=Object.assign||function(){let r=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let n=arguments[e];if(n)for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},xK=Date.now(),IL=new WeakMap,LL=new Map;let _K=1e10;function WT(r,e){const t=TK(e);let n=IL.get(r);if(n||IL.set(r,n=Object.create(null)),n[t])return new n[t];const i=`_onBeforeCompile${t}`,s=function(u,c){r.onBeforeCompile.call(this,u,c);const h=this.customProgramCacheKey()+"|"+u.vertexShader+"|"+u.fragmentShader;let d=LL[h];if(!d){const m=SK(this,u,e,t);d=LL[h]=m}u.vertexShader=d.vertexShader,u.fragmentShader=d.fragmentShader,gf(u.uniforms,this.uniforms),e.timeUniform&&(u.uniforms[e.timeUniform]={get value(){return Date.now()-xK}}),this[i]&&this[i](u)},o=function(){return a(e.chained?r:r.clone())},a=function(u){const c=Object.create(u,l);return Object.defineProperty(c,"baseMaterial",{value:r}),Object.defineProperty(c,"id",{value:_K++}),c.uuid=yK(),c.uniforms=gf({},u.uniforms,e.uniforms),c.defines=gf({},u.defines,e.defines),c.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",c.extensions=gf({},u.extensions,e.extensions),c._listeners=void 0,c},l={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>r.type,set:u=>{r.type=u}},isDerivedFrom:{writable:!0,configurable:!0,value:function(u){const c=this.baseMaterial;return u===c||c.isDerivedMaterial&&c.isDerivedFrom(u)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return r.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return s},set(u){this[i]=u}},copy:{writable:!0,configurable:!0,value:function(u){return r.copy.call(this,u),!r.isShaderMaterial&&!r.isDerivedMaterial&&(gf(this.extensions,u.extensions),gf(this.defines,u.defines),gf(this.uniforms,$0.clone(u.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const u=new r.constructor;return a(u).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let u=this._depthMaterial;return u||(u=this._depthMaterial=WT(r.isDerivedMaterial?r.getDepthMaterial():new XS({depthPacking:ow}),e),u.defines.IS_DEPTH_MATERIAL="",u.uniforms=this.uniforms),u}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let u=this._distanceMaterial;return u||(u=this._distanceMaterial=WT(r.isDerivedMaterial?r.getDistanceMaterial():new YS,e),u.defines.IS_DISTANCE_MATERIAL="",u.uniforms=this.uniforms),u}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:u,_distanceMaterial:c}=this;u&&u.dispose(),c&&c.dispose(),r.dispose.call(this)}}};return n[t]=o,new o}function SK(r,{vertexShader:e,fragmentShader:t},n,i){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:u,fragmentMainIntro:c,fragmentMainOutro:h,fragmentColorTransform:d,customRewriter:m,timeUniform:g}=n;if(s=s||"",o=o||"",a=a||"",u=u||"",c=c||"",h=h||"",(l||m)&&(e=VT(e)),(d||m)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=VT(t)),m){let x=m({vertexShader:e,fragmentShader:t});e=x.vertexShader,t=x.fragmentShader}if(d){let x=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,_=>(x.push(_),"")),h=`${d}
${x.join(`
`)}
${h}`}if(g){const x=`
uniform float ${g};
`;s=x+s,u=x+u}return l&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,s=`${s}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(x,_,S,T)=>/\battribute\s+vec[23]\s+$/.test(T.substr(0,S))?_:`troika_${_}_${i}`),r.map&&r.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=PL(e,i,s,o,a),t=PL(t,i,u,c,h),{vertexShader:e,fragmentShader:t}}function PL(r,e,t,n,i){return(n||i||t)&&(r=r.replace(Dk,`
${t}
void troikaOrigMain${e}() {`),r+=`
void main() {
  ${n}
  troikaOrigMain${e}();
  ${i}
}`),r}function AK(r,e){return r==="uniforms"?void 0:typeof e=="function"?e.toString():e}let EK=0;const DL=new Map;function TK(r){const e=JSON.stringify(r,AK);let t=DL.get(e);return t==null&&DL.set(e,t=++EK),t}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function MK(){return typeof window>"u"&&(self.window=self),function(r){var e={parse:function(i){var s=e._bin,o=new Uint8Array(i);if(s.readASCII(o,0,4)=="ttcf"){var a=4;s.readUshort(o,a),a+=2,s.readUshort(o,a),a+=2;var l=s.readUint(o,a);a+=4;for(var u=[],c=0;c<l;c++){var h=s.readUint(o,a);a+=4,u.push(e._readFont(o,h))}return u}return[e._readFont(o,0)]},_readFont:function(i,s){var o=e._bin,a=s;o.readFixed(i,s),s+=4;var l=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2;for(var u=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],c={_data:i,_offset:a},h={},d=0;d<l;d++){var m=o.readASCII(i,s,4);s+=4,o.readUint(i,s),s+=4;var g=o.readUint(i,s);s+=4;var x=o.readUint(i,s);s+=4,h[m]={offset:g,length:x}}for(d=0;d<u.length;d++){var _=u[d];h[_]&&(c[_.trim()]=e[_.trim()].parse(i,h[_].offset,h[_].length,c))}return c},_tabOffset:function(i,s,o){for(var a=e._bin,l=a.readUshort(i,o+4),u=o+12,c=0;c<l;c++){var h=a.readASCII(i,u,4);u+=4,a.readUint(i,u),u+=4;var d=a.readUint(i,u);if(u+=4,a.readUint(i,u),u+=4,h==s)return d}return 0}};e._bin={readFixed:function(i,s){return(i[s]<<8|i[s+1])+(i[s+2]<<8|i[s+3])/65540},readF2dot14:function(i,s){return e._bin.readShort(i,s)/16384},readInt:function(i,s){return e._bin._view(i).getInt32(s)},readInt8:function(i,s){return e._bin._view(i).getInt8(s)},readShort:function(i,s){return e._bin._view(i).getInt16(s)},readUshort:function(i,s){return e._bin._view(i).getUint16(s)},readUshorts:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(e._bin.readUshort(i,s+2*l));return a},readUint:function(i,s){return e._bin._view(i).getUint32(s)},readUint64:function(i,s){return 4294967296*e._bin.readUint(i,s)+e._bin.readUint(i,s+4)},readASCII:function(i,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(i[s+l]);return a},readUnicode:function(i,s,o){for(var a="",l=0;l<o;l++){var u=i[s++]<<8|i[s++];a+=String.fromCharCode(u)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,s,o){var a=e._bin._tdec;return a&&s==0&&o==i.length?a.decode(i):e._bin.readASCII(i,s,o)},readBytes:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(i[s+l]);return a},readASCIIArray:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(String.fromCharCode(i[s+l]));return a},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,s,o,a,l){var u=e._bin,c={},h=s;u.readFixed(i,s),s+=4;var d=u.readUshort(i,s);s+=2;var m=u.readUshort(i,s);s+=2;var g=u.readUshort(i,s);return s+=2,c.scriptList=e._lctf.readScriptList(i,h+d),c.featureList=e._lctf.readFeatureList(i,h+m),c.lookupList=e._lctf.readLookupList(i,h+g,l),c},e._lctf.readLookupList=function(i,s,o){var a=e._bin,l=s,u=[],c=a.readUshort(i,s);s+=2;for(var h=0;h<c;h++){var d=a.readUshort(i,s);s+=2;var m=e._lctf.readLookupTable(i,l+d,o);u.push(m)}return u},e._lctf.readLookupTable=function(i,s,o){var a=e._bin,l=s,u={tabs:[]};u.ltype=a.readUshort(i,s),s+=2,u.flag=a.readUshort(i,s),s+=2;var c=a.readUshort(i,s);s+=2;for(var h=u.ltype,d=0;d<c;d++){var m=a.readUshort(i,s);s+=2;var g=o(i,h,l+m,u);u.tabs.push(g)}return u},e._lctf.numOfOnes=function(i){for(var s=0,o=0;o<32;o++)(i>>>o&1)!=0&&s++;return s},e._lctf.readClassDef=function(i,s){var o=e._bin,a=[],l=o.readUshort(i,s);if(s+=2,l==1){var u=o.readUshort(i,s);s+=2;var c=o.readUshort(i,s);s+=2;for(var h=0;h<c;h++)a.push(u+h),a.push(u+h),a.push(o.readUshort(i,s)),s+=2}if(l==2){var d=o.readUshort(i,s);for(s+=2,h=0;h<d;h++)a.push(o.readUshort(i,s)),s+=2,a.push(o.readUshort(i,s)),s+=2,a.push(o.readUshort(i,s)),s+=2}return a},e._lctf.getInterval=function(i,s){for(var o=0;o<i.length;o+=3){var a=i[o],l=i[o+1];if(i[o+2],a<=s&&s<=l)return o}return-1},e._lctf.readCoverage=function(i,s){var o=e._bin,a={};a.fmt=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);return s+=2,a.fmt==1&&(a.tab=o.readUshorts(i,s,l)),a.fmt==2&&(a.tab=o.readUshorts(i,s,3*l)),a},e._lctf.coverageIndex=function(i,s){var o=i.tab;if(i.fmt==1)return o.indexOf(s);if(i.fmt==2){var a=e._lctf.getInterval(o,s);if(a!=-1)return o[a+2]+(s-o[a])}return-1},e._lctf.readFeatureList=function(i,s){var o=e._bin,a=s,l=[],u=o.readUshort(i,s);s+=2;for(var c=0;c<u;c++){var h=o.readASCII(i,s,4);s+=4;var d=o.readUshort(i,s);s+=2;var m=e._lctf.readFeatureTable(i,a+d);m.tag=h.trim(),l.push(m)}return l},e._lctf.readFeatureTable=function(i,s){var o=e._bin,a=s,l={},u=o.readUshort(i,s);s+=2,u>0&&(l.featureParams=a+u);var c=o.readUshort(i,s);s+=2,l.tab=[];for(var h=0;h<c;h++)l.tab.push(o.readUshort(i,s+2*h));return l},e._lctf.readScriptList=function(i,s){var o=e._bin,a=s,l={},u=o.readUshort(i,s);s+=2;for(var c=0;c<u;c++){var h=o.readASCII(i,s,4);s+=4;var d=o.readUshort(i,s);s+=2,l[h.trim()]=e._lctf.readScriptTable(i,a+d)}return l},e._lctf.readScriptTable=function(i,s){var o=e._bin,a=s,l={},u=o.readUshort(i,s);s+=2,u>0&&(l.default=e._lctf.readLangSysTable(i,a+u));var c=o.readUshort(i,s);s+=2;for(var h=0;h<c;h++){var d=o.readASCII(i,s,4);s+=4;var m=o.readUshort(i,s);s+=2,l[d.trim()]=e._lctf.readLangSysTable(i,a+m)}return l},e._lctf.readLangSysTable=function(i,s){var o=e._bin,a={};o.readUshort(i,s),s+=2,a.reqFeature=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);return s+=2,a.features=o.readUshorts(i,s,l),a},e.CFF={},e.CFF.parse=function(i,s,o){var a=e._bin;(i=new Uint8Array(i.buffer,s,o))[s=0],i[++s],i[++s],i[++s],s++;var l=[];s=e.CFF.readIndex(i,s,l);for(var u=[],c=0;c<l.length-1;c++)u.push(a.readASCII(i,s+l[c],l[c+1]-l[c]));s+=l[l.length-1];var h=[];s=e.CFF.readIndex(i,s,h);var d=[];for(c=0;c<h.length-1;c++)d.push(e.CFF.readDict(i,s+h[c],s+h[c+1]));s+=h[h.length-1];var m=d[0],g=[];s=e.CFF.readIndex(i,s,g);var x=[];for(c=0;c<g.length-1;c++)x.push(a.readASCII(i,s+g[c],g[c+1]-g[c]));if(s+=g[g.length-1],e.CFF.readSubrs(i,s,m),m.CharStrings){s=m.CharStrings,g=[],s=e.CFF.readIndex(i,s,g);var _=[];for(c=0;c<g.length-1;c++)_.push(a.readBytes(i,s+g[c],g[c+1]-g[c]));m.CharStrings=_}if(m.ROS){s=m.FDArray;var S=[];for(s=e.CFF.readIndex(i,s,S),m.FDArray=[],c=0;c<S.length-1;c++){var T=e.CFF.readDict(i,s+S[c],s+S[c+1]);e.CFF._readFDict(i,T,x),m.FDArray.push(T)}s+=S[S.length-1],s=m.FDSelect,m.FDSelect=[];var E=i[s];if(s++,E!=3)throw E;var C=a.readUshort(i,s);for(s+=2,c=0;c<C+1;c++)m.FDSelect.push(a.readUshort(i,s),i[s+2]),s+=3}return m.Encoding&&(m.Encoding=e.CFF.readEncoding(i,m.Encoding,m.CharStrings.length)),m.charset&&(m.charset=e.CFF.readCharset(i,m.charset,m.CharStrings.length)),e.CFF._readFDict(i,m,x),m},e.CFF._readFDict=function(i,s,o){var a;for(var l in s.Private&&(a=s.Private[1],s.Private=e.CFF.readDict(i,a,a+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(i,a+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=o[s[l]-426+35])},e.CFF.readSubrs=function(i,s,o){var a=e._bin,l=[];s=e.CFF.readIndex(i,s,l);var u,c=l.length;u=c<1240?107:c<33900?1131:32768,o.Bias=u,o.Subrs=[];for(var h=0;h<l.length-1;h++)o.Subrs.push(a.readBytes(i,s+l[h],l[h+1]-l[h]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,s){for(var o=0;o<i.charset.length;o++)if(i.charset[o]==s)return o;return-1},e.CFF.glyphBySE=function(i,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[s])},e.CFF.readEncoding=function(i,s,o){e._bin;var a=[".notdef"],l=i[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var u=i[s];s++;for(var c=0;c<u;c++)a.push(i[s+c]);return a},e.CFF.readCharset=function(i,s,o){var a=e._bin,l=[".notdef"],u=i[s];if(s++,u==0)for(var c=0;c<o;c++){var h=a.readUshort(i,s);s+=2,l.push(h)}else{if(u!=1&&u!=2)throw"error: format: "+u;for(;l.length<o;){h=a.readUshort(i,s),s+=2;var d=0;for(u==1?(d=i[s],s++):(d=a.readUshort(i,s),s+=2),c=0;c<=d;c++)l.push(h),h++}}return l},e.CFF.readIndex=function(i,s,o){var a=e._bin,l=a.readUshort(i,s)+1,u=i[s+=2];if(s++,u==1)for(var c=0;c<l;c++)o.push(i[s+c]);else if(u==2)for(c=0;c<l;c++)o.push(a.readUshort(i,s+2*c));else if(u==3)for(c=0;c<l;c++)o.push(16777215&a.readUint(i,s+3*c-1));else if(l!=1)throw"unsupported offset size: "+u+", count: "+l;return(s+=l*u)-1},e.CFF.getCharString=function(i,s,o){var a=e._bin,l=i[s],u=i[s+1];i[s+2],i[s+3],i[s+4];var c=1,h=null,d=null;l<=20&&(h=l,c=1),l==12&&(h=100*l+u,c=2),21<=l&&l<=27&&(h=l,c=1),l==28&&(d=a.readShort(i,s+1),c=3),29<=l&&l<=31&&(h=l,c=1),32<=l&&l<=246&&(d=l-139,c=1),247<=l&&l<=250&&(d=256*(l-247)+u+108,c=2),251<=l&&l<=254&&(d=256*-(l-251)-u-108,c=2),l==255&&(d=a.readInt(i,s+1)/65535,c=5),o.val=d??"o"+h,o.size=c},e.CFF.readCharString=function(i,s,o){for(var a=s+o,l=e._bin,u=[];s<a;){var c=i[s],h=i[s+1];i[s+2],i[s+3],i[s+4];var d=1,m=null,g=null;c<=20&&(m=c,d=1),c==12&&(m=100*c+h,d=2),c!=19&&c!=20||(m=c,d=2),21<=c&&c<=27&&(m=c,d=1),c==28&&(g=l.readShort(i,s+1),d=3),29<=c&&c<=31&&(m=c,d=1),32<=c&&c<=246&&(g=c-139,d=1),247<=c&&c<=250&&(g=256*(c-247)+h+108,d=2),251<=c&&c<=254&&(g=256*-(c-251)-h-108,d=2),c==255&&(g=l.readInt(i,s+1)/65535,d=5),u.push(g??"o"+m),s+=d}return u},e.CFF.readDict=function(i,s,o){for(var a=e._bin,l={},u=[];s<o;){var c=i[s],h=i[s+1];i[s+2],i[s+3],i[s+4];var d=1,m=null,g=null;if(c==28&&(g=a.readShort(i,s+1),d=3),c==29&&(g=a.readInt(i,s+1),d=5),32<=c&&c<=246&&(g=c-139,d=1),247<=c&&c<=250&&(g=256*(c-247)+h+108,d=2),251<=c&&c<=254&&(g=256*-(c-251)-h-108,d=2),c==255)throw g=a.readInt(i,s+1)/65535,d=5,"unknown number";if(c==30){var x=[];for(d=1;;){var _=i[s+d];d++;var S=_>>4,T=15&_;if(S!=15&&x.push(S),T!=15&&x.push(T),T==15)break}for(var E="",C=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],R=0;R<x.length;R++)E+=C[x[R]];g=parseFloat(E)}c<=21&&(m=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][c],d=1,c==12&&(m=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][h],d=2)),m!=null?(l[m]=u.length==1?u[0]:u,u=[]):u.push(g),s+=d}return l},e.cmap={},e.cmap.parse=function(i,s,o){i=new Uint8Array(i.buffer,s,o),s=0;var a=e._bin,l={};a.readUshort(i,s),s+=2;var u=a.readUshort(i,s);s+=2;var c=[];l.tables=[];for(var h=0;h<u;h++){var d=a.readUshort(i,s);s+=2;var m=a.readUshort(i,s);s+=2;var g=a.readUint(i,s);s+=4;var x="p"+d+"e"+m,_=c.indexOf(g);if(_==-1){var S;_=l.tables.length,c.push(g);var T=a.readUshort(i,g);T==0?S=e.cmap.parse0(i,g):T==4?S=e.cmap.parse4(i,g):T==6?S=e.cmap.parse6(i,g):T==12?S=e.cmap.parse12(i,g):console.debug("unknown format: "+T,d,m,g),l.tables.push(S)}if(l[x]!=null)throw"multiple tables for one platform+encoding";l[x]=_}return l},e.cmap.parse0=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2,a.map=[];for(var u=0;u<l-6;u++)a.map.push(i[s+u]);return a},e.cmap.parse4=function(i,s){var o=e._bin,a=s,l={};l.format=o.readUshort(i,s),s+=2;var u=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2;var c=o.readUshort(i,s);s+=2;var h=c/2;l.searchRange=o.readUshort(i,s),s+=2,l.entrySelector=o.readUshort(i,s),s+=2,l.rangeShift=o.readUshort(i,s),s+=2,l.endCount=o.readUshorts(i,s,h),s+=2*h,s+=2,l.startCount=o.readUshorts(i,s,h),s+=2*h,l.idDelta=[];for(var d=0;d<h;d++)l.idDelta.push(o.readShort(i,s)),s+=2;for(l.idRangeOffset=o.readUshorts(i,s,h),s+=2*h,l.glyphIdArray=[];s<a+u;)l.glyphIdArray.push(o.readUshort(i,s)),s+=2;return l},e.cmap.parse6=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,a.firstCode=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2,a.glyphIdArray=[];for(var u=0;u<l;u++)a.glyphIdArray.push(o.readUshort(i,s)),s+=2;return a},e.cmap.parse12=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2,s+=2,o.readUint(i,s),s+=4,o.readUint(i,s),s+=4;var l=o.readUint(i,s);s+=4,a.groups=[];for(var u=0;u<l;u++){var c=s+12*u,h=o.readUint(i,c+0),d=o.readUint(i,c+4),m=o.readUint(i,c+8);a.groups.push([h,d,m])}return a},e.glyf={},e.glyf.parse=function(i,s,o,a){for(var l=[],u=0;u<a.maxp.numGlyphs;u++)l.push(null);return l},e.glyf._parseGlyf=function(i,s){var o=e._bin,a=i._data,l=e._tabOffset(a,"glyf",i._offset)+i.loca[s];if(i.loca[s]==i.loca[s+1])return null;var u={};if(u.noc=o.readShort(a,l),l+=2,u.xMin=o.readShort(a,l),l+=2,u.yMin=o.readShort(a,l),l+=2,u.xMax=o.readShort(a,l),l+=2,u.yMax=o.readShort(a,l),l+=2,u.xMin>=u.xMax||u.yMin>=u.yMax)return null;if(u.noc>0){u.endPts=[];for(var c=0;c<u.noc;c++)u.endPts.push(o.readUshort(a,l)),l+=2;var h=o.readUshort(a,l);if(l+=2,a.length-l<h)return null;u.instructions=o.readBytes(a,l,h),l+=h;var d=u.endPts[u.noc-1]+1;for(u.flags=[],c=0;c<d;c++){var m=a[l];if(l++,u.flags.push(m),(8&m)!=0){var g=a[l];l++;for(var x=0;x<g;x++)u.flags.push(m),c++}}for(u.xs=[],c=0;c<d;c++){var _=(2&u.flags[c])!=0,S=(16&u.flags[c])!=0;_?(u.xs.push(S?a[l]:-a[l]),l++):S?u.xs.push(0):(u.xs.push(o.readShort(a,l)),l+=2)}for(u.ys=[],c=0;c<d;c++)_=(4&u.flags[c])!=0,S=(32&u.flags[c])!=0,_?(u.ys.push(S?a[l]:-a[l]),l++):S?u.ys.push(0):(u.ys.push(o.readShort(a,l)),l+=2);var T=0,E=0;for(c=0;c<d;c++)T+=u.xs[c],E+=u.ys[c],u.xs[c]=T,u.ys[c]=E}else{var C;u.parts=[];do{C=o.readUshort(a,l),l+=2;var R={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(u.parts.push(R),R.glyphIndex=o.readUshort(a,l),l+=2,1&C){var P=o.readShort(a,l);l+=2;var L=o.readShort(a,l);l+=2}else P=o.readInt8(a,l),l++,L=o.readInt8(a,l),l++;2&C?(R.m.tx=P,R.m.ty=L):(R.p1=P,R.p2=L),8&C?(R.m.a=R.m.d=o.readF2dot14(a,l),l+=2):64&C?(R.m.a=o.readF2dot14(a,l),l+=2,R.m.d=o.readF2dot14(a,l),l+=2):128&C&&(R.m.a=o.readF2dot14(a,l),l+=2,R.m.b=o.readF2dot14(a,l),l+=2,R.m.c=o.readF2dot14(a,l),l+=2,R.m.d=o.readF2dot14(a,l),l+=2)}while(32&C);if(256&C){var F=o.readUshort(a,l);for(l+=2,u.instr=[],c=0;c<F;c++)u.instr.push(a[l]),l++}}return u},e.GDEF={},e.GDEF.parse=function(i,s,o,a){var l=s;s+=4;var u=e._bin.readUshort(i,s);return{glyphClassDef:u===0?null:e._lctf.readClassDef(i,l+u)}},e.GPOS={},e.GPOS.parse=function(i,s,o,a){return e._lctf.parse(i,s,o,a,e.GPOS.subt)},e.GPOS.subt=function(i,s,o,a){var l=e._bin,u=o,c={};if(c.fmt=l.readUshort(i,o),o+=2,s==1||s==2||s==3||s==7||s==8&&c.fmt<=2){var h=l.readUshort(i,o);o+=2,c.coverage=e._lctf.readCoverage(i,h+u)}if(s==1&&c.fmt==1){var d=l.readUshort(i,o);o+=2,d!=0&&(c.pos=e.GPOS.readValueRecord(i,o,d))}else if(s==2&&c.fmt>=1&&c.fmt<=2){d=l.readUshort(i,o),o+=2;var m=l.readUshort(i,o);o+=2;var g=e._lctf.numOfOnes(d),x=e._lctf.numOfOnes(m);if(c.fmt==1){c.pairsets=[];var _=l.readUshort(i,o);o+=2;for(var S=0;S<_;S++){var T=u+l.readUshort(i,o);o+=2;var E=l.readUshort(i,T);T+=2;for(var C=[],R=0;R<E;R++){var P=l.readUshort(i,T);T+=2,d!=0&&(V=e.GPOS.readValueRecord(i,T,d),T+=2*g),m!=0&&(q=e.GPOS.readValueRecord(i,T,m),T+=2*x),C.push({gid2:P,val1:V,val2:q})}c.pairsets.push(C)}}if(c.fmt==2){var L=l.readUshort(i,o);o+=2;var F=l.readUshort(i,o);o+=2;var D=l.readUshort(i,o);o+=2;var I=l.readUshort(i,o);for(o+=2,c.classDef1=e._lctf.readClassDef(i,u+L),c.classDef2=e._lctf.readClassDef(i,u+F),c.matrix=[],S=0;S<D;S++){var N=[];for(R=0;R<I;R++){var V=null,q=null;d!=0&&(V=e.GPOS.readValueRecord(i,o,d),o+=2*g),m!=0&&(q=e.GPOS.readValueRecord(i,o,m),o+=2*x),N.push({val1:V,val2:q})}c.matrix.push(N)}}}else if(s==4&&c.fmt==1)c.markCoverage=e._lctf.readCoverage(i,l.readUshort(i,o)+u),c.baseCoverage=e._lctf.readCoverage(i,l.readUshort(i,o+2)+u),c.markClassCount=l.readUshort(i,o+4),c.markArray=e.GPOS.readMarkArray(i,l.readUshort(i,o+6)+u),c.baseArray=e.GPOS.readBaseArray(i,l.readUshort(i,o+8)+u,c.markClassCount);else if(s==6&&c.fmt==1)c.mark1Coverage=e._lctf.readCoverage(i,l.readUshort(i,o)+u),c.mark2Coverage=e._lctf.readCoverage(i,l.readUshort(i,o+2)+u),c.markClassCount=l.readUshort(i,o+4),c.mark1Array=e.GPOS.readMarkArray(i,l.readUshort(i,o+6)+u),c.mark2Array=e.GPOS.readBaseArray(i,l.readUshort(i,o+8)+u,c.markClassCount);else{if(s==9&&c.fmt==1){var Q=l.readUshort(i,o);o+=2;var re=l.readUint(i,o);if(o+=4,a.ltype==9)a.ltype=Q;else if(a.ltype!=Q)throw"invalid extension substitution";return e.GPOS.subt(i,a.ltype,u+re)}console.debug("unsupported GPOS table LookupType",s,"format",c.fmt)}return c},e.GPOS.readValueRecord=function(i,s,o){var a=e._bin,l=[];return l.push(1&o?a.readShort(i,s):0),s+=1&o?2:0,l.push(2&o?a.readShort(i,s):0),s+=2&o?2:0,l.push(4&o?a.readShort(i,s):0),s+=4&o?2:0,l.push(8&o?a.readShort(i,s):0),s+=8&o?2:0,l},e.GPOS.readBaseArray=function(i,s,o){var a=e._bin,l=[],u=s,c=a.readUshort(i,s);s+=2;for(var h=0;h<c;h++){for(var d=[],m=0;m<o;m++)d.push(e.GPOS.readAnchorRecord(i,u+a.readUshort(i,s))),s+=2;l.push(d)}return l},e.GPOS.readMarkArray=function(i,s){var o=e._bin,a=[],l=s,u=o.readUshort(i,s);s+=2;for(var c=0;c<u;c++){var h=e.GPOS.readAnchorRecord(i,o.readUshort(i,s+2)+l);h.markClass=o.readUshort(i,s),a.push(h),s+=4}return a},e.GPOS.readAnchorRecord=function(i,s){var o=e._bin,a={};return a.fmt=o.readUshort(i,s),a.x=o.readShort(i,s+2),a.y=o.readShort(i,s+4),a},e.GSUB={},e.GSUB.parse=function(i,s,o,a){return e._lctf.parse(i,s,o,a,e.GSUB.subt)},e.GSUB.subt=function(i,s,o,a){var l=e._bin,u=o,c={};if(c.fmt=l.readUshort(i,o),o+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&c.fmt<=2||s==6&&c.fmt<=2){var h=l.readUshort(i,o);o+=2,c.coverage=e._lctf.readCoverage(i,u+h)}if(s==1&&c.fmt>=1&&c.fmt<=2){if(c.fmt==1)c.delta=l.readShort(i,o),o+=2;else if(c.fmt==2){var d=l.readUshort(i,o);o+=2,c.newg=l.readUshorts(i,o,d),o+=2*c.newg.length}}else if(s==2&&c.fmt==1){d=l.readUshort(i,o),o+=2,c.seqs=[];for(var m=0;m<d;m++){var g=l.readUshort(i,o)+u;o+=2;var x=l.readUshort(i,g);c.seqs.push(l.readUshorts(i,g+2,x))}}else if(s==4)for(c.vals=[],d=l.readUshort(i,o),o+=2,m=0;m<d;m++){var _=l.readUshort(i,o);o+=2,c.vals.push(e.GSUB.readLigatureSet(i,u+_))}else if(s==5&&c.fmt==2){if(c.fmt==2){var S=l.readUshort(i,o);o+=2,c.cDef=e._lctf.readClassDef(i,u+S),c.scset=[];var T=l.readUshort(i,o);for(o+=2,m=0;m<T;m++){var E=l.readUshort(i,o);o+=2,c.scset.push(E==0?null:e.GSUB.readSubClassSet(i,u+E))}}}else if(s==6&&c.fmt==3){if(c.fmt==3){for(m=0;m<3;m++){d=l.readUshort(i,o),o+=2;for(var C=[],R=0;R<d;R++)C.push(e._lctf.readCoverage(i,u+l.readUshort(i,o+2*R)));o+=2*d,m==0&&(c.backCvg=C),m==1&&(c.inptCvg=C),m==2&&(c.ahedCvg=C)}d=l.readUshort(i,o),o+=2,c.lookupRec=e.GSUB.readSubstLookupRecords(i,o,d)}}else{if(s==7&&c.fmt==1){var P=l.readUshort(i,o);o+=2;var L=l.readUint(i,o);if(o+=4,a.ltype==9)a.ltype=P;else if(a.ltype!=P)throw"invalid extension substitution";return e.GSUB.subt(i,a.ltype,u+L)}console.debug("unsupported GSUB table LookupType",s,"format",c.fmt)}return c},e.GSUB.readSubClassSet=function(i,s){var o=e._bin.readUshort,a=s,l=[],u=o(i,s);s+=2;for(var c=0;c<u;c++){var h=o(i,s);s+=2,l.push(e.GSUB.readSubClassRule(i,a+h))}return l},e.GSUB.readSubClassRule=function(i,s){var o=e._bin.readUshort,a={},l=o(i,s),u=o(i,s+=2);s+=2,a.input=[];for(var c=0;c<l-1;c++)a.input.push(o(i,s)),s+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(i,s,u),a},e.GSUB.readSubstLookupRecords=function(i,s,o){for(var a=e._bin.readUshort,l=[],u=0;u<o;u++)l.push(a(i,s),a(i,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(i,s){var o=e._bin,a=s,l=[],u=o.readUshort(i,s);s+=2;for(var c=0;c<u;c++){var h=o.readUshort(i,s);s+=2,l.push(e.GSUB.readChainSubClassRule(i,a+h))}return l},e.GSUB.readChainSubClassRule=function(i,s){for(var o=e._bin,a={},l=["backtrack","input","lookahead"],u=0;u<l.length;u++){var c=o.readUshort(i,s);s+=2,u==1&&c--,a[l[u]]=o.readUshorts(i,s,c),s+=2*a[l[u]].length}return c=o.readUshort(i,s),s+=2,a.subst=o.readUshorts(i,s,2*c),s+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(i,s){var o=e._bin,a=s,l=[],u=o.readUshort(i,s);s+=2;for(var c=0;c<u;c++){var h=o.readUshort(i,s);s+=2,l.push(e.GSUB.readLigature(i,a+h))}return l},e.GSUB.readLigature=function(i,s){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2;for(var u=0;u<l-1;u++)a.chain.push(o.readUshort(i,s)),s+=2;return a},e.head={},e.head.parse=function(i,s,o){var a=e._bin,l={};return a.readFixed(i,s),s+=4,l.fontRevision=a.readFixed(i,s),s+=4,a.readUint(i,s),s+=4,a.readUint(i,s),s+=4,l.flags=a.readUshort(i,s),s+=2,l.unitsPerEm=a.readUshort(i,s),s+=2,l.created=a.readUint64(i,s),s+=8,l.modified=a.readUint64(i,s),s+=8,l.xMin=a.readShort(i,s),s+=2,l.yMin=a.readShort(i,s),s+=2,l.xMax=a.readShort(i,s),s+=2,l.yMax=a.readShort(i,s),s+=2,l.macStyle=a.readUshort(i,s),s+=2,l.lowestRecPPEM=a.readUshort(i,s),s+=2,l.fontDirectionHint=a.readShort(i,s),s+=2,l.indexToLocFormat=a.readShort(i,s),s+=2,l.glyphDataFormat=a.readShort(i,s),s+=2,l},e.hhea={},e.hhea.parse=function(i,s,o){var a=e._bin,l={};return a.readFixed(i,s),s+=4,l.ascender=a.readShort(i,s),s+=2,l.descender=a.readShort(i,s),s+=2,l.lineGap=a.readShort(i,s),s+=2,l.advanceWidthMax=a.readUshort(i,s),s+=2,l.minLeftSideBearing=a.readShort(i,s),s+=2,l.minRightSideBearing=a.readShort(i,s),s+=2,l.xMaxExtent=a.readShort(i,s),s+=2,l.caretSlopeRise=a.readShort(i,s),s+=2,l.caretSlopeRun=a.readShort(i,s),s+=2,l.caretOffset=a.readShort(i,s),s+=2,s+=8,l.metricDataFormat=a.readShort(i,s),s+=2,l.numberOfHMetrics=a.readUshort(i,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(i,s,o,a){for(var l=e._bin,u={aWidth:[],lsBearing:[]},c=0,h=0,d=0;d<a.maxp.numGlyphs;d++)d<a.hhea.numberOfHMetrics&&(c=l.readUshort(i,s),s+=2,h=l.readShort(i,s),s+=2),u.aWidth.push(c),u.lsBearing.push(h);return u},e.kern={},e.kern.parse=function(i,s,o,a){var l=e._bin,u=l.readUshort(i,s);if(s+=2,u==1)return e.kern.parseV1(i,s-2,o,a);var c=l.readUshort(i,s);s+=2;for(var h={glyph1:[],rval:[]},d=0;d<c;d++){s+=2,o=l.readUshort(i,s),s+=2;var m=l.readUshort(i,s);s+=2;var g=m>>>8;if((g&=15)!=0)throw"unknown kern table format: "+g;s=e.kern.readFormat0(i,s,h)}return h},e.kern.parseV1=function(i,s,o,a){var l=e._bin;l.readFixed(i,s),s+=4;var u=l.readUint(i,s);s+=4;for(var c={glyph1:[],rval:[]},h=0;h<u;h++){l.readUint(i,s),s+=4;var d=l.readUshort(i,s);s+=2,l.readUshort(i,s),s+=2;var m=d>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;s=e.kern.readFormat0(i,s,c)}return c},e.kern.readFormat0=function(i,s,o){var a=e._bin,l=-1,u=a.readUshort(i,s);s+=2,a.readUshort(i,s),s+=2,a.readUshort(i,s),s+=2,a.readUshort(i,s),s+=2;for(var c=0;c<u;c++){var h=a.readUshort(i,s);s+=2;var d=a.readUshort(i,s);s+=2;var m=a.readShort(i,s);s+=2,h!=l&&(o.glyph1.push(h),o.rval.push({glyph2:[],vals:[]}));var g=o.rval[o.rval.length-1];g.glyph2.push(d),g.vals.push(m),l=h}return s},e.loca={},e.loca.parse=function(i,s,o,a){var l=e._bin,u=[],c=a.head.indexToLocFormat,h=a.maxp.numGlyphs+1;if(c==0)for(var d=0;d<h;d++)u.push(l.readUshort(i,s+(d<<1))<<1);if(c==1)for(d=0;d<h;d++)u.push(l.readUint(i,s+(d<<2)));return u},e.maxp={},e.maxp.parse=function(i,s,o){var a=e._bin,l={},u=a.readUint(i,s);return s+=4,l.numGlyphs=a.readUshort(i,s),s+=2,u==65536&&(l.maxPoints=a.readUshort(i,s),s+=2,l.maxContours=a.readUshort(i,s),s+=2,l.maxCompositePoints=a.readUshort(i,s),s+=2,l.maxCompositeContours=a.readUshort(i,s),s+=2,l.maxZones=a.readUshort(i,s),s+=2,l.maxTwilightPoints=a.readUshort(i,s),s+=2,l.maxStorage=a.readUshort(i,s),s+=2,l.maxFunctionDefs=a.readUshort(i,s),s+=2,l.maxInstructionDefs=a.readUshort(i,s),s+=2,l.maxStackElements=a.readUshort(i,s),s+=2,l.maxSizeOfInstructions=a.readUshort(i,s),s+=2,l.maxComponentElements=a.readUshort(i,s),s+=2,l.maxComponentDepth=a.readUshort(i,s),s+=2),l},e.name={},e.name.parse=function(i,s,o){var a=e._bin,l={};a.readUshort(i,s),s+=2;var u=a.readUshort(i,s);s+=2,a.readUshort(i,s);for(var c,h=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=s+=2,m=0;m<u;m++){var g=a.readUshort(i,s);s+=2;var x=a.readUshort(i,s);s+=2;var _=a.readUshort(i,s);s+=2;var S=a.readUshort(i,s);s+=2;var T=a.readUshort(i,s);s+=2;var E=a.readUshort(i,s);s+=2;var C,R=h[S],P=d+12*u+E;if(g==0)C=a.readUnicode(i,P,T/2);else if(g==3&&x==0)C=a.readUnicode(i,P,T/2);else if(x==0)C=a.readASCII(i,P,T);else if(x==1)C=a.readUnicode(i,P,T/2);else if(x==3)C=a.readUnicode(i,P,T/2);else{if(g!=1)throw"unknown encoding "+x+", platformID: "+g;C=a.readASCII(i,P,T),console.debug("reading unknown MAC encoding "+x+" as ASCII")}var L="p"+g+","+_.toString(16);l[L]==null&&(l[L]={}),l[L][R!==void 0?R:S]=C,l[L]._lang=_}for(var F in l)if(l[F].postScriptName!=null&&l[F]._lang==1033)return l[F];for(var F in l)if(l[F].postScriptName!=null&&l[F]._lang==0)return l[F];for(var F in l)if(l[F].postScriptName!=null&&l[F]._lang==3084)return l[F];for(var F in l)if(l[F].postScriptName!=null)return l[F];for(var F in l){c=F;break}return console.debug("returning name table with languageID "+l[c]._lang),l[c]},e["OS/2"]={},e["OS/2"].parse=function(i,s,o){var a=e._bin.readUshort(i,s);s+=2;var l={};if(a==0)e["OS/2"].version0(i,s,l);else if(a==1)e["OS/2"].version1(i,s,l);else if(a==2||a==3||a==4)e["OS/2"].version2(i,s,l);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(i,s,l)}return l},e["OS/2"].version0=function(i,s,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(i,s),s+=2,o.usWeightClass=a.readUshort(i,s),s+=2,o.usWidthClass=a.readUshort(i,s),s+=2,o.fsType=a.readUshort(i,s),s+=2,o.ySubscriptXSize=a.readShort(i,s),s+=2,o.ySubscriptYSize=a.readShort(i,s),s+=2,o.ySubscriptXOffset=a.readShort(i,s),s+=2,o.ySubscriptYOffset=a.readShort(i,s),s+=2,o.ySuperscriptXSize=a.readShort(i,s),s+=2,o.ySuperscriptYSize=a.readShort(i,s),s+=2,o.ySuperscriptXOffset=a.readShort(i,s),s+=2,o.ySuperscriptYOffset=a.readShort(i,s),s+=2,o.yStrikeoutSize=a.readShort(i,s),s+=2,o.yStrikeoutPosition=a.readShort(i,s),s+=2,o.sFamilyClass=a.readShort(i,s),s+=2,o.panose=a.readBytes(i,s,10),s+=10,o.ulUnicodeRange1=a.readUint(i,s),s+=4,o.ulUnicodeRange2=a.readUint(i,s),s+=4,o.ulUnicodeRange3=a.readUint(i,s),s+=4,o.ulUnicodeRange4=a.readUint(i,s),s+=4,o.achVendID=[a.readInt8(i,s),a.readInt8(i,s+1),a.readInt8(i,s+2),a.readInt8(i,s+3)],s+=4,o.fsSelection=a.readUshort(i,s),s+=2,o.usFirstCharIndex=a.readUshort(i,s),s+=2,o.usLastCharIndex=a.readUshort(i,s),s+=2,o.sTypoAscender=a.readShort(i,s),s+=2,o.sTypoDescender=a.readShort(i,s),s+=2,o.sTypoLineGap=a.readShort(i,s),s+=2,o.usWinAscent=a.readUshort(i,s),s+=2,o.usWinDescent=a.readUshort(i,s),s+=2},e["OS/2"].version1=function(i,s,o){var a=e._bin;return s=e["OS/2"].version0(i,s,o),o.ulCodePageRange1=a.readUint(i,s),s+=4,o.ulCodePageRange2=a.readUint(i,s),s+=4},e["OS/2"].version2=function(i,s,o){var a=e._bin;return s=e["OS/2"].version1(i,s,o),o.sxHeight=a.readShort(i,s),s+=2,o.sCapHeight=a.readShort(i,s),s+=2,o.usDefault=a.readUshort(i,s),s+=2,o.usBreak=a.readUshort(i,s),s+=2,o.usMaxContext=a.readUshort(i,s),s+=2},e["OS/2"].version5=function(i,s,o){var a=e._bin;return s=e["OS/2"].version2(i,s,o),o.usLowerOpticalPointSize=a.readUshort(i,s),s+=2,o.usUpperOpticalPointSize=a.readUshort(i,s),s+=2},e.post={},e.post.parse=function(i,s,o){var a=e._bin,l={};return l.version=a.readFixed(i,s),s+=4,l.italicAngle=a.readFixed(i,s),s+=4,l.underlinePosition=a.readShort(i,s),s+=2,l.underlineThickness=a.readShort(i,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,s){var o=i.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var l=o.tables[a];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var u=-1,c=0;c<l.endCount.length;c++)if(s<=l.endCount[c]){u=c;break}return u==-1||l.startCount[u]>s?0:65535&(l.idRangeOffset[u]!=0?l.glyphIdArray[s-l.startCount[u]+(l.idRangeOffset[u]>>1)-(l.idRangeOffset.length-u)]:s+l.idDelta[u])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(c=0;c<l.groups.length;c++){var h=l.groups[c];if(h[0]<=s&&s<=h[1])return h[2]+(s-h[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(i,s){var o={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[s]){var a=i.SVG.entries[s];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),i.SVG.entries[s]=a),a)}if(i.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},u=i.CFF,c=i.CFF.Private;if(u.ROS){for(var h=0;u.FDSelect[h+2]<=s;)h+=2;c=u.FDArray[u.FDSelect[h+1]].Private}e.U._drawCFF(i.CFF.CharStrings[s],l,u,c,o)}else i.glyf&&e.U._drawGlyf(s,i,o);return o},e.U._drawGlyf=function(i,s,o){var a=s.glyf[i];a==null&&(a=s.glyf[i]=e.glyf._parseGlyf(s,i)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,s,o))},e.U._simpleGlyph=function(i,s){for(var o=0;o<i.noc;o++){for(var a=o==0?0:i.endPts[o-1]+1,l=i.endPts[o],u=a;u<=l;u++){var c=u==a?l:u-1,h=u==l?a:u+1,d=1&i.flags[u],m=1&i.flags[c],g=1&i.flags[h],x=i.xs[u],_=i.ys[u];if(u==a)if(d){if(!m){e.U.P.moveTo(s,x,_);continue}e.U.P.moveTo(s,i.xs[c],i.ys[c])}else m?e.U.P.moveTo(s,i.xs[c],i.ys[c]):e.U.P.moveTo(s,(i.xs[c]+x)/2,(i.ys[c]+_)/2);d?m&&e.U.P.lineTo(s,x,_):g?e.U.P.qcurveTo(s,x,_,i.xs[h],i.ys[h]):e.U.P.qcurveTo(s,x,_,(x+i.xs[h])/2,(_+i.ys[h])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(i,s,o){for(var a=0;a<i.parts.length;a++){var l={cmds:[],crds:[]},u=i.parts[a];e.U._drawGlyf(u.glyphIndex,s,l);for(var c=u.m,h=0;h<l.crds.length;h+=2){var d=l.crds[h],m=l.crds[h+1];o.crds.push(d*c.a+m*c.b+c.tx),o.crds.push(d*c.c+m*c.d+c.ty)}for(h=0;h<l.cmds.length;h++)o.cmds.push(l.cmds[h])}},e.U._getGlyphClass=function(i,s){var o=e._lctf.getInterval(s,i);return o==-1?0:s[o+2]},e.U._applySubs=function(i,s,o,a){for(var l=i.length-s-1,u=0;u<o.tabs.length;u++)if(o.tabs[u]!=null){var c,h=o.tabs[u];if(!h.coverage||(c=e._lctf.coverageIndex(h.coverage,i[s]))!=-1){if(o.ltype==1)i[s],h.fmt==1?i[s]=i[s]+h.delta:i[s]=h.newg[c];else if(o.ltype==4)for(var d=h.vals[c],m=0;m<d.length;m++){var g=d[m],x=g.chain.length;if(!(x>l)){for(var _=!0,S=0,T=0;T<x;T++){for(;i[s+S+(1+T)]==-1;)S++;g.chain[T]!=i[s+S+(1+T)]&&(_=!1)}if(_){for(i[s]=g.nglyph,T=0;T<x+S;T++)i[s+T+1]=-1;break}}}else if(o.ltype==5&&h.fmt==2)for(var E=e._lctf.getInterval(h.cDef,i[s]),C=h.cDef[E+2],R=h.scset[C],P=0;P<R.length;P++){var L=R[P],F=L.input;if(!(F.length>l)){for(_=!0,T=0;T<F.length;T++){var D=e._lctf.getInterval(h.cDef,i[s+1+T]);if(E==-1&&h.cDef[D+2]!=F[T]){_=!1;break}}if(_){var I=L.substLookupRecords;for(m=0;m<I.length;m+=2)I[m],I[m+1]}}}else if(o.ltype==6&&h.fmt==3){if(!e.U._glsCovered(i,h.backCvg,s-h.backCvg.length)||!e.U._glsCovered(i,h.inptCvg,s)||!e.U._glsCovered(i,h.ahedCvg,s+h.inptCvg.length))continue;var N=h.lookupRec;for(P=0;P<N.length;P+=2){E=N[P];var V=a[N[P+1]];e.U._applySubs(i,s+E,V,a)}}}}},e.U._glsCovered=function(i,s,o){for(var a=0;a<s.length;a++)if(e._lctf.coverageIndex(s[a],i[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(i,s,o){for(var a={cmds:[],crds:[]},l=0,u=0;u<s.length;u++){var c=s[u];if(c!=-1){for(var h=u<s.length-1&&s[u+1]!=-1?s[u+1]:0,d=e.U.glyphToPath(i,c),m=0;m<d.crds.length;m+=2)a.crds.push(d.crds[m]+l),a.crds.push(d.crds[m+1]);for(o&&a.cmds.push(o),m=0;m<d.cmds.length;m++)a.cmds.push(d.cmds[m]);o&&a.cmds.push("X"),l+=i.hmtx.aWidth[c],u<s.length-1&&(l+=e.U.getPairAdjustment(i,c,h))}}return a},e.U.P={},e.U.P.moveTo=function(i,s,o){i.cmds.push("M"),i.crds.push(s,o)},e.U.P.lineTo=function(i,s,o){i.cmds.push("L"),i.crds.push(s,o)},e.U.P.curveTo=function(i,s,o,a,l,u,c){i.cmds.push("C"),i.crds.push(s,o,a,l,u,c)},e.U.P.qcurveTo=function(i,s,o,a,l){i.cmds.push("Q"),i.crds.push(s,o,a,l)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,s,o,a,l){for(var u=s.stack,c=s.nStems,h=s.haveWidth,d=s.width,m=s.open,g=0,x=s.x,_=s.y,S=0,T=0,E=0,C=0,R=0,P=0,L=0,F=0,D=0,I=0,N={val:0,size:0};g<i.length;){e.CFF.getCharString(i,g,N);var V=N.val;if(g+=N.size,V=="o1"||V=="o18")u.length%2!=0&&!h&&(d=u.shift()+a.nominalWidthX),c+=u.length>>1,u.length=0,h=!0;else if(V=="o3"||V=="o23")u.length%2!=0&&!h&&(d=u.shift()+a.nominalWidthX),c+=u.length>>1,u.length=0,h=!0;else if(V=="o4")u.length>1&&!h&&(d=u.shift()+a.nominalWidthX,h=!0),m&&e.U.P.closePath(l),_+=u.pop(),e.U.P.moveTo(l,x,_),m=!0;else if(V=="o5")for(;u.length>0;)x+=u.shift(),_+=u.shift(),e.U.P.lineTo(l,x,_);else if(V=="o6"||V=="o7")for(var q=u.length,Q=V=="o6",re=0;re<q;re++){var ee=u.shift();Q?x+=ee:_+=ee,Q=!Q,e.U.P.lineTo(l,x,_)}else if(V=="o8"||V=="o24"){q=u.length;for(var se=0;se+6<=q;)S=x+u.shift(),T=_+u.shift(),E=S+u.shift(),C=T+u.shift(),x=E+u.shift(),_=C+u.shift(),e.U.P.curveTo(l,S,T,E,C,x,_),se+=6;V=="o24"&&(x+=u.shift(),_+=u.shift(),e.U.P.lineTo(l,x,_))}else{if(V=="o11")break;if(V=="o1234"||V=="o1235"||V=="o1236"||V=="o1237")V=="o1234"&&(T=_,E=(S=x+u.shift())+u.shift(),I=C=T+u.shift(),P=C,F=_,x=(L=(R=(D=E+u.shift())+u.shift())+u.shift())+u.shift(),e.U.P.curveTo(l,S,T,E,C,D,I),e.U.P.curveTo(l,R,P,L,F,x,_)),V=="o1235"&&(S=x+u.shift(),T=_+u.shift(),E=S+u.shift(),C=T+u.shift(),D=E+u.shift(),I=C+u.shift(),R=D+u.shift(),P=I+u.shift(),L=R+u.shift(),F=P+u.shift(),x=L+u.shift(),_=F+u.shift(),u.shift(),e.U.P.curveTo(l,S,T,E,C,D,I),e.U.P.curveTo(l,R,P,L,F,x,_)),V=="o1236"&&(S=x+u.shift(),T=_+u.shift(),E=S+u.shift(),I=C=T+u.shift(),P=C,L=(R=(D=E+u.shift())+u.shift())+u.shift(),F=P+u.shift(),x=L+u.shift(),e.U.P.curveTo(l,S,T,E,C,D,I),e.U.P.curveTo(l,R,P,L,F,x,_)),V=="o1237"&&(S=x+u.shift(),T=_+u.shift(),E=S+u.shift(),C=T+u.shift(),D=E+u.shift(),I=C+u.shift(),R=D+u.shift(),P=I+u.shift(),L=R+u.shift(),F=P+u.shift(),Math.abs(L-x)>Math.abs(F-_)?x=L+u.shift():_=F+u.shift(),e.U.P.curveTo(l,S,T,E,C,D,I),e.U.P.curveTo(l,R,P,L,F,x,_));else if(V=="o14"){if(u.length>0&&!h&&(d=u.shift()+o.nominalWidthX,h=!0),u.length==4){var W=u.shift(),$=u.shift(),j=u.shift(),U=u.shift(),X=e.CFF.glyphBySE(o,j),le=e.CFF.glyphBySE(o,U);e.U._drawCFF(o.CharStrings[X],s,o,a,l),s.x=W,s.y=$,e.U._drawCFF(o.CharStrings[le],s,o,a,l)}m&&(e.U.P.closePath(l),m=!1)}else if(V=="o19"||V=="o20")u.length%2!=0&&!h&&(d=u.shift()+a.nominalWidthX),c+=u.length>>1,u.length=0,h=!0,g+=c+7>>3;else if(V=="o21")u.length>2&&!h&&(d=u.shift()+a.nominalWidthX,h=!0),_+=u.pop(),x+=u.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,x,_),m=!0;else if(V=="o22")u.length>1&&!h&&(d=u.shift()+a.nominalWidthX,h=!0),x+=u.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,x,_),m=!0;else if(V=="o25"){for(;u.length>6;)x+=u.shift(),_+=u.shift(),e.U.P.lineTo(l,x,_);S=x+u.shift(),T=_+u.shift(),E=S+u.shift(),C=T+u.shift(),x=E+u.shift(),_=C+u.shift(),e.U.P.curveTo(l,S,T,E,C,x,_)}else if(V=="o26")for(u.length%2&&(x+=u.shift());u.length>0;)S=x,T=_+u.shift(),x=E=S+u.shift(),_=(C=T+u.shift())+u.shift(),e.U.P.curveTo(l,S,T,E,C,x,_);else if(V=="o27")for(u.length%2&&(_+=u.shift());u.length>0;)T=_,E=(S=x+u.shift())+u.shift(),C=T+u.shift(),x=E+u.shift(),_=C,e.U.P.curveTo(l,S,T,E,C,x,_);else if(V=="o10"||V=="o29"){var Z=V=="o10"?a:o;if(u.length==0)console.debug("error: empty stack");else{var oe=u.pop(),pe=Z.Subrs[oe+Z.Bias];s.x=x,s.y=_,s.nStems=c,s.haveWidth=h,s.width=d,s.open=m,e.U._drawCFF(pe,s,o,a,l),x=s.x,_=s.y,c=s.nStems,h=s.haveWidth,d=s.width,m=s.open}}else if(V=="o30"||V=="o31"){var de=u.length,ye=(se=0,V=="o31");for(se+=de-(q=-3&de);se<q;)ye?(T=_,E=(S=x+u.shift())+u.shift(),_=(C=T+u.shift())+u.shift(),q-se==5?(x=E+u.shift(),se++):x=E,ye=!1):(S=x,T=_+u.shift(),E=S+u.shift(),C=T+u.shift(),x=E+u.shift(),q-se==5?(_=C+u.shift(),se++):_=C,ye=!0),e.U.P.curveTo(l,S,T,E,C,x,_),se+=4}else{if((V+"").charAt(0)=="o")throw console.debug("Unknown operation: "+V,i),V;u.push(V)}}}s.x=x,s.y=_,s.nStems=c,s.haveWidth=h,s.width=d,s.open=m};var t=e,n={Typr:t};return r.Typr=t,r.default=n,Object.defineProperty(r,"__esModule",{value:!0}),r}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function wK(){return function(r){var e=Uint8Array,t=Uint16Array,n=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(V,q){for(var Q=new t(31),re=0;re<31;++re)Q[re]=q+=1<<V[re-1];var ee=new n(Q[30]);for(re=1;re<30;++re)for(var se=Q[re];se<Q[re+1];++se)ee[se]=se-Q[re]<<5|re;return[Q,ee]},l=a(i,2),u=l[0],c=l[1];u[28]=258,c[258]=28;for(var h=a(s,0)[0],d=new t(32768),m=0;m<32768;++m){var g=(43690&m)>>>1|(21845&m)<<1;g=(61680&(g=(52428&g)>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,d[m]=((65280&g)>>>8|(255&g)<<8)>>>1}var x=function(V,q,Q){for(var re=V.length,ee=0,se=new t(q);ee<re;++ee)++se[V[ee]-1];var W,$=new t(q);for(ee=0;ee<q;++ee)$[ee]=$[ee-1]+se[ee-1]<<1;{W=new t(1<<q);var j=15-q;for(ee=0;ee<re;++ee)if(V[ee])for(var U=ee<<4|V[ee],X=q-V[ee],le=$[V[ee]-1]++<<X,Z=le|(1<<X)-1;le<=Z;++le)W[d[le]>>>j]=U}return W},_=new e(288);for(m=0;m<144;++m)_[m]=8;for(m=144;m<256;++m)_[m]=9;for(m=256;m<280;++m)_[m]=7;for(m=280;m<288;++m)_[m]=8;var S=new e(32);for(m=0;m<32;++m)S[m]=5;var T=x(_,9),E=x(S,5),C=function(V){for(var q=V[0],Q=1;Q<V.length;++Q)V[Q]>q&&(q=V[Q]);return q},R=function(V,q,Q){var re=q/8|0;return(V[re]|V[re+1]<<8)>>(7&q)&Q},P=function(V,q){var Q=q/8|0;return(V[Q]|V[Q+1]<<8|V[Q+2]<<16)>>(7&q)},L=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(V,q,Q){var re=new Error(q||L[V]);if(re.code=V,Error.captureStackTrace&&Error.captureStackTrace(re,F),!Q)throw re;return re},D=function(V,q,Q){var re=V.length;if(!re||Q&&!Q.l&&re<5)return q||new e(0);var ee=!q||Q,se=!Q||Q.i;Q||(Q={}),q||(q=new e(3*re));var W,$=function(rt){var fe=q.length;if(rt>fe){var Je=new e(Math.max(2*fe,rt));Je.set(q),q=Je}},j=Q.f||0,U=Q.p||0,X=Q.b||0,le=Q.l,Z=Q.d,oe=Q.m,pe=Q.n,de=8*re;do{if(!le){Q.f=j=R(V,U,1);var ye=R(V,U+1,3);if(U+=3,!ye){var Ge=V[(te=((W=U)/8|0)+(7&W&&1)+4)-4]|V[te-3]<<8,Ke=te+Ge;if(Ke>re){se&&F(0);break}ee&&$(X+Ge),q.set(V.subarray(te,Ke),X),Q.b=X+=Ge,Q.p=U=8*Ke;continue}if(ye==1)le=T,Z=E,oe=9,pe=5;else if(ye==2){var De=R(V,U,31)+257,K=R(V,U+10,15)+4,Pe=De+R(V,U+5,31)+1;U+=14;for(var Be=new e(Pe),Xe=new e(19),ve=0;ve<K;++ve)Xe[o[ve]]=R(V,U+3*ve,7);U+=3*K;var et=C(Xe),Ce=(1<<et)-1,We=x(Xe,et);for(ve=0;ve<Pe;){var te,z=We[R(V,U,Ce)];if(U+=15&z,(te=z>>>4)<16)Be[ve++]=te;else{var me=0,_e=0;for(te==16?(_e=3+R(V,U,3),U+=2,me=Be[ve-1]):te==17?(_e=3+R(V,U,7),U+=3):te==18&&(_e=11+R(V,U,127),U+=7);_e--;)Be[ve++]=me}}var Ee=Be.subarray(0,De),we=Be.subarray(De);oe=C(Ee),pe=C(we),le=x(Ee,oe),Z=x(we,pe)}else F(1);if(U>de){se&&F(0);break}}ee&&$(X+131072);for(var ut=(1<<oe)-1,ke=(1<<pe)-1,Ze=U;;Ze=U){var lt=(me=le[P(V,U)&ut])>>>4;if((U+=15&me)>de){se&&F(0);break}if(me||F(2),lt<256)q[X++]=lt;else{if(lt==256){Ze=U,le=null;break}var Ye=lt-254;if(lt>264){var nt=i[ve=lt-257];Ye=R(V,U,(1<<nt)-1)+u[ve],U+=nt}var Ct=Z[P(V,U)&ke],ht=Ct>>>4;if(Ct||F(3),U+=15&Ct,we=h[ht],ht>3&&(nt=s[ht],we+=P(V,U)&(1<<nt)-1,U+=nt),U>de){se&&F(0);break}ee&&$(X+131072);for(var it=X+Ye;X<it;X+=4)q[X]=q[X-we],q[X+1]=q[X+1-we],q[X+2]=q[X+2-we],q[X+3]=q[X+3-we];X=it}}Q.l=le,Q.p=Ze,Q.b=X,le&&(j=1,Q.m=oe,Q.d=Z,Q.n=pe)}while(!j);return X==q.length?q:function(rt,fe,Je){(Je==null||Je>rt.length)&&(Je=rt.length);var ce=new(rt instanceof t?t:rt instanceof n?n:e)(Je-fe);return ce.set(rt.subarray(fe,Je)),ce}(q,0,X)},I=new e(0),N=typeof TextDecoder<"u"&&new TextDecoder;try{N.decode(I,{stream:!0})}catch{}return r.convert_streams=function(V){var q=new DataView(V),Q=0;function re(){var De=q.getUint16(Q);return Q+=2,De}function ee(){var De=q.getUint32(Q);return Q+=4,De}function se(De){Ge.setUint16(Ke,De),Ke+=2}function W(De){Ge.setUint32(Ke,De),Ke+=4}for(var $={signature:ee(),flavor:ee(),length:ee(),numTables:re(),reserved:re(),totalSfntSize:ee(),majorVersion:re(),minorVersion:re(),metaOffset:ee(),metaLength:ee(),metaOrigLength:ee(),privOffset:ee(),privLength:ee()},j=0;Math.pow(2,j)<=$.numTables;)j++;j--;for(var U=16*Math.pow(2,j),X=16*$.numTables-U,le=12,Z=[],oe=0;oe<$.numTables;oe++)Z.push({tag:ee(),offset:ee(),compLength:ee(),origLength:ee(),origChecksum:ee()}),le+=16;var pe,de=new Uint8Array(12+16*Z.length+Z.reduce(function(De,K){return De+K.origLength+4},0)),ye=de.buffer,Ge=new DataView(ye),Ke=0;return W($.flavor),se($.numTables),se(U),se(j),se(X),Z.forEach(function(De){W(De.tag),W(De.origChecksum),W(le),W(De.origLength),De.outOffset=le,(le+=De.origLength)%4!=0&&(le+=4-le%4)}),Z.forEach(function(De){var K,Pe=V.slice(De.offset,De.offset+De.compLength);if(De.compLength!=De.origLength){var Be=new Uint8Array(De.origLength);K=new Uint8Array(Pe,2),D(K,Be)}else Be=new Uint8Array(Pe);de.set(Be,De.outOffset);var Xe=0;(le=De.outOffset+De.origLength)%4!=0&&(Xe=4-le%4),de.set(new Uint8Array(Xe).buffer,De.outOffset+De.origLength),pe=le+Xe}),ye.slice(0,pe)},Object.defineProperty(r,"__esModule",{value:!0}),r}({}).convert_streams}function CK(r,e){const t={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,s=2,o=4,a=8,l=16,u=32;let c;function h(L){if(!c){const F={R:s,L:i,D:o,C:l,U:u,T:a};c=new Map;for(let D in n){let I=0;n[D].split(",").forEach(N=>{let[V,q]=N.split("+");V=parseInt(V,36),q=q?parseInt(q,36):0,c.set(I+=V,F[D]);for(let Q=q;Q--;)c.set(++I,F[D])})}}return c.get(L)||u}const d=1,m=2,g=3,x=4,_=[null,"isol","init","fina","medi"];function S(L){const F=new Uint8Array(L.length);let D=u,I=d,N=-1;for(let V=0;V<L.length;V++){const q=L.codePointAt(V);let Q=h(q)|0,re=d;Q&a||(D&(i|o|l)?Q&(s|o|l)?(re=g,(I===d||I===g)&&F[N]++):Q&(i|u)&&(I===m||I===x)&&F[N]--:D&(s|u)&&(I===m||I===x)&&F[N]--,I=F[V]=re,D=Q,N=V,q>65535&&V++)}return F}function T(L,F){const D=[];for(let N=0;N<F.length;N++){const V=F.codePointAt(N);V>65535&&N++,D.push(r.U.codeToGlyph(L,V))}const I=L.GSUB;if(I){const{lookupList:N,featureList:V}=I;let q;const Q=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,re=[];V.forEach(ee=>{if(Q.test(ee.tag))for(let se=0;se<ee.tab.length;se++){if(re[ee.tab[se]])continue;re[ee.tab[se]]=!0;const W=N[ee.tab[se]],$=/^(isol|init|fina|medi)$/.test(ee.tag);$&&!q&&(q=S(F));for(let j=0;j<D.length;j++)(!q||!$||_[q[j]]===ee.tag)&&r.U._applySubs(D,j,W,N)}})}return D}function E(L,F){const D=new Int16Array(F.length*3);let I=0;for(;I<F.length;I++){const Q=F[I];if(Q===-1)continue;D[I*3+2]=L.hmtx.aWidth[Q];const re=L.GPOS;if(re){const ee=re.lookupList;for(let se=0;se<ee.length;se++){const W=ee[se];for(let $=0;$<W.tabs.length;$++){const j=W.tabs[$];if(W.ltype===1){if(r._lctf.coverageIndex(j.coverage,Q)!==-1&&j.pos){q(j.pos,I);break}}else if(W.ltype===2){let U=null,X=N();if(X!==-1){const le=r._lctf.coverageIndex(j.coverage,F[X]);if(le!==-1){if(j.fmt===1){const Z=j.pairsets[le];for(let oe=0;oe<Z.length;oe++)Z[oe].gid2===Q&&(U=Z[oe])}else if(j.fmt===2){const Z=r.U._getGlyphClass(F[X],j.classDef1),oe=r.U._getGlyphClass(Q,j.classDef2);U=j.matrix[Z][oe]}if(U){U.val1&&q(U.val1,X),U.val2&&q(U.val2,I);break}}}}else if(W.ltype===4){const U=r._lctf.coverageIndex(j.markCoverage,Q);if(U!==-1){const X=N(V),le=X===-1?-1:r._lctf.coverageIndex(j.baseCoverage,F[X]);if(le!==-1){const Z=j.markArray[U],oe=j.baseArray[le][Z.markClass];D[I*3]=oe.x-Z.x+D[X*3]-D[X*3+2],D[I*3+1]=oe.y-Z.y+D[X*3+1];break}}}else if(W.ltype===6){const U=r._lctf.coverageIndex(j.mark1Coverage,Q);if(U!==-1){const X=N();if(X!==-1){const le=F[X];if(C(L,le)===3){const Z=r._lctf.coverageIndex(j.mark2Coverage,le);if(Z!==-1){const oe=j.mark1Array[U],pe=j.mark2Array[Z][oe.markClass];D[I*3]=pe.x-oe.x+D[X*3]-D[X*3+2],D[I*3+1]=pe.y-oe.y+D[X*3+1];break}}}}}}}}else if(L.kern&&!L.cff){const ee=N();if(ee!==-1){const se=L.kern.glyph1.indexOf(F[ee]);if(se!==-1){const W=L.kern.rval[se].glyph2.indexOf(Q);W!==-1&&(D[ee*3+2]+=L.kern.rval[se].vals[W])}}}}return D;function N(Q){for(let re=I-1;re>=0;re--)if(F[re]!==-1&&(!Q||Q(F[re])))return re;return-1}function V(Q){return C(L,Q)===1}function q(Q,re){for(let ee=0;ee<3;ee++)D[re*3+ee]+=Q[ee]||0}}function C(L,F){const D=L.GDEF&&L.GDEF.glyphClassDef;return D?r.U._getGlyphClass(F,D):0}function R(...L){for(let F=0;F<L.length;F++)if(typeof L[F]=="number")return L[F]}function P(L){const F=Object.create(null),D=L["OS/2"],I=L.hhea,N=L.head.unitsPerEm,V=R(D&&D.sTypoAscender,I&&I.ascender,N),q={unitsPerEm:N,ascender:V,descender:R(D&&D.sTypoDescender,I&&I.descender,0),capHeight:R(D&&D.sCapHeight,V),xHeight:R(D&&D.sxHeight,V),lineGap:R(D&&D.sTypoLineGap,I&&I.lineGap),supportsCodePoint(Q){return r.U.codeToGlyph(L,Q)>0},forEachGlyph(Q,re,ee,se){let W=0;const $=1/q.unitsPerEm*re,j=T(L,Q);let U=0;const X=E(L,j);return j.forEach((le,Z)=>{if(le!==-1){let oe=F[le];if(!oe){const{cmds:pe,crds:de}=r.U.glyphToPath(L,le);let ye="",Ge=0;for(let Be=0,Xe=pe.length;Be<Xe;Be++){const ve=t[pe[Be]];ye+=pe[Be];for(let et=1;et<=ve;et++)ye+=(et>1?",":"")+de[Ge++]}let Ke,De,K,Pe;if(de.length){Ke=De=1/0,K=Pe=-1/0;for(let Be=0,Xe=de.length;Be<Xe;Be+=2){let ve=de[Be],et=de[Be+1];ve<Ke&&(Ke=ve),et<De&&(De=et),ve>K&&(K=ve),et>Pe&&(Pe=et)}}else Ke=K=De=Pe=0;oe=F[le]={index:le,advanceWidth:L.hmtx.aWidth[le],xMin:Ke,yMin:De,xMax:K,yMax:Pe,path:ye}}se.call(null,oe,W+X[Z*3]*$,X[Z*3+1]*$,U),W+=X[Z*3+2]*$,ee&&(W+=ee*re)}U+=Q.codePointAt(U)>65535?2:1}),W}};return q}return function(F){const D=new Uint8Array(F,0,4),I=r._bin.readASCII(D,0,4);if(I==="wOFF")F=e(F);else if(I==="wOF2")throw new Error("woff2 fonts not supported");return P(r.parse(F)[0])}}const bK=Bm({name:"Typr Font Parser",dependencies:[MK,wK,CK],init(r,e,t){const n=r(),i=e();return t(n,i)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function RK(){return function(r){var e=function(){this.buckets=new Map};e.prototype.add=function(E){var C=E>>5;this.buckets.set(C,(this.buckets.get(C)||0)|1<<(31&E))},e.prototype.has=function(E){var C=this.buckets.get(E>>5);return C!==void 0&&(C&1<<(31&E))!=0},e.prototype.serialize=function(){var E=[];return this.buckets.forEach(function(C,R){E.push((+R).toString(36)+":"+C.toString(36))}),E.join(",")},e.prototype.deserialize=function(E){var C=this;this.buckets.clear(),E.split(",").forEach(function(R){var P=R.split(":");C.buckets.set(parseInt(P[0],36),parseInt(P[1],36))})};var t=Math.pow(2,8),n=t-1,i=~n;function s(E){var C=function(P){return P&i}(E).toString(16),R=function(P){return(P&i)+t-1}(E).toString(16);return"codepoint-index/plane"+(E>>16)+"/"+C+"-"+R+".json"}function o(E,C){var R=E&n,P=C.codePointAt(R/6|0);return((P=(P||48)-48)&1<<R%6)!=0}function a(E,C){var R;(R=E,R.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(P){return P.split("-").map(function(L){return parseInt(L.trim(),16)})})).forEach(function(P){var L=P[0],F=P[1];F===void 0&&(F=L),C(L,F)})}function l(E,C){a(E,function(R,P){for(var L=R;L<=P;L++)C(L)})}var u={},c={},h=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function m(E){var C=h.get(E);return C||(C=new e,l(E.ranges,function(R){return C.add(R)}),h.set(E,C)),C}var g,x=new Map;function _(E,C,R){return E[C]?C:E[R]?R:function(P){for(var L in P)return L}(E)}function S(E,C){var R=C;if(!E.includes(R)){R=1/0;for(var P=0;P<E.length;P++)Math.abs(E[P]-C)<Math.abs(R-C)&&(R=E[P])}return R}function T(E){return g||(g=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(C){g.add(C)})),g.has(E)}return r.CodePointSet=e,r.clearCache=function(){u={},c={}},r.getFontsForString=function(E,C){C===void 0&&(C={});var R,P=C.lang;P===void 0&&(P=new RegExp("\\p{Script=Hangul}","u").test(R=E)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(R)?"ja":"en");var L=C.category;L===void 0&&(L="sans-serif");var F=C.style;F===void 0&&(F="normal");var D=C.weight;D===void 0&&(D=400);var I=(C.dataUrl||d).replace(/\/$/g,""),N=new Map,V=new Uint8Array(E.length),q={},Q={},re=new Array(E.length),ee=new Map,se=!1;function W(U){var X=x.get(U);return X||(X=fetch(I+"/"+U).then(function(le){if(!le.ok)throw new Error(le.statusText);return le.json().then(function(Z){if(!Array.isArray(Z)||Z[0]!==1)throw new Error("Incorrect schema version; need 1, got "+Z[0]);return Z[1]})}).catch(function(le){if(I!==d)return se||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+I+'", trying default CDN. '+le.message),se=!0),I=d,x.delete(U),W(U);throw le}),x.set(U,X)),X}for(var $=function(U){var X=E.codePointAt(U),le=s(X);re[U]=le,u[le]||ee.has(le)||ee.set(le,W(le).then(function(Z){u[le]=Z})),X>65535&&(U++,j=U)},j=0;j<E.length;j++)$(j);return Promise.all(ee.values()).then(function(){ee.clear();for(var U=function(le){var Z=E.codePointAt(le),oe=null,pe=u[re[le]],de=void 0;for(var ye in pe){var Ge=Q[ye];if(Ge===void 0&&(Ge=Q[ye]=new RegExp(ye).test(P||"en")),Ge){for(var Ke in de=ye,pe[ye])if(o(Z,pe[ye][Ke])){oe=Ke;break}break}}if(!oe){e:for(var De in pe)if(De!==de){for(var K in pe[De])if(o(Z,pe[De][K])){oe=K;break e}}}oe||(console.debug("No font coverage for U+"+Z.toString(16)),oe="latin"),re[le]=oe,c[oe]||ee.has(oe)||ee.set(oe,W("font-meta/"+oe+".json").then(function(Pe){c[oe]=Pe})),Z>65535&&(le++,X=le)},X=0;X<E.length;X++)U(X);return Promise.all(ee.values())}).then(function(){for(var U,X=null,le=0;le<E.length;le++){var Z=E.codePointAt(le);if(X&&(T(Z)||m(X).has(Z)))V[le]=V[le-1];else{X=c[re[le]];var oe=q[X.id];if(!oe){var pe=X.typeforms,de=_(pe,L,"sans-serif"),ye=_(pe[de],F,"normal"),Ge=S((U=pe[de])===null||U===void 0?void 0:U[ye],D);oe=q[X.id]=I+"/font-files/"+X.id+"/"+de+"."+ye+"."+Ge+".woff"}var Ke=N.get(oe);Ke==null&&(Ke=N.size,N.set(oe,Ke)),V[le]=Ke}Z>65535&&(le++,V[le]=V[le-1])}return{fontUrls:Array.from(N.keys()),chars:V}})},Object.defineProperty(r,"__esModule",{value:!0}),r}({})}function IK(r,e){const t=Object.create(null),n=Object.create(null);function i(o,a){const l=u=>{console.error(`Failure loading font ${o}`,u)};try{const u=new XMLHttpRequest;u.open("get",o,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status>=400)l(new Error(u.statusText));else if(u.status>0)try{const c=r(u.response);c.src=o,a(c)}catch(c){l(c)}},u.onerror=l,u.send()}catch(u){l(u)}}function s(o,a){let l=t[o];l?a(l):n[o]?n[o].push(a):(n[o]=[a],i(o,u=>{u.src=o,t[o]=u,n[o].forEach(c=>c(u)),delete n[o]}))}return function(o,a,{lang:l,fonts:u=[],style:c="normal",weight:h="normal",unicodeFontsURL:d}={}){const m=new Uint8Array(o.length),g=[];o.length||T();const x=new Map,_=[];if(c!=="italic"&&(c="normal"),typeof h!="number"&&(h=h==="bold"?700:400),u&&!Array.isArray(u)&&(u=[u]),u=u.slice().filter(C=>!C.lang||C.lang.test(l)).reverse(),u.length){let L=0;(function F(D=0){for(let I=D,N=o.length;I<N;I++){const V=o.codePointAt(I);if(L===1&&g[m[I-1]].supportsCodePoint(V)||I>0&&/\s/.test(o[I]))m[I]=m[I-1],L===2&&(_[_.length-1][1]=I);else for(let q=m[I],Q=u.length;q<=Q;q++)if(q===Q){const re=L===2?_[_.length-1]:_[_.length]=[I,I];re[1]=I,L=2}else{m[I]=q;const{src:re,unicodeRange:ee}=u[q];if(!ee||E(V,ee)){const se=t[re];if(!se){s(re,()=>{F(I)});return}if(se.supportsCodePoint(V)){let W=x.get(se);typeof W!="number"&&(W=g.length,g.push(se),x.set(se,W)),m[I]=W,L=1;break}}}V>65535&&I+1<N&&(m[I+1]=m[I],I++,L===2&&(_[_.length-1][1]=I))}S()})()}else _.push([0,o.length-1]),S();function S(){if(_.length){const C=_.map(R=>o.substring(R[0],R[1]+1)).join(`
`);e.getFontsForString(C,{lang:l||void 0,style:c,weight:h,dataUrl:d}).then(({fontUrls:R,chars:P})=>{const L=g.length;let F=0;_.forEach(I=>{for(let N=0,V=I[1]-I[0];N<=V;N++)m[I[0]+N]=P[F++]+L;F++});let D=0;R.forEach((I,N)=>{s(I,V=>{g[N+L]=V,++D===R.length&&T()})})})}else T()}function T(){a({chars:m,fonts:g})}function E(C,R){for(let P=0;P<R.length;P++){const[L,F=L]=R[P];if(L<=C&&C<=F)return!0}return!1}}}const LK=Bm({name:"FontResolver",dependencies:[IK,bK,RK],init(r,e,t){return r(e,t())}});function PK(r,e){const n=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",s=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:g,lang:x,fonts:_,style:S,weight:T,preResolvedFonts:E,unicodeFontsURL:C},R){const P=({chars:L,fonts:F})=>{let D,I;const N=[];for(let V=0;V<L.length;V++)L[V]!==I?(I=L[V],N.push(D={start:V,end:V,fontObj:F[L[V]]})):D.end=V;R(N)};E?P(E):r(g,P,{lang:x,fonts:_,style:S,weight:T,unicodeFontsURL:C})}function a({text:g="",font:x,lang:_,sdfGlyphSize:S=64,fontSize:T=400,fontWeight:E=1,fontStyle:C="normal",letterSpacing:R=0,lineHeight:P="normal",maxWidth:L=1/0,direction:F,textAlign:D="left",textIndent:I=0,whiteSpace:N="normal",overflowWrap:V="normal",anchorX:q=0,anchorY:Q=0,metricsOnly:re=!1,unicodeFontsURL:ee,preResolvedFonts:se=null,includeCaretPositions:W=!1,chunkedBoundsSize:$=8192,colorRanges:j=null},U){const X=h(),le={fontLoad:0,typesetting:0};g.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),g=g.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),T=+T,R=+R,L=+L,P=P||"normal",I=+I,o({text:g,lang:_,style:C,weight:E,fonts:typeof x=="string"?[{src:x}]:x,unicodeFontsURL:ee,preResolvedFonts:se},Z=>{le.fontLoad=h()-X;const oe=isFinite(L);let pe=null,de=null,ye=null,Ge=null,Ke=null,De=null,K=null,Pe=null,Be=0,Xe=0,ve=N!=="nowrap";const et=new Map,Ce=h();let We=I,te=0,z=new d;const me=[z];Z.forEach(ke=>{const{fontObj:Ze}=ke,{ascender:lt,descender:Ye,unitsPerEm:nt,lineGap:Ct,capHeight:ht,xHeight:it}=Ze;let rt=et.get(Ze);if(!rt){const Te=T/nt,Oe=P==="normal"?(lt-Ye+Ct)*Te:P*T,st=(Oe-(lt-Ye)*Te)/2,xt=Math.min(Oe,(lt-Ye)*Te),_t=(lt+Ye)/2*Te+xt/2;rt={index:et.size,src:Ze.src,fontObj:Ze,fontSizeMult:Te,unitsPerEm:nt,ascender:lt*Te,descender:Ye*Te,capHeight:ht*Te,xHeight:it*Te,lineHeight:Oe,baseline:-st-lt*Te,caretTop:_t,caretBottom:_t-xt},et.set(Ze,rt)}const{fontSizeMult:fe}=rt,Je=g.slice(ke.start,ke.end+1);let ce,He;Ze.forEachGlyph(Je,T,R,(Te,Oe,st,xt)=>{Oe+=te,xt+=ke.start,ce=Oe,He=Te;const _t=g.charAt(xt),Ht=Te.advanceWidth*fe,zt=z.count;let gt;if("isEmpty"in Te||(Te.isWhitespace=!!_t&&new RegExp(i).test(_t),Te.canBreakAfter=!!_t&&s.test(_t),Te.isEmpty=Te.xMin===Te.xMax||Te.yMin===Te.yMax||n.test(_t)),!Te.isWhitespace&&!Te.isEmpty&&Xe++,ve&&oe&&!Te.isWhitespace&&Oe+Ht+We>L&&zt){if(z.glyphAt(zt-1).glyphObj.canBreakAfter)gt=new d,We=-Oe;else for(let vn=zt;vn--;)if(vn===0&&V==="break-word"){gt=new d,We=-Oe;break}else if(z.glyphAt(vn).glyphObj.canBreakAfter){gt=z.splitAt(vn+1);const Dn=gt.glyphAt(0).x;We-=Dn;for(let In=gt.count;In--;)gt.glyphAt(In).x-=Dn;break}gt&&(z.isSoftWrapped=!0,z=gt,me.push(z),Be=L)}let Qt=z.glyphAt(z.count);Qt.glyphObj=Te,Qt.x=Oe+We,Qt.y=st,Qt.width=Ht,Qt.charIndex=xt,Qt.fontData=rt,_t===`
`&&(z=new d,me.push(z),We=-(Oe+Ht+R*T)+I)}),te=ce+He.advanceWidth*fe+R*T});let _e=0;me.forEach(ke=>{let Ze=!0;for(let lt=ke.count;lt--;){const Ye=ke.glyphAt(lt);Ze&&!Ye.glyphObj.isWhitespace&&(ke.width=Ye.x+Ye.width,ke.width>Be&&(Be=ke.width),Ze=!1);let{lineHeight:nt,capHeight:Ct,xHeight:ht,baseline:it}=Ye.fontData;nt>ke.lineHeight&&(ke.lineHeight=nt);const rt=it-ke.baseline;rt<0&&(ke.baseline+=rt,ke.cap+=rt,ke.ex+=rt),ke.cap=Math.max(ke.cap,ke.baseline+Ct),ke.ex=Math.max(ke.ex,ke.baseline+ht)}ke.baseline-=_e,ke.cap-=_e,ke.ex-=_e,_e+=ke.lineHeight});let Ee=0,we=0;if(q&&(typeof q=="number"?Ee=-q:typeof q=="string"&&(Ee=-Be*(q==="left"?0:q==="center"?.5:q==="right"?1:u(q)))),Q&&(typeof Q=="number"?we=-Q:typeof Q=="string"&&(we=Q==="top"?0:Q==="top-baseline"?-me[0].baseline:Q==="top-cap"?-me[0].cap:Q==="top-ex"?-me[0].ex:Q==="middle"?_e/2:Q==="bottom"?_e:Q==="bottom-baseline"?-me[me.length-1].baseline:u(Q)*_e)),!re){const ke=e.getEmbeddingLevels(g,F);pe=new Uint16Array(Xe),de=new Uint8Array(Xe),ye=new Float32Array(Xe*2),Ge={},K=[1/0,1/0,-1/0,-1/0],Pe=[],W&&(De=new Float32Array(g.length*4)),j&&(Ke=new Uint8Array(Xe*3));let Ze=0,lt=-1,Ye=-1,nt,Ct;if(me.forEach((ht,it)=>{let{count:rt,width:fe}=ht;if(rt>0){let Je=0;for(let xt=rt;xt--&&ht.glyphAt(xt).glyphObj.isWhitespace;)Je++;let ce=0,He=0;if(D==="center")ce=(Be-fe)/2;else if(D==="right")ce=Be-fe;else if(D==="justify"&&ht.isSoftWrapped){let xt=0;for(let _t=rt-Je;_t--;)ht.glyphAt(_t).glyphObj.isWhitespace&&xt++;He=(Be-fe)/xt}if(He||ce){let xt=0;for(let _t=0;_t<rt;_t++){let Ht=ht.glyphAt(_t);const zt=Ht.glyphObj;Ht.x+=ce+xt,He!==0&&zt.isWhitespace&&_t<rt-Je&&(xt+=He,Ht.width+=He)}}const Te=e.getReorderSegments(g,ke,ht.glyphAt(0).charIndex,ht.glyphAt(ht.count-1).charIndex);for(let xt=0;xt<Te.length;xt++){const[_t,Ht]=Te[xt];let zt=1/0,gt=-1/0;for(let Qt=0;Qt<rt;Qt++)if(ht.glyphAt(Qt).charIndex>=_t){let vn=Qt,Dn=Qt;for(;Dn<rt;Dn++){let In=ht.glyphAt(Dn);if(In.charIndex>Ht)break;Dn<rt-Je&&(zt=Math.min(zt,In.x),gt=Math.max(gt,In.x+In.width))}for(let In=vn;In<Dn;In++){const xi=ht.glyphAt(In);xi.x=gt-(xi.x+xi.width-zt)}break}}let Oe;const st=xt=>Oe=xt;for(let xt=0;xt<rt;xt++){const _t=ht.glyphAt(xt);Oe=_t.glyphObj;const Ht=Oe.index,zt=ke.levels[_t.charIndex]&1;if(zt){const gt=e.getMirroredCharacter(g[_t.charIndex]);gt&&_t.fontData.fontObj.forEachGlyph(gt,0,0,st)}if(W){const{charIndex:gt,fontData:Qt}=_t,vn=_t.x+Ee,Dn=_t.x+_t.width+Ee;De[gt*4]=zt?Dn:vn,De[gt*4+1]=zt?vn:Dn,De[gt*4+2]=ht.baseline+Qt.caretBottom+we,De[gt*4+3]=ht.baseline+Qt.caretTop+we;const In=gt-lt;In>1&&c(De,lt,In),lt=gt}if(j){const{charIndex:gt}=_t;for(;gt>Ye;)Ye++,j.hasOwnProperty(Ye)&&(Ct=j[Ye])}if(!Oe.isWhitespace&&!Oe.isEmpty){const gt=Ze++,{fontSizeMult:Qt,src:vn,index:Dn}=_t.fontData,In=Ge[vn]||(Ge[vn]={});In[Ht]||(In[Ht]={path:Oe.path,pathBounds:[Oe.xMin,Oe.yMin,Oe.xMax,Oe.yMax]});const xi=_t.x+Ee,ns=_t.y+ht.baseline+we;ye[gt*2]=xi,ye[gt*2+1]=ns;const Ri=xi+Oe.xMin*Qt,Ji=ns+Oe.yMin*Qt,Gi=xi+Oe.xMax*Qt,qi=ns+Oe.yMax*Qt;Ri<K[0]&&(K[0]=Ri),Ji<K[1]&&(K[1]=Ji),Gi>K[2]&&(K[2]=Gi),qi>K[3]&&(K[3]=qi),gt%$===0&&(nt={start:gt,end:gt,rect:[1/0,1/0,-1/0,-1/0]},Pe.push(nt)),nt.end++;const Ii=nt.rect;if(Ri<Ii[0]&&(Ii[0]=Ri),Ji<Ii[1]&&(Ii[1]=Ji),Gi>Ii[2]&&(Ii[2]=Gi),qi>Ii[3]&&(Ii[3]=qi),pe[gt]=Ht,de[gt]=Dn,j){const Hs=gt*3;Ke[Hs]=Ct>>16&255,Ke[Hs+1]=Ct>>8&255,Ke[Hs+2]=Ct&255}}}}}),De){const ht=g.length-lt;ht>1&&c(De,lt,ht)}}const ut=[];et.forEach(({index:ke,src:Ze,unitsPerEm:lt,ascender:Ye,descender:nt,lineHeight:Ct,capHeight:ht,xHeight:it})=>{ut[ke]={src:Ze,unitsPerEm:lt,ascender:Ye,descender:nt,lineHeight:Ct,capHeight:ht,xHeight:it}}),le.typesetting=h()-Ce,U({glyphIds:pe,glyphFontIndices:de,glyphPositions:ye,glyphData:Ge,fontData:ut,caretPositions:De,glyphColors:Ke,chunkedBounds:Pe,fontSize:T,topBaseline:we+me[0].baseline,blockBounds:[Ee,we-_e,Ee+Be,we],visibleBounds:K,timings:le})})}function l(g,x){a({...g,metricsOnly:!0},_=>{const[S,T,E,C]=_.blockBounds;x({width:E-S,height:C-T})})}function u(g){let x=g.match(/^([\d.]+)%$/),_=x?parseFloat(x[1]):NaN;return isNaN(_)?0:_/100}function c(g,x,_){const S=g[x*4],T=g[x*4+1],E=g[x*4+2],C=g[x*4+3],R=(T-S)/_;for(let P=0;P<_;P++){const L=(x+P)*4;g[L]=S+R*P,g[L+1]=S+R*(P+1),g[L+2]=E,g[L+3]=C}}function h(){return(self.performance||Date).now()}function d(){this.data=[]}const m=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(g){let x=d.flyweight;return x.data=this.data,x.index=g,x},splitAt(g){let x=new d;return x.data=this.data.splice(g*m.length),x}},d.flyweight=m.reduce((g,x,_,S)=>(Object.defineProperty(g,x,{get(){return this.data[this.index*m.length+_]},set(T){this.data[this.index*m.length+_]=T}}),g),{data:null,index:0}),{typeset:a,measure:l}}const jf=()=>(self.performance||Date).now(),vA=Pk();let BL;function DK(r,e,t,n,i,s,o,a,l,u,c=!0){return c?FK(r,e,t,n,i,s,o,a,l,u).then(null,h=>(BL||(console.warn("WebGL SDF generation failed, falling back to JS",h),BL=!0),kL(r,e,t,n,i,s,o,a,l,u))):kL(r,e,t,n,i,s,o,a,l,u)}const o_=[],BK=5;let jT=0;function Bk(){const r=jf();for(;o_.length&&jf()-r<BK;)o_.shift()();jT=o_.length?setTimeout(Bk,0):0}const FK=(...r)=>new Promise((e,t)=>{o_.push(()=>{const n=jf();try{vA.webgl.generateIntoCanvas(...r),e({timing:jf()-n})}catch(i){t(i)}}),jT||(jT=setTimeout(Bk,0))}),kK=4,OK=2e3,FL={};let UK=0;function kL(r,e,t,n,i,s,o,a,l,u){const c="TroikaTextSDFGenerator_JS_"+UK++%kK;let h=FL[c];return h||(h=FL[c]={workerModule:Bm({name:c,workerId:c,dependencies:[Pk,jf],init(d,m){const g=d().javascript.generate;return function(...x){const _=m();return{textureData:g(...x),timing:m()-_}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(r,e,t,n,i,s).then(({textureData:d,timing:m})=>{const g=jf(),x=new Uint8Array(d.length*4);for(let _=0;_<d.length;_++)x[_*4+u]=d[_];return vA.webglUtils.renderImageData(o,x,a,l,r,e,1<<3-u),m+=jf()-g,--h.requests===0&&(h.idleTimer=setTimeout(()=>{mK(c)},OK)),{timing:m}})}function NK(r){r._warm||(vA.webgl.isSupported(r),r._warm=!0)}const GK=vA.webglUtils.resizeWebGLCanvasWithoutClearing,r0={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},HK=new yt;function Ip(){return(self.performance||Date).now()}const OL=Object.create(null);function Fk(r,e){r=WK({},r);const t=Ip(),n=[];if(r.font&&n.push({label:"user",src:jK(r.font)}),r.font=n,r.text=""+r.text,r.sdfGlyphSize=r.sdfGlyphSize||r0.sdfGlyphSize,r.unicodeFontsURL=r.unicodeFontsURL||r0.unicodeFontsURL,r.colorRanges!=null){let d={};for(let m in r.colorRanges)if(r.colorRanges.hasOwnProperty(m)){let g=r.colorRanges[m];typeof g!="number"&&(g=HK.set(g).getHex()),d[m]=g}r.colorRanges=d}Object.freeze(r);const{textureWidth:i,sdfExponent:s}=r0,{sdfGlyphSize:o}=r,a=i/o*4;let l=OL[o];if(!l){const d=document.createElement("canvas");d.width=i,d.height=o*256/a,l=OL[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:d,sdfTexture:new ci(d,void 0,void 0,void 0,vi,vi),contextLost:!1,glyphsByFont:new Map},l.sdfTexture.generateMipmaps=!1,zK(l)}const{sdfTexture:u,sdfCanvas:c}=l;Uk(r).then(d=>{const{glyphIds:m,glyphFontIndices:g,fontData:x,glyphPositions:_,fontSize:S,timings:T}=d,E=[],C=new Float32Array(m.length*4);let R=0,P=0;const L=Ip(),F=x.map(q=>{let Q=l.glyphsByFont.get(q.src);return Q||l.glyphsByFont.set(q.src,Q=new Map),Q});m.forEach((q,Q)=>{const re=g[Q],{src:ee,unitsPerEm:se}=x[re];let W=F[re].get(q);if(!W){const{path:le,pathBounds:Z}=d.glyphData[ee][q],oe=Math.max(Z[2]-Z[0],Z[3]-Z[1])/o*(r0.sdfMargin*o+.5),pe=l.glyphCount++,de=[Z[0]-oe,Z[1]-oe,Z[2]+oe,Z[3]+oe];F[re].set(q,W={path:le,atlasIndex:pe,sdfViewBox:de}),E.push(W)}const{sdfViewBox:$}=W,j=_[P++],U=_[P++],X=S/se;C[R++]=j+$[0]*X,C[R++]=U+$[1]*X,C[R++]=j+$[2]*X,C[R++]=U+$[3]*X,m[Q]=W.atlasIndex}),T.quads=(T.quads||0)+(Ip()-L);const D=Ip();T.sdf={};const I=c.height,N=Math.ceil(l.glyphCount/a),V=Math.pow(2,Math.ceil(Math.log2(N*o)));V>I&&(console.info(`Increasing SDF texture size ${I}->${V}`),GK(c,i,V),u.dispose()),Promise.all(E.map(q=>kk(q,l,r.gpuAccelerateSDF).then(({timing:Q})=>{T.sdf[q.atlasIndex]=Q}))).then(()=>{E.length&&!l.contextLost&&(Ok(l),u.needsUpdate=!0),T.sdfTotal=Ip()-D,T.total=Ip()-t,e(Object.freeze({parameters:r,sdfTexture:u,sdfGlyphSize:o,sdfExponent:s,glyphBounds:C,glyphAtlasIndices:m,glyphColors:d.glyphColors,caretPositions:d.caretPositions,chunkedBounds:d.chunkedBounds,ascender:d.ascender,descender:d.descender,lineHeight:d.lineHeight,capHeight:d.capHeight,xHeight:d.xHeight,topBaseline:d.topBaseline,blockBounds:d.blockBounds,visibleBounds:d.visibleBounds,timings:d.timings}))})}),Promise.resolve().then(()=>{l.contextLost||NK(c)})}function kk({path:r,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:n,sdfCanvas:i,contextLost:s},o){if(s)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:l}=r0,u=Math.max(t[2]-t[0],t[3]-t[1]),c=Math.floor(e/4),h=c%(a/n)*n,d=Math.floor(c/(a/n))*n,m=e%4;return DK(n,n,r,t,u,l,i,h,d,m,o)}function zK(r){const e=r.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),r.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),r.contextLost=!1;const n=[];r.glyphsByFont.forEach(i=>{i.forEach(s=>{n.push(kk(s,r,!0))})}),Promise.all(n).then(()=>{Ok(r),r.sdfTexture.needsUpdate=!0})})}function VK({font:r,characters:e,sdfGlyphSize:t},n){let i=Array.isArray(e)?e.join(`
`):""+e;Fk({font:r,sdfGlyphSize:t,text:i},n)}function WK(r,e){for(let t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}let Px;function jK(r){return Px||(Px=typeof document>"u"?{}:document.createElement("a")),Px.href=r,Px.href}function Ok(r){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=r,{width:n,height:i}=e,s=r.sdfCanvas.getContext("webgl");let o=t.image.data;(!o||o.length!==n*i*4)&&(o=new Uint8Array(n*i*4),t.image={width:n,height:i,data:o},t.flipY=!1,t.isDataTexture=!0),s.readPixels(0,0,n,i,s.RGBA,s.UNSIGNED_BYTE,o)}}const KK=Bm({name:"Typesetter",dependencies:[PK,LK,vK],init(r,e,t){return r(e,t())}}),Uk=Bm({name:"Typesetter",dependencies:[KK],init(r){return function(e){return new Promise(t=>{r.typeset(e,t)})}},getTransferables(r){const e=[];for(let t in r)r[t]&&r[t].buffer&&e.push(r[t].buffer);return e}});Uk.onMainThread;const UL={};function $K(r){let e=UL[r];return e||(e=UL[r]=new sc(1,1,r,r).translate(.5,.5,0)),e}const XK="aTroikaGlyphBounds",NL="aTroikaGlyphIndex",YK="aTroikaGlyphColor";class JK extends gA{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Yi,this.boundingBox=new Ni}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=$K(e);["position","normal","uv"].forEach(n=>{this.attributes[n]=t.attributes[n].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,i,s){this.updateAttributeData(XK,e,4),this.updateAttributeData(NL,t,1),this.updateAttributeData(YK,s,3),this._blockBounds=n,this._chunkedBounds=i,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:i,floor:s,min:o,max:a,sin:l,cos:u}=Math,c=i/2,h=i*2,d=Math.abs(t),m=e[0]/d,g=e[2]/d,x=s((m+c)/h)!==s((g+c)/h)?-d:o(l(m)*d,l(g)*d),_=s((m-c)/h)!==s((g-c)/h)?d:a(l(m)*d,l(g)*d),S=s((m+i)/h)!==s((g+i)/h)?d*2:a(d-u(m)*d,d-u(g)*d);n.min.set(x,e[1],t<0?-S:0),n.max.set(_,e[3],t<0?0:S)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(NL).count,n=this._chunkedBounds;if(n)for(let i=n.length;i--;){t=n[i].end;let s=n[i].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,n){const i=this.getAttribute(e);t?i&&i.array.length===t.length?(i.array.set(t),i.needsUpdate=!0):(this.setAttribute(e,new fh(t,n)),delete this._maxInstanceCount,this.dispose()):i&&this.deleteAttribute(e)}}const qK=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,QK=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,ZK=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,e$=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function t$(r){const e=WT(r,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Qe},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new gn(0,0,0,0)},uTroikaClipRect:{value:new gn(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Qe},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new yt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new ln},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:qK,vertexTransform:QK,fragmentDefs:ZK,fragmentColorTransform:e$,customRewriter({vertexShader:t,fragmentShader:n}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(n)&&(n=n.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(t)||(t=t.replace(Dk,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:n}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Yw=new so({color:16777215,side:Lo,transparent:!0}),GL=8421504,HL=new Wt,Dx=new ae,ME=new ae,$g=[],n$=new ae,wE="+x+y";function zL(r){return Array.isArray(r)?r[0]:r}let Nk=()=>{const r=new ui(new sc(1,1),Yw);return Nk=()=>r,r},Gk=()=>{const r=new ui(new sc(1,1,32,1),Yw);return Gk=()=>r,r};const i$={type:"syncstart"},r$={type:"synccomplete"},Hk=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],s$=Hk.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let zk=class extends ui{constructor(){const e=new JK;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=GL,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=wE,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(i$),Fk({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{n.forEach(i=>i&&i())})),this.dispatchEvent(r$),e&&e()})))}onBeforeRender(e,t,n,i,s,o){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return t$(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Yw.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function n(){t.removeEventListener("dispose",n),e.dispose()})),this.hasOutline()){let n=e._outlineMtl;return n||(n=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),n.isTextOutlineMaterial=!0,n.depthWrite=!1,n.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),n.dispose()})),[n,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return zL(this.material).getDepthMaterial()}get customDistanceMaterial(){return zL(this.material).getDistanceMaterial()}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:a,blockBounds:l}=i;n.uTroikaSDFTexture.value=a,n.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),n.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,n.uTroikaSDFExponent.value=i.sdfExponent,n.uTroikaTotalBounds.value.fromArray(l),n.uTroikaUseGlyphColors.value=!t&&!!i.glyphColors;let u=0,c=0,h=0,d,m,g,x=0,_=0;if(t){let{outlineWidth:T,outlineOffsetX:E,outlineOffsetY:C,outlineBlur:R,outlineOpacity:P}=this;u=this._parsePercent(T)||0,c=Math.max(0,this._parsePercent(R)||0),d=P,x=this._parsePercent(E)||0,_=this._parsePercent(C)||0}else h=Math.max(0,this._parsePercent(this.strokeWidth)||0),h&&(g=this.strokeColor,n.uTroikaStrokeColor.value.set(g??GL),m=this.strokeOpacity,m==null&&(m=1)),d=this.fillOpacity;n.uTroikaEdgeOffset.value=u,n.uTroikaPositionOffset.value.set(x,_),n.uTroikaBlurRadius.value=c,n.uTroikaStrokeWidth.value=h,n.uTroikaStrokeOpacity.value=m,n.uTroikaFillOpacity.value=d??1,n.uTroikaCurveRadius.value=this.curveRadius||0;let S=this.clipRect;if(S&&Array.isArray(S)&&S.length===4)n.uTroikaClipRect.value.fromArray(S);else{const T=(this.fontSize||.1)*100;n.uTroikaClipRect.value.set(l[0]-T,l[1]-T,l[2]+T,l[3]+T)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const s=t?this.outlineColor||0:this.color;if(s==null)delete e.color;else{const a=e.hasOwnProperty("color")?e.color:e.color=new yt;(s!==a._input||typeof s=="object")&&a.set(a._input=s)}let o=this.orientation||wE;if(o!==e._orientation){let a=n.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==wE&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,u,c,h,d]=l;Dx.set(0,0,0)[c]=u==="-"?1:-1,ME.set(0,0,0)[d]=h==="-"?-1:1,HL.lookAt(n$,Dx.cross(ME),ME),a.setFromMatrix4(HL)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new Qe){t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e,t=new Qe){return Dx.copy(e),this.localPositionToTextCoords(this.worldToLocal(Dx),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:i}=this;if(n){const s=n.blockBounds,o=i?Gk():Nk(),a=o.geometry,{position:l,uv:u}=a.attributes;for(let c=0;c<u.count;c++){let h=s[0]+u.getX(c)*(s[2]-s[0]);const d=s[1]+u.getY(c)*(s[3]-s[1]);let m=0;i&&(m=i-Math.cos(h/i)*i,h=Math.sin(h/i)*i),l.setXYZ(c,h,d,m)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,$g.length=0,o.raycast(e,$g);for(let c=0;c<$g.length;c++)$g[c].object=this,t.push($g[c])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,s$.forEach(n=>{this[n]=e[n]}),this}clone(){return new this.constructor().copy(this)}};Hk.forEach(r=>{const e="_private_"+r;Object.defineProperty(zk.prototype,r,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new Ni;new yt;const VL=ne.forwardRef(({sdfGlyphSize:r=64,anchorX:e="center",anchorY:t="middle",font:n,fontSize:i=1,children:s,characters:o,onSync:a,...l},u)=>{const c=Ro(({invalidate:g})=>g),[h]=ne.useState(()=>new zk),[d,m]=ne.useMemo(()=>{const g=[];let x="";return ne.Children.forEach(s,_=>{typeof _=="string"||typeof _=="number"?x+=_:g.push(_)}),[g,x]},[s]);return Hw(()=>new Promise(g=>VK({font:n,characters:o},g)),["troika-text",n,o]),ne.useLayoutEffect(()=>void h.sync(()=>{c(),a&&a(h)})),ne.useEffect(()=>()=>h.dispose(),[h]),ne.createElement("primitive",Qu({object:h,ref:u,font:n,text:m,anchorX:e,anchorY:t,fontSize:i,sdfGlyphSize:r},l),d)}),o$=()=>parseInt(bm.replace(/\D+/g,"")),a$=o$();let Bx=null,Vk="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Wk(r=!0,e=!0,t){return n=>{t&&t(n),r&&(Bx||(Bx=new sK),Bx.setDecoderPath(typeof r=="string"?r:Vk),n.setDRACOLoader(Bx)),e&&n.setMeshoptDecoder(typeof EE=="function"?EE():EE)}}const oc=(r,e,t,n)=>Lv(Kw,r,Wk(e,t,n));oc.preload=(r,e,t,n)=>Lv.preload(Kw,r,Wk(e,t,n));oc.clear=r=>Lv.clear(Kw,r);oc.setDecoderPath=r=>{Vk=r};const E0=ne.forwardRef(({makeDefault:r,camera:e,regress:t,domElement:n,enableDamping:i=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...u},c)=>{const h=Ro(P=>P.invalidate),d=Ro(P=>P.camera),m=Ro(P=>P.gl),g=Ro(P=>P.events),x=Ro(P=>P.setEvents),_=Ro(P=>P.set),S=Ro(P=>P.get),T=Ro(P=>P.performance),E=e||d,C=n||g.connected||m.domElement,R=ne.useMemo(()=>new Ej(E),[E]);return _h(()=>{R.enabled&&R.update()},-1),ne.useEffect(()=>(s&&R.connect(s===!0?C:s),R.connect(C),()=>void R.dispose()),[s,C,t,R,h]),ne.useEffect(()=>{const P=D=>{h(),t&&T.regress(),o&&o(D)},L=D=>{a&&a(D)},F=D=>{l&&l(D)};return R.addEventListener("change",P),R.addEventListener("start",L),R.addEventListener("end",F),()=>{R.removeEventListener("start",L),R.removeEventListener("end",F),R.removeEventListener("change",P)}},[o,a,l,R,h,x]),ne.useEffect(()=>{if(r){const P=S().controls;return _({controls:R}),()=>_({controls:P})}},[r,R]),ne.createElement("primitive",Qu({ref:c,object:R,enableDamping:i},u))}),l$="modulepreload",u$=function(r){return"/Pradyunuydarp/"+r},WL={},c$=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let o=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=o(t.map(u=>{if(u=u$(u),u in WL)return;WL[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":l$,c||(d.as="script"),d.crossOrigin="",d.href=u,l&&d.setAttribute("nonce",l),document.head.appendChild(d),c)return new Promise((m,g)=>{d.addEventListener("load",m),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},Mt=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},h$=Number.isSafeInteger||function(r){return typeof r=="number"&&Math.abs(r)<=f$},f$=Number.MAX_SAFE_INTEGER||9007199254740991;let Nt=function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r}({}),Le=function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",r.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",r.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.ASSET_LIST_LOAD_ERROR="assetListLoadError",r.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",r.ASSET_LIST_PARSING_ERROR="assetListParsingError",r.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.ATTACH_MEDIA_ERROR="attachMediaError",r.UNKNOWN="unknown",r}({}),H=function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.MEDIA_ENDED="hlsMediaEnded",r.STALL_RESOLVED="hlsStallResolved",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFERED_TO_END="hlsBufferedToEnd",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",r.ASSET_LIST_LOADING="hlsAssetListLoading",r.ASSET_LIST_LOADED="hlsAssetListLoaded",r.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",r.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",r.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",r.INTERSTITIAL_STARTED="hlsInterstitialStarted",r.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",r.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",r.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",r.INTERSTITIAL_ENDED="hlsInterstitialEnded",r.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",r.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",r.EVENT_CUE_ENTER="hlsEventCueEnter",r}({});var _n={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Bt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Lp{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class d${constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Lp(e),this.fast_=new Lp(t),this.defaultTTFB_=i,this.ttfb_=new Lp(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new Lp(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new Lp(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Lp(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,s=n/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function p$(r,e,t){return(e=g$(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function $n(){return $n=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},$n.apply(null,arguments)}function jL(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Wn(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?jL(Object(t),!0).forEach(function(n){p$(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):jL(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function m$(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function g$(r){var e=m$(r,"string");return typeof e=="symbol"?e:e+""}class ac{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=th,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const th=function(){},v$={trace:th,debug:th,log:th,warn:th,info:th,error:th};function KT(){return $n({},v$)}function y$(r,e){const t=self.console[r];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${r}] >`):th}function KL(r,e,t){return e[r]?e[r].bind(e):y$(r,t)}const $T=KT();function x$(r,e,t){const n=KT();if(typeof console=="object"&&r===!0||typeof r=="object"){const i=["debug","log","info","warn","error"];i.forEach(s=>{n[s]=KL(s,r,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.0`)}catch{return KT()}i.forEach(s=>{$T[s]=KL(s,r)})}else $n($T,n);return n}const wn=$T;function Zu(r=!0){return typeof self>"u"?void 0:(r||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function _$(r){return typeof self<"u"&&r===self.ManagedMediaSource}function jk(r,e){const t=Object.keys(r),n=Object.keys(e),i=t.length,s=n.length;return!i||!s||i===s&&!t.some(o=>n.indexOf(o)===-1)}function Oo(r,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(r);if(e){const c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}const t=r.length;let n,i,s,o="",a=0;for(;a<t;){if(n=r[a++],n===0&&e)return o;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(n);break;case 12:case 13:i=r[a++],o+=String.fromCharCode((n&31)<<6|i&63);break;case 14:i=r[a++],s=r[a++],o+=String.fromCharCode((n&15)<<12|(i&63)<<6|(s&63)<<0);break}}return o}const bl={hexDump:function(r){let e="";for(let t=0;t<r.length;t++){let n=r[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}};function S$(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var CE={exports:{}},$L;function A$(){return $L||($L=1,function(r,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var h=a.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");return h.path=a.normalizePath(h.path),a.buildURLFromParts(h)}var d=a.parseURL(u);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return c.alwaysNormalize?(d.path=a.normalizePath(d.path),a.buildURLFromParts(d)):u;var m=a.parseURL(l);if(!m)throw new Error("Error trying to parse base URL.");if(!m.netLoc&&m.path&&m.path[0]!=="/"){var g=i.exec(m.path);m.netLoc=g[1],m.path=g[2]}m.netLoc&&!m.path&&(m.path="/");var x={scheme:m.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(x.netLoc=m.netLoc,d.path[0]!=="/"))if(!d.path)x.path=m.path,d.params||(x.params=m.params,d.query||(x.query=m.query));else{var _=m.path,S=_.substring(0,_.lastIndexOf("/")+1)+d.path;x.path=a.normalizePath(S)}return x.path===null&&(x.path=c.alwaysNormalize?a.normalizePath(d.path):d.path),a.buildURLFromParts(x)},parseURL:function(l){var u=n.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};r.exports=a})()}(CE)),CE.exports}var Jw=A$();class yA{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Kn={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class qw{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,E$(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;n.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Kn.AUDIO]:null,[Kn.VIDEO]:null,[Kn.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new yA),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Jw.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Kn.AUDIO]=null,e[Kn.VIDEO]=null,e[Kn.AUDIOVIDEO]=null}}function Zr(r){return r.sn!=="initSegment"}class a_ extends qw{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(Mt(e)&&Mt(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Mt(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Mt(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Zr(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,s,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:s,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,s)}}class Kk extends qw{constructor(e,t,n,i,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function $k(r,e){const t=Object.getPrototypeOf(r);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||$k(t,e)}}function E$(r,e){const t=$k(r,e);t&&(t.enumerable=!0,Object.defineProperty(r,e,t))}const sS=Math.pow(2,32)-1,T$=[].push,Xk={video:1,audio:2,id3:3,text:4};function Sr(r){return String.fromCharCode.apply(null,r)}function Yk(r,e){const t=r[e]<<8|r[e+1];return t<0?65536+t:t}function Jt(r,e){const t=Jk(r,e);return t<0?4294967296+t:t}function XL(r,e){let t=Jt(r,e);return t*=Math.pow(2,32),t+=Jt(r,e+4),t}function Jk(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function bE(r,e,t){r[e]=t>>24,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t&255}function M$(r){const e=r.byteLength;for(let t=0;t<e;){const n=Jt(r,t);if(n>8&&r[t+4]===109&&r[t+5]===111&&r[t+6]===111&&r[t+7]===102)return!0;t=n>1?t+n:e}return!1}function sn(r,e){const t=[];if(!e.length)return t;const n=r.byteLength;for(let i=0;i<n;){const s=Jt(r,i),o=Sr(r.subarray(i+4,i+8)),a=s>1?i+s:n;if(o===e[0])if(e.length===1)t.push(r.subarray(i+8,a));else{const l=sn(r.subarray(i+8,a),e.slice(1));l.length&&T$.apply(t,l)}i=a}return t}function w$(r){const e=[],t=r[0];let n=8;const i=Jt(r,n);n+=4;let s=0,o=0;t===0?(s=Jt(r,n),o=Jt(r,n+4),n+=8):(s=XL(r,n),o=XL(r,n+8),n+=16),n+=2;let a=r.length+o;const l=Yk(r,n);n+=2;for(let u=0;u<l;u++){let c=n;const h=Jt(r,c);c+=4;const d=h&2147483647;if((h&2147483648)>>>31===1)return wn.warn("SIDX has hierarchical references (not supported)"),null;const g=Jt(r,c);c+=4,e.push({referenceSize:d,subsegmentDuration:g,info:{duration:g/i,start:a,end:a+d-1}}),a+=d,c+=4,n=c}return{earliestPresentationTime:s,timescale:i,version:t,referencesCount:l,references:e}}function qk(r){const e=[],t=sn(r,["moov","trak"]);for(let i=0;i<t.length;i++){const s=t[i],o=sn(s,["tkhd"])[0];if(o){let a=o[0];const l=Jt(o,a===0?12:20),u=sn(s,["mdia","mdhd"])[0];if(u){a=u[0];const c=Jt(u,a===0?12:20),h=sn(s,["mdia","hdlr"])[0];if(h){const d=Sr(h.subarray(8,12)),m={soun:Kn.AUDIO,vide:Kn.VIDEO}[d],g=sn(s,["mdia","minf","stbl","stsd"])[0],x=C$(g);m?(e[l]={timescale:c,type:m,stsd:x},e[m]=Wn({timescale:c,id:l},x)):e[l]={timescale:c,type:d,stsd:x}}}}}return sn(r,["moov","mvex","trex"]).forEach(i=>{const s=Jt(i,4),o=e[s];o&&(o.default={duration:Jt(i,12),flags:Jt(i,20)})}),e}function C$(r){const e=r.subarray(8),t=e.subarray(86),n=Sr(e.subarray(4,8));let i=n,s;const o=n==="enca"||n==="encv";if(o){const u=sn(e,[n])[0].subarray(n==="enca"?28:78);sn(u,["sinf"]).forEach(h=>{const d=sn(h,["schm"])[0];if(d){const m=Sr(d.subarray(4,8));if(m==="cbcs"||m==="cenc"){const g=sn(h,["frma"])[0];g&&(i=Sr(g))}}})}const a=i;switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const l=sn(t,["avcC"])[0];i+="."+kx(l[1])+kx(l[2])+kx(l[3]),s=Fx(a==="avc1"?"dva1":"dvav",t);break}case"mp4a":{const l=sn(e,[n])[0],u=sn(l.subarray(28),["esds"])[0];if(u&&u.length>7){let c=4;if(u[c++]!==3)break;c=RE(u,c),c+=2;const h=u[c++];if(h&128&&(c+=2),h&64&&(c+=u[c++]),u[c++]!==4)break;c=RE(u,c);const d=u[c++];if(d===64)i+="."+kx(d);else break;if(c+=12,u[c++]!==5)break;c=RE(u,c);const m=u[c++];let g=(m&248)>>3;g===31&&(g+=1+((m&7)<<3)+((u[c]&224)>>5)),i+="."+g}break}case"hvc1":case"hev1":{const l=sn(t,["hvcC"]);if(l){const u=l[0],c=u[1],h=["","A","B","C"][c>>6],d=c&31,m=Jt(u,2),g=(c&32)>>5?"H":"L",x=u[12],_=u.subarray(6,12);i+="."+h+d,i+="."+m.toString(16).toUpperCase(),i+="."+g+x;let S="";for(let T=_.length;T--;){const E=_[T];(E||S)&&(S="."+E.toString(16).toUpperCase()+S)}i+=S}s=Fx(a=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{i=Fx(i,t)||i;break}case"vp09":{const l=sn(t,["vpcC"])[0],u=l[4],c=l[5],h=l[6]>>4&15;i+="."+Cl(u)+"."+Cl(c)+"."+Cl(h);break}case"av01":{const l=sn(t,["av1C"])[0],u=l[1]>>>5,c=l[1]&31,h=l[2]>>>7?"H":"M",d=(l[2]&64)>>6,m=(l[2]&32)>>5,g=u===2&&d?m?12:10:d?10:8,x=(l[2]&16)>>4,_=(l[2]&8)>>3,S=(l[2]&4)>>2,T=l[2]&3;i+="."+u+"."+Cl(c)+h+"."+Cl(g)+"."+x+"."+_+S+T+"."+Cl(1)+"."+Cl(1)+"."+Cl(1)+"."+0,s=Fx("dav1",t);break}}return{codec:i,encrypted:o,supplemental:s}}function Fx(r,e){const t=sn(e,["dvvC"]),n=t.length?t[0]:sn(e,["dvcC"])[0];if(n){const i=n[2]>>1&127,s=n[2]<<5&32|n[3]>>3&31;return r+"."+Cl(i)+"."+Cl(s)}}function RE(r,e){const t=e+5;for(;r[e++]&128&&e<t;);return e}function kx(r){return("0"+r.toString(16).toUpperCase()).slice(-2)}function Cl(r){return(r<10?"0":"")+r}function b$(r,e){if(!r||!e)return r;const t=e.keyId;return t&&e.isCommonEncryption&&sn(r,["moov","trak"]).forEach(i=>{const o=sn(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=sn(o,["enca"]);const l=a.length>0;l||(a=sn(o,["encv"])),a.forEach(u=>{const c=l?u.subarray(28):u.subarray(78);sn(c,["sinf"]).forEach(d=>{const m=Qk(d);if(m){const g=m.subarray(8,24);g.some(x=>x!==0)||(wn.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${bl.hexDump(g)} -> ${bl.hexDump(t)}`),m.set(t,8))}})})}),r}function Qk(r){const e=sn(r,["schm"])[0];if(e){const t=Sr(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return sn(r,["schi","tenc"])[0]}return null}function R$(r,e){return sn(e,["moof","traf"]).reduce((t,n)=>{const i=sn(n,["tfdt"])[0],s=i[0],o=sn(n,["tfhd"]).reduce((a,l)=>{const u=Jt(l,4),c=r[u];if(c){let h=Jt(i,4);if(s===1){if(h===sS)return wn.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;h*=sS+1,h+=Jt(i,8)}const d=c.timescale||9e4,m=h/d;if(Mt(m)&&(a===null||m<a))return m}return a},null);return o!==null&&Mt(o)&&(t===null||o<t)?o:t},null)}function I$(r,e){let t=0,n=0,i=0;const s=sn(r,["moof","traf"]);for(let o=0;o<s.length;o++){const a=s[o],l=sn(a,["tfhd"])[0],u=Jt(l,4),c=e[u];if(!c)continue;const h=c.default,d=Jt(l,0)|(h==null?void 0:h.flags);let m=h==null?void 0:h.duration;d&8&&(d&2?m=Jt(l,12):m=Jt(l,8));const g=c.timescale||9e4,x=sn(a,["trun"]);for(let _=0;_<x.length;_++){if(t=L$(x[_]),!t&&m){const S=Jt(x[_],4);t=m*S}c.type===Kn.VIDEO?n+=t/g:c.type===Kn.AUDIO&&(i+=t/g)}}if(n===0&&i===0){let o=1/0,a=0,l=0;const u=sn(r,["sidx"]);for(let c=0;c<u.length;c++){const h=w$(u[c]);if(h!=null&&h.references){o=Math.min(o,h.earliestPresentationTime/h.timescale);const d=h.references.reduce((m,g)=>m+g.info.duration||0,0);a=Math.max(a,d+h.earliestPresentationTime/h.timescale),l=a-o}}if(l&&Mt(l))return l}return n||i}function L$(r){const e=Jt(r,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=Jt(r,4);for(let s=0;s<i;s++){if(e&256){const o=Jt(r,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function P$(r,e,t){sn(e,["moof","traf"]).forEach(n=>{sn(n,["tfhd"]).forEach(i=>{const s=Jt(i,4),o=r[s];if(!o)return;const a=o.timescale||9e4;sn(n,["tfdt"]).forEach(l=>{const u=l[0],c=t*a;if(c){let h=Jt(l,4);if(u===0)h-=c,h=Math.max(h,0),bE(l,4,h);else{h*=Math.pow(2,32),h+=Jt(l,8),h-=c,h=Math.max(h,0);const d=Math.floor(h/(sS+1)),m=Math.floor(h%(sS+1));bE(l,4,d),bE(l,8,m)}}})})})}function D$(r){const e={valid:null,remainder:null},t=sn(r,["moof"]);if(t.length<2)return e.remainder=r,e;const n=t[t.length-1];return e.valid=r.slice(0,n.byteOffset-8),e.remainder=r.slice(n.byteOffset-8),e}function ga(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function YL(r,e){const t=[],n=e.samples,i=e.timescale,s=e.id;let o=!1;return sn(n,["moof"]).map(l=>{const u=l.byteOffset-8;sn(l,["traf"]).map(h=>{const d=sn(h,["tfdt"]).map(m=>{const g=m[0];let x=Jt(m,4);return g===1&&(x*=Math.pow(2,32),x+=Jt(m,8)),x/i})[0];return d!==void 0&&(r=d),sn(h,["tfhd"]).map(m=>{const g=Jt(m,4),x=Jt(m,0)&16777215,_=(x&1)!==0,S=(x&2)!==0,T=(x&8)!==0;let E=0;const C=(x&16)!==0;let R=0;const P=(x&32)!==0;let L=8;g===s&&(_&&(L+=8),S&&(L+=4),T&&(E=Jt(m,L),L+=4),C&&(R=Jt(m,L),L+=4),P&&(L+=4),e.type==="video"&&(o=xA(e.codec)),sn(h,["trun"]).map(F=>{const D=F[0],I=Jt(F,0)&16777215,N=(I&1)!==0;let V=0;const q=(I&4)!==0,Q=(I&256)!==0;let re=0;const ee=(I&512)!==0;let se=0;const W=(I&1024)!==0,$=(I&2048)!==0;let j=0;const U=Jt(F,4);let X=8;N&&(V=Jt(F,X),X+=4),q&&(X+=4);let le=V+u;for(let Z=0;Z<U;Z++){if(Q?(re=Jt(F,X),X+=4):re=E,ee?(se=Jt(F,X),X+=4):se=R,W&&(X+=4),$&&(D===0?j=Jt(F,X):j=Jk(F,X),X+=4),e.type===Kn.VIDEO){let oe=0;for(;oe<se;){const pe=Jt(n,le);if(le+=4,B$(o,n[le])){const de=n.subarray(le,le+pe);Qw(de,o?2:1,r+j/i,t)}le+=pe,oe+=pe+4}}r+=re/i}}))})})}),t}function xA(r){if(!r)return!1;const e=r.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function B$(r,e){if(r){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Qw(r,e,t,n){const i=Zk(r);let s=0;s+=e;let o=0,a=0,l=0;for(;s<i.length;){o=0;do{if(s>=i.length)break;l=i[s++],o+=l}while(l===255);a=0;do{if(s>=i.length)break;l=i[s++],a+=l}while(l===255);const u=i.length-s;let c=s;if(a<u)s+=a;else if(a>u){wn.error(`Malformed SEI payload. ${a} is too small, only ${u} bytes left to parse.`);break}if(o===4){if(i[c++]===181){const d=Yk(i,c);if(c+=2,d===49){const m=Jt(i,c);if(c+=4,m===1195456820){const g=i[c++];if(g===3){const x=i[c++],_=31&x,S=64&x,T=S?2+_*3:0,E=new Uint8Array(T);if(S){E[0]=x;for(let C=1;C<T;C++)E[C]=i[c++]}n.push({type:g,payloadType:o,pts:t,bytes:E})}}}}}else if(o===5&&a>16){const h=[];for(let g=0;g<16;g++){const x=i[c++].toString(16);h.push(x.length==1?"0"+x:x),(g===3||g===5||g===7||g===9)&&h.push("-")}const d=a-16,m=new Uint8Array(d);for(let g=0;g<d;g++)m[g]=i[c++];n.push({payloadType:o,pts:t,uuid:h.join(""),userData:Oo(m),userDataBytes:m})}}}function Zk(r){const e=r.byteLength,t=[];let n=1;for(;n<e-2;)r[n]===0&&r[n+1]===0&&r[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return r;const i=e-t.length,s=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=r[o];return s}function F$(r){const e=r[0];let t="",n="",i=0,s=0,o=0,a=0,l=0,u=0;if(e===0){for(;Sr(r.subarray(u,u+1))!=="\0";)t+=Sr(r.subarray(u,u+1)),u+=1;for(t+=Sr(r.subarray(u,u+1)),u+=1;Sr(r.subarray(u,u+1))!=="\0";)n+=Sr(r.subarray(u,u+1)),u+=1;n+=Sr(r.subarray(u,u+1)),u+=1,i=Jt(r,12),s=Jt(r,16),a=Jt(r,20),l=Jt(r,24),u=28}else if(e===1){u+=4,i=Jt(r,u),u+=4;const h=Jt(r,u);u+=4;const d=Jt(r,u);for(u+=4,o=2**32*h+d,h$(o)||(o=Number.MAX_SAFE_INTEGER,wn.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=Jt(r,u),u+=4,l=Jt(r,u),u+=4;Sr(r.subarray(u,u+1))!=="\0";)t+=Sr(r.subarray(u,u+1)),u+=1;for(t+=Sr(r.subarray(u,u+1)),u+=1;Sr(r.subarray(u,u+1))!=="\0";)n+=Sr(r.subarray(u,u+1)),u+=1;n+=Sr(r.subarray(u,u+1)),u+=1}const c=r.subarray(u,r.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:c}}function k$(r,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(r,4),i=0,n=8;i<t;i++)s.set(e[i],n),n+=e[i].byteLength;return s}function O$(r,e,t){if(r.byteLength!==16)throw new RangeError("Invalid system id");let n,i;n=0,i=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),k$([112,115,115,104],new Uint8Array([n,0,0,0]),r,s,i,o,t||new Uint8Array)}function U$(r){const e=[];if(r instanceof ArrayBuffer){const t=r.byteLength;let n=0;for(;n+32<t;){const i=new DataView(r,n),s=N$(i);e.push(s),n+=s.size}}return e}function N$(r){const e=r.getUint32(0),t=r.byteOffset,n=r.byteLength;if(n<e)return{offset:t,size:n};if(r.getUint32(4)!==1886614376)return{offset:t,size:e};const s=r.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const o=r.buffer,a=bl.hexDump(new Uint8Array(o,t+12,16)),l=r.getUint32(28);let u=null,c=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};c=new Uint8Array(o,t+32,l)}else if(s===1){if(!l||n<t+32+l*16+16)return{offset:t,size:e};u=[];for(let h=0;h<l;h++)u.push(new Uint8Array(o,t+32+h*16,16))}return{version:s,systemId:a,kids:u,data:c,offset:t,size:e}}const eO=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),mm={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function tO(r,e){const t=mm[e];return!!t&&!!t[r.slice(0,4)]}function XT(r,e,t=!0){return!r.split(",").some(n=>!nO(n,e,t))}function nO(r,e,t=!0){var n;const i=Zu(t);return(n=i==null?void 0:i.isTypeSupported(Z0(r,e)))!=null?n:!1}function Z0(r,e){return`${e}/mp4;codecs=${r}`}function JL(r){if(r){const e=r.substring(0,4);return mm.video[e]}return 2}function oS(r){const e=eO();return r.split(",").reduce((t,n)=>{const s=e&&xA(n)?9:mm.video[n];return s?(s*2+t)/(t?3:2):(mm.audio[n]+t)/(t?2:1)},0)}const IE={};function G$(r,e=!0){if(IE[r])return IE[r];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[r];for(let i=0;i<t.length;i++){var n;if(nO(t[i],"audio",e))return IE[r]=t[i],t[i];if(t[i]==="mp3"&&(n=Zu(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return r}const H$=/flac|opus|mp4a\.40\.34/i;function aS(r,e=!0){return r.replace(H$,t=>G$(t.toLowerCase(),e))}function z$(r,e){const t=[];if(r){const n=r.split(",");for(let i=0;i<n.length;i++)tO(n[i],"video")||t.push(n[i])}return e&&t.push(e),t.join(",")}function l_(r,e){if(r&&(r.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(r)!==-1))return r;if(e){const t=e.split(",");if(t.length>1){if(r){for(let n=t.length;n--;)if(t[n].substring(0,4)===r.substring(0,4))return t[n]}return t[0]}}return e||r}function V$(r){const e=r.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let i=n.shift()+".";i+=parseInt(n.shift()).toString(16),i+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=i}}return e.join(",")}function W$(r){if(r.startsWith("av01.")){const e=r.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return r}function qL(r){const e=Zu(r)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function iO(r){return r.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const rO={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function sO(r,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:r}}const QL={};function j$(r,e,t,n,i,s){const o=r.audioCodec?r.audioGroups:null,a=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):a?1/0:2;let c=null;if(o!=null&&o.length)try{o.length===1&&o[0]?c=e.groups[o[0]].channels:c=o.reduce((h,d)=>{if(d){const m=e.groups[d];if(!m)throw new Error(`Audio track group ${d} not found`);Object.keys(m.channels).forEach(g=>{h[g]=(h[g]||0)+m.channels[g]})}return h},{2:0})}catch{return!0}return r.videoCodec!==void 0&&(r.width>1920&&r.height>1088||r.height>1920&&r.width>1088||r.frameRate>Math.max(n,30)||r.videoRange!=="SDR"&&r.videoRange!==t||r.bitrate>Math.max(i,8e6))||!!c&&Mt(u)&&Object.keys(c).some(h=>parseInt(h)>u)}function oO(r,e,t){const n=r.videoCodec,i=r.audioCodec;if(!n&&!i||!t)return Promise.resolve(rO);const s=[];if(n){const o={width:r.width,height:r.height,bitrate:Math.ceil(Math.max(r.bitrate*.9,r.averageBitrate)),framerate:r.frameRate||30},a=r.videoRange;a!=="SDR"&&(o.transferFunction=a.toLowerCase());const l=n.split(","),u=navigator.userAgent;if(l.some(c=>xA(c))&&eO())return Promise.resolve(sO(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${u})`),s));s.push.apply(s,l.map(c=>({type:"media-source",video:Wn(Wn({},o),{},{contentType:Z0(W$(c),"video")})})))}return i&&r.audioGroups&&r.audioGroups.forEach(o=>{var a;o&&((a=e.groups[o])==null||a.tracks.forEach(l=>{if(l.groupId===o){const u=l.channels||"",c=parseFloat(u);Mt(c)&&c>2&&s.push.apply(s,i.split(",").map(h=>({type:"media-source",audio:{contentType:Z0(h,"audio"),channels:""+c}})))}}))}),Promise.all(s.map(o=>{const a=K$(o);return QL[a]||(QL[a]=t.decodingInfo(o))})).then(o=>({supported:!o.some(a=>!a.supported),configurations:s,decodingInfoResults:o})).catch(o=>({supported:!1,configurations:s,decodingInfoResults:[],error:o}))}function K$(r){const{audio:e,video:t}=r,n=t||e;if(n){const i=iO(n.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${i}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}const YT=["NONE","TYPE-0","TYPE-1",null];function $$(r){return YT.indexOf(r)>-1}const lS=["SDR","PQ","HLG"];function X$(r){return!!r&&lS.indexOf(r)>-1}var T0={No:"",Yes:"YES",v2:"v2"};function ZL(r){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=r,i=n<e/2;return e&&i?t?T0.v2:T0.Yes:T0.No}class JT{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class gm{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return eP(this._audioGroups,e)}hasSubtitleGroup(e){return eP(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function eP(r,e){return!e||!r?!1:r.indexOf(e)!==-1}function Y$(){if(typeof matchMedia=="function"){const r=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(r.media!==e.media)return r.matches===!0}return!1}function J$(r,e){let t=!1,n=[];if(r&&(t=r!=="SDR",n=[r]),e){n=e.allowedVideoRanges||lS.slice(0);const i=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:i&&Y$(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const q$=r=>{const e=new WeakSet;return(t,n)=>{if(r&&(n=r(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},yi=(r,e)=>JSON.stringify(r,q$(e));function Q$(r,e,t,n,i){const s=Object.keys(r),o=n==null?void 0:n.channels,a=n==null?void 0:n.audioCodec,l=i==null?void 0:i.videoCodec,u=o&&parseInt(o)===2;let c=!1,h=!1,d=1/0,m=1/0,g=1/0,x=1/0,_=0,S=[];const{preferHDR:T,allowedVideoRanges:E}=J$(e,i);for(let F=s.length;F--;){const D=r[s[F]];c||(c=D.channels[2]>0),d=Math.min(d,D.minHeight),m=Math.min(m,D.minFramerate),g=Math.min(g,D.minBitrate),E.filter(N=>D.videoRanges[N]>0).length>0&&(h=!0)}d=Mt(d)?d:0,m=Mt(m)?m:0;const C=Math.max(1080,d),R=Math.max(30,m);g=Mt(g)?g:t,t=Math.max(g,t),h||(e=void 0);const P=s.length>1;return{codecSet:s.reduce((F,D)=>{const I=r[D];if(D===F)return F;if(S=h?E.filter(N=>I.videoRanges[N]>0):[],P){if(I.minBitrate>t)return wl(D,`min bitrate of ${I.minBitrate} > current estimate of ${t}`),F;if(!I.hasDefaultAudio)return wl(D,"no renditions with default or auto-select sound found"),F;if(a&&D.indexOf(a.substring(0,4))%5!==0)return wl(D,`audio codec preference "${a}" not found`),F;if(o&&!u){if(!I.channels[o])return wl(D,`no renditions with ${o} channel sound found (channels options: ${Object.keys(I.channels)})`),F}else if((!a||u)&&c&&I.channels[2]===0)return wl(D,"no renditions with stereo sound found"),F;if(I.minHeight>C)return wl(D,`min resolution of ${I.minHeight} > maximum of ${C}`),F;if(I.minFramerate>R)return wl(D,`min framerate of ${I.minFramerate} > maximum of ${R}`),F;if(!S.some(N=>I.videoRanges[N]>0))return wl(D,`no variants with VIDEO-RANGE of ${yi(S)} found`),F;if(l&&D.indexOf(l.substring(0,4))%5!==0)return wl(D,`video codec preference "${l}" not found`),F;if(I.maxScore<_)return wl(D,`max score of ${I.maxScore} < selected max of ${_}`),F}return F&&(oS(D)>=oS(F)||I.fragmentError>r[F].fragmentError)?F:(x=I.minIndex,_=I.maxScore,D)},void 0),videoRanges:S,preferHDR:T,minFramerate:m,minBitrate:g,minIndex:x}}function wl(r,e){wn.log(`[abr] start candidates with "${r}" ignored because ${e}`)}function aO(r){return r.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Z$(r,e,t,n){return r.slice(t,n+1).reduce((i,s,o)=>{if(!s.codecSet)return i;const a=s.audioGroups;let l=i[s.codecSet];l||(i[s.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,s.bitrate);const u=Math.min(s.height,s.width);return l.minHeight=Math.min(l.minHeight,u),l.minFramerate=Math.min(l.minFramerate,s.frameRate),l.minIndex=Math.min(l.minIndex,o),l.maxScore=Math.max(l.maxScore,s.score),l.fragmentError+=s.fragmentError,l.videoRanges[s.videoRange]=(l.videoRanges[s.videoRange]||0)+1,a&&a.forEach(c=>{if(!c)return;const h=e.groups[c];h&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?h.hasDefault:h.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(h.channels).forEach(d=>{l.channels[d]=(l.channels[d]||0)+h.channels[d]}))}),i},{})}function tP(r){if(!r)return r;const{lang:e,assocLang:t,characteristics:n,channels:i,audioCodec:s}=r;return{lang:e,assocLang:t,characteristics:n,channels:i,audioCodec:s}}function Bl(r,e,t){if("attrs"in r){const n=e.indexOf(r);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(Kf(r,i,t))return n}return-1}function Kf(r,e,t){const{groupId:n,name:i,lang:s,assocLang:o,default:a}=r,l=r.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(s===void 0||e7(s,e.lang))&&(s===void 0||e.assocLang===o)&&(a===void 0||e.default===a)&&(l===void 0||e.forced===l)&&(!("characteristics"in r)||t7(r.characteristics||"",e.characteristics))&&(t===void 0||t(r,e))}function e7(r,e="--"){return r.length===e.length?r===e:r.startsWith(e)||e.startsWith(r)}function t7(r,e=""){const t=r.split(","),n=e.split(",");return t.length===n.length&&!t.some(i=>n.indexOf(i)===-1)}function Mf(r,e){const{audioCodec:t,channels:n}=r;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function n7(r,e,t,n,i){const s=e[n],a=e.reduce((d,m,g)=>{const x=m.uri;return(d[x]||(d[x]=[])).push(g),d},{})[s.uri];a.length>1&&(n=Math.max.apply(Math,a));const l=s.videoRange,u=s.frameRate,c=s.codecSet.substring(0,4),h=nP(e,n,d=>{if(d.videoRange!==l||d.frameRate!==u||d.codecSet.substring(0,4)!==c)return!1;const m=d.audioGroups,g=t.filter(x=>!m||m.indexOf(x.groupId)!==-1);return Bl(r,g,i)>-1});return h>-1?h:nP(e,n,d=>{const m=d.audioGroups,g=t.filter(x=>!m||m.indexOf(x.groupId)!==-1);return Bl(r,g,i)>-1})}function nP(r,e,t){for(let n=e;n>-1;n--)if(t(r[n]))return n;for(let n=e+1;n<r.length;n++)if(t(r[n]))return n;return-1}function uS(r,e){var t;return!!r&&r!==((t=e.loadLevelObj)==null?void 0:t.uri)}class lO extends ac{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:i,partCurrent:s,hls:o}=this,{autoLevelEnabled:a,media:l}=o;if(!i||!l)return;const u=performance.now(),c=s?s.stats:i.stats,h=s?s.duration:i.duration,d=u-c.loading.start,m=o.minAutoLevel,g=i.level,x=this._nextAutoLevel;if(c.aborted||c.loaded&&c.loaded===c.total||g<=m){this.clearTimer(),this._nextAutoLevel=-1;return}if(!a)return;const _=x>-1&&x!==g,S=!!t||_;if(!S&&(l.paused||!l.playbackRate||!l.readyState))return;const T=o.mainForwardBufferInfo;if(!S&&T===null)return;const E=this.bwEstimator.getEstimateTTFB(),C=Math.abs(l.playbackRate);if(d<=Math.max(E,1e3*(h/(C*2))))return;const R=T?T.len/C:0,P=c.loading.first?c.loading.first-c.loading.start:-1,L=c.loaded&&P>-1,F=this.getBwEstimate(),D=o.levels,I=D[g],N=Math.max(c.loaded,Math.round(h*(i.bitrate||I.averageBitrate)/8));let V=L?d-P:d;V<1&&L&&(V=Math.min(d,c.loaded*8/F));const q=L?c.loaded*1e3/V:0,Q=E/1e3,re=q?(N-c.loaded)/q:N*8/F+Q;if(re<=R)return;const ee=q?q*8:F,se=((n=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,W=this.hls.config.abrBandWidthUpFactor;let $=Number.POSITIVE_INFINITY,j;for(j=g-1;j>m;j--){const Z=D[j].maxBitrate,oe=!D[j].details||se;if($=this.getTimeToLoadFrag(Q,ee,h*Z,oe),$<Math.min(R,h+Q))break}if($>=re||$>h*10)return;L?this.bwEstimator.sample(d-Math.min(E,P),c.loaded):this.bwEstimator.sampleTTFB(d);const U=D[j].maxBitrate;this.getBwEstimate()*W>U&&this.resetEstimator(U);const X=this.findBestLevel(U,m,j,0,R,1,1);X>-1&&(j=X),this.warn(`Fragment ${i.sn}${s?" part "+s.index:""} of level ${g} is loading too slowly;
      Fragment duration: ${i.duration.toFixed(3)}
      Time to underbuffer: ${R.toFixed(3)} s
      Estimated load time for current fragment: ${re.toFixed(3)} s
      Estimated load time for down switch fragment: ${$.toFixed(3)} s
      TTFB estimate: ${P|0} ms
      Current BW estimate: ${Mt(F)?F|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${j} @ ${U|0} bps`),o.nextLoadLevel=o.nextAutoLevel=j,this.clearTimer();const le=()=>{if(this.clearTimer(),this.fragCurrent===i&&this.hls.loadLevel===j&&j>0){const Z=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${j>0?"and switching down":""}
      Fragment duration: ${i.duration.toFixed(3)} s
      Time to underbuffer: ${Z.toFixed(3)} s`),i.abortRequests(),this.fragCurrent=this.partCurrent=null,j>m){let oe=this.findBestLevel(this.hls.levels[m].bitrate,m,j,0,Z,1,1);oe===-1&&(oe=m),this.hls.nextLoadLevel=this.hls.nextAutoLevel=oe,this.resetEstimator(this.hls.levels[oe].bitrate)}}};_||re>$*2?le():this.timer=self.setInterval(le,$*1e3),o.trigger(H.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:s,stats:c})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new d$(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.FRAG_LOADING,this.onFragLoading,this),e.on(H.FRAG_LOADED,this.onFragLoaded,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this),e.on(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.FRAG_LOADING,this.onFragLoading,this),e.off(H.FRAG_LOADED,this.onFragLoaded,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this),e.off(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(H.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Le.BUFFER_ADD_CODEC_ERROR:case Le.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Le.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:i,partCurrent:s}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const o=performance.now(),a=s?s.stats:n.stats,l=o-a.loading.start,u=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&u>-1){const h=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(h,u),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,i){const s=e+n/t,o=i?e+this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,s=i.end-i.first;Mt(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Bt.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const s={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(H.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,s=i!=null&&i.stats.loaded?i.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Bt.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,t,e,0,i,1,1);if(s>-1)return s;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:s,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let c=s.abrBandWidthFactor,h=s.abrBandWidthUpFactor;if(u){const _=this.findBestLevel(l,o,i,u,0,c,h);if(_>=0)return this.rebufferNotice=-1,_}let d=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const _=this.bitrateTestDelay;_&&(d=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-_,this.info(`bitrate test took ${Math.round(1e3*_)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),c=h=1)}const m=this.findBestLevel(l,o,i,u,d,c,h);if(this.rebufferNotice!==m&&(this.rebufferNotice=m,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${m}`)),m>-1)return m;const g=n.levels[o],x=n.loadLevelObj;return x&&(g==null?void 0:g.bitrate)<x.bitrate?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,s,o,a){var l;const u=i+s,c=this.lastLoadedFragLevel,h=c===-1?this.hls.firstLevel:c,{fragCurrent:d,partCurrent:m}=this,{levels:g,allAudioTracks:x,loadLevel:_,config:S}=this.hls;if(g.length===1)return 0;const T=g[h],E=!!((l=this.hls.latestLevelDetails)!=null&&l.live),C=_===-1||c===-1;let R,P="SDR",L=(T==null?void 0:T.frameRate)||0;const{audioPreference:F,videoPreference:D}=S,I=this.audioTracksByGroup||(this.audioTracksByGroup=aO(x));let N=-1;if(C){if(this.firstSelection!==-1)return this.firstSelection;const ee=this.codecTiers||(this.codecTiers=Z$(g,I,t,n)),se=Q$(ee,P,e,F,D),{codecSet:W,videoRanges:$,minFramerate:j,minBitrate:U,minIndex:X,preferHDR:le}=se;N=X,R=W,P=le?$[$.length-1]:$[0],L=j,e=Math.max(e,U),this.log(`picked start tier ${yi(se)}`)}else R=T==null?void 0:T.codecSet,P=T==null?void 0:T.videoRange;const V=m?m.duration:d?d.duration:0,q=this.bwEstimator.getEstimateTTFB()/1e3,Q=[];for(let ee=n;ee>=t;ee--){var re;const se=g[ee],W=ee>h;if(!se)continue;if(S.useMediaCapabilities&&!se.supportedResult&&!se.supportedPromise){const oe=navigator.mediaCapabilities;typeof(oe==null?void 0:oe.decodingInfo)=="function"&&(j$(se,I,P,L,e,F)||xA(se.videoCodec))?(se.supportedPromise=oO(se,I,oe),se.supportedPromise.then(pe=>{if(!this.hls)return;se.supportedResult=pe;const de=this.hls.levels,ye=de.indexOf(se);pe.error?this.warn(`MediaCapabilities decodingInfo error: "${pe.error}" for level ${ye} ${yi(pe)}`):pe.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${ye} ${yi(pe)}`),ye>-1&&de.length>1&&(this.log(`Removing unsupported level ${ye}`),this.hls.removeLevel(ye),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):se.supportedResult=rO}if((R&&se.codecSet!==R||P&&se.videoRange!==P||W&&L>se.frameRate||!W&&L>0&&L<se.frameRate||se.supportedResult&&!((re=se.supportedResult.decodingInfoResults)!=null&&re[0].smooth))&&(!C||ee!==N)){Q.push(ee);continue}const $=se.details,j=(m?$==null?void 0:$.partTarget:$==null?void 0:$.averagetargetduration)||V;let U;W?U=a*e:U=o*e;const X=V&&i>=V*2&&s===0?se.averageBitrate:se.maxBitrate,le=this.getTimeToLoadFrag(q,U,X*j,$===void 0);if(U>=X&&(ee===c||se.loadError===0&&se.fragmentError===0)&&(le<=q||!Mt(le)||E&&!this.bitrateTestDelay||le<u)){const oe=this.forcedAutoLevel;return ee!==_&&(oe===-1||oe!==_)&&(Q.length&&this.trace(`Skipped level(s) ${Q.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${g[Q[0]].codecs}" ${g[Q[0]].videoRange}; not compatible with "${R}" ${P}`),this.info(`switch candidate:${h}->${ee} adjustedbw(${Math.round(U)})-bitrate=${Math.round(U-X)} ttfb:${q.toFixed(1)} avgDuration:${j.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${le.toFixed(1)} firstSelection:${C} codecSet:${se.codecSet} videoRange:${se.videoRange} hls.loadLevel:${_}`)),C&&(this.firstSelection=ee),ee}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const Zw={search:function(r,e){let t=0,n=r.length-1,i=null,s=null;for(;t<=n;){i=(t+n)/2|0,s=r[i];const o=e(s);if(o>0)t=i+1;else if(o<0)n=i-1;else return s}return null}};function i7(r,e,t){if(e===null||!Array.isArray(r)||!r.length||!Mt(e))return null;const n=r[0].programDateTime;if(e<(n||0))return null;const i=r[r.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let s=0;s<r.length;++s){const o=r[s];if(s7(e,t,o))return o}return null}function sd(r,e,t=0,n=0,i=.005){let s=null;if(r){s=e[1+r.sn-e[0].sn]||null;const a=r.endDTS-t;a>0&&a<15e-7&&(t+=15e-7),s&&r.level!==s.level&&s.end<=r.end&&(s=e[2+r.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!r||r.level===s.level)&&iP(t,n,s)===0||r7(s,r,Math.min(i,n))))return s;const o=Zw.search(e,iP.bind(null,t,n));return o&&(o!==r||!s)?o:s}function r7(r,e,t){if(e&&e.start===0&&e.level<r.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((i,s)=>(s[0]==="INF"&&(i+=parseFloat(s[1])),i),t);return r.start<=n}return!1}function iP(r=0,e=0,t){if(t.start<=r&&t.start+t.duration>r)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=r?1:t.start-n>r&&t.start?-1:0}function s7(r,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>r}function uO(r,e){return Zw.search(r,t=>t.cc<e?1:t.cc>e?-1:0)}function o7(r,e,t){if(r&&r.startCC<=e&&r.endCC>=e){const n=t.start,i=t.end;let s=r.fragments;if(!t.relurl){const{fragmentHint:o}=r;o&&(s=s.concat(o))}return Zw.search(s,o=>o.cc<e||o.end<=n?1:o.cc>e||o.start>=i?-1:0)}return null}function cS(r){switch(r.details){case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_TIMEOUT:case Le.LEVEL_LOAD_TIMEOUT:case Le.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function rP(r,e){const t=cS(e);return r.default[`${t?"timeout":"error"}Retry`]}function eC(r,e){const t=r.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*r.retryDelayMs,r.maxRetryDelayMs)}function sP(r){return Wn(Wn({},r),{errorRetry:null,timeoutRetry:null})}function hS(r,e,t,n){if(!r)return!1;const i=n==null?void 0:n.code,s=e<r.maxNumRetry&&(a7(i)||!!t);return r.shouldRetry?r.shouldRetry(r,e,t,n,s):s}function a7(r){return r===0&&navigator.onLine===!1||!!r&&(r<400||r>499)}var Ur={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ca={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class cO extends ac{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(H.ERROR,this.onError,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(H.ERROR,this.onError,this),e.off(H.ERROR,this.onErrorOut,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Bt.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,s=t.context;switch(t.details){case Le.FRAG_LOAD_ERROR:case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_ERROR:case Le.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Le.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=ev();return}case Le.FRAG_GAP:case Le.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ur.SendAlternateToPenaltyBox;return}case Le.LEVEL_EMPTY_ERROR:case Le.LEVEL_PARSING_ERROR:{var o,a;const u=t.parent===Bt.MAIN?t.level:i.loadLevel;t.details===Le.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(a=o.levelDetails)!=null&&a.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case Le.LEVEL_LOAD_ERROR:case Le.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case Le.AUDIO_TRACK_LOAD_ERROR:case Le.AUDIO_TRACK_LOAD_TIMEOUT:case Le.SUBTITLE_LOAD_ERROR:case Le.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const u=i.loadLevelObj;if(u&&(s.type===_n.AUDIO_TRACK&&u.hasAudioGroup(s.groupId)||s.type===_n.SUBTITLE_TRACK&&u.hasSubtitleGroup(s.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Ur.SendAlternateToPenaltyBox,t.errorAction.flags=ca.MoveAllAlternatesMatchingHost;return}}return;case Le.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=i.loadLevelObj,c=u==null?void 0:u.attrs["HDCP-LEVEL"];c?t.errorAction={action:Ur.SendAlternateToPenaltyBox,flags:ca.MoveAllAlternatesMatchingHDCP,hdcpLevel:c}:this.keySystemError(t)}return;case Le.BUFFER_ADD_CODEC_ERROR:case Le.REMUX_ALLOC_ERROR:case Le.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:i.loadLevel)}return;case Le.INTERNAL_EXCEPTION:case Le.BUFFER_APPENDING_ERROR:case Le.BUFFER_FULL_ERROR:case Le.LEVEL_SWITCH_ERROR:case Le.BUFFER_STALLED_ERROR:case Le.BUFFER_SEEK_OVER_HOLE:case Le.BUFFER_NUDGE_ON_STALL:t.errorAction=ev();return}t.type===Nt.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=rP(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(hS(i,s,cS(e),e.response))return{action:Ur.RetryRequest,flags:ca.None,retryConfig:i,retryCount:s};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=s),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=rP(e.details.startsWith("key")?o:s,e),l=t.levels.reduce((c,h)=>c+h.fragmentError,0);if(i&&(e.details!==Le.FRAG_GAP&&i.fragmentError++,hS(a,l,cS(e),e.response)))return{action:Ur.RetryRequest,flags:ca.None,retryConfig:a,retryCount:l};const u=this.getLevelSwitchAction(e,n);return a&&(u.retryConfig=a,u.retryCount=l),u}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var s,o;const u=e.details;i.loadError++,u===Le.BUFFER_APPEND_ERROR&&i.fragmentError++;let c=-1;const{levels:h,loadLevel:d,minAutoLevel:m,maxAutoLevel:g}=n;n.autoLevelEnabled||(n.loadLevel=-1);const x=(s=e.frag)==null?void 0:s.type,S=(x===Bt.AUDIO&&u===Le.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===Le.BUFFER_ADD_CODEC_ERROR||u===Le.BUFFER_APPEND_ERROR))&&h.some(({audioCodec:P})=>i.audioCodec!==P),E=e.sourceBufferName==="video"&&(u===Le.BUFFER_ADD_CODEC_ERROR||u===Le.BUFFER_APPEND_ERROR)&&h.some(({codecSet:P,audioCodec:L})=>i.codecSet!==P&&i.audioCodec===L),{type:C,groupId:R}=(o=e.context)!=null?o:{};for(let P=h.length;P--;){const L=(P+d)%h.length;if(L!==d&&L>=m&&L<=g&&h[L].loadError===0){var a,l;const F=h[L];if(u===Le.FRAG_GAP&&x===Bt.MAIN&&e.frag){const D=h[L].details;if(D){const I=sd(e.frag,D.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(C===_n.AUDIO_TRACK&&F.hasAudioGroup(R)||C===_n.SUBTITLE_TRACK&&F.hasSubtitleGroup(R))continue;if(x===Bt.AUDIO&&(a=i.audioGroups)!=null&&a.some(D=>F.hasAudioGroup(D))||x===Bt.SUBTITLE&&(l=i.subtitleGroups)!=null&&l.some(D=>F.hasSubtitleGroup(D))||S&&i.audioCodec===F.audioCodec||!S&&i.audioCodec!==F.audioCodec||E&&i.codecSet===F.codecSet)continue}c=L;break}}if(c>-1&&n.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:Ur.SendAlternateToPenaltyBox,flags:ca.None,nextAutoLevel:c}}return{action:Ur.SendAlternateToPenaltyBox,flags:ca.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Ur.DoNothing:break;case Ur.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Le.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case Ur.RetryRequest:break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:s,nextAutoLevel:o}=n;switch(i){case ca.None:this.switchLevel(e,o);break;case ca.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=YT[YT.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Le.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=iO(e.mimeType),i=this.hls.levels;for(let s=i.length;s--;)i[s][`${e.sourceBufferName}Codec`]===n&&this.hls.removeLevel(s)}}}function ev(r){const e={action:Ur.DoNothing,flags:ca.None};return r&&(e.resolved=!0),e}var Ar={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class l7{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.BUFFER_APPENDED,this.onBufferAppended,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this),e.on(H.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.BUFFER_APPENDED,this.onBufferAppended,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this),e.off(H.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const s=n[i];if(!s)break;const o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,s=Object.keys(i);for(let o=s.length;o--;){const a=i[s[o]];if((a==null?void 0:a.body.type)===t&&(!n||a.buffered)){const l=a.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,n,i,s){this.timeRanges&&(this.timeRanges[e]=t);const o=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const l=this.fragments[a];if(!l||o>=l.body.sn)return;if(!l.buffered&&(!l.loaded||s)){l.body.type===n&&this.removeFragment(l.body);return}const u=l.range[e];if(u){if(u.time.length===0){this.removeFragment(l.body);return}u.time.some(c=>{const h=!this.isTimeBuffered(c.startPTS,c.endPTS,t);return h&&this.removeFragment(l.body),h})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,i=Pp(n),s=this.fragments[i];if(!s||s.buffered&&n.gap)return;const o=!n.relurl;Object.keys(t).forEach(a=>{const l=n.elementaryStreams[a];if(!l)return;const u=t[a],c=o||l.partial===!0;s.range[a]=this.getBufferedTimes(n,e.part,c,u)}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=n.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),Ox(s)||this.removeParts(n.sn-1,n.type)):this.removeFragment(s.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=Pp(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const s={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,u=e.maxStartPTS||o;for(let c=0;c<i.length;c++){const h=i.start(c)-this.bufferPadding,d=i.end(c)+this.bufferPadding;if(u>=h&&l<=d){s.time.push({startPTS:Math.max(o,i.start(c)),endPTS:Math.min(a,i.end(c))});break}else if(o<d&&a>h){const m=Math.max(o,i.start(c)),g=Math.min(a,i.end(c));g>m&&(s.partial=!0,s.time.push({startPTS:m,endPTS:g}))}else if(a<=h)break}return s}getPartialFragment(e){let t=null,n,i,s,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(u=>{const c=l[u];c&&Ox(c)&&(i=c.body.start-a,s=c.body.end+a,e>=i&&e<=s&&(n=Math.min(e-i,s-e),o<=n&&(t=c.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ox(t))}getState(e){const t=Pp(e),n=this.fragments[t];return n?n.buffered?Ox(n)?Ar.PARTIAL:Ar.OK:Ar.APPENDING:Ar.NOT_LOADED}isTimeBuffered(e,t,n){let i,s;for(let o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=i&&t<=s)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,s=Pp(n);this.fragments[s]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:s,type:o}=t;if(n.sn==="initSegment")return;const a=n.type;if(i){let u=this.activePartLists[a];u||(this.activePartLists[a]=u=[]),u.push(i)}this.timeRanges=s;const l=s[o];this.detectEvictedFragments(o,l,a,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Pp(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const s=t[n[i]];if((s==null?void 0:s.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,s){i&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=Pp(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const n=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;n&&n.forEach(i=>i.clearElementaryStreamInfo())}}function Ox(r){var e,t,n;return r.buffered&&(r.body.gap||((e=r.range.video)==null?void 0:e.partial)||((t=r.range.audio)==null?void 0:t.partial)||((n=r.range.audiovideo)==null?void 0:n.partial))}function Pp(r){return`${r.type}_${r.level}_${r.sn}`}var dh={cbc:0,ctr:1};class u7{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case dh.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case dh.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function c7(r){const e=r.byteLength,t=e&&new DataView(r.buffer).getUint8(e-1);return t?r.slice(0,e-t):r}class h7{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],s=n[1],o=n[2],a=n[3],l=this.invSubMix,u=l[0],c=l[1],h=l[2],d=l[3],m=new Uint32Array(256);let g=0,x=0,_=0;for(_=0;_<256;_++)_<128?m[_]=_<<1:m[_]=_<<1^283;for(_=0;_<256;_++){let S=x^x<<1^x<<2^x<<3^x<<4;S=S>>>8^S&255^99,e[g]=S,t[S]=g;const T=m[g],E=m[T],C=m[E];let R=m[S]*257^S*16843008;i[g]=R<<24|R>>>8,s[g]=R<<16|R>>>16,o[g]=R<<8|R>>>24,a[g]=R,R=C*16843009^E*65537^T*257^g*16843008,u[S]=R<<24|R>>>8,c[S]=R<<16|R>>>16,h[S]=R<<8|R>>>24,d[S]=R,g?(g=T^m[m[m[C^T]]],x^=m[m[x]]):g=x=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let a,l;const u=this.keySchedule=new Uint32Array(o),c=this.invKeySchedule=new Uint32Array(o),h=this.sBox,d=this.rcon,m=this.invSubMix,g=m[0],x=m[1],_=m[2],S=m[3];let T,E;for(a=0;a<o;a++){if(a<s){T=u[a]=t[a];continue}E=T,a%s===0?(E=E<<8|E>>>24,E=h[E>>>24]<<24|h[E>>>16&255]<<16|h[E>>>8&255]<<8|h[E&255],E^=d[a/s|0]<<24):s>6&&a%s===4&&(E=h[E>>>24]<<24|h[E>>>16&255]<<16|h[E>>>8&255]<<8|h[E&255]),u[a]=T=(u[a-s]^E)>>>0}for(l=0;l<o;l++)a=o-l,l&3?E=u[a]:E=u[a-4],l<4||a<=4?c[l]=E:c[l]=g[h[E>>>24]]^x[h[E>>>16&255]]^_[h[E>>>8&255]]^S[h[E&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],u=a[1],c=a[2],h=a[3],d=this.uint8ArrayToUint32Array_(n);let m=d[0],g=d[1],x=d[2],_=d[3];const S=new Int32Array(e),T=new Int32Array(S.length);let E,C,R,P,L,F,D,I,N,V,q,Q,re,ee;const se=this.networkToHostOrderSwap;for(;t<S.length;){for(N=se(S[t]),V=se(S[t+1]),q=se(S[t+2]),Q=se(S[t+3]),L=N^s[0],F=Q^s[1],D=q^s[2],I=V^s[3],re=4,ee=1;ee<i;ee++)E=l[L>>>24]^u[F>>16&255]^c[D>>8&255]^h[I&255]^s[re],C=l[F>>>24]^u[D>>16&255]^c[I>>8&255]^h[L&255]^s[re+1],R=l[D>>>24]^u[I>>16&255]^c[L>>8&255]^h[F&255]^s[re+2],P=l[I>>>24]^u[L>>16&255]^c[F>>8&255]^h[D&255]^s[re+3],L=E,F=C,D=R,I=P,re=re+4;E=o[L>>>24]<<24^o[F>>16&255]<<16^o[D>>8&255]<<8^o[I&255]^s[re],C=o[F>>>24]<<24^o[D>>16&255]<<16^o[I>>8&255]<<8^o[L&255]^s[re+1],R=o[D>>>24]<<24^o[I>>16&255]<<16^o[L>>8&255]<<8^o[F&255]^s[re+2],P=o[I>>>24]<<24^o[L>>16&255]<<16^o[F>>8&255]<<8^o[D&255]^s[re+3],T[t]=se(E^m),T[t+1]=se(P^g),T[t+2]=se(R^x),T[t+3]=se(C^_),m=N,g=V,x=q,_=Q,t=t+4}return T.buffer}}class f7{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=d7(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function d7(r){switch(r){case dh.cbc:return"AES-CBC";case dh.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${r}`)}}const p7=16;class tC{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?c7(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise((s,o)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,n,i);const l=this.flush();l?s(l.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:s,currentResult:o,remainderData:a}=this;if(i!==dh.cbc||t.byteLength!==16)return wn.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=ga(a,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;s&&(n=s);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new h7),u.expandKey(t);const c=o;return this.currentResult=u.decrypt(l.buffer,0,n),this.currentIV=l.slice(-16).buffer,c||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new f7(this.subtle,t,i)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new u7(this.subtle,new Uint8Array(n),i).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(wn.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,n,i)))}onWebCryptoError(e,t,n,i){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%p7;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(wn.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const oP=Math.pow(2,17);class m7{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Pu({type:Nt.NETWORK_ERROR,details:Le.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,s=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(g=>g[0]==="GAP")){l(lP(e));return}else e.gap=!1;const u=this.loader=s?new s(i):new o(i),c=aP(e);e.loader=u;const h=sP(i.fragLoadPolicy.default),d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:oP};e.stats=u.stats;const m={onSuccess:(g,x,_,S)=>{this.resetLoader(e,u);let T=g.data;_.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),a({frag:e,part:null,payload:T,networkDetails:S})},onError:(g,x,_,S)=>{this.resetLoader(e,u),l(new Pu({type:Nt.NETWORK_ERROR,details:Le.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Wn({url:n,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:_,stats:S}))},onAbort:(g,x,_)=>{this.resetLoader(e,u),l(new Pu({type:Nt.NETWORK_ERROR,details:Le.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:_,stats:g}))},onTimeout:(g,x,_)=>{this.resetLoader(e,u),l(new Pu({type:Nt.NETWORK_ERROR,details:Le.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:_,stats:g}))}};t&&(m.onProgress=(g,x,_,S)=>t({frag:e,part:null,payload:_,networkDetails:S})),u.load(c,d,m)})}loadPart(e,t,n){this.abort();const i=this.config,s=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(lP(e,t));return}const u=this.loader=s?new s(i):new o(i),c=aP(e,t);e.loader=u;const h=sP(i.fragLoadPolicy.default),d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:oP};t.stats=u.stats,u.load(c,d,{onSuccess:(m,g,x,_)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const S={frag:e,part:t,payload:m.data,networkDetails:_};n(S),a(S)},onError:(m,g,x,_)=>{this.resetLoader(e,u),l(new Pu({type:Nt.NETWORK_ERROR,details:Le.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Wn({url:c.url,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:x,stats:_}))},onAbort:(m,g,x)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new Pu({type:Nt.NETWORK_ERROR,details:Le.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:x,stats:m}))},onTimeout:(m,g,x)=>{this.resetLoader(e,u),l(new Pu({type:Nt.NETWORK_ERROR,details:Le.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:x,stats:m}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,s=i.total;if(n.loaded+=i.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(n.loaded/s),l),h=(l-u)*Math.round(n.loaded/u);n.total=n.loaded+h}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=i.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function aP(r,e=null){const t=e||r,n={frag:r,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(Mt(i)&&Mt(s)){var o;let a=i,l=s;if(r.sn==="initSegment"&&g7((o=r.decryptdata)==null?void 0:o.method)){const u=s-i;u%16&&(l=s+(16-u%16)),i!==0&&(n.resetIV=!0,a=i-16)}n.rangeStart=a,n.rangeEnd=l}return n}function lP(r,e){const t=new Error(`GAP ${r.gap?"tag":"attribute"} found`),n={type:Nt.MEDIA_ERROR,details:Le.FRAG_GAP,fatal:!1,frag:r,error:t,networkDetails:null};return e&&(n.part=e),(e||r).stats.aborted=!0,new Pu(n)}function g7(r){return r==="AES-128"||r==="AES-256"}class Pu extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class hO extends ac{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class _A{constructor(e,t,n,i=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ux(),this.buffering={audio:Ux(),video:Ux(),audiovideo:Ux()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=s,this.partial=o}}function Ux(){return{start:0,executeStart:0,executeEnd:0,end:0}}const uP={length:0,start:()=>0,end:()=>0};class pn{static isBuffered(e,t){if(e){const n=pn.getBuffered(e);for(let i=n.length;i--;)if(t>=n.start(i)&&t<=n.end(i))return!0}return!1}static bufferedRanges(e){if(e){const t=pn.getBuffered(e);return pn.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=pn.bufferedRanges(e);if(i.length)return pn.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((c,h)=>c.start-h.start||h.end-c.end);let i=-1,s=[];if(n)for(let c=0;c<e.length;c++){t>=e[c].start&&t<=e[c].end&&(i=c);const h=s.length;if(h){const d=s[h-1].end;e[c].start-d<n?e[c].end>d&&(s[h-1].end=e[c].end):s.push(e[c])}else s.push(e[c])}else s=e;let o=0,a,l=t,u=t;for(let c=0;c<s.length;c++){const h=s[c].start,d=s[c].end;if(i===-1&&t>=h&&t<=d&&(i=c),t+n>=h&&t<d)l=h,u=d,o=u-t;else if(t+n<h){a=h;break}}return{len:o,start:l||0,end:u||0,nextStart:a,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||uP}catch(t){return wn.log("failed to get media.buffered",t),uP}}}const fO=/\{\$([a-zA-Z0-9-_]+)\}/g;function cP(r){return fO.test(r)}function qT(r,e){if(r.variableList!==null||r.hasVariableRefs){const t=r.variableList;return e.replace(fO,n=>{const i=n.substring(2,n.length-1),s=t==null?void 0:t[i];return s===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):s})}return e}function hP(r,e,t){let n=r.variableList;n||(r.variableList=n={});let i,s;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(i))s=o.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(o){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else i=e.NAME,s=e.VALUE;i in n?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=s||""}function v7(r,e,t){const n=e.IMPORT;if(t&&n in t){let i=r.variableList;i||(r.variableList=i={}),i[n]=t[n]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const y7=/^(\d+)x(\d+)$/,fP=/(.+?)=(".*?"|.*?)(?:,|$)/g;class pi{constructor(e,t){typeof e=="string"&&(e=pi.parseAttrList(e,t)),$n(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((i,s)=>(i[s.toLowerCase()]=!0,i),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=y7.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={},s='"';for(fP.lastIndex=0;(n=fP.exec(e))!==null;){const o=n[1].trim();let a=n[2];const l=a.indexOf(s)===0&&a.lastIndexOf(s)===a.length-1;let u=!1;if(l)a=a.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(l||u))a=qT(t,a);else if(!u&&!l)switch(o){case"CLOSED-CAPTIONS":if(a==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":wn.warn(`${e}: attribute ${o} is missing quotes`)}i[o]=a}return i}}const x7="com.apple.hls.interstitial";function _7(r){return r!=="ID"&&r!=="CLASS"&&r!=="CUE"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function S7(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"||r==="SCTE35-CMD"}class nC{constructor(e,t,n=0){var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(i=t==null?void 0:t.tagOrder)!=null?i:n,t){const s=t.attr;for(const o in s)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==s[o]){wn.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=$n(new pi({}),s,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Mt(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(wn.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Mt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===x7}get isValid(){return!!this.id&&!this._badValueForSameId&&Mt(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const A7=10;class dO{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?Mt(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||A7}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function nm(r){return r==="AES-128"||r==="AES-256"||r==="AES-256-CTR"}function iC(r){switch(r){case"AES-128":case"AES-256":return dh.cbc;case"AES-256-CTR":return dh.ctr;default:throw new Error(`invalid full segment method ${r}`)}}function rC(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0))}function QT(r){return Uint8Array.from(unescape(encodeURIComponent(r)),e=>e.charCodeAt(0))}function E7(r){const e=QT(r).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function T7(r){const e=function(n,i,s){const o=n[i];n[i]=n[s],n[s]=o};e(r,0,3),e(r,1,2),e(r,4,5),e(r,6,7)}function M7(r){const e=r.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const s=i[0]==="base64",o=i[1];s?(n.splice(-1,1),t=rC(o)):t=E7(o)}}return t}const fS=typeof self<"u"?self:void 0;var Gn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ks={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function LE(r){switch(r){case ks.FAIRPLAY:return Gn.FAIRPLAY;case ks.PLAYREADY:return Gn.PLAYREADY;case ks.WIDEVINE:return Gn.WIDEVINE;case ks.CLEARKEY:return Gn.CLEARKEY}}var Nx={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function PE(r){if(r===Nx.WIDEVINE)return Gn.WIDEVINE;if(r===Nx.PLAYREADY)return Gn.PLAYREADY;if(r===Nx.CENC||r===Nx.CLEARKEY)return Gn.CLEARKEY}function DE(r){switch(r){case Gn.FAIRPLAY:return ks.FAIRPLAY;case Gn.PLAYREADY:return ks.PLAYREADY;case Gn.WIDEVINE:return ks.WIDEVINE;case Gn.CLEARKEY:return ks.CLEARKEY}}function Gx(r){const{drmSystems:e,widevineLicenseUrl:t}=r,n=e?[Gn.FAIRPLAY,Gn.WIDEVINE,Gn.PLAYREADY,Gn.CLEARKEY].filter(i=>!!e[i]):[];return!n[Gn.WIDEVINE]&&t&&n.push(Gn.WIDEVINE),n}const sC=function(r){return fS!=null&&(r=fS.navigator)!=null&&r.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function w7(r,e,t,n){let i;switch(r){case Gn.FAIRPLAY:i=["cenc","sinf"];break;case Gn.WIDEVINE:case Gn.PLAYREADY:i=["cenc"];break;case Gn.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return C7(i,e,t,n)}function C7(r,e,t,n){return[{initDataTypes:r,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function pO(r){const e=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(o){const a=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(a){const l=rC(a).subarray(0,16);return T7(l),l}}return null}let Hx={};class vm{static clearKeyUriToKeyIdMap(){Hx={}}constructor(e,t,n,i=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!nm(e)}isSupported(){if(this.method){if(nm(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ks.FAIRPLAY:case ks.WIDEVINE:case ks.PLAYREADY:case ks.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(nm(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(wn.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=b7(e);return new vm(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=M7(this.uri);if(t)switch(this.keyFormat){case ks.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case ks.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=O$(n,null,t),this.keyId=pO(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Hx[this.uri];if(!n){const i=Object.keys(Hx).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),Hx[this.uri]=n}this.keyId=n}return this}}function b7(r){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=r>>8*(15-t)&255;return e}const dP=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,pP=/#EXT-X-MEDIA:(.*)/g,R7=/^#EXT(?:INF|-X-TARGETDURATION):/m,BE=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),I7=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class qa{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return Jw.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return R7.test(e)}static parseMasterPlaylist(e,t){const n=cP(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];dP.lastIndex=0;let o;for(;(o=dP.exec(e))!=null;)if(o[1]){var a;const u=new pi(o[1],i),c=qT(i,o[2]),h={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:qa.resolve(c,t)},d=u.decimalResolution("RESOLUTION");d&&(h.width=d.width,h.height=d.height),vP(u.CODECS,h);const m=u["SUPPLEMENTAL-CODECS"];m&&(h.supplemental={},vP(m,h.supplemental)),(a=h.unknownCodecs)!=null&&a.length||s.push(h),i.levels.push(h)}else if(o[3]){const u=o[3],c=o[4];switch(u){case"SESSION-DATA":{const h=new pi(c,i),d=h["DATA-ID"];d&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[d]=h);break}case"SESSION-KEY":{const h=mP(c,t,i);h.encrypted&&h.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(h)):wn.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const h=new pi(c,i);hP(i,h,t)}break}case"CONTENT-STEERING":{const h=new pi(c,i);i.contentSteering={uri:qa.resolve(h["SERVER-URI"],t),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=gP(c);break}}}const l=s.length>0&&s.length<i.levels.length;return i.levels=l?s:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const s={},o=n.levels,a={AUDIO:o.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:o.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(pP.lastIndex=0;(i=pP.exec(e))!==null;){const u=new pi(i[1],n),c=u.TYPE;if(c){const h=a[c],d=s[c]||[];s[c]=d;const m=u.LANGUAGE,g=u["ASSOC-LANGUAGE"],x=u.CHANNELS,_=u.CHARACTERISTICS,S=u["INSTREAM-ID"],T={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||m||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:m,url:u.URI?qa.resolve(u.URI,t):""};if(g&&(T.assocLang=g),x&&(T.channels=x),_&&(T.characteristics=_),S&&(T.instreamId=S),h!=null&&h.length){const E=qa.findGroup(h,T.groupId)||h[0];yP(T,E,"audioCodec"),yP(T,E,"textCodec")}d.push(T)}}return s}static parseLevelPlaylist(e,t,n,i,s,o){var a;const l={url:t},u=new dO(t),c=u.fragments,h=[];let d=null,m=0,g=0,x=0,_=0,S=0,T=null,E=new a_(i,l),C,R,P,L=-1,F=!1,D=null,I;if(BE.lastIndex=0,u.m3u8=e,u.hasVariableRefs=cP(e),((a=BE.exec(e))==null?void 0:a[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(C=BE.exec(e))!==null;){F&&(F=!1,E=new a_(i,l),E.playlistOffset=x,E.start=x,E.sn=m,E.cc=_,S&&(E.bitrate=S),E.level=n,d&&(E.initSegment=d,d.rawProgramDateTime&&(E.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null),D&&(E.setByteRange(D),D=null)));const Q=C[1];if(Q){E.duration=parseFloat(Q);const re=(" "+C[2]).slice(1);E.title=re||null,E.tagList.push(re?["INF",Q,re]:["INF",Q])}else if(C[3]){if(Mt(E.duration)){E.playlistOffset=x,E.start=x,P&&_P(E,P,u),E.sn=m,E.level=n,E.cc=_,c.push(E);const re=(" "+C[3]).slice(1);E.relurl=qT(u,re),ZT(E,T,h),T=E,x+=E.duration,m++,g=0,F=!0}}else{if(C=C[0].match(I7),!C){wn.warn("No matches on slow regex match for level playlist!");continue}for(R=1;R<C.length&&C[R]===void 0;R++);const re=(" "+C[R]).slice(1),ee=(" "+C[R+1]).slice(1),se=C[R+2]?(" "+C[R+2]).slice(1):null;switch(re){case"BYTERANGE":T?E.setByteRange(ee,T):E.setByteRange(ee);break;case"PROGRAM-DATE-TIME":E.rawProgramDateTime=ee,E.tagList.push(["PROGRAM-DATE-TIME",ee]),L===-1&&(L=c.length);break;case"PLAYLIST-TYPE":u.type&&Ru(u,re,C),u.type=ee.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?Ru(u,re,C):c.length>0&&SP(u,re,C),m=u.startSN=parseInt(ee);break;case"SKIP":{u.skippedSegments&&Ru(u,re,C);const W=new pi(ee,u),$=W.decimalInteger("SKIPPED-SEGMENTS");if(Mt($)){u.skippedSegments+=$;for(let U=$;U--;)c.push(null);m+=$}const j=W.enumeratedString("RECENTLY-REMOVED-DATERANGES");j&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(j.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&Ru(u,re,C),u.targetduration=Math.max(parseInt(ee),1);break;case"VERSION":u.version!==null&&Ru(u,re,C),u.version=parseInt(ee);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||Ru(u,re,C),u.live=!1;break;case"#":(ee||se)&&E.tagList.push(se?[ee,se]:[ee]);break;case"DISCONTINUITY":_++,E.tagList.push(["DIS"]);break;case"GAP":E.gap=!0,E.tagList.push([re]);break;case"BITRATE":E.tagList.push([re,ee]),S=parseInt(ee)*1e3,Mt(S)?E.bitrate=S:S=0;break;case"DATERANGE":{const W=new pi(ee,u),$=new nC(W,u.dateRanges[W.ID],u.dateRangeTagCount);u.dateRangeTagCount++,$.isValid||u.skippedSegments?u.dateRanges[$.id]=$:wn.warn(`Ignoring invalid DATERANGE tag: "${ee}"`),E.tagList.push(["EXT-X-DATERANGE",ee]);break}case"DEFINE":{{const W=new pi(ee,u);"IMPORT"in W?v7(u,W,o):hP(u,W,t)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?Ru(u,re,C):c.length>0&&SP(u,re,C),u.startCC=_=parseInt(ee);break;case"KEY":{const W=mP(ee,t,u);if(W.isSupported()){if(W.method==="NONE"){P=void 0;break}P||(P={}),P[W.keyFormat]&&(P=$n({},P)),P[W.keyFormat]=W}else wn.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${ee}"`);break}case"START":u.startTimeOffset=gP(ee);break;case"MAP":{const W=new pi(ee,u);if(E.duration){const $=new a_(i,l);xP($,W,n,P),d=$,E.initSegment=d,d.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=d.rawProgramDateTime)}else{const $=E.byteRangeEndOffset;if($){const j=E.byteRangeStartOffset;D=`${$-j}@${j}`}else D=null;xP(E,W,n,P),d=E,F=!0}d.cc=_;break}case"SERVER-CONTROL":{I&&Ru(u,re,C),I=new pi(ee),u.canBlockReload=I.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=I.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&I.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=I.optionalFloat("PART-HOLD-BACK",0),u.holdBack=I.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&Ru(u,re,C);const W=new pi(ee);u.partTarget=W.decimalFloatingPoint("PART-TARGET");break}case"PART":{let W=u.partList;W||(W=u.partList=[]);const $=g>0?W[W.length-1]:void 0,j=g++,U=new pi(ee,u),X=new Kk(U,E,l,j,$);W.push(X),E.duration+=X.duration;break}case"PRELOAD-HINT":{const W=new pi(ee,u);u.preloadHint=W;break}case"RENDITION-REPORT":{const W=new pi(ee,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(W);break}default:wn.warn(`line parsed but not handled: ${C}`);break}}}T&&!T.relurl?(c.pop(),x-=T.duration,u.partList&&(u.fragmentHint=T)):u.partList&&(ZT(E,T,h),E.cc=_,u.fragmentHint=E,P&&_P(E,P,u)),u.targetduration||(u.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const N=c.length,V=c[0],q=c[N-1];if(x+=u.skippedSegments*u.targetduration,x>0&&N&&q){u.averagetargetduration=x/N;const Q=q.sn;u.endSN=Q!=="initSegment"?Q:0,u.live||(q.endList=!0),V&&u.startCC===void 0&&(u.startCC=V.cc),L>0&&(P7(c,L),V&&h.unshift(V))}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(x+=u.fragmentHint.duration),u.totalduration=x,h.length&&u.dateRangeTagCount&&V&&mO(h,u),u.endCC=_,u}}function mO(r,e){const t=r.length,n=r[t-1],i=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let o=s.length;o--;){const a=e.dateRanges[s[o]],l=a.startDate.getTime();a.tagAnchor=n.ref;for(let u=t;u--;){const c=L7(e,l,r,u,i);if(c!==-1){a.tagAnchor=e.fragments[c].ref;break}}}}function L7(r,e,t,n,i){const s=t[n];if(s){const a=s.programDateTime;if(e>=a||n===0){var o;const l=(((o=t[n+1])==null?void 0:o.start)||i)-s.start;if(e<=a+l*1e3){const u=t[n].sn-r.startSN,c=r.fragments;if(c.length>t.length){const d=(t[n+1]||c[c.length-1]).sn-r.startSN;for(let m=d;m>u;m--){const g=c[m].programDateTime;if(e>=g&&e<g+c[m].duration*1e3)return m}}return u}}}return-1}function mP(r,e,t){var n,i;const s=new pi(r,t),o=(n=s.METHOD)!=null?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=(i=s.KEYFORMAT)!=null?i:"identity";a&&s.IV&&!l&&wn.error(`Invalid IV: ${s.IV}`);const h=a?qa.resolve(a,e):"",d=(u||"1").split("/").map(Number).filter(Number.isFinite);return new vm(o,h,c,d,l)}function gP(r){const t=new pi(r).decimalFloatingPoint("TIME-OFFSET");return Mt(t)?t:null}function vP(r,e){let t=(r||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=t.filter(s=>tO(s,n));i.length&&(e[`${n}Codec`]=i.map(s=>s.split("/")[0]).join(","),t=t.filter(s=>i.indexOf(s)===-1))}),e.unknownCodecs=t}function yP(r,e,t){const n=e[t];n&&(r[t]=n)}function P7(r,e){let t=r[e];for(let n=e;n--;){const i=r[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function ZT(r,e,t){r.rawProgramDateTime?t.push(r):e!=null&&e.programDateTime&&(r.programDateTime=e.endProgramDateTime)}function xP(r,e,t,n){r.relurl=e.URI,e.BYTERANGE&&r.setByteRange(e.BYTERANGE),r.level=t,r.sn="initSegment",n&&(r.levelkeys=n),r.initSegment=null}function _P(r,e,t){r.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(r)}function Ru(r,e,t){r.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function SP(r,e,t){r.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function FE(r,e){const t=e.startPTS;if(Mt(t)){let n=0,i;e.sn>r.sn?(n=t-r.start,i=r):(n=r.start-t,i=e),i.duration!==n&&i.setDuration(n)}else e.sn>r.sn?r.cc===e.cc&&r.minEndPTS?e.setStart(r.start+(r.minEndPTS-r.start)):e.setStart(r.start+r.duration):e.setStart(Math.max(r.start-e.duration,0))}function gO(r,e,t,n,i,s){n-t<=0&&(wn.warn("Fragment should have a positive duration",e),n=t+e.duration,s=i+e.duration);let a=t,l=n;const u=e.startPTS,c=e.endPTS;if(Mt(u)){const _=Math.abs(u-t);Mt(e.deltaPTS)?e.deltaPTS=Math.max(_,e.deltaPTS):e.deltaPTS=_,a=Math.max(t,u),t=Math.min(t,u),i=Math.min(i,e.startDTS),l=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const h=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=a,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const d=e.sn;if(!r||d<r.startSN||d>r.endSN)return 0;let m;const g=d-r.startSN,x=r.fragments;for(x[g]=e,m=g;m>0;m--)FE(x[m],x[m-1]);for(m=g;m<x.length-1;m++)FE(x[m],x[m+1]);return r.fragmentHint&&FE(x[x.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,h}function D7(r,e){if(r===e)return;let t=null;const n=r.fragments;for(let l=n.length-1;l>=0;l--){const u=n[l].initSegment;if(u){t=u;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let i;k7(r,e,(l,u,c,h)=>{if(e.skippedSegments&&u.cc!==l.cc){const d=l.cc-u.cc;for(let m=c;m<h.length;m++)h[m].cc+=d}Mt(l.startPTS)&&Mt(l.endPTS)&&(u.setStart(u.startPTS=l.startPTS),u.startDTS=l.startDTS,u.maxStartPTS=l.maxStartPTS,u.endPTS=l.endPTS,u.endDTS=l.endDTS,u.minEndPTS=l.minEndPTS,u.setDuration(l.endPTS-l.startPTS),u.duration&&(i=u),e.PTSKnown=e.alignedSliding=!0),l.hasStreams&&(u.elementaryStreams=l.elementaryStreams),u.loader=l.loader,l.hasStats&&(u.stats=l.stats),l.initSegment&&(u.initSegment=l.initSegment,t=l.initSegment)});const s=e.fragments,o=e.fragmentHint?s.concat(e.fragmentHint):s;if(t&&o.forEach(l=>{var u;l&&(!l.initSegment||l.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(l.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=s.some(l=>!l),e.deltaUpdateFailed){wn.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)s.shift();e.startSN=s[0].sn}else{e.endCC=s[s.length-1].cc,e.canSkipDateRanges&&(e.dateRanges=B7(r.dateRanges,e));const l=r.fragments.filter(u=>u.rawProgramDateTime);if(r.hasProgramDateTime&&!e.hasProgramDateTime)for(let u=1;u<o.length;u++)o[u].programDateTime===null&&ZT(o[u],o[u-1],l);mO(l,e)}F7(r.partList,e.partList,(l,u)=>{u.elementaryStreams=l.elementaryStreams,u.stats=l.stats}),i?gO(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):vO(r,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=r.requestScheduled)}function B7(r,e){const{dateRanges:t,recentlyRemovedDateranges:n}=e,i=$n({},r);n&&n.forEach(a=>{delete i[a]});const o=Object.keys(i).length;return o&&Object.keys(t).forEach(a=>{const l=i[a],u=new nC(t[a].attr,l);u.isValid?(i[a]=u,l||(u.tagOrder+=o)):wn.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${yi(t[a].attr)}"`)}),i}function F7(r,e,t){if(r&&e){let n=0;for(let i=0,s=r.length;i<=s;i++){const o=r[i],a=e[i+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function k7(r,e,t){const n=e.skippedSegments,i=Math.max(r.startSN,e.startSN)-e.startSN,s=(r.fragmentHint?1:0)+(n?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,o=e.startSN-r.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let u=i;u<=s;u++){const c=l[o+u];let h=a[u];if(n&&!h&&c&&(h=e.fragments[u]=c),c&&h){if(t(c,h,u,a),c.url&&c.url!==h.url){e.playlistParsingError=AP(`media sequence mismatch ${h.sn}:`,r,e,c,h);return}else if(c.cc!==h.cc){e.playlistParsingError=AP(`discontinuity sequence mismatch (${c.cc}!=${h.cc})`,r,e,c,h);return}}}}function AP(r,e,t,n,i){return new Error(`${r} ${i.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function vO(r,e,t=!0){const n=e.startSN+e.skippedSegments-r.startSN,i=r.fragments,s=n>=0;let o=0;if(s&&n<i.length)o=i[n].start;else if(s&&e.startSN===r.endSN+1)o=r.fragmentEnd;else if(s&&t)o=r.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=r.fragmentStart;else return;eM(e,o)}function eM(r,e){if(e){const t=r.fragments;for(let n=r.skippedSegments;n<t.length;n++)t[n].addStart(e);r.fragmentHint&&r.fragmentHint.addStart(e)}}function yO(r,e=1/0){let t=1e3*r.targetduration;if(r.updated){const n=r.fragments;if(n.length&&t*4>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function O7(r,e,t){if(!r)return null;let n=r.fragments[e-r.startSN];return n||(n=r.fragmentHint,n&&n.sn===e)?n:e<r.startSN&&t&&t.sn===e?t:null}function EP(r,e,t){return r?xO(r.partList,e,t):null}function xO(r,e,t){if(r)for(let n=r.length;n--;){const i=r[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function _O(r){r.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(i=>{i.level=t,i.initSegment&&(i.initSegment.level=t)})})}function M0(r,e){for(let n=0,i=r.length;n<i;n++){var t;if(((t=r[n])==null?void 0:t.cc)===e)return r[n]}return null}function U7(r,e){return!!(r&&e.startCC<r.endCC&&e.endCC>r.startCC)}function TP(r,e){if(r){const t=r.start+e;r.start=r.startPTS=t,r.endPTS=t+r.duration}}function SO(r,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)TP(t[n],r);e.fragmentHint&&TP(e.fragmentHint,r),e.alignedSliding=!0}function N7(r,e){r&&(AO(e,r),!e.alignedSliding&&r&&dS(e,r),!e.alignedSliding&&r&&!e.skippedSegments&&vO(r,e,!1))}function AO(r,e){if(!U7(e,r))return;const t=Math.min(e.endCC,r.endCC),n=M0(e.fragments,t),i=M0(r.fragments,t);if(!n||!i)return;wn.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const s=n.start-i.start;SO(s,r)}function dS(r,e){if(!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=r.fragments,n=e.fragments;if(!t.length||!n.length)return;let i,s;const o=Math.min(e.endCC,r.endCC);e.startCC<o&&r.startCC<o&&(i=M0(n,o),s=M0(t,o)),(!i||!s)&&(i=n[Math.floor(n.length/2)],s=M0(t,i.cc)||t[Math.floor(t.length/2)]);const a=i.programDateTime,l=s.programDateTime;if(!a||!l)return;const u=(l-a)/1e3-(s.start-i.start);SO(u,r)}const G7={toString:function(r){let e="";const t=r.length;for(let n=0;n<t;n++)e+=`[${r.start(n).toFixed(3)}-${r.end(n).toFixed(3)}]`;return e}},tt={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class SA extends hO{constructor(e,t,n,i,s){super(i,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=tt.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:a,media:l,mediaBuffer:u,state:c}=this,h=l?l.currentTime:0,d=pn.bufferInfo(u||l,h,o.maxBufferHole);if(this.log(`media seeking to ${Mt(h)?h.toFixed(3):h}, state: ${c}`),this.state===tt.ENDED)this.resetLoadingState();else if(a){const m=o.maxFragLookUpTolerance,g=a.start-m,x=a.start+a.duration+m;if(!d.len||x<d.start||g>d.end){const _=h>x;(h<g||_)&&(_&&a.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(h,1/0,this.playlistType,!0);const m=this.lastCurrentTime;if(h>m&&(this.lastCurrentTime=h),!this.loadingParts){const g=Math.max(d.end,h),x=this.shouldLoadParts(this.getLevelDetails(),g);x&&(this.log(`LL-Part loading ON after seeking to ${h.toFixed(2)} with buffer @${g.toFixed(2)}`),this.loadingParts=x)}}!this.hls.hasEnoughToStart&&!d.len&&(this.log(`setting startPosition to ${h} because of seek before start`),this.nextLoadPosition=this.startPosition=h),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new m7(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new tC(e.config)}registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===tt.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=tt.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const s=e.nextStart;if(s&&s>i&&s<t.edge||this.media.currentTime<e.start)return!1;const a=t.partList;if(a!=null&&a.length){const u=a[a.length-1];return pn.isBuffered(this.media,u.start+u.duration/2)}const l=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),n.addEventListener("seeking",this.onMediaSeeking),n.addEventListener("ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===tt.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(i!==null){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=tt.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=s=>{const o=s.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(o,!1,s.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,i).then(s=>{if(!s)return;const o=this.state,a=s.frag;if(this.fragContextChanged(a)){(o===tt.FRAG_LOADING||!this.fragCurrent&&o===tt.PARSING)&&(this.fragmentTracker.removeFragment(a),this.state=tt.IDLE);return}"payload"in s&&(this.log(`Loaded ${a.type} sn: ${a.sn} of ${this.playlistLabel()} ${a.level}`),this.hls.trigger(H.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===tt.STOPPED||this.state===tt.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Ar.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Ar.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(H.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const i=n==null?void 0:n.frag;if(!i||this.fragContextChanged(i)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{frag:s,payload:o}=n,a=s.decryptdata;if(o&&o.byteLength>0&&a!=null&&a.key&&a.iv&&nm(a.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),a.key.buffer,a.iv.buffer,iC(a.method)).catch(u=>{throw i.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:s}),u}).then(u=>{const c=self.performance.now();return i.trigger(H.FRAG_DECRYPTED,{frag:s,payload:u,stats:{tstart:l,tdecrypt:c}}),n.payload=u,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===tt.STOPPED||this.state===tt.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==tt.STOPPED&&(this.state=tt.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?G7.toString(pn.getBuffered(n)):"(detached)"})`),Zr(e)){var i;if(e.type!==Bt.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(a=>!!o[a])){this.state=tt.IDLE;return}}const s=(i=this.levels)==null?void 0:i[e.level];s!=null&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state=tt.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:s}=e,o=!s||s.length===0||s.some(l=>!l),a=new _A(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var s;this.fragCurrent=e;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=tt.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(h=>{if(!this.fragContextChanged(h.frag))return this.hls.trigger(H.KEY_LOADED,h),this.state===tt.KEY_LOADING&&(this.state=tt.IDLE),h}),this.hls.trigger(H.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments);const l=this.fragPrevious;if(Zr(e)&&(!l||e.sn!==l.sn)){const h=this.shouldLoadParts(t.details,e.end);h!==this.loadingParts&&(this.log(`LL-Part loading ${h?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${e.sn}`),this.loadingParts=h)}if(n=Math.max(e.start,n||0),this.loadingParts&&Zr(e)){const h=o.partList;if(h&&i){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const d=this.getNextPart(h,e,n);if(d>-1){const m=h[d];e=this.fragCurrent=m.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${m.index} (${d}/${h.length-1}) of ${this.fragInfo(e,!1,m)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=m.start+m.duration,this.state=tt.FRAG_LOADING;let g;return a?g=a.then(x=>!x||this.fragContextChanged(x.frag)?null:this.doFragPartsLoad(e,m,t,i)).catch(x=>this.handleFragLoadError(x)):g=this.doFragPartsLoad(e,m,t,i).catch(x=>this.handleFragLoadError(x)),this.hls.trigger(H.FRAG_LOADING,{frag:e,part:m,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):g}else if(!e.url||this.loadedEndOfParts(h,n))return Promise.resolve(null)}}if(Zr(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${o?"["+o.startSN+"-"+o.endSN+"]":""}, target: ${parseFloat(n.toFixed(3))}`),Mt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=tt.FRAG_LOADING;const u=this.config.progressive;let c;return u&&a?c=a.then(h=>!h||this.fragContextChanged(h==null?void 0:h.frag)?null:this.fragmentLoader.load(e,i)).catch(h=>this.handleFragLoadError(h)):c=Promise.all([this.fragmentLoader.load(e,u?i:void 0),a]).then(([h])=>(!u&&h&&i&&i(h),h)).catch(h=>this.handleFragLoadError(h)),this.hls.trigger(H.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,n,i){return new Promise((s,o)=>{var a;const l=[],u=(a=n.details)==null?void 0:a.partList,c=h=>{this.fragmentLoader.loadPart(e,h,i).then(d=>{l[h.index]=d;const m=d.part;this.hls.trigger(H.FRAG_LOADED,d);const g=EP(n.details,e.sn,h.index+1)||xO(u,e.sn,h.index+1);if(g)c(g);else return s({frag:e,part:m,partsLoaded:l})}).catch(o)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Le.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(H.ERROR,t)}else this.hls.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==tt.PARSING){!this.fragCurrent&&this.state!==tt.STOPPED&&this.state!==tt.ERROR&&(this.state=tt.IDLE);return}const{frag:n,part:i,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,i&&(i.stats.parsing.end=o);const a=this.getLevelDetails(),u=a&&n.sn>a.endSN||this.shouldLoadParts(a,n.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(n,i,s,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var n;const s=e.partList[0],o=s.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=o){var i;if((this.hls.hasEnoughToStart?((i=this.media)==null?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:s,part:o}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;const a=t[i],l=a.details,u=o>-1?EP(l,s,o):null,c=u?u.fragment:O7(l,s,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:u,level:a}):null}bufferFragmentData(e,t,n,i,s){var o;if(!e||this.state!==tt.PARSING)return;const{data1:a,data2:l}=e;let u=a;if(a&&l&&(u=ga(a,l)),!((o=u)!=null&&o.length))return;const c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:u};if(this.hls.trigger(H.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!pn.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=pn.bufferInfo(t,n,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,i.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var n;const i=this.getLoadPosition();if(!Mt(i))return null;const o=this.lastCurrentTime>i||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,o)}getFwdBufferInfoAtPos(e,t,n,i){const s=pn.bufferInfo(e,t,i);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&(s.nextStart<=o.end||o.gap)){const a=Math.max(Math.min(s.nextStart,o.end)-t,i);return pn.bufferInfo(e,t,a)}}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),s=Math.max(e-t*3,n.maxMaxBufferLength/2,i);return s>=i?(n.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=Bt.MAIN){var n;const i=(n=this.fragmentTracker)==null?void 0:n.getAppendedFrag(e,t);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:s}=this,o=n[0].start,a=s.lowLatencyMode&&!!t.partList;let l=null;if(t.live){const h=s.initialLiveManifestSize;if(i<h)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${h})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var u;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(t,n);const d=this.hls.startPosition,m=this.hls.liveSyncPosition,g=l?(d!==-1&&d>=o?d:m)||l.start:e;this.log(`Setting startPosition to ${g} to match start frag at live edge. mainStart: ${d} liveSyncPosition: ${m} frag.start: ${(u=l)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=g}}else e<=o&&(l=n[0]);if(!l){const h=this.loadingParts?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,h,t)}let c=this.filterReplacedPrimary(l,t);if(!c&&l){const h=l.sn-t.startSN;c=this.filterReplacedPrimary(n[h+1]||null,t)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Ar.OK||n===Ar.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,s){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&n.nextStart)){const a=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(a!==null&&n.len+a.len>=s){const l=o.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(MP(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(MP(this.hls.config)&&e.type!==Bt.SUBTITLE){const n=this.hls.interstitialsManager,i=n==null?void 0:n.bufferingItem;if(i){const o=i.event;if(o){if(o.appendInPlace||Math.abs(e.start-i.start)>1||i.start===0)return null}else if(e.end<=i.start&&(t==null?void 0:t.live)===!1||e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}const s=n==null?void 0:n.playerQueue;if(s)for(let o=s.length;o--;){const a=s[o].interstitial;if(a.appendInPlace&&e.start>=a.startTime&&e.end<=a.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,s=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const u=e[a];if(o=o&&!u.independent,i>-1&&n<u.start)break;const c=u.loaded;c?i=-1:(s||u.independent||o)&&u.fragment===t&&(i=a),s=c}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=i7(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];n.cc===o.cc&&(i=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=uO(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:u}=i,c=n.partList,h=!!(this.loadingParts&&c!=null&&c.length&&l);h&&l&&!this.bitrateTest&&c[c.length-1].fragment.sn===l.sn&&(o=o.concat(l),a=l.sn);let d;if(e<t){var m;const x=e<this.lastCurrentTime||e>t-u||(m=this.media)!=null&&m.paused||!this.startFragRequested?0:u;d=sd(s,o,e,x)}else d=o[o.length-1];if(d){const g=d.sn-n.startSN,x=this.fragmentTracker.getState(d);if((x===Ar.OK||x===Ar.PARTIAL&&d.gap)&&(s=d),s&&d.sn===s.sn&&(!h||c[0].fragment.sn>d.sn||!n.live&&!h)&&s&&d.level===s.level){const S=o[g+1];d.sn<a&&this.fragmentTracker.getState(S)!==Ar.OK?d=S:d=null}}return d}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,o=!t,a=e.alignedSliding&&Mt(s);if(o||!a&&!s){N7(n,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${i}`),l}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const i=this.timelineOffset;if(n===-1){const s=this.startTimeOffset!==null,o=s?this.startTimeOffset:e.startTimeOffset;o!==null&&Mt(o)?(n=t+o,o<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${o} found in ${s?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+i}this.nextLoadPosition=n+i}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Zr(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==tt.FRAG_LOADING_WAITING_RETRY)&&(this.state=tt.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const g=this.getCurrentContext(t.chunkMeta);g&&(t.frag=g.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const s=t.details===Le.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,flags:l,retryCount:u=0,retryConfig:c}=o||{},h=!!o&&!!c,d=h&&a===Ur.RetryRequest,m=h&&!o.resolved&&l===ca.MoveAllAlternatesMatchingHost;if(!d&&m&&Zr(n)&&!n.endList)this.resetFragmentErrors(e),this.treatAsGap(n),o.resolved=!0;else if((d||m)&&u<c.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const g=eC(c,u);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${u+1}/${c.maxNumRetry} in ${g}ms`),o.resolved=!0,this.retryDate=self.performance.now()+g,this.state=tt.FRAG_LOADING_WAITING_RETRY}else if(c&&o)if(this.resetFragmentErrors(e),u<c.maxNumRetry)!s&&a!==Ur.RemoveAlternatePermanently&&(o.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${u})`);return}else a===Ur.SendAlternateToPenaltyBox?this.state=tt.WAITING_LEVEL:this.state=tt.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===tt.PARSING||this.state===tt.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),s=i&&i.len>.5;s&&this.reduceMaxBufferLength(i.len,(t==null?void 0:t.duration)||10);const o=!s;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Bt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==tt.STOPPED&&(this.state=tt.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=pn.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===tt.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==tt.STOPPED&&(this.state=tt.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const s=n.details;if(!s){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const c=e.elementaryStreams[u];if(c){const h=c.endPTS-c.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${h})`),l||!1;const d=i?0:gO(s,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(H.LEVEL_PTS_UPDATED,{details:s,level:n,drift:d,type:u,frag:e,start:c.startPTS,end:c.endPTS}),!0}return l},!1)){var a;if(n.fragmentError===0&&this.treatAsGap(e,n),((a=this.transmuxer)==null?void 0:a.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=tt.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(H.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Bt.MAIN?"level":"track"}fragInfo(e,t=!0,n){var i,s;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((i=t&&!n?e.startPTS:(n||e).start)!=null?i:NaN).toFixed(3)}-${((s=t&&!n?e.endPTS:(n||e).end)!=null?s:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function MP(r){return!!r.interstitialsController&&r.enableInterstitialPlayback!==!1}class EO{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=H7(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function H7(r,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<r.length;i++){const s=r[i];t.set(s,n),n+=s.length}return t}var kE={exports:{}},wP;function z7(){return wP||(wP=1,function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var m=new i(c,h||l,d),g=t?t+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],m]:l._events[g].push(m):(l._events[g]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,m=h.length,g=new Array(m);d<m;d++)g[d]=h[d].fn;return g},a.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,d,m,g){var x=t?t+u:u;if(!this._events[x])return!1;var _=this._events[x],S=arguments.length,T,E;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),S){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,h),!0;case 4:return _.fn.call(_.context,c,h,d),!0;case 5:return _.fn.call(_.context,c,h,d,m),!0;case 6:return _.fn.call(_.context,c,h,d,m,g),!0}for(E=1,T=new Array(S-1);E<S;E++)T[E-1]=arguments[E];_.fn.apply(_.context,T)}else{var C=_.length,R;for(E=0;E<C;E++)switch(_[E].once&&this.removeListener(u,_[E].fn,void 0,!0),S){case 1:_[E].fn.call(_[E].context);break;case 2:_[E].fn.call(_[E].context,c);break;case 3:_[E].fn.call(_[E].context,c,h);break;case 4:_[E].fn.call(_[E].context,c,h,d);break;default:if(!T)for(R=1,T=new Array(S-1);R<S;R++)T[R-1]=arguments[R];_[E].fn.apply(_[E].context,T)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,d){var m=t?t+u:u;if(!this._events[m])return this;if(!c)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===c&&(!d||g.once)&&(!h||g.context===h)&&o(this,m);else{for(var x=0,_=[],S=g.length;x<S;x++)(g[x].fn!==c||d&&!g[x].once||h&&g[x].context!==h)&&_.push(g[x]);_.length?this._events[m]=_.length===1?_[0]:_:o(this,m)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,r.exports=a}(kE)),kE.exports}var V7=z7(),oC=S$(V7);const tv="1.6.0",ym={};function W7(){return typeof __HLS_WORKER_BUNDLE__=="function"}function j7(){const r=ym[tv];if(r)return r.clientCount++,r;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),i={worker:new self.Worker(t),objectURL:t,clientCount:1};return ym[tv]=i,i}function K7(r){const e=ym[r];if(e)return e.clientCount++,e;const t=new self.URL(r,self.location.href).href,i={worker:new self.Worker(t),scriptURL:t,clientCount:1};return ym[r]=i,i}function $7(r){const e=ym[r||tv];if(e&&e.clientCount--===1){const{worker:n,objectURL:i}=e;delete ym[r||tv],i&&self.URL.revokeObjectURL(i),n.terminate()}}function TO(r,e){return e+10<=r.length&&r[e]===51&&r[e+1]===68&&r[e+2]===73&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128}function aC(r,e){return e+10<=r.length&&r[e]===73&&r[e+1]===68&&r[e+2]===51&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128}function AA(r,e){let t=0;return t=(r[e]&127)<<21,t|=(r[e+1]&127)<<14,t|=(r[e+2]&127)<<7,t|=r[e+3]&127,t}function nv(r,e){const t=e;let n=0;for(;aC(r,e);){n+=10;const i=AA(r,e+6);n+=i,TO(r,e+10)&&(n+=10),e+=n}if(n>0)return r.subarray(t,t+n)}function X7(r,e,t,n){const i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=e[t+2],o=s>>2&15;if(o>12){const m=new Error(`invalid ADTS sampling index:${o}`);r.emit(H.ERROR,H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!0,error:m,reason:m.message});return}const a=(s>>6&3)+1,l=e[t+3]>>6&3|(s&1)<<2,u="mp4a.40."+a,c=i[o];let h=o;(a===5||a===29)&&(h-=3);const d=[a<<3|(h&14)>>1,(h&1)<<7|l<<3];return wn.log(`manifest codec:${n}, parsed codec:${u}, channels:${l}, rate:${c} (ADTS object type:${a} sampling index:${o})`),{config:d,samplerate:c,channelCount:l,codec:u,parsedCodec:u,manifestCodec:n}}function MO(r,e){return r[e]===255&&(r[e+1]&246)===240}function wO(r,e){return r[e+1]&1?7:9}function lC(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function Y7(r,e){return e+5<r.length}function pS(r,e){return e+1<r.length&&MO(r,e)}function J7(r,e){return Y7(r,e)&&MO(r,e)&&lC(r,e)<=r.length-e}function q7(r,e){if(pS(r,e)){const t=wO(r,e);if(e+t>=r.length)return!1;const n=lC(r,e);if(n<=t)return!1;const i=e+n;return i===r.length||pS(r,i)}return!1}function CO(r,e,t,n,i){if(!r.samplerate){const s=X7(e,t,n,i);if(!s)return;$n(r,s)}}function bO(r){return 1024*9e4/r}function Q7(r,e){const t=wO(r,e);if(e+t<=r.length){const n=lC(r,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function RO(r,e,t,n,i){const s=bO(r.samplerate),o=n+i*s,a=Q7(e,t);let l;if(a){const{frameLength:h,headerLength:d}=a,m=d+h,g=Math.max(0,t+m-e.length);g?(l=new Uint8Array(m-d),l.set(e.subarray(t+d,e.length),0)):l=e.subarray(t+d,t+m);const x={unit:l,pts:o};return g||r.samples.push(x),{sample:x,length:m,missing:g}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:u,missing:-1}}function Z7(r,e){return aC(r,e)&&AA(r,e+6)+10<=r.length-e}function eX(r){if(r.size<2)return;const e=Oo(r.data,!0),t=new Uint8Array(r.data.subarray(e.length+1));return{key:r.type,info:e,data:t.buffer}}function tX(r){if(r.size<2)return;if(r.type==="TXXX"){let t=1;const n=Oo(r.data.subarray(t),!0);t+=n.length+1;const i=Oo(r.data.subarray(t));return{key:r.type,info:n,data:i}}const e=Oo(r.data.subarray(1));return{key:r.type,info:"",data:e}}function nX(r){if(r.type==="WXXX"){if(r.size<2)return;let t=1;const n=Oo(r.data.subarray(t),!0);t+=n.length+1;const i=Oo(r.data.subarray(t));return{key:r.type,info:n,data:i}}const e=Oo(r.data);return{key:r.type,info:"",data:e}}function iX(r){return btoa(String.fromCharCode(...r))}function IO(r,e){if(r<0)return-IO(-r,e);const t=Math.pow(10,e);if(Math.abs(r*t%1-.5)<Number.EPSILON){const i=Math.floor(r*t);return(i%2===0?i:i+1)/t}else return Math.round(r*t)/t}function rX(r,e){const t=new URL(r),n=new URL(e);if(t.origin!==n.origin)return r;const i=t.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;i[0]===s[0];)i.shift(),s.shift();for(;s.length;)s.shift(),i.unshift("..");return i.join("/")}function sX(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?s:s&3|8).toString(16)})}}}function oX(r){return r instanceof ArrayBuffer?r:r.byteOffset==0&&r.byteLength==r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer}function OE(r,e=0,t=1/0){return aX(r,e,t,Uint8Array)}function aX(r,e,t,n){const i=lX(r);let s=1;"BYTES_PER_ELEMENT"in n&&(s=n.BYTES_PER_ELEMENT);const o=uX(r)?r.byteOffset:0,a=(o+r.byteLength)/s,l=(o+e)/s,u=Math.floor(Math.max(0,Math.min(l,a))),c=Math.floor(Math.min(u+Math.max(t,0),a));return new n(i,u,c-u)}function lX(r){return r instanceof ArrayBuffer?r:r.buffer}function uX(r){return r&&r.buffer instanceof ArrayBuffer&&r.byteLength!==void 0&&r.byteOffset!==void 0}function cX(r){const e={key:r.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(r.size<2)return;if(r.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=r.data.subarray(1).indexOf(0);if(n===-1)return;const i=Oo(OE(r.data,1,n)),s=r.data[2+n],o=r.data.subarray(3+n).indexOf(0);if(o===-1)return;const a=Oo(OE(r.data,3+n,o));let l;return i==="-->"?l=Oo(OE(r.data,4+n+o)):l=oX(r.data.subarray(4+n+o)),e.mimeType=i,e.pictureType=s,e.description=a,e.data=l,e}function hX(r){return r.type==="PRIV"?eX(r):r.type[0]==="W"?nX(r):r.type==="APIC"?cX(r):tX(r)}function fX(r){const e=String.fromCharCode(r[0],r[1],r[2],r[3]),t=AA(r,4),n=10;return{type:e,size:t,data:r.subarray(n,n+t)}}const zx=10,dX=10;function LO(r){let e=0;const t=[];for(;aC(r,e);){const n=AA(r,e+6);r[e+5]>>6&1&&(e+=zx),e+=zx;const i=e+n;for(;e+dX<i;){const s=fX(r.subarray(e)),o=hX(s);o&&t.push(o),e+=s.size+zx}TO(r,e)&&(e+=zx)}return t}function PO(r){return r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp"}function pX(r){if(r.data.byteLength===8){const e=new Uint8Array(r.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function uC(r){const e=LO(r);for(let t=0;t<e.length;t++){const n=e[t];if(PO(n))return pX(n)}}let io=function(r){return r.audioId3="org.id3",r.dateRange="com.apple.quicktime.HLS",r.emsg="https://aomedia.org/emsg/ID3",r.misbklv="urn:misb:KLV:bin:1910.1",r}({});function Il(r="",e=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class cC{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=ga(this.cachedData,e),this.cachedData=null);let n=nv(e,0),i=n?n.length:0,s;const o=this._audioTrack,a=this._id3Track,l=n?uC(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&Mt(l))&&(this.basePTS=mX(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:io.audioId3,duration:Number.POSITIVE_INFINITY});i<u;){if(this.canParse(e,i)){const c=this.appendFrame(o,e,i);c?(this.frameIndex++,this.lastPTS=c.sample.pts,i+=c.length,s=i):i=u}else Z7(e,i)?(n=nv(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:io.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,s=i):i++;if(i===u&&s!==u){const c=e.slice(s);this.cachedData?this.cachedData=ga(this.cachedData,c):this.cachedData=c}}return{audioTrack:o,videoTrack:Il(),id3Track:a,textTrack:Il()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Il(),id3Track:this._id3Track,textTrack:Il()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const mX=(r,e,t)=>{if(Mt(r))return r*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let Vx=null;const gX=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],vX=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],yX=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],xX=[0,1,1,4];function DO(r,e,t,n,i){if(t+24>e.length)return;const s=BO(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,a=n+i*o,l={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return r.config=[],r.channelCount=s.channelCount,r.samplerate=s.sampleRate,r.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function BO(r,e){const t=r[e+1]>>3&3,n=r[e+1]>>1&3,i=r[e+2]>>4&15,s=r[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&s!==3){const o=r[e+2]>>1&1,a=r[e+3]>>6,l=t===3?3-n:n===3?3:4,u=gX[l*14+i-1]*1e3,h=vX[(t===3?0:t===2?1:2)*3+s],d=a===3?1:2,m=yX[t][n],g=xX[n],x=m*8*g,_=Math.floor(m*u/h+o)*g;if(Vx===null){const E=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Vx=E?parseInt(E[1]):0}return!!Vx&&Vx<=87&&n===2&&u>=224e3&&a===0&&(r[e+3]=r[e+3]|128),{sampleRate:h,channelCount:d,frameLength:_,samplesPerFrame:x}}}function hC(r,e){return r[e]===255&&(r[e+1]&224)===224&&(r[e+1]&6)!==0}function FO(r,e){return e+1<r.length&&hC(r,e)}function _X(r,e){return hC(r,e)&&4<=r.length-e}function kO(r,e){if(e+1<r.length&&hC(r,e)){const n=BO(r,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const s=e+i;return s===r.length||FO(r,s)}return!1}class SX extends cC{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=nv(e,0);let i=(n==null?void 0:n.length)||0;if(kO(e,i))return!1;for(let s=e.length;i<s;i++)if(q7(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return J7(e,t)}appendFrame(e,t,n){CO(e,this.observer,t,n,e.manifestCodec);const i=RO(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const OO=(r,e)=>{let t=0,n=5;e+=n;const i=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=r[e];const a=Math.min(n,8),l=8-a;s[0]=4278190080>>>24+l<<l,i[0]=(o[0]&s[0])>>l,t=t?t<<a|i[0]:i[0],e+=1,n-=a}return t};class AX extends cC{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=UO(e,t,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=nv(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&uC(t)!==void 0&&OO(e,n)<16}}function UO(r,e,t,n,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],l=e[t+4]&63,c=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+c>e.length)return-1;const h=e[t+6]>>5;let d=0;h===2?d+=2:(h&1&&h!==1&&(d+=2),h&4&&(d+=2));const m=(e[t+6]<<8|e[t+7])>>12-d&1,x=[2,1,2,3,3,4,4,5][h]+m,_=e[t+5]>>3,S=e[t+5]&7,T=new Uint8Array([s<<6|_<<1|S>>2,(S&3)<<6|h<<3|m<<2|l>>4,l<<4&224]),E=1536/a*9e4,C=n+i*E,R=e.subarray(t,t+c);return r.config=T,r.channelCount=x,r.samplerate=a,r.samples.push({unit:R,pts:C}),c}class EX extends cC{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=nv(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&uC(t)!==void 0&&OO(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(kO(e,n))return wn.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return _X(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return DO(e,t,n,this.basePTS,this.frameIndex)}}const TX=/\/emsg[-/]ID3/i;class MX{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const s=this.videoTrack=Il("video",1),o=this.audioTrack=Il("audio",1),a=this.txtTrack=Il("text",1);if(this.id3Track=Il("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=qk(e);if(l.video){const{id:u,timescale:c,codec:h,supplemental:d}=l.video;s.id=u,s.timescale=a.timescale=c,s.codec=h,s.supplemental=d}if(l.audio){const{id:u,timescale:c,codec:h}=l.audio;o.id=u,o.timescale=c,o.codec=h}a.id=Xk.text,s.sampleDuration=0,s.duration=o.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return M$(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ga(this.remainderData,e));const a=D$(n);this.remainderData=a.remainder,i.samples=a.valid||new Uint8Array}else i.samples=n;const o=this.extractID3Track(i,t);return s.samples=YL(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=YL(e,t),{videoTrack:t,audioTrack:Il(),id3Track:i,textTrack:Il()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=sn(e.samples,["emsg"]);i&&i.forEach(s=>{const o=F$(s);if(TX.test(o.schemeIdUri)){const a=CP(o,t);let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=o.payload;n.samples.push({data:u,len:u.byteLength,dts:a,pts:a,type:io.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const a=CP(o,t);n.samples.push({data:o.payload,len:o.payload.byteLength,dts:a,pts:a,type:io.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function CP(r,e){return Mt(r.presentationTime)?r.presentationTime/r.timeScale:e+r.presentationTimeDelta/r.timeScale}class wX{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new tC(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,dh.cbc)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const s=i.subarray(16,i.length-i.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)n.set(e.subarray(s,s+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)e.set(n.subarray(i,i+16),s);return e}decryptAvcSample(e,t,n,i,s){const o=Zk(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const s=e[t].units;for(;!(n>=s.length);n++){const o=s[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,i,o),!this.decrypter.isSync()))return}}}}class NO{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;i=s[s.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,i=n.length;if(i){const s=n[i-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let s=e.naluState||0;const o=s,a=[];let l=0,u,c,h,d=-1,m=0;for(s===-1&&(d=0,m=this.getNALuType(t,0),s=0,l=1);l<i;){if(u=t[l++],!s){s=u?0:1;continue}if(s===1){s=u?0:2;continue}if(!u)s=3;else if(u===1){if(c=l-s-1,d>=0){const g={data:t.subarray(d,c),type:m};a.push(g)}else{const g=this.getLastNalUnit(e.samples);g&&(o&&l<=4-o&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-o)),c>0&&(g.data=ga(g.data,t.subarray(0,c)),g.state=0))}l<i?(h=this.getNALuType(t,l),d=l,m=h,s=0):s=-1}else s=0}if(d>=0&&s>=0){const g={data:t.subarray(d,i),type:m,state:s};a.push(g)}if(a.length===0){const g=this.getLastNalUnit(e.samples);g&&(g.data=ga(g.data,t))}return e.naluState=s,a}}class w0{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");i.set(e.subarray(n,n+s)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&wn.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class bP extends NO{parsePES(e,t,n,i){const s=this.parseNALu(e,n.data,i);let o=this.VideoSample,a,l=!1;n.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),s.forEach(u=>{var c,h;switch(u.type){case 1:{let x=!1;a=!0;const _=u.data;if(l&&_.length>4){const S=this.readSliceType(_);(S===2||S===4||S===7||S===9)&&(x=!0)}if(x){var d;(d=o)!=null&&d.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.frame=!0,o.key=x;break}case 5:a=!0,(c=o)!=null&&c.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 6:{a=!0,Qw(u.data,1,n.pts,t.samples);break}case 7:{var m,g;a=!0,l=!0;const x=u.data,_=this.readSPS(x);if(!e.sps||e.width!==_.width||e.height!==_.height||((m=e.pixelRatio)==null?void 0:m[0])!==_.pixelRatio[0]||((g=e.pixelRatio)==null?void 0:g[1])!==_.pixelRatio[1]){e.width=_.width,e.height=_.height,e.pixelRatio=_.pixelRatio,e.sps=[x];const S=x.subarray(1,4);let T="avc1.";for(let E=0;E<3;E++){let C=S[E].toString(16);C.length<2&&(C="0"+C),T+=C}e.codec=T}break}case 8:a=!0,e.pps=[u.data];break;case 9:a=!0,e.audFound=!0,(h=o)!=null&&h.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:a=!0;break;default:a=!1;break}o&&a&&o.units.push(u)}),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new w0(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,i=8,s;for(let o=0;o<e;o++)i!==0&&(s=t.readEG(),i=(n+s+256)%256),n=i===0?n:i}readSPS(e){const t=new w0(e);let n=0,i=0,s=0,o=0,a,l,u;const c=t.readUByte.bind(t),h=t.readBits.bind(t),d=t.readUEG.bind(t),m=t.readBoolean.bind(t),g=t.skipBits.bind(t),x=t.skipEG.bind(t),_=t.skipUEG.bind(t),S=this.skipScalingList.bind(this);c();const T=c();if(h(5),g(3),c(),_(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const F=d();if(F===3&&g(1),_(),_(),g(1),m())for(l=F!==3?8:12,u=0;u<l;u++)m()&&(u<6?S(16,t):S(64,t))}_();const E=d();if(E===0)d();else if(E===1)for(g(1),x(),x(),a=d(),u=0;u<a;u++)x();_(),g(1);const C=d(),R=d(),P=h(1);P===0&&g(1),g(1),m()&&(n=d(),i=d(),s=d(),o=d());let L=[1,1];if(m()&&m())switch(c()){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:{L=[c()<<8|c(),c()<<8|c()];break}}return{width:Math.ceil((C+1)*16-n*2-i*2),height:(2-P)*(R+1)*16-(P?2:4)*(s+o),pixelRatio:L}}}class RP extends NO{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,i){const s=this.parseNALu(e,n.data,i);let o=this.VideoSample,a,l=!1;n.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),s.forEach(u=>{var c,h;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.frame=!0,a=!0;break;case 16:case 17:case 18:case 21:if(a=!0,l){var d;(d=o)!=null&&d.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:a=!0,(c=o)!=null&&c.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 39:a=!0,Qw(u.data,2,n.pts,t.samples);break;case 32:a=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=$n(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(a=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const m=this.readSPS(u.data);e.width=m.width,e.height=m.height,e.pixelRatio=m.pixelRatio,e.codec=m.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const g in m.params)e.params[g]=m.params[g]}this.pushParameterSet(e.sps,u.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0;break;case 34:if(a=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const m=this.readPPS(u.data);for(const g in m)e.params[g]=m[g]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:a=!0,e.audFound=!0,(h=o)!=null&&h.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:a=!1;break}o&&a&&o.units.push(u)}),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&e[i]===3&&e[i-1]===0&&e[i-2]===0||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new w0(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),i=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:i}}readSPS(e){const t=new w0(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),s=t.readBoolean(),o=t.readBits(5),a=t.readUByte(),l=t.readUByte(),u=t.readUByte(),c=t.readUByte(),h=t.readUByte(),d=t.readUByte(),m=t.readUByte(),g=t.readUByte(),x=t.readUByte(),_=t.readUByte(),S=t.readUByte(),T=[],E=[];for(let ve=0;ve<n;ve++)T.push(t.readBoolean()),E.push(t.readBoolean());if(n>0)for(let ve=n;ve<8;ve++)t.readBits(2);for(let ve=0;ve<n;ve++)T[ve]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),E[ve]&&t.readUByte();t.readUEG();const C=t.readUEG();C==3&&t.skipBits(1);const R=t.readUEG(),P=t.readUEG(),L=t.readBoolean();let F=0,D=0,I=0,N=0;L&&(F+=t.readUEG(),D+=t.readUEG(),I+=t.readUEG(),N+=t.readUEG());const V=t.readUEG(),q=t.readUEG(),Q=t.readUEG(),re=t.readBoolean();for(let ve=re?0:n;ve<=n;ve++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let et=0;et<4;et++)for(let Ce=0;Ce<(et===3?2:6);Ce++)if(!t.readBoolean())t.readUEG();else{const te=Math.min(64,1<<4+(et<<1));et>1&&t.readEG();for(let z=0;z<te;z++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const W=t.readUEG();let $=0;for(let ve=0;ve<W;ve++){let et=!1;if(ve!==0&&(et=t.readBoolean()),et){ve===W&&t.readUEG(),t.readBoolean(),t.readUEG();let Ce=0;for(let We=0;We<=$;We++){const te=t.readBoolean();let z=!1;te||(z=t.readBoolean()),(te||z)&&Ce++}$=Ce}else{const Ce=t.readUEG(),We=t.readUEG();$=Ce+We;for(let te=0;te<Ce;te++)t.readUEG(),t.readBoolean();for(let te=0;te<We;te++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const ve=t.readUEG();for(let et=0;et<ve;et++){for(let Ce=0;Ce<Q+4;Ce++)t.readBits(1);t.readBits(1)}}let U=0,X=1,le=1,Z=!0,oe=1,pe=0;t.readBoolean(),t.readBoolean();let de=!1;if(t.readBoolean()){if(t.readBoolean()){const me=t.readUByte(),_e=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Ee=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];me>0&&me<16?(X=_e[me-1],le=Ee[me-1]):me===255&&(X=t.readBits(16),le=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),de=t.readBoolean(),de&&(F+=t.readUEG(),D+=t.readUEG(),I+=t.readUEG(),N+=t.readUEG()),t.readBoolean()&&(oe=t.readBits(32),pe=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Ee=t.readBoolean(),we=t.readBoolean();let ut=!1;(Ee||we)&&(ut=t.readBoolean(),ut&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),ut&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let ke=0;ke<=n;ke++){Z=t.readBoolean();const Ze=Z||t.readBoolean();let lt=!1;Ze?t.readEG():lt=t.readBoolean();const Ye=lt?1:t.readUEG()+1;if(Ee)for(let nt=0;nt<Ye;nt++)t.readUEG(),t.readUEG(),ut&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(we)for(let nt=0;nt<Ye;nt++)t.readUEG(),t.readUEG(),ut&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),U=t.readUEG())}let Ge=R,Ke=P;if(L||de){let ve=1,et=1;C===1?ve=et=2:C==2&&(ve=2),Ge=R-ve*D-ve*F,Ke=P-et*N-et*I}const De=i?["A","B","C"][i]:"",K=a<<24|l<<16|u<<8|c;let Pe=0;for(let ve=0;ve<32;ve++)Pe=(Pe|(K>>ve&1)<<31-ve)>>>0;let Be=Pe.toString(16);return o===1&&Be==="2"&&(Be="6"),{codecString:`hvc1.${De}${o}.${Be}.${s?"H":"L"}${S}.B0`,params:{general_tier_flag:s,general_profile_idc:o,general_profile_space:i,general_profile_compatibility_flags:[a,l,u,c],general_constraint_indicator_flags:[h,d,m,g,x,_],general_level_idc:S,bit_depth:V+8,bit_depth_luma_minus8:V,bit_depth_chroma_minus8:q,min_spatial_segmentation_idc:U,chroma_format_idc:C,frame_rate:{fixed:Z,fps:pe/oe}},width:Ge,height:Ke,pixelRatio:[X,le]}}readPPS(e){const t=new w0(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const i=t.readBoolean(),s=t.readBoolean();let o=1;return s&&i?o=0:s?o=3:i&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const kr=188;class nh{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=nh.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(kr*5,t-kr)+1,i=0;for(;i<n;){let s=!1,o=-1,a=0;for(let l=i;l<t;l+=kr)if(e[l]===71&&(t-l===kr||e[l+kr]===71)){if(a++,o===-1&&(o=l,o!==0&&(n=Math.min(o+kr*99,e.length-kr)+1)),s||(s=tM(e,l)===0),s&&a>1&&(o===0&&a>2||l+kr>n))return o}else{if(a)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Xk[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=nh.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=nh.createTrack("audio",i),this._id3Track=nh.createTrack("id3"),this._txtTrack=nh.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let s;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,u=this._txtTrack;let c=o.pid,h=o.pesData,d=a.pid,m=l.pid,g=a.pesData,x=l.pesData,_=null,S=this.pmtParsed,T=this._pmtId,E=e.length;if(this.remainderData&&(e=ga(this.remainderData,e),E=e.length,this.remainderData=null),E<kr&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:u};const C=Math.max(0,nh.syncOffset(e));E-=(E-C)%kr,E<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,E,e.buffer.byteLength-E));let R=0;for(let L=C;L<E;L+=kr)if(e[L]===71){const F=!!(e[L+1]&64),D=tM(e,L),I=(e[L+3]&48)>>4;let N;if(I>1){if(N=L+5+e[L+4],N===L+kr)continue}else N=L+4;switch(D){case c:if(F){if(h&&(s=Dp(h,this.logger))){if(this.videoParser===null)switch(o.segmentCodec){case"avc":this.videoParser=new bP;break;case"hevc":this.videoParser=new RP;break}this.videoParser!==null&&this.videoParser.parsePES(o,u,s,!1)}h={data:[],size:0}}h&&(h.data.push(e.subarray(N,L+kr)),h.size+=L+kr-N);break;case d:if(F){if(g&&(s=Dp(g,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s);break}g={data:[],size:0}}g&&(g.data.push(e.subarray(N,L+kr)),g.size+=L+kr-N);break;case m:F&&(x&&(s=Dp(x,this.logger))&&this.parseID3PES(l,s),x={data:[],size:0}),x&&(x.data.push(e.subarray(N,L+kr)),x.size+=L+kr-N);break;case 0:F&&(N+=e[N]+1),T=this._pmtId=CX(e,N);break;case T:{F&&(N+=e[N]+1);const V=bX(e,N,this.typeSupported,n,this.observer,this.logger);c=V.videoPid,c>0&&(o.pid=c,o.segmentCodec=V.segmentVideoCodec),d=V.audioPid,d>0&&(a.pid=d,a.segmentCodec=V.segmentAudioCodec),m=V.id3Pid,m>0&&(l.pid=m),_!==null&&!S&&(this.logger.warn(`MPEG-TS PMT found at ${L} after unknown PID '${_}'. Backtracking to sync byte @${C} to parse all TS packets.`),_=null,L=C-188),S=this.pmtParsed=!0;break}case 17:case 8191:break;default:_=D;break}}else R++;R>0&&nM(this.observer,new Error(`Found ${R} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=h,a.pesData=g,l.pesData=x;const P={audioTrack:a,videoTrack:o,id3Track:l,textTrack:u};return i&&this.extractRemainingSamples(P),P}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:s}=e,o=n.pesData,a=t.pesData,l=i.pesData;let u;if(o&&(u=Dp(o,this.logger))){if(this.videoParser===null)switch(n.segmentCodec){case"avc":this.videoParser=new bP;break;case"hevc":this.videoParser=new RP;break}this.videoParser!==null&&(this.videoParser.parsePES(n,s,u,!0),n.pesData=null)}else n.pesData=o;if(a&&(u=Dp(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else a!=null&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(u=Dp(l,this.logger))?(this.parseID3PES(i,u),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new wX(this.observer,this.config,t);return this.decrypt(i,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:s}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let s=t.data;if(i){this.aacOverFlow=null;const h=i.missing,d=i.sample.unit.byteLength;if(h===-1)s=ga(i.sample.unit,s);else{const m=d-h;i.sample.unit.set(s.subarray(0,h),m),e.samples.push(i.sample),n=i.missing}}let o,a;for(o=n,a=s.length;o<a-1&&!pS(s,o);o++);if(o!==n){let h;const d=o<a-1;if(d?h=`AAC PES did not start with ADTS header,offset:${o}`:h="No ADTS header found in AAC PES",nM(this.observer,new Error(h),d,this.logger),!d)return}CO(e,this.observer,s,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){const h=bO(e.samplerate);l=i.sample.pts+h}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;o<a;)if(c=RO(e,s,o,l,u),o+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;o<a-1&&!pS(s,o);o++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let s=0,o=0;const a=t.pts;if(a===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<i;)if(FO(n,o)){const l=DO(e,n,o,a,s);if(l)o+=l.length,s++;else break}else o++}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(i===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=n.length;let o=0,a=0,l;for(;a<s&&(l=UO(e,n,a,i,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=$n({},t,{type:this._videoTrack?io.emsg:io.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function tM(r,e){return((r[e+1]&31)<<8)+r[e+2]}function CX(r,e){return(r[e+10]&31)<<8|r[e+11]}function bX(r,e,t,n,i,s){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(r[e+1]&15)<<8|r[e+2],l=e+3+a-4,u=(r[e+10]&15)<<8|r[e+11];for(e+=12+u;e<l;){const c=tM(r,e),h=(r[e+3]&15)<<8|r[e+4];switch(r[e]){case 207:if(!n){UE("ADTS AAC",s);break}case 15:o.audioPid===-1&&(o.audioPid=c);break;case 21:o.id3Pid===-1&&(o.id3Pid=c);break;case 219:if(!n){UE("H.264",s);break}case 27:o.videoPid===-1&&(o.videoPid=c);break;case 3:case 4:!t.mpeg&&!t.mp3?s.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=c,o.segmentAudioCodec="mp3");break;case 193:if(!n){UE("AC-3",s);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=c,o.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&h>0){let d=e+5,m=h;for(;m>2;){switch(r[d]){case 106:t.ac3!==!0?s.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=c,o.segmentAudioCodec="ac3");break}const x=r[d+1]+2;d+=x,m-=x}}break;case 194:case 135:return nM(i,new Error("Unsupported EC-3 in M2TS found"),void 0,s),o;case 36:o.videoPid===-1&&(o.videoPid=c,o.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}e+=h+5}return o}function nM(r,e,t,n){n.warn(`parsing error: ${e.message}`),r.emit(H.ERROR,H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function UE(r,e){e.log(`${r} with AES-128-CBC encryption found in unencrypted stream`)}function Dp(r,e){let t=0,n,i,s,o,a;const l=r.data;if(!r||r.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=ga(l[0],l[1]),l.splice(1,1);if(n=l[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(i=(n[4]<<8)+n[5],i&&i>r.size-6)return null;const c=n[7];c&192&&(o=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,c&64?(a=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,o-a>60*9e4&&(e.warn(`${Math.round((o-a)/9e4)}s delta between PTS and DTS, align them`),o=a)):a=o),s=n[8];let h=s+9;if(r.size<=h)return null;r.size-=h;const d=new Uint8Array(r.size);for(let m=0,g=l.length;m<g;m++){n=l[m];let x=n.byteLength;if(h)if(h>x){h-=x;continue}else n=n.subarray(h),x-=h,h=0;d.set(n,t),t+=x}return i&&(i-=s+3),{data:d,pts:o,dts:a,len:i}}return null}class RX{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const qc=Math.pow(2,32)-1;class Re{static init(){Re.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Re.types)Re.types.hasOwnProperty(e)&&(Re.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Re.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);Re.STTS=Re.STSC=Re.STCO=s,Re.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Re.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Re.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Re.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);Re.FTYP=Re.box(Re.types.ftyp,o,l,o,a),Re.DINF=Re.box(Re.types.dinf,Re.box(Re.types.dref,i))}static box(e,...t){let n=8,i=t.length;const s=i;for(;i--;)n+=t[i].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),i=0,n=8;i<s;i++)o.set(t[i],n),n+=t[i].byteLength;return o}static hdlr(e){return Re.box(Re.types.hdlr,Re.HDLR_TYPES[e])}static mdat(e){return Re.box(Re.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(qc+1)),i=Math.floor(t%(qc+1));return Re.box(Re.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return Re.box(Re.types.mdia,Re.mdhd(e.timescale||0,e.duration||0),Re.hdlr(e.type),Re.minf(e))}static mfhd(e){return Re.box(Re.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Re.box(Re.types.minf,Re.box(Re.types.smhd,Re.SMHD),Re.DINF,Re.stbl(e)):Re.box(Re.types.minf,Re.box(Re.types.vmhd,Re.VMHD),Re.DINF,Re.stbl(e))}static moof(e,t,n){return Re.box(Re.types.moof,Re.mfhd(e),Re.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=Re.trak(e[t]);return Re.box.apply(null,[Re.types.moov,Re.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(Re.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=Re.trex(e[t]);return Re.box.apply(null,[Re.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(qc+1)),i=Math.floor(t%(qc+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Re.box(Re.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,s;for(i=0;i<t.length;i++)s=t[i].flags,n[i+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return Re.box(Re.types.sdtp,n)}static stbl(e){return Re.box(Re.types.stbl,Re.stsd(e),Re.box(Re.types.stts,Re.STTS),Re.box(Re.types.stsc,Re.STSC),Re.box(Re.types.stsz,Re.STSZ),Re.box(Re.types.stco,Re.STCO))}static avc1(e){let t=[],n=[],i,s,o;for(i=0;i<e.sps.length;i++)s=e.sps[i],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(i=0;i<e.pps.length;i++)s=e.pps[i],o=s.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(s));const a=Re.box(Re.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,u=e.height,c=e.pixelRatio[0],h=e.pixelRatio[1];return Re.box(Re.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Re.box(Re.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Re.box(Re.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Re.box(Re.types.mp4a,Re.audioStsd(e),Re.box(Re.types.esds,Re.esds(e)))}static mp3(e){return Re.box(Re.types[".mp3"],Re.audioStsd(e))}static ac3(e){return Re.box(Re.types["ac-3"],Re.audioStsd(e),Re.box(Re.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Re.box(Re.types.stsd,Re.STSD,Re.mp4a(e));if(t==="ac3"&&e.config)return Re.box(Re.types.stsd,Re.STSD,Re.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Re.box(Re.types.stsd,Re.STSD,Re.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Re.box(Re.types.stsd,Re.STSD,Re.avc1(e));if(t==="hevc"&&e.vps)return Re.box(Re.types.stsd,Re.STSD,Re.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,s=e.height||0,o=Math.floor(n/(qc+1)),a=Math.floor(n%(qc+1));return Re.box(Re.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=Re.sdtp(e),i=e.id,s=Math.floor(t/(qc+1)),o=Math.floor(t%(qc+1));return Re.box(Re.types.traf,Re.box(Re.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),Re.box(Re.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),Re.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Re.box(Re.types.trak,Re.tkhd(e),Re.mdia(e))}static trex(e){const t=e.id;return Re.box(Re.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,s=12+16*i,o=new Uint8Array(s);let a,l,u,c,h,d;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<i;a++)l=n[a],u=l.duration,c=l.size,h=l.flags,d=l.cts,o.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&61440,h.degradPrio&15,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*a);return Re.box(Re.types.trun,o)}static initSegment(e){Re.types||Re.init();const t=Re.moov(e);return ga(Re.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=4,s=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),i-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let o=s.length;for(let g=0;g<n.length;g+=1){o+=3;for(let x=0;x<n[g].length;x+=1)o+=2+n[g][x].length}const a=new Uint8Array(o);a.set(s,0),o=s.length;const l=n.length-1;for(let g=0;g<n.length;g+=1){a.set(new Uint8Array([32+g|(g===l?128:0),0,n[g].length]),o),o+=3;for(let x=0;x<n[g].length;x+=1)a.set(new Uint8Array([n[g][x].length>>8,n[g][x].length&255]),o),o+=2,a.set(n[g][x],o),o+=n[g][x].length}const u=Re.box(Re.types.hvcC,a),c=e.width,h=e.height,d=e.pixelRatio[0],m=e.pixelRatio[1];return Re.box(Re.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,Re.box(Re.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Re.box(Re.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,m>>24,m>>16&255,m>>8&255,m&255])))}}Re.types=void 0;Re.HDLR_TYPES=void 0;Re.STTS=void 0;Re.STSC=void 0;Re.STCO=void 0;Re.STSZ=void 0;Re.VMHD=void 0;Re.SMHD=void 0;Re.STSD=void 0;Re.FTYP=void 0;Re.DINF=void 0;const GO=9e4;function fC(r,e,t=1,n=!1){const i=r*e*t;return n?Math.round(i):i}function IX(r,e,t=1,n=!1){return fC(r,e,1/t,n)}function Xg(r,e=!1){return fC(r,1e3,1/GO,e)}function LX(r,e=1){return fC(r,GO,1/e)}const PX=10*1e3,DX=1024,BX=1152,FX=1536;let Bp=null,NE=null;function IP(r,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:r?2:1,isNonSync:r?0:1}}}class u_{constructor(e,t,n,i){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.ISGenerated=!1,Bp===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Bp=o?parseInt(o[1]):0}if(NE===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);NE=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((s,o)=>{let a=o.pts,l=a-s;return l<-4294967296&&(t=!0,a=ha(a,n),l=a-s),l>0?s:a},n);return t&&this.logger.debug("PTS rollover detected"),i}remux(e,t,n,i,s,o,a,l){let u,c,h,d,m,g,x=s,_=s;const S=e.pid>-1,T=t.pid>-1,E=t.samples.length,C=e.samples.length>0,R=a&&E>0||E>1;if((!S||C)&&(!T||R)||this.ISGenerated||a){if(this.ISGenerated){var L,F,D,I;const Q=this.videoTrackConfig;(Q&&(t.width!==Q.width||t.height!==Q.height||((L=t.pixelRatio)==null?void 0:L[0])!==((F=Q.pixelRatio)==null?void 0:F[0])||((D=t.pixelRatio)==null?void 0:D[1])!==((I=Q.pixelRatio)==null?void 0:I[1]))||!Q&&R||this.nextAudioPts===null&&C)&&this.resetInitSegment()}this.ISGenerated||(h=this.generateIS(e,t,s,o));const N=this.isVideoContiguous;let V=-1,q;if(R&&(V=kX(t.samples),!N&&this.config.forceKeyFrameOnDiscontinuity))if(g=!0,V>0){this.logger.warn(`[mp4-remuxer]: Dropped ${V} out of ${E} video samples due to a missing keyframe`);const Q=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(V),t.dropped+=V,_+=(t.samples[0].pts-Q)/t.inputTimeScale,q=_}else V===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${E} video samples`),g=!1);if(this.ISGenerated){if(C&&R){const Q=this.getVideoStartPts(t.samples),ee=(ha(e.samples[0].pts,Q)-Q)/t.inputTimeScale;x+=Math.max(0,ee),_+=Math.max(0,-ee)}if(C){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(e,t,s,o)),c=this.remuxAudio(e,x,this.isAudioContiguous,o,T||R||l===Bt.AUDIO?_:void 0),R){const Q=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(e,t,s,o)),u=this.remuxVideo(t,_,N,Q)}}else R&&(u=this.remuxVideo(t,_,N,0));u&&(u.firstKeyFrame=V,u.independent=V!==-1,u.firstKeyFramePTS=q)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(m=HO(n,s,this._initPTS,this._initDTS)),i.samples.length&&(d=zO(i,s,this._initPTS))),{audio:c,video:u,initSegment:h,independent:g,text:d,id3:m}}generateIS(e,t,n,i){const s=e.samples,o=t.samples,a=this.typeSupported,l={},u=this._initPTS;let c=!u||i,h="audio/mp4",d,m,g;if(c&&(d=m=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(h="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:h,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):Re.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(g=e.inputTimeScale,!u||g!==u.timescale?d=m=s[0].pts-Math.round(g*n):c=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Re.initSegment([t]),metadata:{width:t.width,height:t.height}},c)if(g=t.inputTimeScale,!u||g!==u.timescale){const x=this.getVideoStartPts(o),_=Math.round(g*n);m=Math.min(m,ha(o[0].dts,x)-_),d=Math.min(d,x-_)}else c=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:d,timescale:g},this._initDTS={baseTime:m,timescale:g}):d=g=void 0,{tracks:l,initPTS:d,timescale:g}}remuxVideo(e,t,n,i){const s=e.inputTimeScale,o=e.samples,a=[],l=o.length,u=this._initPTS;let c=this.nextAvcDts,h=8,d=this.videoSampleDuration,m,g,x=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,S=!1;if(!n||c===null){const $=t*s,j=o[0].pts-ha(o[0].dts,o[0].pts);Bp&&c!==null&&Math.abs($-j-c)<15e3?n=!0:c=$-j}const T=u.baseTime*s/u.timescale;for(let $=0;$<l;$++){const j=o[$];j.pts=ha(j.pts-T,c),j.dts=ha(j.dts-T,c),j.dts<o[$>0?$-1:$].dts&&(S=!0)}S&&o.sort(function($,j){const U=$.dts-j.dts,X=$.pts-j.pts;return U||X}),m=o[0].dts,g=o[o.length-1].dts;const E=g-m,C=E?Math.round(E/(l-1)):d||e.inputTimeScale/30;if(n){const $=m-c,j=$>C,U=$<-1;if((j||U)&&(j?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Xg($,!0)} ms (${$}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Xg(-$,!0)} ms (${$}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!U||c>=o[0].pts||Bp)){m=c;const X=o[0].pts-$;if(j)o[0].dts=m,o[0].pts=X;else{let le=!0;for(let Z=0;Z<o.length&&!(o[Z].dts>X&&le);Z++){const oe=o[Z].pts;if(o[Z].dts-=$,o[Z].pts-=$,Z<o.length-1){const pe=o[Z+1].pts,de=o[Z].pts,ye=pe<=de,Ge=pe<=oe;le=ye==Ge}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${Xg(X,!0)}/${Xg(m,!0)}, delta: ${Xg($,!0)} ms`)}}m=Math.max(0,m);let R=0,P=0,L=m;for(let $=0;$<l;$++){const j=o[$],U=j.units,X=U.length;let le=0;for(let Z=0;Z<X;Z++)le+=U[Z].data.length;P+=le,R+=X,j.length=le,j.dts<L?(j.dts=L,L+=C/4|0||1):L=j.dts,x=Math.min(j.pts,x),_=Math.max(j.pts,_)}g=o[l-1].dts;const F=P+4*R+8;let D;try{D=new Uint8Array(F)}catch($){this.observer.emit(H.ERROR,H.ERROR,{type:Nt.MUX_ERROR,details:Le.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:F,reason:`fail allocating video mdat ${F}`});return}const I=new DataView(D.buffer);I.setUint32(0,F),D.set(Re.types.mdat,4);let N=!1,V=Number.POSITIVE_INFINITY,q=Number.POSITIVE_INFINITY,Q=Number.NEGATIVE_INFINITY,re=Number.NEGATIVE_INFINITY;for(let $=0;$<l;$++){const j=o[$],U=j.units;let X=0;for(let oe=0,pe=U.length;oe<pe;oe++){const de=U[oe],ye=de.data,Ge=de.data.byteLength;I.setUint32(h,Ge),h+=4,D.set(ye,h),h+=Ge,X+=4+Ge}let le;if($<l-1)d=o[$+1].dts-j.dts,le=o[$+1].pts-j.pts;else{const oe=this.config,pe=$>0?j.dts-o[$-1].dts:C;if(le=$>0?j.pts-o[$-1].pts:C,oe.stretchShortVideoTrack&&this.nextAudioPts!==null){const de=Math.floor(oe.maxBufferHole*s),ye=(i?x+i*s:this.nextAudioPts)-j.pts;ye>de?(d=ye-pe,d<0?d=pe:N=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${ye/90} ms to the next segment; using duration ${d/90} ms for the last video frame.`)):d=pe}else d=pe}const Z=Math.round(j.pts-j.dts);V=Math.min(V,d),Q=Math.max(Q,d),q=Math.min(q,le),re=Math.max(re,le),a.push(IP(j.key,d,X,Z))}if(a.length){if(Bp){if(Bp<70){const $=a[0].flags;$.dependsOn=2,$.isNonSync=0}}else if(NE&&re-q<Q-V&&C/Q<.025&&a[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let $=m;for(let j=0,U=a.length;j<U;j++){const X=$+a[j].duration,le=$+a[j].cts;if(j<U-1){const Z=X+a[j+1].cts;a[j].duration=Z-le}else a[j].duration=j?a[j-1].duration:C;a[j].cts=0,$=X}}}d=N||!d?C:d,this.nextAvcDts=c=g+d,this.videoSampleDuration=d,this.isVideoContiguous=!0;const W={data1:Re.moof(e.sequenceNumber++,m,$n(e,{samples:a})),data2:D,startPTS:x/s,endPTS:(_+d)/s,startDTS:m/s,endDTS:c/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,W}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return BX;case"ac3":return FX;default:return DX}}remuxAudio(e,t,n,i,s){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,u=this.getSamplesPerFrame(e),c=u*l,h=this._initPTS,d=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,m=[],g=s!==void 0;let x=e.samples,_=d?0:8,S=this.nextAudioPts||-1;const T=t*o,E=h.baseTime*o/h.timescale;if(this.isAudioContiguous=n=n||x.length&&S>0&&(i&&Math.abs(T-S)<9e3||Math.abs(ha(x[0].pts-E,T)-S)<20*c),x.forEach(function(ee){ee.pts=ha(ee.pts-E,T)}),!n||S<0){if(x=x.filter(ee=>ee.pts>=0),!x.length)return;s===0?S=0:i&&!g?S=Math.max(0,T):S=x[0].pts}if(e.segmentCodec==="aac"){const ee=this.config.maxAudioFramesDrift;for(let se=0,W=S;se<x.length;se++){const $=x[se],j=$.pts,U=j-W,X=Math.abs(1e3*U/o);if(U<=-ee*c&&g)se===0&&(this.logger.warn(`Audio frame @ ${(j/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*U/o)} ms.`),this.nextAudioPts=S=W=j);else if(U>=ee*c&&X<PX&&g){let le=Math.round(U/c);W=j-le*c,W<0&&(le--,W+=c),se===0&&(this.nextAudioPts=S=W),this.logger.warn(`[mp4-remuxer]: Injecting ${le} audio frame @ ${(W/o).toFixed(3)}s due to ${Math.round(1e3*U/o)} ms gap.`);for(let Z=0;Z<le;Z++){const oe=Math.max(W,0);let pe=RX.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);pe||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),pe=$.unit.subarray()),x.splice(se,0,{unit:pe,pts:oe}),W+=c,se++}}$.pts=W,W+=c}}let C=null,R=null,P,L=0,F=x.length;for(;F--;)L+=x[F].unit.byteLength;for(let ee=0,se=x.length;ee<se;ee++){const W=x[ee],$=W.unit;let j=W.pts;if(R!==null){const X=m[ee-1];X.duration=Math.round((j-R)/l)}else if(n&&e.segmentCodec==="aac"&&(j=S),C=j,L>0){L+=_;try{P=new Uint8Array(L)}catch(X){this.observer.emit(H.ERROR,H.ERROR,{type:Nt.MUX_ERROR,details:Le.REMUX_ALLOC_ERROR,fatal:!1,error:X,bytes:L,reason:`fail allocating audio mdat ${L}`});return}d||(new DataView(P.buffer).setUint32(0,L),P.set(Re.types.mdat,4))}else return;P.set($,_);const U=$.byteLength;_+=U,m.push(IP(!0,u,U,0)),R=j}const D=m.length;if(!D)return;const I=m[m.length-1];this.nextAudioPts=S=R+l*I.duration;const N=d?new Uint8Array(0):Re.moof(e.sequenceNumber++,C/l,$n({},e,{samples:m}));e.samples=[];const V=C/o,q=S/o,re={data1:N,data2:P,startPTS:V,endPTS:q,startDTS:V,endDTS:q,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,re}}function ha(r,e){let t;if(e===null)return r;for(e<r?t=-8589934592:t=8589934592;Math.abs(r-e)>4294967296;)r+=t;return r}function kX(r){for(let e=0;e<r.length;e++)if(r[e].key)return e;return-1}function HO(r,e,t,n){const i=r.samples.length;if(!i)return;const s=r.inputTimeScale;for(let a=0;a<i;a++){const l=r.samples[a];l.pts=ha(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=ha(l.dts-n.baseTime*s/n.timescale,e*s)/s}const o=r.samples;return r.samples=[],{samples:o}}function zO(r,e,t){const n=r.samples.length;if(!n)return;const i=r.inputTimeScale;for(let o=0;o<n;o++){const a=r.samples[o];a.pts=ha(a.pts-t.baseTime*i/t.timescale,e*i)/i}r.samples.sort((o,a)=>o.pts-a.pts);const s=r.samples;return r.samples=[],{samples:s}}class OX{constructor(e,t,n,i){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.logger=i}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(b$(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=qk(e);i.audio&&(t=LP(i.audio,Kn.AUDIO)),i.video&&(n=LP(i.video,Kn.VIDEO));const s={};i.audio&&i.video?s.audiovideo={container:"video/mp4",codec:t+","+n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:i.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?s.video={container:"video/mp4",codec:n,supplemental:i.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,i,s,o){var a,l;let{initPTS:u,lastEndTime:c}=this;const h={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};Mt(c)||(c=this.lastEndTime=s||0);const d=t.samples;if(!(d!=null&&d.length))return h;const m={initPTS:void 0,timescale:1};let g=this.initData;if((a=g)!=null&&a.length||(this.generateInitSegment(d),g=this.initData),!((l=g)!=null&&l.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);const x=I$(d,g),_=R$(g,d),S=_===null?s:_;(o||!u)&&(UX(u,S,s,x)||m.timescale!==u.timescale)&&(m.initPTS=S-s,u&&u.timescale===1&&this.logger.warn(`Adjusting initPTS @${s} from ${u.baseTime/u.timescale} to ${m.initPTS}`),this.initPTS=u={baseTime:m.initPTS,timescale:1});const T=e?S-u.baseTime/u.timescale:c,E=T+x;P$(g,d,u.baseTime/u.timescale),x>0?this.lastEndTime=E:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const C=!!g.audio,R=!!g.video;let P="";C&&(P+="audio"),R&&(P+="video");const L={data1:d,startPTS:T,startDTS:T,endPTS:E,endDTS:E,type:P,hasAudio:C,hasVideo:R,nb:1,dropped:0};return h.audio=L.type==="audio"?L:void 0,h.video=L.type!=="audio"?L:void 0,h.initSegment=m,h.id3=HO(n,s,u,u),i.samples.length&&(h.text=zO(i,s,u)),h}}function UX(r,e,t,n){if(r===null)return!0;const i=Math.max(n,1),s=e-r.baseTime/r.timescale;return Math.abs(s-t)>i}function LP(r,e){const t=r==null?void 0:r.codec;return t&&t.length>4?t:e===Kn.AUDIO?t==="ec-3"||t==="ac-3"||t==="alac"?t:t==="fLaC"||t==="Opus"?aS(t,!1):(wn.warn(`Unhandled audio codec "${t}" in mp4 MAP`),t||"mp4a"):(wn.warn(`Unhandled video codec "${t}" in mp4 MAP`),t||"avc1")}let Du;try{Du=self.performance.now.bind(self.performance)}catch{Du=Date.now}const c_=[{demux:MX,remux:OX},{demux:nh,remux:u_},{demux:SX,remux:u_},{demux:EX,remux:u_}];c_.splice(2,0,{demux:AX,remux:u_});class PP{constructor(e,t,n,i,s,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=s,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const s=n.transmuxing;s.executeStart=Du();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:u,discontinuity:c,trackSwitch:h,accurateTimeOffset:d,timeOffset:m,initSegmentChange:g}=i||a,{audioCodec:x,videoCodec:_,defaultInitPts:S,duration:T,initSegmentData:E}=l,C=NX(o,t);if(C&&nm(C.method)){const F=this.getDecrypter(),D=iC(C.method);if(F.isSync()){let I=F.softwareDecrypt(o,C.key.buffer,C.iv.buffer,D);if(n.part>-1){const V=F.flush();I=V&&V.buffer}if(!I)return s.executeEnd=Du(),GE(n);o=new Uint8Array(I)}else return this.asyncResult=!0,this.decryptionPromise=F.webCryptoDecrypt(o,C.key.buffer,C.iv.buffer,D).then(I=>{const N=this.push(I,null,n);return this.decryptionPromise=null,N}),this.decryptionPromise}const R=this.needsProbing(c,h);if(R){const F=this.configureTransmuxer(o);if(F)return this.logger.warn(`[transmuxer] ${F.message}`),this.observer.emit(H.ERROR,H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!1,error:F,reason:F.message}),s.executeEnd=Du(),GE(n)}(c||h||g||R)&&this.resetInitSegment(E,x,_,T,t),(c||g||R)&&this.resetInitialTimestamp(S),u||this.resetContiguity();const P=this.transmux(o,C,m,d,n);this.asyncResult=iv(P);const L=this.currentTransmuxState;return L.contiguous=!0,L.discontinuity=!1,L.trackSwitch=!1,s.executeEnd=Du(),P}flush(e){const t=e.transmuxing;t.executeStart=Du();const{decrypter:n,currentTransmuxState:i,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(e));const o=[],{timeOffset:a}=i;if(n){const h=n.flush();h&&o.push(this.push(h.buffer,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u){t.executeEnd=Du();const h=[GE(e)];return this.asyncResult?Promise.resolve(h):h}const c=l.flush(a);return iv(c)?(this.asyncResult=!0,c.then(h=>(this.flushRemux(o,h,e),o))):(this.flushRemux(o,c,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===Bt.MAIN?"level":"track"} ${n.level}`);const c=this.remuxer.remux(i,s,o,a,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=Du()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,i,s):o=this.transmuxUnencrypted(e,n,i,s),o}transmuxUnencrypted(e,t,n,i){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,i,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let s;for(let h=0,d=c_.length;h<d;h++){var o;if((o=c_[h].demux)!=null&&o.probe(e,this.logger)){s=c_[h];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,l=this.remuxer,u=s.remux,c=s.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(n,t,i,this.logger)),(!a||!(a instanceof c))&&(this.demuxer=new c(n,t,i,this.logger),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new tC(this.config)),e}}function NX(r,e){let t=null;return r.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const GE=r=>({remuxResult:{},chunkMeta:r});function iv(r){return"then"in r&&r.then instanceof Function}class GX{constructor(e,t,n,i,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=s||null}}class HX{constructor(e,t,n,i,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=s,this.initSegmentChange=o}}let DP=0;class VO{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=DP++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const u=l.data,c=this.hls;if(!(!c||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var h;const d=(h=this.workerContext)==null?void 0:h.objectURL;d&&self.URL.revokeObjectURL(d);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{c.logger[u.data.logType]&&c.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,c.trigger(u.event,u.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const u=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const o=(l,u)=>{u=u||{},u.frag=this.frag||void 0,l===H.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(l,u)};this.observer=new oC,this.observer.on(H.FRAG_DECRYPTED,o),this.observer.on(H.ERROR,o);const a=qL(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(s.workerPath||W7()){try{s.workerPath?(l.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=K7(s.workerPath)):(l.log(`injecting Web Worker for "${t}"`),this.workerContext=j7());const{worker:c}=this.workerContext;c.addEventListener("message",this.onWorkerMessage),c.addEventListener("error",this.onWorkerError),c.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:t,config:yi(s)})}catch(c){l.warn(`Error setting up "${t}" Web Worker, fallback to inline`,c),this.terminateWorker(),this.error=null,this.transmuxer=new PP(this.observer,a,s,"",t,e.logger)}return}}this.transmuxer=new PP(this.observer,a,s,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=DP++;const t=this.hls.config,n=qL(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:yi(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),$7(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,s,o,a,l,u,c){var h,d;u.transmuxing.start=self.performance.now();const{instanceNo:m,transmuxer:g}=this,x=o?o.start:s.start,_=s.decryptdata,S=this.frag,T=!(S&&s.cc===S.cc),E=!(S&&u.level===S.level),C=S?u.sn-S.sn:-1,R=this.part?u.part-this.part.index:-1,P=C===0&&u.id>1&&u.id===(S==null?void 0:S.stats.chunkCount),L=!E&&(C===1||C===0&&(R===1||P&&R<=0)),F=self.performance.now();(E||C||s.stats.parsing.start===0)&&(s.stats.parsing.start=F),o&&(R||!L)&&(o.stats.parsing.start=F);const D=!(S&&((h=s.initSegment)==null?void 0:h.url)===((d=S.initSegment)==null?void 0:d.url)),I=new HX(T,L,l,E,x,D);if(!L||T||D){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===Bt.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${T}
        trackSwitch: ${E}
        contiguous: ${L}
        accurateTimeOffset: ${l}
        timeOffset: ${x}
        initSegmentChange: ${D}`);const N=new GX(n,i,t,a,c);this.configureTransmuxer(N)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:m,cmd:"demux",data:e,decryptdata:_,chunkMeta:u,state:I},e instanceof ArrayBuffer?[e]:[]);else if(g){const N=g.push(e,_,u,I);iv(N)?N.then(V=>{this.handleTransmuxComplete(V)}).catch(V=>{this.transmuxerError(V,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(N)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const i=n.flush(e);iv(i)?i.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")}):this.handleFlushResult(i,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const BP=100;class WO extends SA{constructor(e,t,n){super(e,t,n,"audio-stream-controller",Bt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(H.BUFFER_RESET,this.onBufferReset,this),e.on(H.BUFFER_CREATED,this.onBufferCreated,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(H.FRAG_LOADING,this.onFragLoading,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(H.BUFFER_RESET,this.onBufferReset,this),e.off(H.BUFFER_CREATED,this.onBufferCreated,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(H.FRAG_LOADING,this.onFragLoading,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){if(n===Bt.MAIN){const o=t.cc,a=this.fragCurrent;if(this.initPTS[o]={baseTime:i,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${i}/${s}`),this.mainAnchor=t,this.state===tt.WAITING_INIT_PTS){const l=this.waitingData;(!l&&!this.loadingParts||l&&l.frag.cc!==o)&&(this.nextLoadPosition=this.findSyncFrag(t).start),this.tick()}else!this.hls.hasEnoughToStart&&a&&a.cc!==o?(this.startFragRequested=!1,this.nextLoadPosition=this.findSyncFrag(t).start,a.abortRequests(),this.resetLoadingState()):this.state===tt.IDLE&&this.tick()}}findSyncFrag(e){const t=this.getLevelDetails(),n=e.cc;return o7(t,n,e)||t&&uO(t.fragments,n)||e}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=tt.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(BP),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=tt.IDLE):this.state=tt.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case tt.IDLE:this.doTickIdle();break;case tt.WAITING_TRACK:{const{levels:t,trackId:n}=this,i=t==null?void 0:t[n],s=i==null?void 0:i.details;if(s&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(s))break;this.state=tt.WAITING_INIT_PTS}break}case tt.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,trackId:s}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((i==null?void 0:i[s])||null),this.state=tt.IDLE}break}case tt.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:n,part:i,cache:s,complete:o}=t,a=this.mainAnchor;if(this.initPTS[n.cc]!==void 0){this.waitingData=null,this.state=tt.FRAG_LOADING;const l=s.flush().buffer,u={frag:n,part:i,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),o&&super._handleFragmentLoadComplete(u)}else a&&a.cc!==t.frag.cc&&(this.log(`Waiting fragment cc (${n.cc}) cancelled because video is at cc ${a.cc}`),this.nextLoadPosition=this.findSyncFrag(a).start,this.clearWaitingFragment())}else this.state=tt.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.state!==tt.STOPPED&&(this.state=tt.IDLE))}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:s}=this,o=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(n!=null&&n[s]))return;const a=n[s],l=a.details;if(!l||this.waitForLive(a)||this.waitForCdnTuneIn(l)){this.state=tt.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,Kn.AUDIO,Bt.AUDIO));const c=this.getFwdBufferInfo(u,Bt.AUDIO);if(c===null)return;if(!this.switchingTrack&&this._streamEnded(c,l)){t.trigger(H.BUFFER_EOS,{type:"audio"}),this.state=tt.ENDED;return}const h=c.len,d=t.maxBufferLength,m=l.fragments,g=m[0].start,x=this.getLoadPosition(),_=this.flushing?x:c.end;if(this.switchingTrack&&i){const E=x;l.PTSKnown&&E<g&&(c.end>g||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=g+.05)}if(h>=d&&!this.switchingTrack&&_<m[m.length-1].start)return;let S=this.getNextFragment(_,l);if(S&&this.isLoopLoading(S,_)&&(S=this.getNextFragmentLoopLoading(S,l,c,Bt.MAIN,d)),!S){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&Zr(S)&&!S.endList&&(!l.live||!this.loadingParts&&_<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===Ar.OK&&(this.mainFragLoading=T=null),T&&Zr(T))){if(S.start>T.end){const C=this.fragmentTracker.getFragAtPos(_,Bt.MAIN);C&&C.end>T.end&&(T=C,this.mainFragLoading={frag:C,targetBufferTime:null})}if(S.start>T.end)return}this.loadFragment(S,a,_)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new gm(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==tt.STOPPED&&(this.setInterval(BP),this.state=tt.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(H.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:s,id:o,groupId:a,track:l}=t;if(!i){this.warn(`Audio tracks reset while loading track ${o} "${l.name}" of "${a}"`);return}const u=this.mainDetails;if(!u||s.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=t,this.state!==tt.STOPPED&&(this.state=tt.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${l.name}" of "${a}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const c=i[o];let h=0;if(s.live||(n=c.details)!=null&&n.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;if(c.details){var d;h=this.alignPlaylists(s,c.details,(d=this.levelLastLoaded)==null?void 0:d.details)}s.alignedSliding||(AO(s,u),s.alignedSliding||dS(s,u),h=s.fragmentStart)}c.details=s,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(u,h),this.hls.trigger(H.AUDIO_TRACK_UPDATED,{details:s,id:o,groupId:t.groupId}),this.state===tt.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=tt.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:s}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[a];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const h=o.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new VO(this.hls,Bt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const m=this.initPTS[n.cc],g=(t=n.initSegment)==null?void 0:t.data;if(m!==void 0){const _=i?i.index:-1,S=_!==-1,T=new _A(n.level,n.sn,n.stats.chunkCount,s.byteLength,_,S);d.push(s,g,h,"",n,i,c.totalduration,!1,T,m)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:x}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new EO,complete:!1};x.push(new Uint8Array(s)),this.state!==tt.STOPPED&&(this.state=tt.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Bt.MAIN&&Zr(t.frag)&&(this.mainFragLoading=t,this.state===tt.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==Bt.AUDIO){!this.audioOnly&&n.type===Bt.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Zr(n)){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(H.AUDIO_TRACK_SWITCHED,Wn({},s)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=tt.ERROR;return}switch(t.details){case Le.FRAG_GAP:case Le.FRAG_PARSING_ERROR:case Le.FRAG_DECRYPT_ERROR:case Le.FRAG_LOAD_ERROR:case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_ERROR:case Le.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Bt.AUDIO,t);break;case Le.AUDIO_TRACK_LOAD_ERROR:case Le.AUDIO_TRACK_LOAD_TIMEOUT:case Le.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===tt.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===_n.AUDIO_TRACK&&(this.state=tt.IDLE);break;case Le.BUFFER_ADD_CODEC_ERROR:case Le.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case Le.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Le.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Kn.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Kn.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===tt.ENDED&&(this.state=tt.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Bt.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:u,level:c}=a,{details:h}=c,{audio:d,text:m,id3:g,initSegment:x}=s;if(this.fragContextChanged(l)||!h){this.fragmentTracker.removeFragment(l);return}if(this.state=tt.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),x!=null&&x.tracks){const _=l.initSegment||l;this._bufferInitSegment(c,x.tracks,_,o),i.trigger(H.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:n,tracks:x.tracks})}if(d){const{startPTS:_,endPTS:S,startDTS:T,endDTS:E}=d;u&&(u.elementaryStreams[Kn.AUDIO]={startPTS:_,endPTS:S,startDTS:T,endDTS:E}),l.setElementaryStreamInfo(Kn.AUDIO,_,S,T,E),this.bufferFragmentData(d,l,u,o)}if(g!=null&&(t=g.samples)!=null&&t.length){const _=$n({id:n,frag:l,details:h},g);i.trigger(H.FRAG_PARSING_METADATA,_)}if(m){const _=$n({id:n,frag:l,details:h},m);i.trigger(H.FRAG_PARSING_USERDATA,_)}}_bufferInitSegment(e,t,n,i){if(this.state!==tt.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const s=t.audio;s.id=Bt.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(H.BUFFER_CODECS,t);const a=s.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(H.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.switchingTrack||i===Ar.NOT_LOADED||i===Ar.PARTIAL){var s;if(!Zr(e))this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=tt.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&dS(t.details,o)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:s,audioCodec:o,channels:a}=this.bufferedTrack;Kf({name:t,lang:n,assocLang:i,characteristics:s,audioCodec:o,channels:a},e,Mf)||(uS(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(H.AUDIO_TRACK_SWITCHED,Wn({},e))}}class EA extends ac{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=t==null?void 0:t.renditionReports;if(i){let s=-1;for(let o=0;o<i.length;o++){const a=i[o];let l;try{l=new self.URL(a.URI,t.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),l=a.URI||""}if(l===e){s=o;break}else l===e.substring(0,l.length)&&(s=o)}if(s!==-1){const o=i[s],a=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const c=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&c>t.partTarget&&(l+=1)}const u=n&&ZL(n);return new JT(a,l>=0?l:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:i,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;i.advancedDateTime=Date.now()-a;const l=this.hls.config.timelineOffset;if(l!==i.appliedTimelineOffset){const c=Math.max(l||0,0);i.appliedTimelineOffset=c,i.fragments.forEach(h=>{h.start=h.playlistOffset+c})}if(i.live||n!=null&&n.live){const c="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){D7(n,i);const T=i.playlistParsingError;if(T){this.warn(T);const E=this.hls;if(!E.config.ignorePlaylistParsingErrors){var u;const{networkDetails:C}=t;E.trigger(H.ERROR,{type:Nt.NETWORK_ERROR,details:Le.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:T,reason:T.message,level:t.level||void 0,parent:(u=i.fragments[0])==null?void 0:u.type,networkDetails:C,stats:s});return}i.playlistParsingError=null}}i.requestScheduled===-1&&(i.requestScheduled=s.loading.start);const h=this.hls.mainForwardBufferInfo,d=h?h.end-h.len:0,m=(i.edge-d)*1e3,g=yO(i,m);if(i.requestScheduled+g<o?i.requestScheduled=o:i.requestScheduled+=g,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;let x,_,S;if(i.canBlockReload&&i.endSN&&i.advanced){const T=this.hls.config.lowLatencyMode,E=i.lastPartSn,C=i.endSN,R=i.lastPartIndex,P=R!==-1,L=E===C;P?L?(_=C+1,S=T?0:R):(_=E,S=T?R+1:i.maxPartIndex):_=C+1;const F=i.age,D=F+i.ageHeader;let I=Math.min(D-i.partTarget,i.targetduration*1.5);if(I>0){if(D>i.targetduration*3)this.log(`Playlist last advanced ${F.toFixed(2)}s ago. Omitting segment and part directives.`),_=void 0,S=void 0;else if(n!=null&&n.tuneInGoal&&D-i.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${I} with playlist age: ${i.age}`),I=0;else{const N=Math.floor(I/i.targetduration);if(_+=N,S!==void 0){const V=Math.round(I%i.targetduration/i.partTarget);S+=V}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${F.toFixed(2)}s goal: ${I} skip sn ${N} to part ${S}`)}i.tuneInGoal=I}if(x=this.getDeliveryDirectives(i,t.deliveryDirectives,_,S),T||!L){i.requestScheduled=o,this.loadingPlaylist(c,x);return}}else(i.canBlockReload||i.canSkipUntil)&&(x=this.getDeliveryDirectives(i,t.deliveryDirectives,_,S));x&&_!==void 0&&i.canBlockReload&&(i.requestScheduled=s.loading.first+Math.max(g-a*2,g/2)),this.scheduleLoading(c,x,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i){this.loadingPlaylist(e,t);return}const s=self.performance.now(),o=i.requestScheduled;if(s>=o){this.loadingPlaylist(e,t);return}const a=o-s;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),a)}getDeliveryDirectives(e,t,n,i){let s=ZL(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,s=T0.No),new JT(n,i,s)}checkRetry(e){const t=e.details,n=cS(e),i=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=i||{},l=!!i&&!!a&&(s===Ur.RetryRequest||!i.resolved&&s===Ur.SendAlternateToPenaltyBox);if(l){var u;if(o>=a.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const c=eC(a,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${c}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}function jO(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!rv(r[t].attrs,e[t].attrs))return!1;return!0}function rv(r,e,t){const n=r["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>r[i]!==e[i])}function iM(r,e){return e.label.toLowerCase()===r.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(r.lang||"").toLowerCase())}class KO extends EA{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVEL_LOADING,this.onLevelLoading,this),e.off(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(H.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(H.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let s=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(i==null?void 0:i.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(d=>!n||n.indexOf(d.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(d=>d.default)&&(this.selectDefaultTrack=!1),a.forEach((d,m)=>{d.id=m});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!s&&l){const d=Bl(l,a,Mf);if(d>-1)s=a[d];else{const m=Bl(l,this.tracks);s=this.tracks[m]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const c={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(H.AUDIO_TRACKS_UPDATED,c);const h=this.trackId;if(u!==-1&&h===-1)this.setAudioTrack(u);else if(a.length&&h===-1){var o;const d=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(d.message),this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:d})}}}onError(e,t){t.fatal||!t.context||t.context.type===_n.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Kf(e,i,Mf))return i;const s=Bl(e,this.tracksInGroup,Mf);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(i){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=n7(e,t.levels,n,o,Mf);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=Bl(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],s=i.details&&!i.details.live;if(e===this.trackId&&i===n&&s||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(H.AUDIO_TRACK_SWITCHING,Wn({},i)),s))return;const o=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||Kf(e,i,Mf)))return n}if(e){const{name:n,lang:i,assocLang:s,characteristics:o,audioCodec:a,channels:l}=e;for(let u=0;u<t.length;u++){const c=t[u];if(Kf({name:n,lang:i,assocLang:s,characteristics:o,audioCodec:a,channels:l},c,Mf))return u}for(let u=0;u<t.length;u++){const c=t[u];if(rv(e.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const c=t[u];if(rv(e.attrs,c.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&uS(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,s=this.getUrlWithDirectives(e.url,t),o=e.details,a=o==null?void 0:o.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${s}`),this.hls.trigger(H.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:t||null,track:e})}}class zX{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const i=this.queues[t];i.push(e),i.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(s){var n;if(i.onError(s),this.queues===null||this.tracks===null)return;const o=(n=this.tracks[e])==null?void 0:n.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],i=n==null?void 0:n.buffer;return i?`SourceBuffer${i.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const FP=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,$O="HlsJsTrackRemovedError";class VX extends Error{constructor(e){super(e),this.name=$O}}class XO extends ac{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var i;this.hls&&((i=this.mediaSource)==null?void 0:i.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:i,mediaSource:s}=this;n&&this.log("Media source opened"),!(!i||!s)&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(H.MEDIA_ATTACHED,{media:i,mediaSource:s}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&this.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=_$(Zu(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.BUFFER_RESET,this.onBufferReset,this),e.on(H.BUFFER_APPENDING,this.onBufferAppending,this),e.on(H.BUFFER_CODECS,this.onBufferCodecs,this),e.on(H.BUFFER_EOS,this.onBufferEos,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.FRAG_PARSED,this.onFragParsed,this),e.on(H.FRAG_CHANGED,this.onFragChanged,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.BUFFER_RESET,this.onBufferReset,this),e.off(H.BUFFER_APPENDING,this.onBufferAppending,this),e.off(H.BUFFER_CODECS,this.onBufferCodecs,this),e.off(H.BUFFER_EOS,this.onBufferEos,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.FRAG_PARSED,this.onFragParsed,this),e.off(H.FRAG_CHANGED,this.onFragChanged,this),e.off(H.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const o=this.isQueued();(s||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?$n(n,i.tracks):this.sourceBuffers.forEach(s=>{const[o]=s;o&&(n[o]=$n({},this.tracks[o]),this.removeBuffer(o)),s[0]=s[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media,i=Zu(this.appendSource);if(this.transferData=this.overrides=void 0,n&&i){const s=!!t.mediaSource;(s||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(o),s)this._objectUrl=n.src,this.attachTransferred();else{const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&o instanceof l,kP(n),WX(n,a),n.load()}catch{n.src=a}else n.src=a}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,s=i?Object.keys(i):null,o=s?s.length:0,a=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(i&&s&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${yi(n,(l,u)=>l==="initSegment"?void 0:u)};
transfer tracks: ${yi(i,(l,u)=>l==="initSegment"?void 0:u)}}`),!jk(i,n)){t.mediaSource=null,t.tracks=void 0;const l=e.currentTime,u=this.details,c=Math.max(l,(u==null?void 0:u.fragments[0].start)||0);if(c-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${c}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(n)}") start time: ${c} currentTime: ${l}`),this.onMediaDetaching(H.MEDIA_DETACHING,{}),this.onMediaAttaching(H.MEDIA_ATTACHING,t),e.currentTime=c;return}this.transferData=void 0,s.forEach(l=>{const u=l,c=i[u];if(c){const h=c.buffer;if(h){const d=this.fragmentTracker,m=c.id;if(d.hasFragments(m)||d.hasParts(m)){const _=pn.getBuffered(h);d.detectEvictedFragments(u,_,m,null,!0)}const g=HE(u),x=[u,h];this.sourceBuffers[g]=x,h.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,c)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:s,_objectUrl:o}=this;if(s){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([a])=>{a&&this.removeBuffer(a)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const a=s.readyState==="open";try{const l=s.sourceBuffers;for(let u=l.length;u--;)a&&l[u].abort(),s.removeSourceBuffer(l[u]);a&&s.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(i.removeAttribute("src"),this.appendSource&&kP(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(H.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;(i=this.mediaSource)!=null&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(s){this.warn(`onBufferReset ${e}`,s)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[HE(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new zX(this.tracks)}onBufferCodecs(e,t){const n=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const s="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),o=!s&&this.sourceBufferCount&&this.media&&i.some(a=>!n[a]);if(s||o){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${i}" SourceBuffers`);return}i.forEach(a=>{var l,u,c;const h=t[a],{id:d,codec:m,levelCodec:g,container:x,metadata:_,supplemental:S}=h;let T=n[a];const E=(l=this.transferData)==null||(u=l.tracks)==null?void 0:u[a],C=E!=null&&E.buffer?E:T,R=(C==null?void 0:C.pendingCodec)||(C==null?void 0:C.codec),P=C==null?void 0:C.levelCodec;T||(T=n[a]={buffer:void 0,listeners:[],codec:m,supplemental:S,container:x,levelCodec:g,metadata:_,id:d});const L=l_(R,P),F=L==null?void 0:L.replace(FP,"$1");let D=l_(m,g);const I=(c=D)==null?void 0:c.replace(FP,"$1");D&&L&&F!==I&&(a.slice(0,5)==="audio"&&(D=aS(D,this.appendSource)),this.log(`switching codec ${R} to ${D}`),D!==(T.pendingCodec||T.codec)&&(T.pendingCodec=D),T.container=x,this.appendChangeType(a,x,D))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const i=`${t};codecs=${n}`,s={label:`change-type=${i}`,execute:()=>{const o=this.tracks[e];if(o){const a=o.buffer;a!=null&&a.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),a.changeType(i),o.codec=n,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(s,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,Bt.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var a;const l=this.tracks.video;(this.lastVideoAppendEnd>i||l!=null&&l.buffer&&pn.isBuffered(l.buffer,i)||((a=this.fragmentTracker.getAppendedFrag(i,Bt.MAIN))==null?void 0:a.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn("Error executing block-audio operation",a)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:s,parent:o,frag:a,part:l,chunkMeta:u}=t,c=u.buffering[s],h=a.sn,d=self.performance.now();c.start=d;const m=a.stats.buffering,g=l?l.stats.buffering:null;m.start===0&&(m.start=d),g&&g.start===0&&(g.start=d);const x=n.audio;let _=!1;s==="audio"&&(x==null?void 0:x.container)==="audio/mpeg"&&(_=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const S=this.tracks.video,T=S==null?void 0:S.buffer;if(T&&h!=="initSegment"){const R=l||a,P=this.blockedAudioAppend;if(s==="audio"&&o!=="main"&&!this.blockedAudioAppend){const F=R.start+R.duration*.05,D=T.buffered,I=this.currentOp("video");!D.length&&!I?this.blockAudio(R):!I&&!pn.isBuffered(T,F)&&this.lastVideoAppendEnd<F&&this.blockAudio(R)}else if(s==="video"){const L=R.end;if(P){const F=P.frag.start;(L>F||L<this.lastVideoAppendEnd||pn.isBuffered(T,F))&&this.unblockAudio()}this.lastVideoAppendEnd=L}}const E=(l||a).start,C={label:`append-${s}`,execute:()=>{if(c.executeStart=self.performance.now(),_){const R=this.tracks[s];if(R){const P=R.buffer;if(P){const L=E-P.timestampOffset;Math.abs(L)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${E} (delta: ${L}) sn: ${h})`),P.timestampOffset=E)}}}this.appendExecutor(i,s)},onStart:()=>{},onComplete:()=>{const R=self.performance.now();c.executeEnd=c.end=R,m.first===0&&(m.first=R),g&&g.first===0&&(g.first=R);const P={};this.sourceBuffers.forEach(([L,F])=>{L&&(P[L]=pn.getBuffered(F))}),this.appendErrors[s]=0,s==="audio"||s==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(H.BUFFER_APPENDED,{type:s,frag:a,part:l,chunkMeta:u,parent:a.type,timeRanges:P})},onError:R=>{var P;const L={type:Nt.MEDIA_ERROR,parent:a.type,details:Le.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:a,part:l,chunkMeta:u,error:R,err:R,fatal:!1};if(R.code===DOMException.QUOTA_EXCEEDED_ERR)L.details=Le.BUFFER_FULL_ERROR;else if(R.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!((P=this.media)!=null&&P.error))L.errorAction=ev(!0);else if(R.name===$O)this.sourceBufferCount===0?L.errorAction=ev(!0):++this.appendErrors[s];else{const F=++this.appendErrors[s];this.warn(`Failed ${F}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer`),F>=this.hls.config.appendErrorMaxRetry&&(L.fatal=!0)}this.hls.trigger(H.ERROR,L)}};this.append(C,s,this.isPending(this.tracks[s]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(H.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:s}=t;n?this.append(this.getFlushOp(n,i,s),n):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,i,s),o)})}onFragParsed(e,t){const{frag:n,part:i}=t,s=[],o=i?i.elementaryStreams:n.elementaryStreams;o[Kn.AUDIOVIDEO]?s.push("audiovideo"):(o[Kn.AUDIO]&&s.push("audio"),o[Kn.VIDEO]&&s.push("video"));const a=()=>{const l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const u=i?i.stats:n.stats;this.hls.trigger(H.FRAG_BUFFERED,{frag:n,part:i,stats:u,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,s)}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,n;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((n=this.tracks[e])==null?void 0:n.ending))})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([o])=>{if(o){const a=this.tracks[o];(!t.type||t.type===o)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${o} buffer reached EOS`)))}});const i=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var a;return o&&!((a=this.tracks[o])!=null&&a.ended)})&&(i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(H.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(H.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===Le.BUFFER_APPEND_ERROR&&t.frag){var n;const i=(n=t.errorAction)==null?void 0:n.nextAutoLevel;Mt(i)&&i!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const i=e.config,s=n.currentTime,o=t.levelTargetDuration,a=t.live&&i.liveBackBufferLength!==null?i.liveBackBufferLength:i.backBufferLength;if(Mt(a)&&a>=0){const l=Math.max(a,o),u=Math.floor(s/o)*o-l;this.flushBackBuffer(s,o,u)}if(Mt(i.frontBufferFlushThreshold)&&i.frontBufferFlushThreshold>0){const l=Math.max(i.maxBufferLength,i.frontBufferFlushThreshold),u=Math.max(l,o),c=Math.floor(s/o)*o+u;this.flushFrontBuffer(s,o,c)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([i,s])=>{if(s){const a=pn.getBuffered(s);if(a.length>0&&n>a.start(0)){var o;this.hls.trigger(H.BACK_BUFFER_REACHED,{bufferEnd:n});const l=this.tracks[i];if((o=this.details)!=null&&o.live)this.hls.trigger(H.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l!=null&&l.ended){this.log(`Cannot flush ${i} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(H.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:i})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([i,s])=>{if(s){const o=pn.getBuffered(s),a=o.length;if(a<2)return;const l=o.start(a-1),u=o.end(a-1);if(n>l||e>=l&&e<=u)return;this.hls.trigger(H.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:i})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||(n==null?void 0:n.readyState)!=="open")return null;const i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&n.setLiveSeekableRange){const u=Math.max(0,t.fragmentStart),c=Math.max(u,i);return{duration:1/0,start:u,end:c}}return{duration:1/0}}const s=(e=this.overrides)==null?void 0:e.duration;if(s)return Mt(s)?{duration:s}:null;const o=this.media.duration,a=Mt(n.duration)?n.duration:0;return i>a&&i>o||!Mt(o)?{duration:i}:null}updateMediaSource({duration:e,start:t,end:n}){const i=this.mediaSource;!this.media||!i||i.readyState!=="open"||(i.duration!==e&&(Mt(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),i.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${i.duration}. Setting seekable range to ${t}-${n}.`),i.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${yi(n)}`),this.tracksReady){var i;const s=(i=this.transferData)==null?void 0:i.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const i=this.tracks[t];e[t]={buffer:n,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}}),this.hls.trigger(H.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const o=s,a=e[o];if(this.isPending(a)){const l=this.getTrackCodec(a,o),u=`${a.container};codecs=${l}`;a.codec=l,this.log(`creating sourceBuffer(${u})${this.currentOp(o)?" Queued":""} ${yi(a)}`);try{const c=n.addSourceBuffer(u),h=HE(o),d=[o,c];t[h]=d,a.buffer=c}catch(c){var i;this.error(`error while trying to add sourceBuffer: ${c.message}`),this.shiftAndExecuteNext(o),(i=this.operationQueue)==null||i.removeBlockers(),delete this.tracks[o],this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:c,sourceBufferName:o,mimeType:u,parent:a.id});return}this.trackSourceBuffer(o,a)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&(t==="video"||t==="audiovideo")&&XT(n,"video")&&(i=z$(i,n));const s=l_(i,e.levelCodec);return s?t.slice(0,5)==="audio"?aS(s,this.appendSource):s:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(s,o)=>{const a=o.removedRanges;a!=null&&a.length&&this.hls.trigger(H.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const s=this.currentOp(e);s&&s.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:s}=this,o=this.tracks[e],a=o==null?void 0:o.buffer;if(!i||!s||!a){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=Mt(i.duration)?i.duration:1/0,u=Mt(s.duration)?s.duration:1/0,c=Math.max(0,t),h=Math.min(n,l,u);h>c&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${c},${h}] from the ${e} SourceBuffer`),a.remove(c,h)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=n==null?void 0:n.buffer;if(!i)throw new VX(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){this.isUpdating()||this.isQueued()?this.blockBuffers(e):e()}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=t.map(o=>this.appendBlocker(o));t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(o=>{n===this.operationQueue&&(e(),this.stepOperationQueue(t))})}stepOperationQueue(e){e.forEach(t=>{var n;const i=(n=this.tracks[t])==null?void 0:n.buffer;!i||i.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const s=i.buffer;if(!s)return;const o=n.bind(this,e);i.listeners.push({event:t,listener:o}),s.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(i=>{n.removeEventListener(i.event,i.listener)}),t.listeners.length=0)}}function kP(r){const e=r.querySelectorAll("source");[].slice.call(e).forEach(t=>{r.removeChild(t)})}function WX(r,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,r.appendChild(t)}function HE(r){return r==="audio"?1:0}class TA{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(H.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.BUFFER_CODECS,this.onBufferCodecs,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(H.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.BUFFER_CODECS,this.onBufferCodecs,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Mt(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,s)=>this.isLevelAllowed(i)&&s<=e);return this.clientRect=null,TA.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let s=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&i(l,e[a+1])){s=a;break}}return s}}const jX={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},to=jX,KX={HLS:"h"},$X=KX,XX="CMCD-Object",YX="CMCD-Request",JX="CMCD-Session",qX="CMCD-Status",s0={OBJECT:XX,REQUEST:YX,SESSION:JX,STATUS:qX},QX={[s0.OBJECT]:["br","d","ot","tb"],[s0.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[s0.SESSION]:["cid","pr","sf","sid","st","v"],[s0.STATUS]:["bs","rtp"]};class xm{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof xm?n:new xm(n))),this.value=e,this.params=t}}const ZX="Dict";function eY(r){return Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":typeof r=="object"?JSON.stringify(r):String(r)}function tY(r,e,t,n){return new Error(`failed to ${r} "${eY(e)}" as ${t}`,{cause:n})}function jl(r,e,t){return tY("serialize",r,e,t)}class YO{constructor(e){this.description=e}}const OP="Bare Item",nY="Boolean";function iY(r){if(typeof r!="boolean")throw jl(r,nY);return r?"?1":"?0"}const rY="Byte Sequence";function sY(r){if(ArrayBuffer.isView(r)===!1)throw jl(r,rY);return`:${iX(r)}:`}const oY="Integer";function aY(r){return r<-999999999999999||999999999999999<r}function JO(r){if(aY(r))throw jl(r,oY);return r.toString()}function lY(r){return`@${JO(r.getTime()/1e3)}`}const uY="Decimal";function cY(r){const e=IO(r,3);if(Math.floor(Math.abs(e)).toString().length>12)throw jl(r,uY);const t=e.toString();return t.includes(".")?t:`${t}.0`}const hY="String",fY=/[\x00-\x1f\x7f]+/;function dY(r){if(fY.test(r))throw jl(r,hY);return`"${r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function pY(r){return r.description||r.toString().slice(7,-1)}const mY="Token";function UP(r){const e=pY(r);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw jl(e,mY);return e}function rM(r){switch(typeof r){case"number":if(!Mt(r))throw jl(r,OP);return Number.isInteger(r)?JO(r):cY(r);case"string":return dY(r);case"symbol":return UP(r);case"boolean":return iY(r);case"object":if(r instanceof Date)return lY(r);if(r instanceof Uint8Array)return sY(r);if(r instanceof YO)return UP(r);default:throw jl(r,OP)}}const gY="Key";function sM(r){if(/^[a-z*][a-z0-9\-_.*]*$/.test(r)===!1)throw jl(r,gY);return r}function dC(r){return r==null?"":Object.entries(r).map(([e,t])=>t===!0?`;${sM(e)}`:`;${sM(e)}=${rM(t)}`).join("")}function qO(r){return r instanceof xm?`${rM(r.value)}${dC(r.params)}`:rM(r)}function vY(r){return`(${r.value.map(qO).join(" ")})${dC(r.params)}`}function yY(r,e={whitespace:!0}){if(typeof r!="object")throw jl(r,ZX);const t=r instanceof Map?r.entries():Object.entries(r),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,s])=>{s instanceof xm||(s=new xm(s));let o=sM(i);return s.value===!0?o+=dC(s.params):(o+="=",Array.isArray(s.value)?o+=vY(s):o+=qO(s)),o}).join(`,${n}`)}function xY(r,e){return yY(r,e)}function _Y(r){return r==="ot"||r==="sf"||r==="st"}function SY(r){return typeof r=="number"?Mt(r):r!=null&&r!==""&&r!==!1}const h_=r=>Math.round(r),AY=(r,e)=>(e!=null&&e.baseUrl&&(r=rX(r,e.baseUrl)),encodeURIComponent(r)),Wx=r=>h_(r/100)*100,EY={br:h_,d:h_,bl:Wx,dl:Wx,mtp:Wx,nor:AY,rtp:Wx,tb:h_};function TY(r,e){const t={};if(r==null||typeof r!="object")return t;const n=Object.keys(r).sort(),i=$n({},EY,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return n.forEach(o=>{if(s!=null&&s(o))return;let a=r[o];const l=i[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||SY(a)&&(_Y(o)&&typeof a=="string"&&(a=new YO(a)),t[o]=a))}),t}function QO(r,e={}){return r?xY(TY(r,e),$n({whitespace:!1},e)):""}function MY(r,e={}){const t={};if(!r)return t;const n=Object.entries(r),i=Object.entries(QX).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),s=n.reduce((o,a)=>{var l,u;const[c,h]=a,d=((l=i.find(m=>m[1].includes(c)))===null||l===void 0?void 0:l[0])||s0.REQUEST;return(u=o[d])!==null&&u!==void 0||(o[d]={}),o[d][c]=h,o},{});return Object.entries(s).reduce((o,[a,l])=>(o[a]=QO(l,e),o),t)}function wY(r,e,t){return $n(r,MY(e,t))}const CY="CMCD";function bY(r,e={}){if(!r)return"";const t=QO(r,e);return`${CY}=${encodeURIComponent(t)}`}const NP=/CMCD=[^&#]+/;function RY(r,e,t){const n=bY(e,t);if(!n)return r;if(NP.test(r))return r.replace(NP,n);const i=r.includes("?")?"&":"?";return`${r}${i}${n}`}class ZO{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:to.MANIFEST,su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=i=>{try{const{frag:s,part:o}=i,a=this.hls.levels[s.level],l=this.getObjectType(s),u={d:(o||s).duration*1e3,ot:l};(l===to.VIDEO||l===to.AUDIO||l==to.MUXED)&&(u.br=a.bitrate/1e3,u.tb=this.getTopBandwidth(l)/1e3,u.bl=this.getBufferLength(l));const c=o?this.getNextPart(o):this.getNextFrag(s);c!=null&&c.url&&c.url!==s.url&&(u.nor=c.url),this.apply(i,u)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHED,this.onMediaDetached,this),e.on(H.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHED,this.onMediaDetached,this),e.off(H.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:$X.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){$n(t,this.createData());const n=t.ot===to.INIT||t.ot===to.VIDEO||t.ot===to.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((o,a)=>(i.includes(a)&&(o[a]=t[a]),o),{}));const s={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),wY(e.headers,t,s)):e.url=RY(e.url,t,s)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const i=e.sn-n.startSN;return n.fragments[i+1]}}getNextPart(e){var t,n;const{index:i,fragment:s}=e,o=(t=this.hls.levels[s.level])==null||(n=t.details)==null?void 0:n.partList;if(o){const{sn:a}=s;for(let l=o.length-1;l>=0;l--){const u=o[l];if(u.index===i&&u.fragment.sn===a)return o[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return to.TIMED_TEXT;if(e.sn==="initSegment")return to.INIT;if(t==="audio")return to.AUDIO;if(t==="main")return this.hls.audioTracks.length?to.VIDEO:to.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===to.AUDIO)n=i.audioTracks;else{const s=i.maxAutoLevel,o=s>-1?s+1:i.levels.length;n=i.levels.slice(0,o)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===to.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:pn.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}}const IY=3e5;class eU extends ac{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===Ur.SendAlternateToPenaltyBox&&n.flags===ca.MoveAllAlternatesMatchingHost){const i=this.levels;let s=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:u}=t.context;a&&i?o=this.getPathwayForGroupId(a,u,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&i&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==o),n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${i&&i.length} priorities: ${yi(s)} penalized: ${yi(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(s=>{i-n[s]>IY&&delete n[s]});for(let s=0;s<e.length;s++){const o=e[s];if(o in n)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,_O(t),this.hls.trigger(H.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[a];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<i.length;s++)if(t===_n.AUDIO_TRACK&&i[s].hasAudioGroup(e)||t===_n.SUBTITLE_TRACK&&i[s].hasSubtitleGroup(e))return i[s].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(t.some(c=>c.pathwayId===o))return;const u=this.getLevelsForPathway(a).map(c=>{const h=new pi(c.attrs);h["PATHWAY-ID"]=o;const d=h.AUDIO&&`${h.AUDIO}_clone_${o}`,m=h.SUBTITLES&&`${h.SUBTITLES}_clone_${o}`;d&&(n[h.AUDIO]=d,h.AUDIO=d),m&&(i[h.SUBTITLES]=m,h.SUBTITLES=m);const g=tU(c.uri,h["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),x=new gm({attrs:h,audioCodec:c.audioCodec,bitrate:c.bitrate,height:c.height,name:c.name,url:g,videoCodec:c.videoCodec,width:c.width});if(c.audioGroups)for(let _=1;_<c.audioGroups.length;_++)x.addGroupId("audio",`${c.audioGroups[_]}_clone_${o}`);if(c.subtitleGroups)for(let _=1;_<c.subtitleGroups.length;_++)x.addGroupId("text",`${c.subtitleGroups[_]}_clone_${o}`);return x});t.push(...u),GP(this.audioTracks,n,l,o),GP(this.subtitleTracks,i,l,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+c)}const s={responseType:"json",url:i.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(c,h,d,m)=>{this.log(`Loaded steering manifest: "${i}"`);const g=c.data;if((g==null?void 0:g.VERSION)!==1){this.log(`Steering VERSION ${g.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=g.TTL;const{"RELOAD-URI":x,"PATHWAY-CLONES":_,"PATHWAY-PRIORITY":S}=g;if(x)try{this.uri=new self.URL(x,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${x}`);return}this.scheduleRefresh(this.uri||d.url),_&&this.clonePathways(_);const T={steeringManifest:g,url:i.toString()};this.hls.trigger(H.STEERING_MANIFEST_LOADED,T),S&&this.updatePathwayPriority(S)},onError:(c,h,d,m)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${h.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let g=this.timeToLoad*1e3;if(c.code===429){const x=this.loader;if(typeof(x==null?void 0:x.getResponseHeader)=="function"){const _=x.getResponseHeader("Retry-After");_&&(g=parseFloat(_)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,g)},onTimeout:(c,h,d)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function GP(r,e,t,n){r&&Object.keys(e).forEach(i=>{const s=r.filter(o=>o.groupId===i).map(o=>{const a=$n({},o);return a.details=void 0,a.attrs=new pi(a.attrs),a.url=a.attrs.URI=tU(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[i],a.attrs["PATHWAY-ID"]=n,a});r.push(...s)})}function tU(r,e,t,n){const{HOST:i,PARAMS:s,[t]:o}=n;let a;e&&(a=o==null?void 0:o[e],a&&(r=a));const l=new self.URL(r);return i&&!a&&(l.host=i),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}class $f extends ac{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=$f.CDMCleanupPromise?[$f.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:n,initData:i}=t,s=`"${t.type}" event: init data type: "${n}"`;if(this.debug(s),i!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=Gx(this.config));const a=o.map(DE).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(a)}this.keyFormatPromise.then(o=>{const a=LE(o);let l,u;if(n==="sinf"){if(a!==Gn.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${a}`);return}const g=Sr(new Uint8Array(i));try{const x=rC(JSON.parse(g).sinf),_=Qk(x);if(!_)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(_.subarray(8,24)),u=Gn.FAIRPLAY}catch(x){this.warn(`${s} Failed to parse sinf: ${x}`);return}}else{if(a!==Gn.WIDEVINE&&a!==Gn.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${a}`);return}const g=U$(i),x=g.filter(S=>!!S.systemId&&PE(S.systemId)===a);x.length>1&&this.warn(`${s} Using first of ${x.length} pssh found for selected key-system ${a}`);const _=x[0];if(!_){g.length===0||g.some(S=>!S.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${g.map(S=>PE(S.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=PE(_.systemId),_.version===0&&_.data)if(u===Gn.WIDEVINE){const S=_.data.length-22;l=new Uint8Array(_.data.subarray(S,S+16))}else u===Gn.PLAYREADY&&(l=pO(_.data))}if(!u||!l)return;const c=bl.hexDump(l),{keyIdToKeySessionPromise:h,mediaKeySessions:d}=this;let m=h[c];for(let g=0;g<d.length;g++){const x=d[g],_=x.decryptdata;if(!_.keyId)continue;const S=bl.hexDump(_.keyId);if(c===S||_.uri.replace(/-/g,"").indexOf(c)!==-1){if(m=h[S],_.pssh)break;delete h[S],_.pssh=new Uint8Array(i),_.keyId=l,m=h[c]=m.then(()=>this.generateRequestWithPreferredKeySession(x,n,i,"encrypted-event-key-match")),m.catch(T=>this.handleError(T));break}}if(!m){if(u!==a){this.log(`Ignoring "${t.type}" event with ${u} init data for selected key-system ${a}`);return}m=h[c]=this.getKeySystemSelectionPromise([u]).then(({keySystem:g,mediaKeys:x})=>{var _;this.throwIfDestroyed();const S=new vm("ISO-23001-7",c,(_=DE(g))!=null?_:"");return S.pssh=new Uint8Array(i),S.keyId=l,this.attemptSetMediaKeys(g,x).then(()=>{this.throwIfDestroyed();const T=this.createMediaKeySessionContext({decryptdata:S,keySystem:g,mediaKeys:x});return this.generateRequestWithPreferredKeySession(T,n,i,"encrypted-event-no-match")})}),m.catch(g=>this.handleError(g))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){const e=this.media;this.unregisterListeners(),this.onMediaDetached(),this._clear(e);const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(H.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(H.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(H.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(H.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(H.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(H.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===Gn.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,l)=>!!o&&l.indexOf(o)===a,i=t.map(o=>o.audioCodec).filter(n),s=t.map(o=>o.videoCodec).filter(n);return i.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,a)=>{const l=u=>{const c=u.shift();this.getMediaKeysPromise(c,i,s).then(h=>o({keySystem:c,mediaKeys:h})).catch(h=>{u.length?l(u):h instanceof sa?a(h):a(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return sC===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=w7(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let o=s==null?void 0:s.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${yi(i)}`),o=this.requestMediaKeySystemAccess(e,i);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),u.then(h=>h?this.setMediaKeysServerCertificate(c,e,h):c))),a.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),a.mediaKeys})}return o.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${bl.hexDump(e.keyId||[])}`);const i=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,s,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return bl.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${bl.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=Gx(this.config),s=e.map(LE).filter(o=>!!o&&i.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:o})=>{const a=DE(o);a?t(a):n(new Error(`Unable to find format for key-system "${o}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.getKeySystemForKeyPromise(t).then(({keySystem:a,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(a,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:a,mediaKeys:l,decryptdata:t}))))),(this.keyIdToKeySessionPromise[n]=s.then(a=>{const l="cenc",u=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(a,l,u,"playlist-key")})).catch(a=>this.handleError(a))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof sa?this.hls.trigger(H.ERROR,e.data):this.hls.trigger(H.ERROR,{type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=LE(e.keyFormat),s=i?[i]:Gx(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Gx(this.config)),e.length===0)throw new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${yi({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var s,o;const a=(s=this.config.drmSystems)==null||(o=s[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const g=a.call(this.hls,t,n,e);if(!g)throw new Error("Invalid response from configured generateRequest filter");t=g.initDataType,n=g.initData?g.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(g){var l;if(this.warn(g.message),(l=this.hls)!=null&&l.config.debug)throw g}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${u} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new oC,h=e._onmessage=g=>{const x=e.mediaKeysSession;if(!x){c.emit("error",new Error("invalid state"));return}const{messageType:_,message:S}=g;this.log(`"${_}" message event for session "${x.sessionId}" message size: ${S.byteLength}`),_==="license-request"||_==="license-renewal"?this.renewLicense(e,S).catch(T=>{c.eventNames().length?c.emit("error",T):this.handleError(T)}):_==="license-release"?e.keySystem===Gn.FAIRPLAY&&(this.updateKeySession(e,QT("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${_}"`)},d=e._onkeystatuseschange=g=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const _=e.keyStatus;c.emit("keyStatus",_),_==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",h),e.mediaKeysSession.addEventListener("keystatuseschange",d);const m=new Promise((g,x)=>{c.on("error",x),c.on("keyStatus",_=>{_.startsWith("usable")?g():_==="output-restricted"?x(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):_==="internal-error"?x(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${_}"`)):_==="expired"?x(new Error("key expired while generating request")):this.warn(`unhandled key status change "${_}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var g;this.log(`Request generated for key-session "${(g=e.mediaKeysSession)==null?void 0:g.sessionId}" keyId: ${u}`)}).catch(g=>{throw new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_SESSION,error:g,fatal:!1},`Error generating key-session request: ${g}`)}).then(()=>m).catch(g=>{throw c.removeAllListeners(),this.removeSession(e),g}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${bl.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${bl.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,m,g,x)=>{o(d.data)},onError:(d,m,g,x)=>{a(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:Wn({url:l.url,data:void 0},d)},`"${e}" certificate request failed (${s}). Status: ${d.code} (${d.text})`))},onTimeout:(d,m,g)=>{a(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(d,m,g)=>{a(new Error("aborted"))}};i.load(l,c,h)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,s)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(o=>{s(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(n,"application/xml"),s=i.querySelectorAll("HttpHeader");if(s.length>0){let c;for(let h=0,d=s.length;h<d;h++){var o,a;c=s[h];const m=(o=c.querySelector("name"))==null?void 0:o.textContent,g=(a=c.querySelector("value"))==null?void 0:a.textContent;m&&g&&e.setRequestHeader(m,g)}}const l=i.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return QT(atob(u))}setupLicenseXHR(e,t,n,i){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,i)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,n,i)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,s)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,a,o,e)}catch(c){this.error(c)}i(l)}else{const l=n.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||a.status>=400&&a.status<500)s(new sa({type:Nt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,t).then(i,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==Gn.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null)}_clear(e){var t;const n=this.mediaKeySessions;this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},vm.clearKeyUriToKeyIdMap();const i=n.length;$f.CDMCleanupPromise=Promise.all(n.map(s=>this.removeSession(s)).concat(e==null||(t=e.setMediaKeys(null))==null?void 0:t.catch(s=>{var o;this.log(`Could not clear media keys: ${s}`),(o=this.hls)==null||o.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${s}`)})}))).then(()=>{i&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(s=>{var o;this.log(`Could not close sessions and clear media keys: ${s}`),(o=this.hls)==null||o.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${s}`)})})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,s)=>(i.indexOf(s.keyFormat)===-1&&i.push(s.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(s=>{var o;this.log(`Could not remove session: ${s}`),(o=this.hls)==null||o.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${s}`)})}).then(()=>t.close()).catch(s=>{var o;this.log(`Could not close session: ${s}`),(o=this.hls)==null||o.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${s}`)})})}}}$f.CDMCleanupPromise=void 0;class sa extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class nU{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(H.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(H.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const s=i-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/s,u=this.hls;if(u.trigger(H.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>u.config.fpsDroppedMonitoringThreshold*a){let c=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(H.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function iU(r,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=r,e.dispatchEvent(t)}function rU(r,e){const t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){wn.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,r.addCue(i)}catch(i){wn.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(r.mode=t)}function Vp(r,e){const t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues)for(let n=r.cues.length;n--;)e&&r.cues[n].removeEventListener("enter",e),r.removeCue(r.cues[n]);t==="disabled"&&(r.mode=t)}function oM(r,e,t,n){const i=r.mode;if(i==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const s=PY(r.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&r.removeCue(s[o])}i==="disabled"&&(r.mode=i)}function LY(r,e){if(e<=r[0].startTime)return 0;const t=r.length-1;if(e>r[t].endTime)return-1;let n=0,i=t,s;for(;n<=i;)if(s=Math.floor((i+n)/2),e<r[s].startTime)i=s-1;else if(e>r[s].startTime&&n<t)n=s+1;else return s;return r[n].startTime-e<e-r[i].startTime?n:i}function PY(r,e,t){const n=[],i=LY(r,e);if(i>-1)for(let s=i,o=r.length;s<o;s++){const a=r[s];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function f_(r){const e=[];for(let t=0;t<r.length;t++){const n=r[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(r[t])}return e}class sU extends EA{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=f_(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")t=n[s];else if(n[s].mode==="showing"){t=n[s];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(H.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVEL_LOADING,this.onLevelLoading,this),e.off(H.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(H.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;f_(n.textTracks).forEach(o=>{Vp(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let s=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(i==null?void 0:i.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(c=>!n||n.indexOf(c.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(c=>c.default)&&(this.selectDefaultTrack=!1),o.forEach((c,h)=>{c.id=h});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;const c=Bl(a,o);if(c>-1)s=o[c];else{const h=Bl(a,this.tracks);s=this.tracks[h]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(H.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const s=t[i];if(!(n&&!s.default||!n&&!e)&&(!e||Kf(s,e)))return i}if(e){for(let i=0;i<t.length;i++){const s=t[i];if(rv(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const s=t[i];if(rv(e.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(iM(i,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===_n.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Kf(e,n))return n;const i=Bl(e,this.tracksInGroup);if(i>-1){const s=this.tracksInGroup[i];return this.setSubtitleTrack(i),s}else{if(n)return null;{const s=Bl(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,s=this.getUrlWithDirectives(e.url,t),o=e.details,a=o==null?void 0:o.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${s}`),this.hls.trigger(H.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=f_(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(s=>iM(n,s))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==i&&(s.mode="disabled")}),i){const s=this.subtitleDisplay?"showing":"hidden";i.mode!==s&&(i.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Mt(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(H.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:o,groupId:a="",name:l,type:u,url:c}=i;this.hls.trigger(H.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:u,url:c});const h=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(h)}}function C0(r){let e=5381,t=r.length;for(;t;)e=e*33^r.charCodeAt(--t);return(e>>>0).toString()}const im=.025;let mS=function(r){return r[r.Point=0]="Point",r[r.Range=1]="Range",r}({});function DY(r,e,t){return`${r.identifier}-${t+1}-${C0(e)}`}class BY{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){if(e>=this.assetList.length)return!0;const t=this.playoutLimit;return e<=0||isNaN(t)?!1:this.assetList[e].startOffset>t}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return zE(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=zE(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Mt(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return zE(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<im))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?mS.Range:mS.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return FY(this)}}function zE(r,e){return r-e.start<e.duration/2&&!(Math.abs(r-(e.start+e.duration))<im)?e.start:e.start+e.duration}function oU(r,e,t){const n=new self.URL(r,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function FY(r){return`["${r.identifier}" ${r.cue.pre?"<pre>":r.cue.post?"<post>":""}${r.timelineStart.toFixed(2)}-${r.resumeTime.toFixed(2)}]`}function aM(r){const e=r.timelineStart,t=r.duration||0;return`["${r.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class kY{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{const u=this.interstitial.playoutLimit,c=this.currentTime;this.startOffset+c>=u&&this.hls.trigger(H.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new e(t);this.interstitial=n,this.assetItem=i;let o=i.uri;try{o=oU(o,s.sessionId).href}catch{}s.loadSource(o);const a=()=>{this.hasDetails=!0};s.once(H.LEVEL_LOADED,a),s.once(H.AUDIO_TRACK_LOADED,a),s.once(H.SUBTITLE_TRACK_LOADED,a),s.on(H.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&u.addEventListener("timeupdate",this.checkPlayout)})}bufferedInPlaceToEnd(e){var t;if(!this.interstitial.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const n=this.timelineOffset,i=pn.bufferInfo(e,n,0);return this.getAssetTime(i.end)>=this._bufferedEosTime-.02}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=pn.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}on(e,t,n){this.hls.on(e,t)}once(e,t,n){this.hls.once(e,t)}off(e,t,n){this.hls.off(e,t)}toString(){var e,t;return`HlsAssetPlayer: ${aM(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${(t=this.interstitial)!=null&&t.appendInPlace?"append-in-place":""}`}}const HP=.033;class OY extends ac{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i)for(i[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(s=i[n])!=null&&s.event;){var s;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let s=n[i];if(t&&t!=="primary"&&(s=s[t]),e===s.start||e>s.start&&e<s.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t&&n[i];i++){const s=n[i].event;if(s!=null&&s.restrictions.jump&&!s.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if(((n=t[i].event)==null?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let s=0;s<i;s++){const o=n[s];if(!o.error){const a=o.timelineStart;if(t===a||t>a&&t<a+(o.duration||0))return s}}return 0}get assetIdAtEnd(){var e,t;const n=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(n){const i=n.assetList,s=i[i.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,s=this.events,o=this.parseDateRanges(i,{url:n.url},t),a=Object.keys(i),l=s?s.filter(u=>!a.includes(u.identifier)):[];o.length&&o.sort((u,c)=>{const h=u.cue.pre,d=u.cue.post,m=c.cue.pre,g=c.cue.post;if(h&&!m)return-1;if(m&&!h||d&&!g)return 1;if(g&&!d)return-1;if(!h&&!m&&!d&&!g){const x=u.startTime,_=c.startTime;if(x!==_)return x-_}return u.dateRange.tagOrder-c.dateRange.tagOrder}),this.events=o,l.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,l)}updateSchedule(e,t=[]){const n=this.events||[];if(n.length||t.length||this.length<2){const i=this.items,s=this.parseSchedule(n,e);(t.length||(i==null?void 0:i.length)!==s.length||s.some((a,l)=>Math.abs(a.playout.start-i[l].playout.start)>.005||Math.abs(a.playout.end-i[l].playout.end)>.005))&&(this.items=s,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,n){const i=[],s=Object.keys(e);for(let o=0;o<s.length;o++){const a=s[o],l=e[a];if(l.isInterstitial){let u=this.eventMap[a];u?u.setDateRange(l):(u=new BY(l,t),this.eventMap[a]=u,n===!1&&(u.appendInPlace=n)),i.push(u)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,s=i.live?1/0:i.edge;let o=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,t);let l=0,u=0;if(e.forEach((c,h)=>{const d=c.cue.pre,m=c.cue.post,g=e[h-1]||null,x=c.appendInPlace,_=m?s:c.startOffset,S=c.duration,T=c.timelineOccupancy===mS.Range?S:0,E=c.resumptionOffset,C=(g==null?void 0:g.startTime)===_,R=_+c.cumulativeDuration;let P=x?R+S:_+E;if(d||!m&&_<=0){const F=u;u+=T,c.timelineStart=R;const D=o;o+=S,n.push({event:c,start:R,end:P,playout:{start:D,end:o},integrated:{start:F,end:u}})}else if(_<=s){if(!C){const I=_-l;if(I>HP){const N=l,V=u;u+=I;const q=o;o+=I;const Q={previousEvent:e[h-1]||null,nextEvent:c,start:N,end:N+I,playout:{start:q,end:o},integrated:{start:V,end:u}};n.push(Q)}else I>0&&g&&(g.cumulativeDuration+=I,n[n.length-1].end=_)}m&&(P=R),c.timelineStart=R;const F=u;u+=T;const D=o;o+=S,n.push({event:c,start:R,end:P,playout:{start:D,end:o},integrated:{start:F,end:u}})}else return;const L=c.resumeTime;m||L>s?l=s:l=L}),l<s){var a;const c=l,h=u,d=s-l;u+=d;const m=o;o+=d,n.push({previousEvent:((a=n[n.length-1])==null?void 0:a.event)||null,nextEvent:null,start:l,end:c+d,playout:{start:m,end:o},integrated:{start:h,end:u}})}this.setDurations(s,o,u)}else n.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,i=n.live?1/0:n.edge;let s=0,o=-1;e.forEach((a,l)=>{const u=a.cue.pre,c=a.cue.post,h=u?0:c?i:a.startTime;this.updateAssetDurations(a),o===h?a.cumulativeDuration=s:(s=0,o=h),!c&&a.snapOptions.in&&(a.resumeAnchor=sd(null,n.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(a,t)||(a.appendInPlace=!1)),!a.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<HP&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`));const m=Mt(a.resumeOffset)?a.resumeOffset:a.duration;s+=m})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;return Math.abs(n-i)>im?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${i}`),!1):t?!Object.keys(t).some(o=>{const a=t[o].details,l=a.edge;if(n>=l)return this.log(`"${e.identifier}" resumption ${n} past ${o} playlist end ${l}`),!1;const u=sd(null,a.fragments,n);if(!u)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${o} playlist (${a.fragStart}-${a.fragmentEnd})`),!0;const c=o==="audio"?.175:0;return Math.abs(u.start-n)<im+c||Math.abs(u.end-n)<im+c?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${o} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${n} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,s=!1;e.assetList.forEach((o,a)=>{const l=t+n;o.startOffset=n,o.timelineStart=l,i||(i=o.duration===null),s||(s=!!o.error);const u=o.error?0:o.duration||0;n+=u}),i&&!s?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Qc(r){return`[${r.event?'"'+r.event.identifier+'"':"primary"}: ${r.start.toFixed(2)}-${r.end.toFixed(2)}]`}class UY{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=oU(n,this.hls.sessionId,e.baseUrl)}catch(d){const m=this.assignAssetListError(e,Le.ASSET_LIST_LOAD_ERROR,d,n);this.hls.trigger(H.ERROR,m);return}t&&i.protocol!=="data:"&&i.searchParams.set("_HLS_start_offset",""+t);const s=this.hls.config,o=s.loader,a=new o(s),l={responseType:"json",url:i.href},u=s.interstitialAssetListLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,m,g,x)=>{const _=d.data,S=_==null?void 0:_.ASSETS;if(!Array.isArray(S)){const T=this.assignAssetListError(e,Le.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),g.url,m,x);this.hls.trigger(H.ERROR,T);return}e.assetListResponse=_,this.hls.trigger(H.ASSET_LIST_LOADED,{event:e,assetListResponse:_,networkDetails:x})},onError:(d,m,g,x)=>{const _=this.assignAssetListError(e,Le.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${d.code} ${d.text} (${m.url})`),m.url,x,g);this.hls.trigger(H.ERROR,_)},onTimeout:(d,m,g)=>{const x=this.assignAssetListError(e,Le.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${m.url})`),m.url,d,g);this.hls.trigger(H.ERROR,x)}};return a.load(l,c,h),this.hls.trigger(H.ASSET_LIST_LOADING,{event:e}),a}assignAssetListError(e,t,n,i,s,o){return e.error=n,{type:Nt.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:o,stats:s}}}function zu(r,e,t){Fl(r,e,t),r.addEventListener(e,t)}function Fl(r,e,t){r.removeEventListener(e,t)}function zP(r){r==null||r.play().catch(()=>{})}class NY extends ac{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;const i=n-this.timelinePos;if(Math.abs(i)<1/7056e5)return;const o=i<=-.01;this.timelinePos=n,this.bufferedPos=n;const a=this.playingItem;if(!a){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(n,n-i)&&this.updateSchedule(),this.checkBuffer(),o&&n<a.start||n>=a.end){var l;const d=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(a)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!o){const m=this.findItemIndex(a);if(d>m){const g=this.schedule.findJumpRestrictedIndex(m+1,d);if(g>m){this.setSchedulePosition(g);return}}}this.setSchedulePosition(d);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(a)){const d=a.event.assetList[0];d&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,d))}return}const c=u.timelineStart,h=u.duration||0;(o&&n<c||n>=c+h)&&this.setScheduleToAssetAtTime(n,u)},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const i=this.playingItem;if(!i||this.playingLastItem)return;if(n>=i.end){this.timelinePos=i.end;const a=this.findItemIndex(i);this.setSchedulePosition(a+1)}const s=this.playingAsset;if(!s)return;const o=s.timelineStart+(s.duration||0);n>=o&&this.setScheduleToAssetAtTime(n,s)},this.onScheduleUpdate=(n,i)=>{const s=this.schedule,o=this.playingItem,a=s.events||[],l=s.items||[],u=s.durations,c=n.map(m=>m.identifier),h=!!(a.length||c.length);if(h&&this.log(`INTERSTITIALS_UPDATED (${a.length}): ${a}
Schedule: ${l.map(m=>Qc(m))}`),c.length&&this.log(`Removed events ${c}`),this.playerQueue.forEach(m=>{if(m.interstitial.appendInPlace){const g=m.assetItem.timelineStart,x=m.timelineOffset-g;if(x)try{m.timelineOffset=g}catch(_){Math.abs(x)>im&&this.warn(`${_} ("${m.assetId}" ${m.timelineOffset}->${g})`)}}}),o){const m=this.updateItem(o,this.timelinePos);this.itemsMatch(o,m)&&(this.playingItem=m,this.waitingItem=this.endedItem=null)}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const d=this.bufferingItem;if(d){const m=this.updateItem(d,this.bufferedPos);this.itemsMatch(d,m)?this.bufferingItem=m:d.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(d.event,null))}if(n.forEach(m=>{m.assetList.forEach(g=>{this.clearAssetPlayer(g.identifier,null)})}),h||i){if(this.hls.trigger(H.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:l.slice(0),durations:u,removedIds:c}),this.isInterstitial(o)&&c.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new UY(e),this.schedule=new OY(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(H.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(H.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(H.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(H.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(H.BUFFER_APPENDED,this.onBufferAppended,this),e.on(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(H.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(H.MEDIA_ENDED,this.onMediaEnded,this),e.on(H.ERROR,this.onError,this),e.on(H.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(H.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(H.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(H.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(H.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(H.BUFFER_CODECS,this.onBufferCodecs,this),e.off(H.BUFFER_APPENDED,this.onBufferAppended,this),e.off(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(H.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(H.MEDIA_ENDED,this.onMediaEnded,this),e.off(H.ERROR,this.onError,this),e.off(H.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Fl(e,"play",this.onPlay),Fl(e,"pause",this.onPause),Fl(e,"seeking",this.onSeeking),Fl(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;zu(n,"seeking",this.onSeeking),zu(n,"timeupdate",this.onTimeupdate),zu(n,"play",this.onPlay),zu(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!i){this.clearScheduleState();const s=this.findItemIndex(n);this.setSchedulePosition(s)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=h=>h&&e.getAssetPlayer(h.identifier),i=(h,d,m,g,x)=>{if(h){let _=h[d].start;const S=h.event;if(S){if(d==="playout"||S.timelineOccupancy!==mS.Point){const T=n(m);(T==null?void 0:T.interstitial)===S&&(_+=T.assetItem.startOffset+T[x])}}else{const T=g==="bufferedPos"?o():e[g];_+=T-h.start}return _}return 0},s=(h,d)=>{if(h!==0&&d!=="primary"&&e.schedule.length){var m;const g=e.schedule.findItemIndexAtTime(h),x=(m=e.schedule.items)==null?void 0:m[g];if(x){const _=x[d].start-x.start;return h+_}}return h},o=()=>{const h=e.bufferedPos;return h===Number.MAX_VALUE?a("primary"):Math.max(h,0)},a=h=>{var d;return(d=e.primaryDetails)!=null&&d.live?e.primaryDetails.edge:e.schedule.durations[h]},l=(h,d)=>{var m,g;const x=e.effectivePlayingItem;if(x!=null&&(m=x.event)!=null&&m.restrictions.skip)return;e.log(`seek to ${h} "${d}"`);const _=e.effectivePlayingItem,S=e.schedule.findItemIndexAtTime(h,d),T=(g=e.schedule.items)==null?void 0:g[S],E=e.getBufferingPlayer(),C=E==null?void 0:E.interstitial,R=C==null?void 0:C.appendInPlace,P=_&&e.itemsMatch(_,T);if(_&&(R||P)){const F=n(e.playingAsset),D=(F==null?void 0:F.media)||e.primaryMedia;if(D){const I=d==="primary"?D.currentTime:i(_,d,e.playingAsset,"timelinePos","currentTime"),N=h-I,V=(R?I:D.currentTime)+N;if(V>=0&&(!F||R||V<=F.duration)){D.currentTime=V;return}}}if(T){let F=h;if(d!=="primary"){const I=T[d].start,N=h-I;F=T.start+N}const D=!e.isInterstitial(T);if((!e.isInterstitial(_)||_.event.appendInPlace)&&(D||T.event.appendInPlace)){const I=e.media||(R?E==null?void 0:E.media:null);I&&(I.currentTime=F)}else if(_){const I=e.findItemIndex(_);if(S>I){const V=e.schedule.findJumpRestrictedIndex(I+1,S);if(V>I){e.setSchedulePosition(V);return}}let N=0;if(D)e.timelinePos=F,e.checkBuffer();else{var L;const V=T==null||(L=T.event)==null?void 0:L.assetList;if(V){const q=h-(T[d]||T).start;for(let Q=V.length;Q--;){const re=V[Q];if(re.duration&&q>=re.startOffset&&q<re.startOffset+re.duration){N=Q;break}}}}e.setSchedulePosition(S,N)}}},u=()=>{const h=e.effectivePlayingItem;if(e.isInterstitial(h))return h;const d=t();return e.isInterstitial(d)?d:null},c={get currentTime(){const h=u(),d=e.effectivePlayingItem;return d&&d===h?i(d,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-d.playout.start:0},set currentTime(h){const d=u(),m=e.effectivePlayingItem;m&&m===d&&l(h+m.playout.start,"playout")},get duration(){const h=u();return h?h.playout.end-h.playout.start:0},get assetPlayers(){var h;const d=(h=u())==null?void 0:h.event.assetList;return d?d.map(m=>e.getAssetPlayer(m.identifier)):[]},get playingIndex(){var h;const d=(h=u())==null?void 0:h.event;return d&&e.effectivePlayingAsset?d.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var h,d;return((h=e.schedule)==null||(d=h.events)==null?void 0:d.slice(0))||[]},get schedule(){var h,d;return((h=e.schedule)==null||(d=h.items)==null?void 0:d.slice(0))||[]},get interstitialPlayer(){return u()?c:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const h=t();return e.findItemIndex(h)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const h=e.effectivePlayingItem;return e.findItemIndex(h)},primary:{get bufferedEnd(){return o()},get currentTime(){const h=e.timelinePos;return h>0?h:0},set currentTime(h){l(h,"primary")},get duration(){return a("primary")},get seekableStart(){var h;return((h=e.primaryDetails)==null?void 0:h.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(h){l(h,"integrated")},get duration(){return a("integrated")},get seekableStart(){var h;return s(((h=e.primaryDetails)==null?void 0:h.fragmentStart)||0,"integrated")}},skip:()=>{const h=e.effectivePlayingItem,d=h==null?void 0:h.event;if(d&&!d.restrictions.skip){const m=e.findItemIndex(h);if(d.appendInPlace){const g=h.playout.start+h.event.duration;l(g+.001,"playout")}else e.advanceAfterAssetEnded(d,m,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,n;if(this.mediaSelection===null)return;const i=this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&!i.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(s=this.primaryMedia);const o=(n=s)==null?void 0:n.currentTime;if(!(o===void 0||!Mt(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i){this.detachedData={media:i};return}const s=e.transferMedia();this.log(`transfer MediaSource from ${e} ${yi(s)}`),this.detachedData=s}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let s=null;const o=this.hls,a=e!==o,l=a&&e.interstitial.appendInPlace,u=(n=this.detachedData)==null?void 0:n.mediaSource;let c;if(o.media)l&&(s=o.transferMedia(),this.detachedData=s),c="Primary";else if(u){const m=this.getBufferingPlayer();m?(s=m.transferMedia(),c=`${m}`):c="detached MediaSource"}else c="detached media";if(!s){if(u)s=this.detachedData,this.log(`using detachedData: MediaSource ${yi(s)}`);else if(!this.detachedData||o.media===t){const m=this.playerQueue;m.length>1&&m.forEach(g=>{if(a&&g.interstitial.appendInPlace!==l){const x=g.interstitial;this.clearInterstitial(g.interstitial,null),x.appendInPlace=!1,x.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${x}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const h=s&&"mediaSource"in s&&((i=s.mediaSource)==null?void 0:i.readyState)!=="closed",d=h&&s?s:t;if(this.log(`${h?"transfering MediaSource":"attaching media"} to ${a?e:"Primary"} from ${c}`),d===s){const m=a&&e.assetId===this.schedule.assetIdAtEnd;d.overrides={duration:this.schedule.duration,endOfStream:!a||m,cueRemoval:!a}}e.attachMedia(d)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(n===-1){const s=this.hls.startPosition;if(this.timelinePos=s,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(s>=0||!this.primaryLive){const o=this.timelinePos=s>0?s:0,a=e.findItemIndexAtTime(o);this.setSchedulePosition(a)}}else if(i&&!this.playingItem){const s=e.findItemIndex(i);this.setSchedulePosition(s)}}advanceAfterAssetEnded(e,t,n){const i=n+1;if(!e.isAssetPastPlayoutLimit(i)&&!e.assetList[i].error)this.setSchedulePosition(t,i);else{const s=this.schedule.items;if(s){const o=t+1,a=s.length;if(o>=a){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.timelinePos=l,this.checkBuffer()),this.setSchedulePosition(o)}}}setScheduleToAssetAtTime(e,t){const n=this.schedule,i=t.parentIdentifier,s=n.getEvent(i);if(s){const o=n.findEventIndex(i),a=n.findAssetIndex(s,e);this.setSchedulePosition(o,a)}}setSchedulePosition(e,t){const n=this.schedule.items;if(!n||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const i=e>=0?n[e]:null,s=this.playingItem,o=this.playingLastItem;if(this.isInterstitial(s)){var a;const u=s.event,c=this.playingAsset,h=c==null?void 0:c.identifier,d=h?this.getAssetPlayer(h):null;if(d&&h&&(!this.eventItemsMatch(s,i)||t!==void 0&&h!==((a=u.assetList)==null?void 0:a[t].identifier))){var l;const m=u.findAssetIndex(c);this.log(`INTERSTITIAL_ASSET_ENDED ${m+1}/${u.assetList.length} ${aM(c)}`),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(H.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:m,event:u,schedule:n.slice(0),scheduleIndex:e,player:d}),this.retreiveMediaSource(h,i),d.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&d.detachMedia()}if(!this.eventItemsMatch(s,i)&&(this.endedItem=s,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${Qc(s)}`),u.hasPlayed=!0,this.hls.trigger(H.INTERSTITIAL_ENDED,{event:u,schedule:n.slice(0),scheduleIndex:e}),u.cue.once)){this.updateSchedule();const m=this.schedule.items;if(i&&m){const g=this.schedule.findItemIndex(i);this.advanceSchedule(g,m,t,s,o)}return}}this.advanceSchedule(e,n,t,s,o)}advanceSchedule(e,t,n,i,s){const o=e>=0?t[e]:null,a=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(u=>{const c=u.interstitial,h=this.schedule.findEventIndex(c.identifier);(h<e||h>e+1)&&this.clearInterstitial(c,o)}),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);const u=o.event;n===void 0&&(n=this.schedule.findAssetIndex(u,this.timelinePos));const c=this.waitingItem;this.assetsBuffered(o,a)||this.setBufferingItem(o);let h=this.preloadAssets(u,n);if(this.eventItemsMatch(o,c||i)||(this.waitingItem=o,this.log(`INTERSTITIAL_STARTED ${Qc(o)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(H.INTERSTITIAL_STARTED,{event:u,schedule:t.slice(0),scheduleIndex:e})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!a){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=o;const d=u.assetList[n];if(!d){const m=t[e+1],g=this.media;m&&g&&!this.isInterstitial(m)&&g.currentTime<m.start&&(g.currentTime=this.timelinePos=m.start),this.advanceAfterAssetEnded(u,e,n||0);return}if(h||(h=this.getAssetPlayer(d.identifier)),h===null||h.destroyed){const m=u.assetList.length;this.warn(`asset ${n+1}/${m} player destroyed ${u}`),h=this.createAssetPlayer(u,d,n)}if(!this.eventItemsMatch(o,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(d))return;this.startAssetPlayer(h,n,t,e,a),this.shouldPlay&&zP(h.media)}else o!==null?(this.resumePrimary(o,e,i),this.shouldPlay&&zP(this.hls.media)):s&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Qc(e)}`),!((i=this.detachedData)!=null&&i.mediaSource)){let o=this.timelinePos;(o<e.start||o>=e.end)&&(o=this.getPrimaryResumption(e,t),this.timelinePos=o),this.attachPrimary(o,e)}if(!n)return;const s=this.schedule.items;s&&(this.log(`resumed ${Qc(e)}`),this.hls.trigger(H.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const i=this.primaryDetails;if(t===0)return this.hls.startPosition;if(i&&(n<i.fragmentStart||n>i.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:pn.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs((((n=i.mainForwardBufferInfo)==null?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(H.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(H.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const n=this.hls.levels[t.level],i=Wn(Wn({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=Wn(Wn({},this.altSelection),{},{audio:n});return}const s=Wn(Wn({},i),{},{audio:n});this.mediaSelection=s}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=Wn(Wn({},this.altSelection),{},{subtitles:n});return}const s=Wn(Wn({},i),{},{subtitles:n});this.mediaSelection=s}onAudioTrackSwitching(e,t){const n=tP(t);this.playerQueue.forEach(i=>i.hls.setAudioOption(t)||i.hls.setAudioOption(n))}onSubtitleTrackSwitch(e,t){const n=tP(t);this.playerQueue.forEach(i=>i.hls.setSubtitleOption(t)||t.id!==-1&&i.hls.setSubtitleOption(n))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const i=this.timelinePos;this.bufferedPos=i,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let i=0;i<t.length;i++){const s=t[i];if(s.cue.post){var n;const o=this.schedule.findEventIndex(s.identifier),a=(n=this.schedule.items)==null?void 0:n[o];this.isInterstitial(a)&&this.eventItemsMatch(a,this.bufferingItem)&&this.bufferedToItem(a,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){const n=this.schedule.items;if(e&&n){const i=this.findItemIndex(e,t);return n[i]||null}return null}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const n=pn.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,t,e)}updateBufferedPos(e,t,n){const i=this.schedule,s=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],s)){this.bufferedPos=e;return}const o=this.playingItem,a=this.findItemIndex(o);let l=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,c;const h=this.findItemIndex(s),d=Math.min(h+1,t.length-1),m=t[d];if((l===-1&&s&&e>=s.end||(u=m.event)!=null&&u.appendInPlace&&e+.01>=m.start)&&(l=d),d-a>1&&(s==null||(c=s.event)==null?void 0:c.appendInPlace)===!1)return;if(this.bufferedPos=e,l>h&&l>a)this.bufferedToItem(m);else{const g=this.primaryDetails;this.primaryLive&&g&&e>g.edge-g.targetduration&&m.start<g.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(m)&&this.preloadAssets(m.event,0)}}else n&&o&&!this.itemsMatch(o,s)&&(l===a?this.bufferedToItem(o):l===a+1&&this.bufferedToItem(t[l]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(i=>{const s=this.getAssetPlayer(i.identifier);return!(s!=null&&s.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:i,events:s}=n;if(!i||!s)return t;const o=this.isInterstitial(e),a=this.getBufferingPlayer();if(this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos)),!this.playbackDisabled){const l=a?a.remaining:t?t.end-this.timelinePos:0;this.log(`buffered to boundary ${Qc(e)}`+(t?` (${l.toFixed(2)} remaining)`:"")),o?e.event.assetList.forEach(u=>{const c=this.getAssetPlayer(u.identifier);c&&c.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering()))}this.hls.trigger(H.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const i=this.detachedData;i?i.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=n.assetList.length===0&&!n.assetListLoader,s=n.cue.once;if(i||!s){const o=this.preloadAssets(n,t);if(o!=null&&o.interstitial.appendInPlace){const a=n.assetList[t],l=this.primaryMedia;a&&l&&this.bufferAssetPlayer(o,l)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,s=i===0&&!e.assetListLoader,o=e.cue.once;if(s){const l=e.timelineStart;if(e.appendInPlace){var a;const d=this.playingItem;!this.isInterstitial(d)&&(d==null||(a=d.nextEvent)==null?void 0:a.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let u,c=0;if(!this.playingItem&&this.primaryLive&&(c=this.hls.startPosition,c===-1&&(c=this.hls.liveSyncPosition||0)),c&&!(e.cue.pre||e.cue.post)){const d=c-l;d>0&&(u=Math.round(d*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:i} ${e}${u?` live-start: ${c} start-offset: ${u}`:""}`),n)return this.createAsset(e,0,0,l,e.duration,n);const h=this.assetListLoader.loadAssetList(e,u);h&&(e.assetListLoader=h)}else if(!o&&i){for(let l=t;l<i;l++){const u=e.assetList[l],c=this.getAssetPlayerQueueIndex(u.identifier);(c===-1||this.playerQueue[c].destroyed)&&!u.error&&this.createAssetPlayer(e,u,l)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(i=>{this.hls.trigger(H.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:i})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,i,s,o){const a={parentIdentifier:e.identifier,identifier:DY(e,o,t),duration:s,startOffset:n,timelineStart:i,uri:o};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,n){this.log(`create HLSAssetPlayer for ${aM(t)}`);const i=this.hls,s=i.userConfig;let o=s.videoPreference;const a=i.loadLevelObj||i.levels[i.currentLevel];(o||a)&&(o=$n({},o),a.videoCodec&&(o.videoCodec=a.videoCodec),a.videoRange&&(o.allowedVideoRanges=[a.videoRange]));const l=i.audioTracks[i.audioTrack],u=i.subtitleTracks[i.subtitleTrack];let c=0;if(this.primaryLive||e.appendInPlace){const E=this.timelinePos-t.timelineStart;if(E>1){const C=t.duration;C&&E<C&&(c=E)}}const h=t.identifier,d=Wn(Wn({},s),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:h,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:l||s.audioPreference,subtitlePreference:u||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(d.timelineOffset=t.timelineStart));const m=d.cmcd;m!=null&&m.sessionId&&m.contentId&&(d.cmcd=$n({},m,{contentId:C0(t.uri)})),this.getAssetPlayer(h)&&this.warn(`Duplicate date range identifier ${e} and asset ${h}`);const g=new kY(this.HlsPlayerClass,d,e,t);this.playerQueue.push(g),e.assetList[n]=t;const x=E=>{if(E.live){const P=new Error(`Interstitials MUST be VOD assets ${e}`),L={fatal:!0,type:Nt.OTHER_ERROR,details:Le.INTERSTITIAL_ASSET_ITEM_ERROR,error:P};this.handleAssetItemError(L,e,this.schedule.findEventIndex(e.identifier),n,P.message);return}const C=E.edge-E.fragmentStart,R=t.duration;(R===null||C>R)&&(this.log(`Interstitial asset "${h}" duration change ${R} > ${C}`),t.duration=C,this.updateSchedule())};g.on(H.LEVEL_UPDATED,(E,{details:C})=>x(C)),g.on(H.LEVEL_PTS_UPDATED,(E,{details:C})=>x(C));const _=(E,C)=>{const R=this.getAssetPlayer(h);if(R&&C.tracks){R.off(H.BUFFER_CODECS,_),R.tracks=C.tracks;const P=this.primaryMedia;this.bufferingAsset===R.assetItem&&P&&!R.media&&this.bufferAssetPlayer(R,P)}};g.on(H.BUFFER_CODECS,_);const S=()=>{var E;const C=this.getAssetPlayer(h);if(this.log(`buffered to end of asset ${C}`),!C)return;const R=this.schedule.findEventIndex(e.identifier),P=e.findAssetIndex(t),L=P+1,F=(E=this.schedule.items)==null?void 0:E[R];if(this.isInterstitial(F))if(P!==-1&&!e.isAssetPastPlayoutLimit(L)&&!e.assetList[L].error)this.bufferedToItem(F,L);else{var D;const I=(D=this.schedule.items)==null?void 0:D[R+1];I&&this.bufferedToItem(I)}};g.on(H.BUFFERED_TO_END,S);const T=E=>()=>{if(!this.getAssetPlayer(h))return;this.shouldPlay=!0;const R=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,R,E)};return g.once(H.MEDIA_ENDED,T(n)),g.once(H.PLAYOUT_LIMIT_REACHED,T(1/0)),g.on(H.ERROR,(E,C)=>{const R=this.getAssetPlayer(h);if(C.details===Le.BUFFER_STALLED_ERROR){if(R!=null&&R.media){const P=R.currentTime,L=R.duration-P;P&&e.appendInPlace&&L/R.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${h} ${e} at ${R.media.currentTime}`),S()):(this.warn(`Stalled at ${P} of ${P+L} in asset ${h} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${C.error} ${e}`)}),g.on(H.DESTROYING,()=>{if(!this.getAssetPlayer(h))return;const C=new Error(`Asset player destroyed unexpectedly ${h}`),R={fatal:!0,type:Nt.OTHER_ERROR,details:Le.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(R,e,this.schedule.findEventIndex(e.identifier),n,C.message)}),this.hls.trigger(H.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:g}),g}clearInterstitial(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)}),e.reset()}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){this.log(`clearAssetPlayer "${e}" toSegment: ${t&&Qc(t)}`);const i=this.playerQueue[n];this.transferMediaFromPlayer(i,t),this.playerQueue.splice(n,1),i.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,s){const{interstitial:o,assetItem:a,assetId:l}=e,u=o.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,(!c||c.identifier!==l)&&(c&&(this.clearAssetPlayer(c.identifier,n[i]),delete c.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${u} ${e}`),this.hls.trigger(H.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:o,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,s)}bufferAssetPlayer(e,t){var n,i;const{interstitial:s,assetItem:o,assetId:a}=e,l=this.schedule.findEventIndex(s.identifier),u=(n=this.schedule.items)==null?void 0:n[l];if(!u)return;this.setBufferingItem(u),this.bufferingAsset=o;const c=this.getBufferingPlayer();if(c===e)return;const h=s.appendInPlace;if(h&&(c==null?void 0:c.interstitial.appendInPlace)===!1)return;const d=(c==null?void 0:c.tracks)||((i=this.detachedData)==null?void 0:i.tracks)||this.requiredTracks;if(h&&o!==this.playingAsset){if(!e.tracks)return;if(d&&!jk(d,e.tracks)){const m=new Error(`Asset "${a}" SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),g={fatal:!0,type:Nt.OTHER_ERROR,details:Le.INTERSTITIAL_ASSET_ITEM_ERROR,error:m},x=s.findAssetIndex(o);this.handleAssetItemError(g,s,l,x,m.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,n,i,s){if(e.details===Le.BUFFER_STALLED_ERROR)return;const o=t.assetList[i]||null;let a=null;if(o){const h=this.getAssetPlayerQueueIndex(o.identifier);a=this.playerQueue[h]||null}const l=this.schedule.items,u=$n({},e,{fatal:!1,errorAction:ev(!0),asset:o,assetListIndex:i,event:t,schedule:l,scheduleIndex:n,player:a});if(this.warn(`Asset item error: ${e.error}`),this.hls.trigger(H.INTERSTITIAL_ASSET_ERROR,u),!e.fatal)return;const c=new Error(s);o&&(this.playingAsset!==o&&this.clearAssetPlayer(o.identifier,null),o.error=c),t.assetList.some(h=>!h.error)?t.appendInPlace&&(t.error=c):t.error=c,this.primaryFallback(t)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;if(this.updateSchedule(),n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${n?Qc(n):"<none>"} error: ${e.error}`),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));let i=this.timelinePos;i===-1&&(i=this.hls.startPosition);const s=this.updateItem(n,i);if(this.itemsMatch(n,s))this.clearInterstitial(e,null);else{const o=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(o)}}else this.checkStart()}onAssetListLoaded(e,t){var n;const i=t.event,s=i.identifier,o=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(s))return;const a=i.timelineStart,l=i.duration;let u=0;o.forEach((g,x)=>{const _=parseFloat(g.DURATION);this.createAsset(i,x,u,a+u,_,g.URI),u+=_}),i.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${l}) ${i}`);const c=this.waitingItem,h=(c==null?void 0:c.event.identifier)===s;this.updateSchedule();const d=(n=this.bufferingItem)==null?void 0:n.event;if(h){var m;const g=this.schedule.findEventIndex(s),x=(m=this.schedule.items)==null?void 0:m[g];if(x){if(!this.playingItem&&this.timelinePos>x.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==g){i.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${i}`),this.primaryFallback(i);return}this.setBufferingItem(x)}this.setSchedulePosition(g)}else if((d==null?void 0:d.identifier)===s&&d.appendInPlace){const g=i.assetList[0],x=this.getAssetPlayer(g.identifier),_=this.primaryMedia;g&&x&&_&&this.bufferAssetPlayer(x,_)}}onError(e,t){switch(t.details){case Le.ASSET_LIST_PARSING_ERROR:case Le.ASSET_LIST_LOAD_ERROR:case Le.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&this.primaryFallback(n);break}case Le.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const VP=500;class aU extends SA{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",Bt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(H.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(H.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(H.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(H.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=tt.IDLE,this.setInterval(VP),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(Zr(n)&&(this.fragPrevious=n),this.state=tt.IDLE,!i)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=n.start;for(let u=0;u<s.length;u++)if(a>=s[u].start&&a<=s[u].end){o=s[u];break}const l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const s=i-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=s){o.shift();continue}else if(o[a].start<s)o[a].start=s;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,s,Bt.SUBTITLE)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Bt.SUBTITLE&&(t.details===Le.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==tt.STOPPED&&(this.state=tt.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&jO(this.levels,t)){this.levels=t.map(n=>new gm(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new gm(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Bt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==tt.STOPPED&&this.setInterval(VP)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:s}=this,{details:o,id:a}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=s[a];if(a>=s.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(o.live||(n=l.details)!=null&&n.live){const h=this.mainDetails;if(o.deltaUpdateFailed||!h)return;const d=h.fragments[0];if(!l.details)o.hasProgramDateTime&&h.hasProgramDateTime?(dS(o,h),u=o.fragmentStart):d&&(u=d.start,eM(o,u));else{var c;u=this.alignPlaylists(o,l.details,(c=this.levelLastLoaded)==null?void 0:c.details),u===0&&d&&(u=d.start,eM(o,u))}}l.details=o,this.levelLastLoaded=l,a===i&&(this.hls.trigger(H.SUBTITLE_TRACK_UPDATED,{details:o,id:a,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===tt.IDLE&&(sd(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&nm(i.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,iC(i.method)).catch(a=>{throw s.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();s.trigger(H.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=tt.IDLE})}}doTick(){if(!this.media){this.state=tt.IDLE;return}if(this.state===tt.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:i}=this,s=this.getLoadPosition(),o=pn.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,i.maxBufferHole),{end:a,len:l}=o,u=n.details,c=this.hls.maxBufferLength+u.levelTargetDuration;if(l>c)return;const h=u.fragments,d=h.length,m=u.edge;let g=null;const x=this.fragPrevious;if(a<m){const T=i.maxFragLookUpTolerance,E=a>m-T?0:T;g=sd(x,h,Math.max(h[0].start,a),E),!g&&x&&x.start<h[0].start&&(g=h[0])}else g=h[d-1];if(g=this.filterReplacedPrimary(g,n.details),!g)return;const _=g.sn-u.startSN,S=h[_-1];if(S&&S.cc===g.cc&&this.fragmentTracker.getState(S)===Ar.NOT_LOADED&&(g=S),this.fragmentTracker.getState(g)===Ar.NOT_LOADED){const T=this.mapToInitFragWhenRequired(g);T&&this.loadFragment(T,n,a)}}}loadFragment(e,t,n){Zr(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new GY(this.tracksBuffered[this.currentTrackId]||[])}}class GY{constructor(e){this.buffered=void 0;const t=(n,i,s)=>{if(i=i>>>0,i>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const HY={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},lU=r=>String.fromCharCode(HY[r]||r),$a=15,Iu=100,zY={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},VY={17:2,18:4,21:6,22:8,23:10,19:13,20:15},WY={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},jY={25:2,26:4,29:6,30:8,31:10,27:13,28:15},KY=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class $Y{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;wn.log(`${this.time} [${e}] ${n}`)}}}const vf=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class uU{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class XY{constructor(){this.uchar=" ",this.penState=new uU}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class YY{constructor(e){this.chars=[],this.pos=0,this.currPenState=new uU,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Iu;t++)this.chars.push(new XY);this.logger=e}equals(e){for(let t=0;t<Iu;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Iu;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Iu;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Iu&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Iu)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=lU(e);if(this.pos>=Iu){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Iu;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Iu;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class VE{constructor(e){this.rows=[],this.currRow=$a-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<$a;t++)this.rows.push(new YY(e));this.logger=e}reset(){for(let e=0;e<$a;e++)this.rows[e].clear();this.currRow=$a-1}equals(e){let t=!0;for(let n=0;n<$a;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<$a;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<$a;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+yi(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<$a;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(o.rows[s+u])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+yi(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let s=0;s<$a;s++){const o=this.rows[s].getTextString();o&&(i=s+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class WP{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new VE(n),this.nonDisplayedMemory=new VE(n),this.lastOutputScreen=new VE(n),this.currRollUpRow=this.displayedMemory.rows[$a-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[$a-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+yi(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class jP{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=qY(),this.logger=void 0;const i=this.logger=new $Y;this.channels=[null,new WP(e,t,i),new WP(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const i=t[n]&127,s=t[n+1]&127;let o=!1,a=null;if(i===0&&s===0)continue;this.logger.log(3,()=>"["+vf([t[n],t[n+1]])+"] -> ("+vf([i,s])+")");const l=this.cmdHistory;if(i>=16&&i<=31){if(JY(i,s,l)){jx(null,null,l),this.logger.log(3,()=>"Repeated command ("+vf([i,s])+") is dropped");continue}jx(i,s,this.cmdHistory),o=this.parseCmd(i,s),o||(o=this.parseMidrow(i,s)),o||(o=this.parsePAC(i,s)),o||(o=this.parseBackgroundAttributes(i,s))}else jx(null,null,l);if(!o&&(a=this.parseChars(i,s),a)){const c=this.currentChannel;c&&c>0?this.channels[c].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+vf([i,s])+" orig: "+vf([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(n||i))return!1;const s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+vf([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(i||s))return!1;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?zY[e]:WY[e]:n=o===1?VY[e]:jY[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+lU(o)+"' in channel "+n),i=[o]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+vf(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=KY[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}jx(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function jx(r,e,t){t.a=r,t.b=e}function JY(r,e,t){return t.a===r&&t.b===e}function qY(){return{a:null,b:null}}var pC=function(){if(fS!=null&&fS.VTTCue)return self.VTTCue;const r=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const u=l.toLowerCase();return~a.indexOf(u)?u:!1}function n(a){return t(r,a)}function i(a){return t(e,a)}function s(a,...l){let u=1;for(;u<arguments.length;u++){const c=arguments[u];for(const h in c)a[h]=c[h]}return a}function o(a,l,u){const c=this,h={enumerable:!0};c.hasBeenReset=!1;let d="",m=!1,g=a,x=l,_=u,S=null,T="",E=!0,C="auto",R="start",P=50,L="middle",F=50,D="middle";Object.defineProperty(c,"id",s({},h,{get:function(){return d},set:function(I){d=""+I}})),Object.defineProperty(c,"pauseOnExit",s({},h,{get:function(){return m},set:function(I){m=!!I}})),Object.defineProperty(c,"startTime",s({},h,{get:function(){return g},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");g=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},h,{get:function(){return x},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");x=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},h,{get:function(){return _},set:function(I){_=""+I,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},h,{get:function(){return S},set:function(I){S=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},h,{get:function(){return T},set:function(I){const N=n(I);if(N===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=N,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},h,{get:function(){return E},set:function(I){E=!!I,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},h,{get:function(){return C},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},h,{get:function(){return R},set:function(I){const N=i(I);if(!N)throw new SyntaxError("An invalid or illegal string was specified.");R=N,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},h,{get:function(){return P},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");P=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},h,{get:function(){return L},set:function(I){const N=i(I);if(!N)throw new SyntaxError("An invalid or illegal string was specified.");L=N,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},h,{get:function(){return F},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");F=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},h,{get:function(){return D},set:function(I){const N=i(I);if(!N)throw new SyntaxError("An invalid or illegal string was specified.");D=N,this.hasBeenReset=!0}})),c.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class QY{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function cU(r){function e(n,i,s,o){return(n|0)*3600+(i|0)*60+(s|0)+parseFloat(o||0)}const t=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class ZY{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function hU(r,e,t,n){const i=n?r.split(n):[r];for(const s in i){if(typeof i[s]!="string")continue;const o=i[s].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const lM=new pC(0,0,""),Kx=lM.align==="middle"?"middle":"center";function eJ(r,e,t){const n=r;function i(){const a=cU(r);if(a===null)throw new Error("Malformed timestamp: "+n);return r=r.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,l){const u=new ZY;hU(a,function(d,m){let g;switch(d){case"region":for(let x=t.length-1;x>=0;x--)if(t[x].id===m){u.set(d,t[x].region);break}break;case"vertical":u.alt(d,m,["rl","lr"]);break;case"line":g=m.split(","),u.integer(d,g[0]),u.percent(d,g[0])&&u.set("snapToLines",!1),u.alt(d,g[0],["auto"]),g.length===2&&u.alt("lineAlign",g[1],["start",Kx,"end"]);break;case"position":g=m.split(","),u.percent(d,g[0]),g.length===2&&u.alt("positionAlign",g[1],["start",Kx,"end","line-left","line-right","auto"]);break;case"size":u.percent(d,m);break;case"align":u.alt(d,m,["start",Kx,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&lM.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",Kx);let h=u.get("position","auto");h==="auto"&&lM.position===50&&(h=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=h}function o(){r=r.replace(/^\s+/,"")}if(o(),e.startTime=i(),o(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);r=r.slice(3),o(),e.endTime=i(),o(),s(r,e)}function fU(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class tJ{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new QY,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,o=0;for(s=fU(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function i(s){hU(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const a=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?i(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new pC(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{eJ(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const nJ=/\r\n|\n\r|\n|\r/g,WE=function(e,t,n=0){return e.slice(n,n+t.length)===t},iJ=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Mt(t)||!Mt(n)||!Mt(i)||!Mt(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*s,t};function mC(r,e,t){return C0(r.toString())+C0(e.toString())+C0(t)}const rJ=function(e,t,n){let i=e[t],s=e[i.prevCC];if(!s||!s.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=i.start-s.start,i.new=!1,i=s,s=e[i.prevCC]}e.presentationOffset=n};function sJ(r,e,t,n,i,s,o){const a=new tJ,l=Oo(new Uint8Array(r)).trim().replace(nJ,`
`).split(`
`),u=[],c=e?LX(e.baseTime,e.timescale):0;let h="00:00.000",d=0,m=0,g,x=!0;a.oncue=function(_){const S=t[n];let T=t.ccOffset;const E=(d-c)/9e4;if(S!=null&&S.new&&(m!==void 0?T=t.ccOffset=S.start:rJ(t,n,E)),E){if(!e){g=new Error("Missing initPTS for VTT MPEGTS");return}T=E-t.presentationOffset}const C=_.endTime-_.startTime,R=ha((_.startTime+T-m)*9e4,i*9e4)/9e4;_.startTime=Math.max(R,0),_.endTime=Math.max(R+C,0);const P=_.text.trim();_.text=decodeURIComponent(encodeURIComponent(P)),_.id||(_.id=mC(_.startTime,_.endTime,P)),_.endTime>0&&u.push(_)},a.onparsingerror=function(_){g=_},a.onflush=function(){if(g){o(g);return}s(u)},l.forEach(_=>{if(x)if(WE(_,"X-TIMESTAMP-MAP=")){x=!1,_.slice(16).split(",").forEach(S=>{WE(S,"LOCAL:")?h=S.slice(6):WE(S,"MPEGTS:")&&(d=parseInt(S.slice(7)))});try{m=iJ(h)/1e3}catch(S){g=S}return}else _===""&&(x=!1);a.parse(_+`
`)}),a.flush()}const jE="stpp.ttml.im1t",dU=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,pU=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,oJ={left:"start",center:"center",right:"end",start:"start",end:"end"};function KP(r,e,t,n){const i=sn(new Uint8Array(r),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=i.map(a=>Oo(a)),o=IX(e.baseTime,1,e.timescale);try{s.forEach(a=>t(aJ(a,o)))}catch(a){n(a)}}function aJ(r,e){const i=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((h,d)=>(h[d]=i.getAttribute(`ttp:${d}`)||s[d],h),{}),a=i.getAttribute("xml:space")!=="preserve",l=$P(KE(i,"styling","style")),u=$P(KE(i,"layout","region")),c=KE(i,"body","[begin]");return[].map.call(c,h=>{const d=mU(h,a);if(!d||!h.hasAttribute("begin"))return null;const m=XE(h.getAttribute("begin"),o),g=XE(h.getAttribute("dur"),o);let x=XE(h.getAttribute("end"),o);if(m===null)throw XP(h);if(x===null){if(g===null)throw XP(h);x=m+g}const _=new pC(m-e,x-e,d);_.id=mC(_.startTime,_.endTime,_.text);const S=u[h.getAttribute("region")],T=l[h.getAttribute("style")],E=lJ(S,T,l),{textAlign:C}=E;if(C){const R=oJ[C];R&&(_.lineAlign=R),_.align=C}return $n(_,E),_}).filter(h=>h!==null)}function KE(r,e,t){const n=r.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function $P(r){return r.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function mU(r,e){return[].slice.call(r.childNodes).reduce((t,n,i)=>{var s;return n.nodeName==="br"&&i?t+`
`:(s=n.childNodes)!=null&&s.length?mU(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function lJ(r,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(i=t[o]),s.reduce((a,l)=>{const u=$E(e,n,l)||$E(r,n,l)||$E(i,n,l);return u&&(a[l]=u),a},{})}function $E(r,e,t){return r&&r.hasAttributeNS(e,t)?r.getAttributeNS(e,t):null}function XP(r){return new Error(`Could not parse ttml timestamp ${r}`)}function XE(r,e){if(!r)return null;let t=cU(r);return t===null&&(dU.test(r)?t=uJ(r,e):pU.test(r)&&(t=cJ(r,e))),t}function uJ(r,e){const t=dU.exec(r),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function cJ(r,e){const t=pU.exec(r),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class $x{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class gU{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=JP(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(H.FRAG_LOADING,this.onFragLoading,this),e.on(H.FRAG_LOADED,this.onFragLoaded,this),e.on(H.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(H.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(H.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(H.FRAG_LOADING,this.onFragLoading,this),e.off(H.FRAG_LOADED,this.onFragLoaded,this),e.off(H.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(H.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(H.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(H.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new $x(this,"textTrack1"),t=new $x(this,"textTrack2"),n=new $x(this,"textTrack3"),i=new $x(this,"textTrack4");this.cea608Parser1=new jP(1,e,t),this.cea608Parser2=new jP(3,n,i)}addCues(e,t,n,i,s){let o=!1;for(let a=s.length;a--;){const l=s[a],u=hJ(l[0],l[1],t,n);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,u/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,i)}else{const a=this.Cues.newCue(null,t,n,i);this.hls.trigger(H.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){const{unparsedVttFrags:o}=this;n===Bt.MAIN&&(this.initPTS[t.cc]={baseTime:i,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(H.FRAG_LOADED,a)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const s=n.textTracks[i];if(YP(s,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(s,o);if(a)n[e]=a,Vp(n[e]),iU(n[e],i);else{const l=this.createTextTrack("captions",s,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(H.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(s=>{Vp(i[s]),delete i[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=JP(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Vp(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(s=>s.textCodec===jE);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(jO(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,a=o?f_(o.textTracks):null;if(this.tracks.forEach((l,u)=>{let c;if(a){let h=null;for(let d=0;d<a.length;d++)if(a[d]&&YP(a[d],l)){h=a[d],a[d]=null;break}h&&(c=h)}if(c)Vp(c);else{const h=vU(l);c=this.createTextTrack(h,l.name,l.lang),c&&(c.mode="disabled")}c&&this.textTracks.push(c)}),a!=null&&a.length){const l=a.filter(u=>u!==null).map(u=>u.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(H.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const s=`textTrack${i[1]}`,o=this.captionsProperties[s];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Bt.MAIN){var n,i;const{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:u}=t.frag,c=(n=(i=t.part)==null?void 0:i.index)!=null?n:-1;s&&o&&(u!==a+1||u===a&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Bt.SUBTITLE)if(i.byteLength){const s=n.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){const a=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===jE?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;KP(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{n.logger.log(`Failed to parse IMSC1: ${i}`),n.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[n.cc]&&a===-1){o.push(e);return}const l=this.hls,u=(t=n.initSegment)!=null&&t.data?ga(n.initSegment.data,new Uint8Array(i)).buffer:i;sJ(u,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,c=>{this._appendCues(c,n.level),l.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},c=>{const h=c.message==="Missing initPTS for VTT MPEGTS";h?o.push(e):this._fallbackToIMSC1(n,i),l.logger.log(`Failed to parse VTT cue: ${c}`),!(h&&a>n.cc)&&l.trigger(H.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:c})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||KP(t,this.initPTS[e.cc],()=>{n.textCodec=jE,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(s=>rU(i,s))}else{const i=this.tracks[t];if(!i)return;const s=i.default?"default":"subtitles"+t;n.trigger(H.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Bt.SUBTITLE&&this.onFragLoaded(H.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(!(n.type===Bt.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let s=0;s<i.length;s++){const o=i[s].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const a=this.extractCea608Data(o);this.cea608Parser1.addData(i[s].pts,a[0]),this.cea608Parser2.addData(i[s].pts,a[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:s}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!s||s==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>oM(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>oM(a[l],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let s=0;s<n;s++){const o=e[i++],a=127&e[i++],l=127&e[i++];if(a===0&&l===0)continue;if((4&o)!==0){const c=3&o;(c===0||c===1)&&(t[c].push(a),t[c].push(l))}}return t}}function vU(r){return r.characteristics&&/transcribes-spoken-dialog/gi.test(r.characteristics)&&/describes-music-and-sound/gi.test(r.characteristics)?"captions":"subtitles"}function YP(r,e){return!!r&&r.kind===vU(e)&&iM(e,r)}function hJ(r,e,t,n){return Math.min(e,n)-Math.max(r,t)}function JP(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const fJ=/\s/,yU={newCue(r,e,t,n){const i=[];let s,o,a,l,u;const c=self.VTTCue||self.TextTrackCue;for(let d=0;d<n.rows.length;d++)if(s=n.rows[d],a=!0,l=0,u="",!s.isEmpty()){var h;for(let x=0;x<s.chars.length;x++)fJ.test(s.chars[x].uchar)&&a?l++:(u+=s.chars[x].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const m=fU(u.trim()),g=mC(e,t,m);r!=null&&(h=r.cues)!=null&&h.getCueById(g)||(o=new c(e,t,m),o.id=g,o.line=d+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(o))}return r&&i.length&&(i.sort((d,m)=>d.line==="auto"||m.line==="auto"?0:d.line>8&&m.line>8?m.line-d.line:d.line-m.line),i.forEach(d=>rU(r,d))),i}};function xU(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const dJ=/(\d+)-(\d+)\/(\d+)/;class uM{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||vJ,this.controller=new self.AbortController,this.stats=new yA}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const s=pJ(e,this.controller.signal),o=e.responseType==="arraybuffer",a=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=l&&Mt(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},t.timeout),(iv(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(h=>{var d;this.response=this.loader=h;const m=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},u-(m-i.loading.start)),!h.ok){const{status:x,statusText:_}=h;throw new yJ(_||"fetch, bad network response",x,h)}i.loading.first=m,i.total=gJ(h.headers)||i.total;const g=(d=this.callbacks)==null?void 0:d.onProgress;return g&&Mt(t.highWaterMark)?this.loadProgressively(h,i,e,t.highWaterMark,g):o?h.arrayBuffer():e.responseType==="json"?h.json():h.text()}).then(h=>{var d,m;const g=this.response;if(!g)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const x=h[a];x&&(i.loaded=i.total=x);const _={url:g.url,data:h,code:g.status},S=(d=this.callbacks)==null?void 0:d.onProgress;S&&!Mt(t.highWaterMark)&&S(i,e,h,g),(m=this.callbacks)==null||m.onSuccess(_,i,e,g)}).catch(h=>{var d;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const m=h&&h.code||0,g=h?h.message:null;(d=this.callbacks)==null||d.onError({code:m,text:g},e,h?h.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,s){const o=new EO,a=e.body.getReader(),l=()=>a.read().then(u=>{if(u.done)return o.dataLength&&s(t,n,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const c=u.value,h=c.length;return t.loaded+=h,h<i||o.dataLength?(o.push(c),o.dataLength>=i&&s(t,n,o.flush().buffer,e)):s(t,n,c.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function pJ(r,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers($n({},r.headers))};return r.rangeEnd&&t.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),t}function mJ(r){const e=dJ.exec(r);if(e)return parseInt(e[2])-parseInt(e[1])+1}function gJ(r){const e=r.get("Content-Range");if(e){const n=mJ(e);if(Mt(n))return n}const t=r.get("Content-Length");if(t)return parseInt(t)}function vJ(r,e){return new self.Request(r.url,e)}class yJ extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const xJ=/^age:\s*[\d.]+\s*$/im;class gC{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new yA,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),s(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{var a;(a=this.callbacks)==null||a.onError({code:n.status,text:o.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&Mt(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,s=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,c=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const g=c??t.response;if(g!=null){var o,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const x=t.responseType==="arraybuffer"?g.byteLength:g.length;n.loaded=n.total=x,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const _=(o=this.callbacks)==null?void 0:o.onProgress;_&&_(n,e,g,t);const S={url:t.responseURL,data:g,code:u};(a=this.callbacks)==null||a.onSuccess(S,n,e,t);return}}const h=s.loadPolicy.errorRetry,d=n.retry,m={url:e.url,data:void 0,code:u};if(hS(h,d,!1,m))this.retry(h);else{var l;wn.error(`${u} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:u,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(hS(e,t,!0))this.retry(e);else{var n;wn.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=eC(e,n.retry),n.retry++,wn.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&xJ.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const _J={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},SJ=Wn(Wn({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:gC,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:lO,bufferController:XO,capLevelController:TA,errorController:cO,fpsController:nU,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:sC,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,certLoadPolicy:{default:_J},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},AJ()),{},{subtitleStreamController:aU,subtitleTrackController:sU,timelineController:gU,audioStreamController:WO,audioTrackController:KO,emeController:$f,cmcdController:ZO,contentSteeringController:eU,interstitialsController:NY});function AJ(){return{cueHandler:yU,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function EJ(r,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=cM(r),i=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(o=>{const a=`${o==="level"?"playlist":o}LoadPolicy`,l=e[a]===void 0,u=[];s.forEach(c=>{const h=`${o}Loading${c}`,d=e[h];if(d!==void 0&&l){u.push(h);const m=n[a].default;switch(e[a]={default:m},c){case"TimeOut":m.maxLoadTimeMs=d,m.maxTimeToFirstByteMs=d;break;case"MaxRetry":m.errorRetry.maxNumRetry=d,m.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":m.errorRetry.retryDelayMs=d,m.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":m.errorRetry.maxRetryDelayMs=d,m.timeoutRetry.maxRetryDelayMs=d;break}}}),u.length&&t.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${a}": ${yi(e[a])}`)}),Wn(Wn({},n),e)}function cM(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(cM):Object.keys(r).reduce((e,t)=>(e[t]=cM(r[t]),e),{}):r}function TJ(r,e){const t=r.loader;t!==uM&&t!==gC?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):xU()&&(r.loader=uM,r.progressive=!0,r.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const d_=2,MJ=.1,wJ=.05,CJ=100;class bJ extends hO{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(H.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(CJ),this.mediaSource=t.mediaSource;const n=this.media=t.media;zu(n,"playing",this.onMediaPlaying),zu(n,"waiting",this.onMediaWaiting),zu(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(Fl(n,"playing",this.onMediaPlaying),Fl(n,"waiting",this.onMediaWaiting),Fl(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const s=(n=this.hls)==null?void 0:n.config;if(!s)return;const{media:o,stalled:a}=this;if(!o)return;const{seeking:l}=o,u=this.seeking&&!l,c=!this.seeking&&l,h=o.paused&&!l||o.ended||o.playbackRate===0;if(this.seeking=l,e!==t){t&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(c||u){u&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(H.MEDIA_ENDED,{stalled:!1}));return}if(!pn.getBuffered(o).length){this.nudgeRetry=0;return}const d=pn.bufferInfo(o,e,0),m=d.nextStart||0,g=this.fragmentTracker;if(l&&g&&this.hls){const P=qP(this.hls.inFlightFragments,e),L=d.len>d_,F=!m||P||m-e>d_&&!g.getPartialFragment(e);if(L||F)return;this.moved=!1}const x=(i=this.hls)==null?void 0:i.latestLevelDetails;if(!this.moved&&this.stalled!==null&&g){if(!(d.len>0)&&!m)return;const L=Math.max(m,d.start||0)-e,D=!!(x!=null&&x.live)?x.targetduration*2:d_,I=g.getPartialFragment(e);if(L>0&&(L<=D||I)){o.paused||this._trySkipBufferHole(I);return}}const _=s.detectStallWithCurrentTimeMs,S=self.performance.now(),T=this.waiting;if(a===null){T>0&&S-T<_?this.stalled=T:this.stalled=S;return}const E=S-a;if(!l&&(E>=_||T)&&this.hls){var C;if(((C=this.mediaSource)==null?void 0:C.readyState)==="ended"&&!(x!=null&&x.live)&&Math.abs(e-((x==null?void 0:x.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(H.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(d),!this.media||!this.hls)return}const R=pn.bufferInfo(o,e,s.maxBufferHole);this._tryFixBufferStall(R,E)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(H.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&i&&i.length>1&&e>i.end(0)){const s=pn.bufferedInfo(pn.timeRangesToArray(this.buffered.audio),e,0);if(s.len>1&&t>=s.start){const o=pn.timeRangesToArray(i),a=pn.bufferedInfo(o,t,0).bufferedIndex;if(a>-1&&a<o.length-1){const l=pn.bufferedInfo(o,e,0).bufferedIndex,u=o[a].end,c=o[a+1].start;if((l===-1||l>a)&&c-u<1&&e-u<2){const h=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${c} buffered index: ${l}`);this.warn(h.message),this.media.currentTime+=1e-6;const d=this.fragmentTracker.getPartialFragment(e)||void 0,m=pn.bufferInfo(this.media,e,0);this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:d,buffer:m.len,bufferInfo:m})}}}}}_tryFixBufferStall(e,t){var n,i;const{fragmentTracker:s,media:o}=this,a=(n=this.hls)==null?void 0:n.config;if(!o||!s||!a)return;const l=o.currentTime,u=(i=this.hls)==null?void 0:i.latestLevelDetails,c=s.getPartialFragment(l);if((c||u!=null&&u.live&&l<u.fragmentStart)&&(this._trySkipBufferHole(c)||!this.media))return;const h=e.buffered;(h&&h.length>1&&e.len>a.maxBufferHole||e.nextStart&&e.nextStart-l<a.maxBufferHole)&&(t>a.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:s}=this;if(!i&&s!==null&&n&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${yi(e)})`);this.warn(o.message),t.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:s}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,s=(t=this.hls)==null?void 0:t.config;if(!i||!n||!s)return 0;const o=i.currentTime,a=pn.bufferInfo(i,o,0),l=o<a.start?a.start:a.nextStart;if(l&&this.hls){const c=a.len<=s.maxBufferHole,h=a.len>0&&a.len<1&&i.readyState<3,d=l-o;if(d>0&&(c||h)){if(d>s.maxBufferHole){let g=!1;if(o===0){const x=n.getAppendedFrag(0,Bt.MAIN);x&&l<x.end&&(g=!0)}if(!g){const x=e||n.getAppendedFrag(o,Bt.MAIN);if(x){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||qP(this.hls.inFlightFragments,l))return 0;let S=!1,T=x.end;for(;T<l;){const E=n.getPartialFragment(T);if(E)T+=E.duration;else{S=!0;break}}if(S)return 0}}}const m=Math.max(l+wJ,o+MJ);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${m}`),this.moved=!0,i.currentTime=m,!(e!=null&&e.gap)){const g=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${m}`);this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,frag:e||void 0,buffer:a.len,bufferInfo:a})}return m}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,s=t==null?void 0:t.config;if(!n||!s)return 0;const o=n.currentTime;if(this.nudgeRetry++,i<s.nudgeMaxRetry){const a=o+(i+1)*s.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${o} to ${a}`);this.warn(l.message),n.currentTime=a,t.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const a=new Error(`Playhead still not moving while enough data buffered @${o} after ${s.nudgeMaxRetry} nudges`);this.error(a.message),t.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.BUFFER_STALLED_ERROR,error:a,fatal:!0,buffer:e.len,bufferInfo:e})}}}function qP(r,e){const t=QP(r.main);if(t&&t.start<=e)return t;const n=QP(r.audio);return n&&n.start<=e?n:null}function QP(r){if(!r)return null;switch(r.state){case tt.IDLE:case tt.STOPPED:case tt.ENDED:case tt.ERROR:return null}return r.frag}const RJ=.25;function hM(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function ZP(r,e,t,n,i){let s=new r(e,t,"");try{s.value=n,i&&(s.type=i)}catch{s=new r(e,t,yi(i?Wn({type:i},n):n))}return s}const Xx=(()=>{const r=hM();try{r&&new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function IJ(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class LJ{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(H.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(H.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(H.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Vp(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return iU(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=hM();if(o)for(let a=0;a<s.length;a++){const l=s[a].type;if(l===io.emsg&&!n||!i)continue;const u=LO(s[a].data);if(u){const c=s[a].pts;let h=c+s[a].duration;h>Xx&&(h=Xx),h-c<=0&&(h=c+RJ);for(let m=0;m<u.length;m++){const g=u[m];if(!PO(g)){this.updateId3CueEnds(c,l);const x=ZP(o,c,h,g,l);x&&this.id3Track.addCue(x)}}}}}updateId3CueEnds(e,t){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let s=i.length;s--;){const o=i[s];o.type===t&&o.startTime<e&&o.endTime===Xx&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let u;i==="audio"?u=c=>c.type===io.audioId3&&l:i==="video"?u=c=>c.type===io.emsg&&a:u=c=>c.type===io.audioId3&&l||c.type===io.emsg&&a,oM(s,t,n,u)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:n}=this,{dateRanges:i}=e,s=Object.keys(i);let o=this.dateRangeCuesAppended;if(n&&t){var a;if((a=n.cues)!=null&&a.length){const c=Object.keys(o).filter(h=>!s.includes(h));for(let h=c.length;h--;){const d=c[h],m=o[d].cues;delete o[d],Object.keys(m).forEach(g=>{try{const x=m[g];x.removeEventListener("enter",this.onEventCueEnter),n.removeCue(x)}catch{}})}}else o=this.dateRangeCuesAppended={}}const l=e.fragments[e.fragments.length-1];if(s.length===0||!Mt(l==null?void 0:l.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=hM();for(let c=0;c<s.length;c++){const h=s[c],d=i[h],m=d.startTime,g=o[h],x=(g==null?void 0:g.cues)||{};let _=(g==null?void 0:g.durationKnown)||!1,S=Xx;const{duration:T,endDate:E}=d;if(E&&T!==null)S=m+T,_=!0;else if(d.endOnNext&&!_){const R=s.reduce((P,L)=>{if(L!==d.id){const F=i[L];if(F.class===d.class&&F.startDate>d.startDate&&(!P||d.startDate<P.startDate))return F}return P},null);R&&(S=R.startTime,_=!0)}const C=Object.keys(d.attr);for(let R=0;R<C.length;R++){const P=C[R];if(!_7(P))continue;const L=x[P];if(L)_&&!g.durationKnown?L.endTime=S:Math.abs(L.startTime-m)>.01&&(L.startTime=m,L.endTime=S);else if(u){let F=d.attr[P];S7(P)&&(F=IJ(F));const I=ZP(u,m,S,{key:P,data:F},io.dateRange);I&&(I.id=h,this.id3Track.addCue(I),x[P]=I,this.hls.config.interstitialsController&&(P==="X-ASSET-LIST"||P==="X-ASSET-URL")&&I.addEventListener("enter",this.onEventCueEnter))}}o[h]={cues:x,dateRange:d,durationKnown:_}}}}class PJ{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const i=this.computeLatency();if(i===null)return;this._latency=i;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:o}=this.config;if(!s||o===1||!n.live)return;const a=this.targetLatency;if(a===null)return;const l=i-a,u=Math.min(this.maxLatency,a+n.targetduration);if(l<u&&l>.05&&this.forwardBufferLength>1){const h=Math.min(2,Math.max(1,o)),d=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,m=Math.min(h,Math.max(1,d));this.changeMediaPlaybackRate(t,m)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let u=a&&n||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:o*i);const c=i;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const i=n.edge,s=e-t-this.edgeStalled,o=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,s),a)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(H.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(H.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(H.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(H.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===Le.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(i=this.targetLatency)==null?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class DJ extends EA{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this),e.on(H.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this),e.off(H.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],s={},o={};let a=!1,l=!1,u=!1;t.levels.forEach(c=>{var h;const d=c.attrs;let{audioCodec:m,videoCodec:g}=c;m&&(c.audioCodec=m=aS(m,n)||void 0),((h=g)==null?void 0:h.indexOf("avc1"))===0&&(g=c.videoCodec=V$(g));const{width:x,height:_,unknownCodecs:S}=c;let T=S?S.length:0;if(S)for(let N=T;N--;){const V=S[N];this.isAudioSupported(V)?(c.audioCodec=m=m?`${m},${V}`:V,T--,mm.audio[m.substring(0,4)]=2):this.isVideoSupported(V)&&(c.videoCodec=g=g?`${g},${V}`:V,T--,mm.video[g.substring(0,4)]=2)}if(a||(a=!!(x&&_)),l||(l=!!g),u||(u=!!m),T||m&&!this.isAudioSupported(m)||g&&!this.isVideoSupported(g)){this.log(`Some or all CODECS not supported "${d.CODECS}"`);return}const{CODECS:E,"FRAME-RATE":C,"HDCP-LEVEL":R,"PATHWAY-ID":P,RESOLUTION:L,"VIDEO-RANGE":F}=d,I=`${`${P||"."}-`}${c.bitrate}-${L}-${C}-${E}-${F}-${R}`;if(s[I])if(s[I].uri!==c.url&&!c.attrs["PATHWAY-ID"]){const N=o[I]+=1;c.attrs["PATHWAY-ID"]=new Array(N+1).join(".");const V=this.createLevel(c);s[I]=V,i.push(V)}else s[I].addGroupId("audio",d.AUDIO),s[I].addGroupId("text",d.SUBTITLES);else{const N=this.createLevel(c);s[I]=N,o[I]=1,i.push(N)}}),this.filterAndSortMediaOptions(i,t,a,l,u)}createLevel(e){const t=new gm(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const i=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(i.message),t.supportedResult=sO(i,[])}return t}isAudioSupported(e){return XT(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return XT(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,s){let o=[],a=[],l=e;if((n||i)&&s&&(l=l.filter(({videoCodec:g,videoRange:x,width:_,height:S})=>(!!g||!!(_&&S))&&X$(x))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let g="no level with compatible codecs found in manifest",x=g;t.levels.length&&(x=`one or more CODECS in variant not supported: ${yi(t.levels.map(S=>S.attrs.CODECS).filter((S,T,E)=>E.indexOf(S)===T))}`,this.warn(x),g+=` (${x})`);const _=new Error(g);this.hls.trigger(H.ERROR,{type:Nt.MEDIA_ERROR,details:Le.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:_,reason:x})}});return}t.audioTracks&&(o=t.audioTracks.filter(g=>!g.audioCodec||this.isAudioSupported(g.audioCodec)),e2(o)),t.subtitles&&(a=t.subtitles,e2(a));const u=l.slice(0);l.sort((g,x)=>{if(g.attrs["HDCP-LEVEL"]!==x.attrs["HDCP-LEVEL"])return(g.attrs["HDCP-LEVEL"]||"")>(x.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&g.height!==x.height)return g.height-x.height;if(g.frameRate!==x.frameRate)return g.frameRate-x.frameRate;if(g.videoRange!==x.videoRange)return lS.indexOf(g.videoRange)-lS.indexOf(x.videoRange);if(g.videoCodec!==x.videoCodec){const _=JL(g.videoCodec),S=JL(x.videoCodec);if(_!==S)return S-_}if(g.uri===x.uri&&g.codecSet!==x.codecSet){const _=oS(g.codecSet),S=oS(x.codecSet);if(_!==S)return S-_}return g.averageBitrate!==x.averageBitrate?g.averageBitrate-x.averageBitrate:0});let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let g=0;g<u.length;g++)if(u[g].pathwayId===l[0].pathwayId){c=u[g];break}}this._levels=l;for(let g=0;g<l.length;g++)if(l[g]===c){var h;this._firstLevel=g;const x=c.bitrate,_=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${x}`),((h=this.hls.userConfig)==null?void 0:h.abrEwmaDefaultEstimate)===void 0){const S=Math.min(x,this.hls.config.abrEwmaDefaultEstimateMax);S>_&&_===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=S)}break}const d=s&&!i,m={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:i,altAudio:!d&&o.some(g=>!!g.url)};this.hls.trigger(H.MANIFEST_PARSED,m)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const c=new Error("invalid level idx"),h=e<0;if(this.hls.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.LEVEL_SWITCH_ERROR,level:e,fatal:h,error:c,reason:c.message}),h)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&i&&s===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${s?" with Pathway "+s:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(H.LEVEL_SWITCHING,l);const u=o.details;if(!u||u.live){const c=this.switchParams(o.uri,i==null?void 0:i.details,u);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(i=>t.indexOf(i)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===_n.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Bt.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:s}=t,o=t.levelInfo;if(!o){var a;this.warn(`Invalid level index ${i}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let l=o.details;l===t.details&&l.advanced&&(l=void 0),this.playlistLoaded(i,t,l)}else(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,s=e.attrs["PATHWAY-ID"],o=e.details,a=o==null?void 0:o.age;this.log(`Loading level index ${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${s?" Pathway "+s:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${n}`),this.hls.trigger(H.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((s,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(a=>a.level=-1)),!1));_O(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(H.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(H.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function e2(r){const e={};r.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function _U(){return self.SourceBuffer||self.WebKitSourceBuffer}function vC(){if(!Zu())return!1;const e=_U();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function SU(){if(!vC())return!1;const r=Zu();return typeof(r==null?void 0:r.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>r.isTypeSupported(Z0(e,"video")))||["mp4a.40.2","fLaC"].some(e=>r.isTypeSupported(Z0(e,"audio"))))}function BJ(){var r;const e=_U();return typeof(e==null||(r=e.prototype)==null?void 0:r.changeType)=="function"}const FJ=100;class kJ extends SA{constructor(e,t,n){super(e,t,n,"stream-controller",Bt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const i=this.media,s=i?i.currentTime:null;if(s===null||!Mt(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const o=this.getFwdBufferInfoAtPos(i,s,Bt.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${s} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(H.MANIFEST_PARSED,this.onManifestParsed,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.LEVEL_LOADED,this.onLevelLoaded,this),e.on(H.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(H.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(H.BUFFER_CREATED,this.onBufferCreated,this),e.on(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(H.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(H.MANIFEST_PARSED,this.onManifestParsed,this),e.off(H.LEVEL_LOADED,this.onLevelLoaded,this),e.off(H.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(H.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(H.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(H.BUFFER_CREATED,this.onBufferCreated,this),e.off(H.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(H.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(FJ),this.level=-1,!this.startFragRequested){let s=i.startLevel;s===-1&&(i.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=i.firstAutoLevel),i.nextLoadLevel=s,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=tt.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=tt.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case tt.WAITING_LEVEL:{const{levels:t,level:n}=this,i=t==null?void 0:t[n],s=i==null?void 0:i.details;if(s&&(!s.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(s))break;this.state=tt.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=tt.IDLE;break}break}case tt.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,level:s}=this,o=i==null?void 0:i[s];this.resetStartWhenNotLoaded(o||null),this.state=tt.IDLE}}break}this.state===tt.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(t===null||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[s]))return;const o=n[s],a=this.getMainFwdBufferInfo();if(a===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const x={};this.altAudio===2&&(x.type="video"),this.hls.trigger(H.BUFFER_EOS,x),this.state=tt.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=o.details;if(!u||this.state===tt.WAITING_LEVEL||this.waitForLive(o)){this.level=s,this.state=tt.WAITING_LEVEL,this.startFragRequested=!1;return}const c=a.len,h=this.getMaxBufferLength(o.maxBitrate);if(c>=h)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:a.end;let m=this.getNextFragment(d,u);if(this.couldBacktrack&&!this.fragPrevious&&m&&Zr(m)&&this.fragmentTracker.getState(m)!==Ar.OK){var g;const _=((g=this.backtrackFragment)!=null?g:m).sn-u.startSN,S=u.fragments[_-1];S&&m.cc===S.cc&&(m=S,this.fragmentTracker.removeFragment(S))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,d)){if(!m.gap){const _=this.audioOnly&&!this.altAudio?Kn.AUDIO:Kn.VIDEO,S=(_===Kn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;S&&this.afterBufferFlushed(S,_,Bt.MAIN)}m=this.getNextFragmentLoopLoading(m,u,a,Bt.MAIN,h)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,o,d))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===Ar.NOT_LOADED||i===Ar.PARTIAL?Zr(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Bt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,u=a.duration,c=Math.max(o.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case tt.KEY_LOADING:case tt.FRAG_LOADING:case tt.FRAG_LOADING_WAITING_RETRY:case tt.PARSING:case tt.PARSED:this.state=tt.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;zu(n,"playing",this.onMediaPlaying),zu(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(Fl(n,"playing",this.onMediaPlaying),Fl(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(H.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(s=>{const o=s.audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,i=i||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&i&&!BJ(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==tt.IDLE)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=tt.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:s}=this,o=t.level,a=t.details,l=a.totalduration;if(!i){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${l}`);const u=t.levelInfo,c=this.fragCurrent;c&&(this.state===tt.FRAG_LOADING||this.state===tt.FRAG_LOADING_WAITING_RETRY)&&c.level!==t.level&&c.loader&&this.abortCurrentFrag();let h=0;if(a.live||(n=u.details)!=null&&n.live){var d;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;h=this.alignPlaylists(a,u.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(u.details=a,this.levelLastLoaded=u,s||this.setStartPosition(a,h),this.hls.trigger(H.LEVEL_UPDATED,{details:a,level:o}),this.state===tt.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=tt.IDLE}s&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,s=this.getLoadPosition(),o=e.fragmentStart,a=e.edge,l=s>=o-t.maxFragLookUpTolerance&&s<=a;if(i!==null&&n.duration>i&&(s<i||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<a-u)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level];if(!a){this.warn(`Level ${n.level} not found on progress`);return}const l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=a.videoCodec,c=l.PTSKnown||!l.live,h=(t=n.initSegment)==null?void 0:t.data,d=this._getAudioCodec(a),m=this.transmuxer=this.transmuxer||new VO(this.hls,Bt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),g=i?i.index:-1,x=g!==-1,_=new _A(n.level,n.sn,n.stats.chunkCount,s.byteLength,g,x),S=this.initPTS[n.cc];m.push(s,h,d,u,n,i,l.totalduration,c,_,S)}onAudioTrackSwitching(e,t){const n=this.hls,i=this.altAudio===2;if(uS(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i){this.fragmentTracker.removeAllFragments(),n.once(H.BUFFER_FLUSHED,()=>{var o;(o=this.hls)==null||o.trigger(H.AUDIO_TRACK_SWITCHED,t)}),n.trigger(H.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(H.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=uS(t.url,this.hls);if(n){const i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,s,o=!1;for(const a in n){const l=n[a];if(l.id==="main"){if(s=a,i=l,a==="video"){const u=n[a];u&&(this.videoBuffer=u.buffer)}}else o=!0}o&&i?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,s=n.type===Bt.MAIN;if(s){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===tt.PARSED&&(this.state=tt.IDLE);return}const a=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),Zr(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const o=this.media;o&&(!this._hasEnoughToStart&&pn.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=tt.ERROR;return}switch(t.details){case Le.FRAG_GAP:case Le.FRAG_PARSING_ERROR:case Le.FRAG_DECRYPT_ERROR:case Le.FRAG_LOAD_ERROR:case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_ERROR:case Le.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Bt.MAIN,t);break;case Le.LEVEL_LOAD_ERROR:case Le.LEVEL_LOAD_TIMEOUT:case Le.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===tt.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===_n.LEVEL&&(this.state=tt.IDLE);break;case Le.BUFFER_ADD_CODEC_ERROR:case Le.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case Le.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Le.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=tt.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Kn.AUDIO||!this.altAudio){const n=(t===Kn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,Bt.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=this.timelineOffset;i&&n&&(n+=i);const s=this.getLevelDetails(),o=pn.getBuffered(e),a=o.length?o.start(0):0,l=a-n,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);l>0&&(l<u||this.loadingParts&&l<2*((s==null?void 0:s.partTarget)||0))&&(this.log(`adjusting start position by ${l} to match buffer start`),n+=l,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${a}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this,s=n==null?void 0:n.frag;if(!s||this.fragContextChanged(s))return;t.fragmentError=0,this.state=tt.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=s.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),i.trigger(H.FRAG_LOADED,n),s.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n=this.playlistType,{hls:i}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:u,level:c}=a,{video:h,text:d,id3:m,initSegment:g}=s,{details:x}=c,_=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=tt.PARSING,g){if(g!=null&&g.tracks){const E=l.initSegment||l;this._bufferInitSegment(c,g.tracks,E,o),i.trigger(H.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:n,tracks:g.tracks})}const S=g.initPTS,T=g.timescale;Mt(S)&&(this.initPTS[l.cc]={baseTime:S,timescale:T},i.trigger(H.INIT_PTS_FOUND,{frag:l,id:n,initPTS:S,timescale:T}))}if(h&&x){const S=x.fragments[l.sn-1-x.startSN],T=l.sn===x.startSN,E=!S||l.cc>S.cc;if(s.independent!==!1){const{startPTS:C,endPTS:R,startDTS:P,endDTS:L}=h;if(u)u.elementaryStreams[h.type]={startPTS:C,endPTS:R,startDTS:P,endDTS:L};else if(h.firstKeyFrame&&h.independent&&o.id===1&&!E&&(this.couldBacktrack=!0),h.dropped&&h.independent){const F=this.getMainFwdBufferInfo(),D=(F?F.end:this.getLoadPosition())+this.config.maxBufferHole,I=h.firstKeyFramePTS?h.firstKeyFramePTS:C;if(!T&&D<I-this.config.maxBufferHole&&!E){this.backtrack(l);return}else E&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,R,l.start,L,!0)}else T&&C-(x.appliedTimelineOffset||0)>d_&&(l.gap=!0);l.setElementaryStreamInfo(h.type,C,R,P,L),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,o,T||E)}else if(T||E)l.gap=!0;else{this.backtrack(l);return}}if(_){const{startPTS:S,endPTS:T,startDTS:E,endDTS:C}=_;u&&(u.elementaryStreams[Kn.AUDIO]={startPTS:S,endPTS:T,startDTS:E,endDTS:C}),l.setElementaryStreamInfo(Kn.AUDIO,S,T,E,C),this.bufferFragmentData(_,l,u,o)}if(x&&m!=null&&(t=m.samples)!=null&&t.length){const S={id:n,frag:l,details:x,samples:m.samples};i.trigger(H.FRAG_PARSING_METADATA,S)}if(x&&d){const S={id:n,frag:l,details:x,samples:d.samples};i.trigger(H.FRAG_PARSING_USERDATA,S)}}_bufferInitSegment(e,t,n,i){if(this.state!==tt.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:a}=t;if(s){let u=l_(s.codec,e.audioCodec);u==="mp4a"&&(u="mp4a.40.5");const c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");const h=s.metadata;h&&"channelCount"in h&&(h.channelCount||1)!==1&&c.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&c.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),e.audioCodec&&e.audioCodec!==u&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${u}"`),s.levelCodec=u,s.id=Bt.MAIN,this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${u||""}/${e.audioCodec||""}/${s.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=Bt.MAIN;const u=o.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${o.codec!==u?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),delete t.video,delete t.audio);const l=Object.keys(t);if(l.length){if(this.hls.trigger(H.BUFFER_CODECS,t),!this.hls)return;l.forEach(u=>{const h=t[u].initSegment;h!=null&&h.byteLength&&this.hls.trigger(H.BUFFER_APPENDING,{type:u,data:h,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Bt.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e==null?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=tt.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(pn.isBuffered(e,n)?t=this.getAppendedFrag(n):pn.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,s=t.level;(!i||t.sn!==i.sn||i.level!==s)&&(this.fragPlaying=t,this.hls.trigger(H.FRAG_CHANGED,{frag:t}),(!i||i.level!==s)&&this.hls.trigger(H.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Mt(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Mt(t)){const n=this.getLevelDetails(),i=this.currentFrag||(n?sd(null,n.fragments,t):null);if(i){const s=i.programDateTime;if(s!==null){const o=s+(t-i.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class OJ{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Le.KEY_LOAD_ERROR,n,i,s){return new Pu({type:Nt.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let s=0;s<t.length;s++){const o=t[s];if(i<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Le.KEY_LOAD_ERROR,u))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Le.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return s.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((i=a)!=null&&i.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,Le.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,s=new i(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,m,g,x)=>{const{frag:_,keyInfo:S,url:T}=g;if(!_.decryptdata||S!==this.keyUriToKeyInfo[T])return a(this.createKeyLoadError(_,Le.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),x));S.decryptdata.key=_.decryptdata.key=new Uint8Array(d.data),_.keyLoader=null,S.loader=null,o({frag:_,keyInfo:S})},onError:(d,m,g,x)=>{this.resetLoader(m),a(this.createKeyLoadError(t,Le.KEY_LOAD_ERROR,new Error(`HTTP Error ${d.code} loading key ${d.text}`),g,Wn({url:l.url,data:void 0},d)))},onTimeout:(d,m,g)=>{this.resetLoader(m),a(this.createKeyLoadError(t,Le.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),g))},onAbort:(d,m,g)=>{this.resetLoader(m),a(this.createKeyLoadError(t,Le.INTERNAL_ABORTED,new Error("key loading aborted"),g))}};s.load(l,c,h)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],s&&s.destroy()}}function t2(r){const{type:e}=r;switch(e){case _n.AUDIO_TRACK:return Bt.AUDIO;case _n.SUBTITLE_TRACK:return Bt.SUBTITLE;default:return Bt.MAIN}}function YE(r,e){let t=r.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class UJ{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(H.MANIFEST_LOADING,this.onManifestLoading,this),e.on(H.LEVEL_LOADING,this.onLevelLoading,this),e.on(H.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(H.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(H.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(H.MANIFEST_LOADING,this.onManifestLoading,this),e.off(H.LEVEL_LOADING,this.onLevelLoading,this),e.off(H.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(H.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(H.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,s=n||i,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:_n.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:s,url:o,deliveryDirectives:a,levelInfo:l}=t;this.load({id:n,level:i,pathwayId:s,responseType:"text",type:_n.LEVEL,url:o,deliveryDirectives:a,levelOrTrack:l})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:s,deliveryDirectives:o,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:_n.AUDIO_TRACK,url:s,deliveryDirectives:o,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:s,deliveryDirectives:o,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:_n.SUBTITLE_TRACK,url:s,deliveryDirectives:o,levelOrTrack:a})}onLevelsUpdated(e,t){const n=this.loaders[_n.LEVEL];if(n){const i=n.context;i&&!t.levels.some(s=>s===i.levelOrTrack)&&(n.abort(),delete this.loaders[_n.LEVEL])}}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const u=this.hls.logger,c=i.context;if(c&&c.levelOrTrack===e.levelOrTrack&&(c.url===e.url||c.deliveryDirectives&&!e.deliveryDirectives)){c.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${c.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let s;if(e.type===_n.MANIFEST?s=n.manifestLoadPolicy.default:s=$n({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),Mt((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===_n.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===_n.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===_n.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const c=u.partTarget,h=u.targetduration;if(c&&h){const d=Math.max(c*3,h*.8)*1e3;s=$n({},s,{maxTimeToFirstByteMs:Math.min(d,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(d,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(u,c,h,d)=>{const m=this.getInternalLoader(h);this.resetInternalLoader(h.type);const g=u.data;if(g.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,h,new Error("no EXTM3U delimiter"),d||null,c);return}c.parsing.start=performance.now(),qa.isMediaPlaylist(g)||h.type!==_n.MANIFEST?this.handleTrackOrLevelPlaylist(u,c,h,d||null,m):this.handleMasterPlaylist(u,c,h,d)},onError:(u,c,h,d)=>{this.handleNetworkError(c,h,!1,u,d)},onTimeout:(u,c,h)=>{this.handleNetworkError(c,h,!0,void 0,u)}};i.load(e,a,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const s=this.hls,o=e.data,a=YE(e,n),l=qa.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,i,t);return}const{contentSteering:u,levels:c,sessionData:h,sessionKeys:d,startTimeOffset:m,variableList:g}=l;this.variableList=g;const{AUDIO:x=[],SUBTITLES:_,"CLOSED-CAPTIONS":S}=qa.parseMasterPlaylistMedia(o,a,l);x.length&&!x.some(E=>!E.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new pi({}),bitrate:0,url:""})),s.trigger(H.MANIFEST_LOADED,{levels:c,audioTracks:x,subtitles:_,captions:S,contentSteering:u,url:a,stats:t,networkDetails:i,sessionData:h,sessionKeys:d,startTimeOffset:m,variableList:g})}handleTrackOrLevelPlaylist(e,t,n,i,s){const o=this.hls,{id:a,level:l,type:u}=n,c=YE(e,n),h=Mt(l)?l:Mt(a)?a:0,d=t2(n),m=qa.parseLevelPlaylist(e.data,c,h,d,0,this.variableList);if(u===_n.MANIFEST){const g={attrs:new pi({}),bitrate:0,details:m,name:"",url:c};m.requestScheduled=t.loading.start+yO(m,0),o.trigger(H.MANIFEST_LOADED,{levels:[g],audioTracks:[],url:c,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=m,this.handlePlaylistLoaded(m,e,t,n,i,s)}handleManifestParsingError(e,t,n,i,s){this.hls.trigger(H.ERROR,{type:Nt.NETWORK_ERROR,details:Le.MANIFEST_PARSING_ERROR,fatal:t.type===_n.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:s})}handleNetworkError(e,t,n=!1,i,s){let o=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===_n.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===_n.AUDIO_TRACK||e.type===_n.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let l=Le.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case _n.MANIFEST:l=n?Le.MANIFEST_LOAD_TIMEOUT:Le.MANIFEST_LOAD_ERROR,u=!0;break;case _n.LEVEL:l=n?Le.LEVEL_LOAD_TIMEOUT:Le.LEVEL_LOAD_ERROR,u=!1;break;case _n.AUDIO_TRACK:l=n?Le.AUDIO_TRACK_LOAD_TIMEOUT:Le.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case _n.SUBTITLE_TRACK:l=n?Le.SUBTITLE_TRACK_LOAD_TIMEOUT:Le.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const h={type:Nt.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:s};if(i){const d=(t==null?void 0:t.url)||e.url;h.response=Wn({url:d,data:void 0},i)}this.hls.trigger(H.ERROR,h)}handlePlaylistLoaded(e,t,n,i,s,o){const a=this.hls,{type:l,level:u,id:c,groupId:h,deliveryDirectives:d}=i,m=YE(t,i),g=t2(i),x=typeof i.level=="number"&&g===Bt.MAIN?u:void 0;if(!e.fragments.length){const S=e.playlistParsingError=new Error("No Segments found in Playlist");a.trigger(H.ERROR,{type:Nt.NETWORK_ERROR,details:Le.LEVEL_EMPTY_ERROR,fatal:!1,url:m,error:S,reason:S.message,response:t,context:i,level:x,parent:g,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const _=e.playlistParsingError;if(_){if(this.hls.logger.warn(_),!a.config.ignorePlaylistParsingErrors){a.trigger(H.ERROR,{type:Nt.NETWORK_ERROR,details:Le.LEVEL_PARSING_ERROR,fatal:!1,url:m,error:_,reason:_.message,response:t,context:i,level:x,parent:g,networkDetails:s,stats:n});return}e.playlistParsingError=null}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case _n.MANIFEST:case _n.LEVEL:a.trigger(H.LEVEL_LOADED,{details:e,levelInfo:i.levelOrTrack||a.levels[0],level:x||0,id:c||0,stats:n,networkDetails:s,deliveryDirectives:d,withoutMultiVariant:l===_n.MANIFEST});break;case _n.AUDIO_TRACK:a.trigger(H.AUDIO_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:c||0,groupId:h||"",stats:n,networkDetails:s,deliveryDirectives:d});break;case _n.SUBTITLE_TRACK:a.trigger(H.SUBTITLE_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:c||0,groupId:h||"",stats:n,networkDetails:s,deliveryDirectives:d});break}}}class Nu{static get version(){return tv}static isMSESupported(){return vC()}static isSupported(){return SU()}static getMediaSource(){return Zu()}static get Events(){return H}static get MetadataSchema(){return io}static get ErrorTypes(){return Nt}static get ErrorDetails(){return Le}static get DefaultConfig(){return Nu.defaultConfig?Nu.defaultConfig:SJ}static set DefaultConfig(e){Nu.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new oC,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=x$(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=EJ(Nu.DefaultConfig,e,t);this.userConfig=e,n.progressive&&TJ(n,t);const{abrController:i,bufferController:s,capLevelController:o,errorController:a,fpsController:l}=n,u=new a(this),c=this.abrController=new i(this),h=new l7(this),d=n.interstitialsController,m=d?this.interstitialsController=new d(this,Nu):null,g=this.bufferController=new s(this,h),x=this.capLevelController=new o(this),_=new l(this),S=new UJ(this),T=n.contentSteeringController,E=T?new T(this):null,C=this.levelController=new DJ(this,E),R=new LJ(this),P=new OJ(this.config),L=this.streamController=new kJ(this,h,P),F=this.gapController=new bJ(this,h);x.setStreamController(L),_.setStreamController(L);const D=[S,C,L];m&&D.splice(1,0,m),E&&D.splice(1,0,E),this.networkControllers=D;const I=[c,g,F,x,_,R,h];this.audioTrackController=this.createController(n.audioTrackController,D);const N=n.audioStreamController;N&&D.push(this.audioStreamController=new N(this,h,P)),this.subtitleTrackController=this.createController(n.subtitleTrackController,D);const V=n.subtitleStreamController;V&&D.push(this.subtititleStreamController=new V(this,h,P)),this.createController(n.timelineController,I),P.emeController=this.emeController=this.createController(n.emeController,I),this.cmcdController=this.createController(n.cmcdController,I),this.latencyController=this.createController(PJ,I),this.coreComponents=I,D.push(u);const q=u.onErrorOut;typeof q=="function"&&this.on(H.ERROR,q,u),this.on(H.MANIFEST_LOADED,S.onManifestLoaded,S)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===H.ERROR;this.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(H.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const s=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(H.ERROR,{type:Nt.OTHER_ERROR,details:Le.ATTACH_MEDIA_ERROR,fatal:!0,error:s});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger(H.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(H.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(H.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=Jw.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(H.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Bt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Bt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Bt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=sX()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){$$(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,n)for(let s=i;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=n)return s}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=aO(t);return oO(e,n,navigator.mediaCapabilities)}}Nu.defaultConfig=void 0;const NJ=Object.freeze(Object.defineProperty({__proto__:null,AbrController:lO,AttrList:pi,AudioStreamController:WO,AudioTrackController:KO,BasePlaylistController:EA,BaseSegment:qw,BaseStreamController:SA,BufferController:XO,CMCDController:ZO,CapLevelController:TA,ChunkMetadata:_A,ContentSteeringController:eU,Cues:yU,DateRange:nC,EMEController:$f,ErrorActionFlags:ca,ErrorController:cO,ErrorDetails:Le,ErrorTypes:Nt,Events:H,FPSController:nU,FetchLoader:uM,Fragment:a_,Hls:Nu,HlsSkip:T0,HlsUrlParameters:JT,KeySystemFormats:ks,KeySystems:Gn,Level:gm,LevelDetails:dO,LevelKey:vm,LoadStats:yA,M3U8Parser:qa,MetadataSchema:io,NetworkErrorAction:Ur,Part:Kk,PlaylistLevelType:Bt,SubtitleStreamController:aU,SubtitleTrackController:sU,TimelineController:gU,XhrLoader:gC,default:Nu,fetchSupported:xU,getMediaSource:Zu,isMSESupported:vC,isSupported:SU,requestMediaKeySystemAccess:sC},Symbol.toStringTag,{value:"Module"})),GJ=((r,e)=>typeof window<"u"&&typeof((r=window.document)==null?void 0:r.createElement)=="function"&&typeof((e=window.navigator)==null?void 0:e.userAgent)=="string")();let JE=null;async function HJ(...r){var e;(e=JE)!==null&&e!==void 0||(JE=await c$(()=>Promise.resolve().then(()=>NJ),[]));const t=JE.default;return t.isSupported()?new t(...r):null}function zJ(r,{unsuspend:e="loadedmetadata",start:t=!0,hls:n={},crossOrigin:i="anonymous",muted:s=!0,loop:o=!0,playsInline:a=!0,onVideoFrame:l,...u}={}){const c=Ro(g=>g.gl),h=ne.useRef(null),d=Hw(()=>new Promise(async g=>{let x,_;typeof r=="string"?x=r:_=r;const S=Object.assign(document.createElement("video"),{src:x,srcObject:_,crossOrigin:i,loop:o,muted:s,playsInline:a,...u});if(x&&GJ&&x.endsWith(".m3u8")){const E=h.current=await HJ(n);E&&(E.on(H.MEDIA_ATTACHED,()=>void E.loadSource(x)),E.attachMedia(S))}const T=new _F(S);"colorSpace"in T?T.colorSpace=c.outputColorSpace:T.encoding=c.outputEncoding,S.addEventListener(e,()=>g(T))}),[r]),m=d.source.data;return VJ(m,l),ne.useEffect(()=>(t&&d.image.play(),()=>{h.current&&(h.current.destroy(),h.current=null)}),[d,t]),d}const VJ=(r,e)=>{ne.useEffect(()=>{if(!e||!r.requestVideoFrameCallback)return;let t;const n=(...i)=>{e(...i),t=r.requestVideoFrameCallback(n)};return r.requestVideoFrameCallback(n),()=>r.cancelVideoFrameCallback(t)},[r,e])};function WJ(r,e){const t=ne.useRef(),[n]=ne.useState(()=>e?e instanceof An?{current:e}:e:t),[i]=ne.useState(()=>new ek(void 0));ne.useLayoutEffect(()=>{e&&(n.current=e instanceof An?e:e.current),i._root=n.current});const s=ne.useRef({}),o=ne.useMemo(()=>{const a={};return r.forEach(l=>Object.defineProperty(a,l.name,{enumerable:!0,get(){if(n.current)return s.current[l.name]||(s.current[l.name]=i.clipAction(l,n.current))},configurable:!0})),{ref:n,clips:r,actions:a,names:r.map(l=>l.name),mixer:i}},[r]);return _h((a,l)=>i.update(l)),ne.useEffect(()=>{const a=n.current;return()=>{s.current={},i.stopAllAction(),Object.values(o.actions).forEach(l=>{a&&i.uncacheAction(l,a)})}},[r]),o}const jJ=ne.forwardRef(function({children:e,disable:t,disableX:n,disableY:i,disableZ:s,left:o,right:a,top:l,bottom:u,front:c,back:h,onCentered:d,precise:m=!0,cacheKey:g=0,...x},_){const S=ne.useRef(null),T=ne.useRef(null),E=ne.useRef(null);return ne.useLayoutEffect(()=>{T.current.matrixWorld.identity();const C=new Ni().setFromObject(E.current,m),R=new ae,P=new Yi,L=C.max.x-C.min.x,F=C.max.y-C.min.y,D=C.max.z-C.min.z;C.getCenter(R),C.getBoundingSphere(P);const I=l?F/2:u?-F/2:0,N=o?-L/2:a?L/2:0,V=c?D/2:h?-D/2:0;T.current.position.set(t||n?0:-R.x+N,t||i?0:-R.y+I,t||s?0:-R.z+V),typeof d<"u"&&d({parent:S.current.parent,container:S.current,width:L,height:F,depth:D,boundingBox:C,boundingSphere:P,center:R,verticalAlignment:I,horizontalAlignment:N,depthAlignment:V})},[g,d,l,o,c,t,n,i,s,m,a,u,h]),ne.useImperativeHandle(_,()=>S.current,[]),ne.createElement("group",Qu({ref:S},x),ne.createElement("group",{ref:T},ne.createElement("group",{ref:E},e)))}),KJ=ne.forwardRef(({children:r,enabled:e=!0,speed:t=1,rotationIntensity:n=1,floatIntensity:i=1,floatingRange:s=[-.1,.1],autoInvalidate:o=!1,...a},l)=>{const u=ne.useRef(null);ne.useImperativeHandle(l,()=>u.current,[]);const c=ne.useRef(Math.random()*1e4);return _h(h=>{var d,m;if(!e||t===0)return;o&&h.invalidate();const g=c.current+h.clock.elapsedTime;u.current.rotation.x=Math.cos(g/4*t)/8*n,u.current.rotation.y=Math.sin(g/4*t)/8*n,u.current.rotation.z=Math.sin(g/4*t)/20*n;let x=Math.sin(g/4*t)/10;x=_v.mapLinear(x,-.1,.1,(d=s==null?void 0:s[0])!==null&&d!==void 0?d:-.1,(m=s==null?void 0:s[1])!==null&&m!==void 0?m:.1),u.current.position.y=x*i,u.current.updateMatrix()}),ne.createElement("group",a,ne.createElement("group",{ref:u,matrixAutoUpdate:!1},r))});class $J extends Go{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:`
        uniform float pixelRatio;
        uniform float time;
        attribute float size;  
        attribute float speed;  
        attribute float opacity;
        attribute vec3 noise;
        attribute vec3 color;
        varying vec3 vColor;
        varying float vOpacity;

        void main() {
          vec4 modelPosition = modelMatrix * vec4(position, 1.0);
          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;
          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;
          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;
          vec4 viewPosition = viewMatrix * modelPosition;
          vec4 projectionPostion = projectionMatrix * viewPosition;
          gl_Position = projectionPostion;
          gl_PointSize = size * 25. * pixelRatio;
          gl_PointSize *= (1.0 / - viewPosition.z);
          vColor = color;
          vOpacity = opacity;
        }
      `,fragmentShader:`
        varying vec3 vColor;
        varying float vOpacity;
        void main() {
          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
          float strength = 0.05 / distanceToCenter - 0.1;
          gl_FragColor = vec4(vColor, strength * vOpacity);
          #include <tonemapping_fragment>
          #include <${a$>=154?"colorspace_fragment":"encodings_fragment"}>
        }
      `})}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(e){this.uniforms.pixelRatio.value=e}}const AU=r=>r&&r.constructor===Float32Array,XJ=r=>[r.r,r.g,r.b],EU=r=>r instanceof Qe||r instanceof ae||r instanceof gn,TU=r=>Array.isArray(r)?r:EU(r)?r.toArray():[r,r,r];function Yg(r,e,t){return ne.useMemo(()=>{if(e!==void 0){if(AU(e))return e;if(e instanceof yt){const n=Array.from({length:r*3},()=>XJ(e)).flat();return Float32Array.from(n)}else if(EU(e)||Array.isArray(e)){const n=Array.from({length:r*3},()=>TU(e)).flat();return Float32Array.from(n)}return Float32Array.from({length:r},()=>e)}return Float32Array.from({length:r},t)},[e])}const fM=ne.forwardRef(({noise:r=1,count:e=100,speed:t=1,opacity:n=1,scale:i=1,size:s,color:o,children:a,...l},u)=>{ne.useMemo(()=>ak({SparklesImplMaterial:$J}),[]);const c=ne.useRef(null),h=Ro(E=>E.viewport.dpr),d=TU(i),m=ne.useMemo(()=>Float32Array.from(Array.from({length:e},()=>d.map(_v.randFloatSpread)).flat()),[e,...d]),g=Yg(e,s,Math.random),x=Yg(e,n),_=Yg(e,t),S=Yg(e*3,r),T=Yg(o===void 0?e*3:e,AU(o)?o:new yt(o),()=>1);return _h(E=>{c.current&&c.current.material&&(c.current.material.time=E.clock.elapsedTime)}),ne.useImperativeHandle(u,()=>c.current,[]),ne.createElement("points",Qu({key:`particle-${e}-${JSON.stringify(i)}`},l,{ref:c}),ne.createElement("bufferGeometry",null,ne.createElement("bufferAttribute",{attach:"attributes-position",args:[m,3]}),ne.createElement("bufferAttribute",{attach:"attributes-size",args:[g,1]}),ne.createElement("bufferAttribute",{attach:"attributes-opacity",args:[x,1]}),ne.createElement("bufferAttribute",{attach:"attributes-speed",args:[_,1]}),ne.createElement("bufferAttribute",{attach:"attributes-color",args:[T,3]}),ne.createElement("bufferAttribute",{attach:"attributes-noise",args:[S,3]})),a||ne.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:h,depthWrite:!1}))});var Jg={},n2;function YJ(){if(n2)return Jg;n2=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.parse=o,Jg.serialize=u;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,s=(()=>{const d=function(){};return d.prototype=Object.create(null),d})();function o(d,m){const g=new s,x=d.length;if(x<2)return g;const _=(m==null?void 0:m.decode)||c;let S=0;do{const T=d.indexOf("=",S);if(T===-1)break;const E=d.indexOf(";",S),C=E===-1?x:E;if(T>C){S=d.lastIndexOf(";",T-1)+1;continue}const R=a(d,S,T),P=l(d,T,R),L=d.slice(R,P);if(g[L]===void 0){let F=a(d,T+1,C),D=l(d,C,F);const I=_(d.slice(F,D));g[L]=I}S=C+1}while(S<x);return g}function a(d,m,g){do{const x=d.charCodeAt(m);if(x!==32&&x!==9)return m}while(++m<g);return g}function l(d,m,g){for(;m>g;){const x=d.charCodeAt(--m);if(x!==32&&x!==9)return m+1}return g}function u(d,m,g){const x=(g==null?void 0:g.encode)||encodeURIComponent;if(!r.test(d))throw new TypeError(`argument name is invalid: ${d}`);const _=x(m);if(!e.test(_))throw new TypeError(`argument val is invalid: ${m}`);let S=d+"="+_;if(!g)return S;if(g.maxAge!==void 0){if(!Number.isInteger(g.maxAge))throw new TypeError(`option maxAge is invalid: ${g.maxAge}`);S+="; Max-Age="+g.maxAge}if(g.domain){if(!t.test(g.domain))throw new TypeError(`option domain is invalid: ${g.domain}`);S+="; Domain="+g.domain}if(g.path){if(!n.test(g.path))throw new TypeError(`option path is invalid: ${g.path}`);S+="; Path="+g.path}if(g.expires){if(!h(g.expires)||!Number.isFinite(g.expires.valueOf()))throw new TypeError(`option expires is invalid: ${g.expires}`);S+="; Expires="+g.expires.toUTCString()}if(g.httpOnly&&(S+="; HttpOnly"),g.secure&&(S+="; Secure"),g.partitioned&&(S+="; Partitioned"),g.priority)switch(typeof g.priority=="string"?g.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${g.priority}`)}if(g.sameSite)switch(typeof g.sameSite=="string"?g.sameSite.toLowerCase():g.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${g.sameSite}`)}return S}function c(d){if(d.indexOf("%")===-1)return d;try{return decodeURIComponent(d)}catch{return d}}function h(d){return i.call(d)==="[object Date]"}return Jg}YJ();var i2="popstate";function JJ(r={}){function e(i,s){let{pathname:o="/",search:a="",hash:l=""}=fd(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),dM("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){let o=i.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=i.location.href,u=l.indexOf("#");a=u===-1?l:l.slice(0,u)}return a+"#"+(typeof s=="string"?s:sv(s))}function n(i,s){tl(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return QJ(e,t,n,r)}function bi(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function tl(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qJ(){return Math.random().toString(36).substring(2,10)}function r2(r,e){return{usr:r.state,key:r.key,idx:e}}function dM(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?fd(e):e,state:t,key:e&&e.key||n||qJ()}}function sv({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function fd(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function QJ(r,e,t,n={}){let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a="POP",l=null,u=c();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function c(){return(o.state||{idx:null}).idx}function h(){a="POP";let _=c(),S=_==null?null:_-u;u=_,l&&l({action:a,location:x.location,delta:S})}function d(_,S){a="PUSH";let T=dM(x.location,_,S);t&&t(T,_),u=c()+1;let E=r2(T,u),C=x.createHref(T);try{o.pushState(E,"",C)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;i.location.assign(C)}s&&l&&l({action:a,location:x.location,delta:1})}function m(_,S){a="REPLACE";let T=dM(x.location,_,S);t&&t(T,_),u=c();let E=r2(T,u),C=x.createHref(T);o.replaceState(E,"",C),s&&l&&l({action:a,location:x.location,delta:0})}function g(_){return ZJ(_)}let x={get action(){return a},get location(){return r(i,o)},listen(_){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(i2,h),l=_,()=>{i.removeEventListener(i2,h),l=null}},createHref(_){return e(i,_)},createURL:g,encodeLocation(_){let S=g(_);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:d,replace:m,go(_){return o.go(_)}};return x}function ZJ(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),bi(t,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:sv(r);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function MU(r,e,t="/"){return eq(r,e,t,!1)}function eq(r,e,t,n){let i=typeof e=="string"?fd(e):e,s=ec(i.pathname||"/",t);if(s==null)return null;let o=wU(r);tq(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=fq(s);a=cq(o[l],u,n)}return a}function wU(r,e=[],t=[],n=""){let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(bi(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let u=Ku([n,l.relativePath]),c=t.concat(l);s.children&&s.children.length>0&&(bi(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),wU(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:lq(u,s.index),routesMeta:c})};return r.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of CU(s.path))i(s,o,l)}),e}function CU(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=CU(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>r.startsWith("/")&&l===""?"/":l)}function tq(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:uq(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var nq=/^:[\w-]+$/,iq=3,rq=2,sq=1,oq=10,aq=-2,s2=r=>r==="*";function lq(r,e){let t=r.split("/"),n=t.length;return t.some(s2)&&(n+=aq),e&&(n+=rq),t.filter(i=>!s2(i)).reduce((i,s)=>i+(nq.test(s)?iq:s===""?sq:oq),n)}function uq(r,e){return r.length===e.length&&r.slice(0,-1).every((n,i)=>n===e[i])?r[r.length-1]-e[e.length-1]:0}function cq(r,e,t=!1){let{routesMeta:n}=r,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],u=a===n.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=gS({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h&&u&&t&&!n[n.length-1].route.index&&(h=gS({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Ku([s,h.pathname]),pathnameBase:gq(Ku([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Ku([s,h.pathnameBase]))}return o}function gS(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=hq(r.path,r.caseSensitive,r.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,{paramName:c,isOptional:h},d)=>{if(c==="*"){let g=a[d]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[d];return h&&!m?u[c]=void 0:u[c]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:r}}function hq(r,e=!1,t=!0){tl(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],i="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),i+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":r!==""&&r!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function fq(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tl(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function ec(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function dq(r,e="/"){let{pathname:t,search:n="",hash:i=""}=typeof r=="string"?fd(r):r;return{pathname:t?t.startsWith("/")?t:pq(t,e):e,search:vq(n),hash:yq(i)}}function pq(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function qE(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mq(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function bU(r){let e=mq(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function RU(r,e,t,n=!1){let i;typeof r=="string"?i=fd(r):(i={...r},bi(!i.pathname||!i.pathname.includes("?"),qE("?","pathname","search",i)),bi(!i.pathname||!i.pathname.includes("#"),qE("#","pathname","hash",i)),bi(!i.search||!i.search.includes("#"),qE("#","search","hash",i)));let s=r===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!n&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=dq(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var Ku=r=>r.join("/").replace(/\/\/+/g,"/"),gq=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),vq=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,yq=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function xq(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var IU=["POST","PUT","PATCH","DELETE"];new Set(IU);var _q=["GET",...IU];new Set(_q);var Fm=ne.createContext(null);Fm.displayName="DataRouter";var MA=ne.createContext(null);MA.displayName="DataRouterState";var LU=ne.createContext({isTransitioning:!1});LU.displayName="ViewTransition";var Sq=ne.createContext(new Map);Sq.displayName="Fetchers";var Aq=ne.createContext(null);Aq.displayName="Await";var Xl=ne.createContext(null);Xl.displayName="Navigation";var Dv=ne.createContext(null);Dv.displayName="Location";var lc=ne.createContext({outlet:null,matches:[],isDataRoute:!1});lc.displayName="Route";var yC=ne.createContext(null);yC.displayName="RouteError";function Eq(r,{relative:e}={}){bi(Bv(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=ne.useContext(Xl),{hash:i,pathname:s,search:o}=Fv(r,{relative:e}),a=s;return t!=="/"&&(a=s==="/"?t:Ku([t,s])),n.createHref({pathname:a,search:o,hash:i})}function Bv(){return ne.useContext(Dv)!=null}function dd(){return bi(Bv(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(Dv).location}var PU="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function DU(r){ne.useContext(Xl).static||ne.useLayoutEffect(r)}function Tq(){let{isDataRoute:r}=ne.useContext(lc);return r?Oq():Mq()}function Mq(){bi(Bv(),"useNavigate() may be used only in the context of a <Router> component.");let r=ne.useContext(Fm),{basename:e,navigator:t}=ne.useContext(Xl),{matches:n}=ne.useContext(lc),{pathname:i}=dd(),s=JSON.stringify(bU(n)),o=ne.useRef(!1);return DU(()=>{o.current=!0}),ne.useCallback((l,u={})=>{if(tl(o.current,PU),!o.current)return;if(typeof l=="number"){t.go(l);return}let c=RU(l,JSON.parse(s),i,u.relative==="path");r==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Ku([e,c.pathname])),(u.replace?t.replace:t.push)(c,u.state,u)},[e,t,s,i,r])}ne.createContext(null);function Fv(r,{relative:e}={}){let{matches:t}=ne.useContext(lc),{pathname:n}=dd(),i=JSON.stringify(bU(t));return ne.useMemo(()=>RU(r,JSON.parse(i),n,e==="path"),[r,i,n,e])}function wq(r,e){return BU(r,e)}function BU(r,e,t,n){var T;bi(Bv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:s}=ne.useContext(Xl),{matches:o}=ne.useContext(lc),a=o[o.length-1],l=a?a.params:{},u=a?a.pathname:"/",c=a?a.pathnameBase:"/",h=a&&a.route;{let E=h&&h.path||"";FU(u,!h||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let d=dd(),m;if(e){let E=typeof e=="string"?fd(e):e;bi(c==="/"||((T=E.pathname)==null?void 0:T.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${E.pathname}" was given in the \`location\` prop.`),m=E}else m=d;let g=m.pathname||"/",x=g;if(c!=="/"){let E=c.replace(/^\//,"").split("/");x="/"+g.replace(/^\//,"").split("/").slice(E.length).join("/")}let _=!s&&t&&t.matches&&t.matches.length>0?t.matches:MU(r,{pathname:x});tl(h||_!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),tl(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=Lq(_&&_.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:Ku([c,i.encodeLocation?i.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?c:Ku([c,i.encodeLocation?i.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),o,t,n);return e&&S?ne.createElement(Dv.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},S):S}function Cq(){let r=kq(),e=xq(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",r),o=ne.createElement(ne.Fragment,null,ne.createElement("p",null,"💿 Hey developer 👋"),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:s},"ErrorBoundary")," or"," ",ne.createElement("code",{style:s},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},e),t?ne.createElement("pre",{style:i},t):null,o)}var bq=ne.createElement(Cq,null),Rq=class extends ne.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?ne.createElement(lc.Provider,{value:this.props.routeContext},ne.createElement(yC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Iq({routeContext:r,match:e,children:t}){let n=ne.useContext(Fm);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ne.createElement(lc.Provider,{value:r},t)}function Lq(r,e=[],t=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let i=r,s=t==null?void 0:t.errors;if(s!=null){let l=i.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);bi(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<i.length;l++){let u=i[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(a=l),u.route.id){let{loaderData:c,errors:h}=t,d=u.route.loader&&!c.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||d){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,u,c)=>{let h,d=!1,m=null,g=null;t&&(h=s&&u.route.id?s[u.route.id]:void 0,m=u.route.errorElement||bq,o&&(a<0&&c===0?(FU("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,g=null):a===c&&(d=!0,g=u.route.hydrateFallbackElement||null)));let x=e.concat(i.slice(0,c+1)),_=()=>{let S;return h?S=m:d?S=g:u.route.Component?S=ne.createElement(u.route.Component,null):u.route.element?S=u.route.element:S=l,ne.createElement(Iq,{match:u,routeContext:{outlet:l,matches:x,isDataRoute:t!=null},children:S})};return t&&(u.route.ErrorBoundary||u.route.errorElement||c===0)?ne.createElement(Rq,{location:t.location,revalidation:t.revalidation,component:m,error:h,children:_(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):_()},null)}function xC(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Pq(r){let e=ne.useContext(Fm);return bi(e,xC(r)),e}function Dq(r){let e=ne.useContext(MA);return bi(e,xC(r)),e}function Bq(r){let e=ne.useContext(lc);return bi(e,xC(r)),e}function _C(r){let e=Bq(r),t=e.matches[e.matches.length-1];return bi(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function Fq(){return _C("useRouteId")}function kq(){var n;let r=ne.useContext(yC),e=Dq("useRouteError"),t=_C("useRouteError");return r!==void 0?r:(n=e.errors)==null?void 0:n[t]}function Oq(){let{router:r}=Pq("useNavigate"),e=_C("useNavigate"),t=ne.useRef(!1);return DU(()=>{t.current=!0}),ne.useCallback(async(i,s={})=>{tl(t.current,PU),t.current&&(typeof i=="number"?r.navigate(i):await r.navigate(i,{fromRouteId:e,...s}))},[r,e])}var o2={};function FU(r,e,t){!e&&!o2[r]&&(o2[r]=!0,tl(!1,t))}ne.memo(Uq);function Uq({routes:r,future:e,state:t}){return BU(r,void 0,t,e)}function o0(r){bi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Nq({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:i,static:s=!1}){bi(!Bv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=r.replace(/^\/*/,"/"),a=ne.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof t=="string"&&(t=fd(t));let{pathname:l="/",search:u="",hash:c="",state:h=null,key:d="default"}=t,m=ne.useMemo(()=>{let g=ec(l,o);return g==null?null:{location:{pathname:g,search:u,hash:c,state:h,key:d},navigationType:n}},[o,l,u,c,h,d,n]);return tl(m!=null,`<Router basename="${o}"> is not able to match the URL "${l}${u}${c}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:ne.createElement(Xl.Provider,{value:a},ne.createElement(Dv.Provider,{children:e,value:m}))}function Gq({children:r,location:e}){return wq(pM(r),e)}function pM(r,e=[]){let t=[];return ne.Children.forEach(r,(n,i)=>{if(!ne.isValidElement(n))return;let s=[...e,i];if(n.type===ne.Fragment){t.push.apply(t,pM(n.props.children,s));return}bi(n.type===o0,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bi(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=pM(n.props.children,s)),t.push(o)}),t}var p_="get",m_="application/x-www-form-urlencoded";function wA(r){return r!=null&&typeof r.tagName=="string"}function Hq(r){return wA(r)&&r.tagName.toLowerCase()==="button"}function zq(r){return wA(r)&&r.tagName.toLowerCase()==="form"}function Vq(r){return wA(r)&&r.tagName.toLowerCase()==="input"}function Wq(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function jq(r,e){return r.button===0&&(!e||e==="_self")&&!Wq(r)}var Yx=null;function Kq(){if(Yx===null)try{new FormData(document.createElement("form"),0),Yx=!1}catch{Yx=!0}return Yx}var $q=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function QE(r){return r!=null&&!$q.has(r)?(tl(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${m_}"`),null):r}function Xq(r,e){let t,n,i,s,o;if(zq(r)){let a=r.getAttribute("action");n=a?ec(a,e):null,t=r.getAttribute("method")||p_,i=QE(r.getAttribute("enctype"))||m_,s=new FormData(r)}else if(Hq(r)||Vq(r)&&(r.type==="submit"||r.type==="image")){let a=r.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=r.getAttribute("formaction")||a.getAttribute("action");if(n=l?ec(l,e):null,t=r.getAttribute("formmethod")||a.getAttribute("method")||p_,i=QE(r.getAttribute("formenctype"))||QE(a.getAttribute("enctype"))||m_,s=new FormData(a,r),!Kq()){let{name:u,type:c,value:h}=r;if(c==="image"){let d=u?`${u}.`:"";s.append(`${d}x`,"0"),s.append(`${d}y`,"0")}else u&&s.append(u,h)}}else{if(wA(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=p_,n=null,i=m_,o=r}return s&&i==="text/plain"&&(o=s,s=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:s,body:o}}function SC(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function Yq(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Jq(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function qq(r,e,t){let n=await Promise.all(r.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await Yq(s,t);return o.links?o.links():[]}return[]}));return tQ(n.flat(1).filter(Jq).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function a2(r,e,t,n,i,s){let o=(l,u)=>t[u]?l.route.id!==t[u].route.id:!0,a=(l,u)=>{var c;return t[u].pathname!==l.pathname||((c=t[u].route.path)==null?void 0:c.endsWith("*"))&&t[u].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,u)=>o(l,u)||a(l,u)):s==="data"?e.filter((l,u)=>{var h;let c=n.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(o(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((h=t[0])==null?void 0:h.params)||{},nextUrl:new URL(r,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function Qq(r,e,{includeHydrateFallback:t}={}){return Zq(r.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function Zq(r){return[...new Set(r)]}function eQ(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function tQ(r,e){let t=new Set;return new Set(e),r.reduce((n,i)=>{let s=JSON.stringify(eQ(i));return t.has(s)||(t.add(s),n.push({key:s,link:i})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var nQ=new Set([100,101,204,205]);function iQ(r,e){let t=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return t.pathname==="/"?t.pathname="_root.data":e&&ec(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function kU(){let r=ne.useContext(Fm);return SC(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function rQ(){let r=ne.useContext(MA);return SC(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var AC=ne.createContext(void 0);AC.displayName="FrameworkContext";function OU(){let r=ne.useContext(AC);return SC(r,"You must render this element inside a <HydratedRouter> element"),r}function sQ(r,e){let t=ne.useContext(AC),[n,i]=ne.useState(!1),[s,o]=ne.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=e,d=ne.useRef(null);ne.useEffect(()=>{if(r==="render"&&o(!0),r==="viewport"){let x=S=>{S.forEach(T=>{o(T.isIntersecting)})},_=new IntersectionObserver(x,{threshold:.5});return d.current&&_.observe(d.current),()=>{_.disconnect()}}},[r]),ne.useEffect(()=>{if(n){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[n]);let m=()=>{i(!0)},g=()=>{i(!1),o(!1)};return t?r!=="intent"?[s,d,{}]:[s,d,{onFocus:qg(a,m),onBlur:qg(l,g),onMouseEnter:qg(u,m),onMouseLeave:qg(c,g),onTouchStart:qg(h,m)}]:[!1,d,{}]}function qg(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function oQ({page:r,...e}){let{router:t}=kU(),n=ne.useMemo(()=>MU(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?ne.createElement(lQ,{page:r,matches:n,...e}):null}function aQ(r){let{manifest:e,routeModules:t}=OU(),[n,i]=ne.useState([]);return ne.useEffect(()=>{let s=!1;return qq(r,e,t).then(o=>{s||i(o)}),()=>{s=!0}},[r,e,t]),n}function lQ({page:r,matches:e,...t}){let n=dd(),{manifest:i,routeModules:s}=OU(),{basename:o}=kU(),{loaderData:a,matches:l}=rQ(),u=ne.useMemo(()=>a2(r,e,l,i,n,"data"),[r,e,l,i,n]),c=ne.useMemo(()=>a2(r,e,l,i,n,"assets"),[r,e,l,i,n]),h=ne.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let g=new Set,x=!1;if(e.forEach(S=>{var E;let T=i.routes[S.route.id];!T||!T.hasLoader||(!u.some(C=>C.route.id===S.route.id)&&S.route.id in a&&((E=s[S.route.id])!=null&&E.shouldRevalidate)||T.hasClientLoader?x=!0:g.add(S.route.id))}),g.size===0)return[];let _=iQ(r,o);return x&&g.size>0&&_.searchParams.set("_routes",e.filter(S=>g.has(S.route.id)).map(S=>S.route.id).join(",")),[_.pathname+_.search]},[o,a,n,i,u,e,r,s]),d=ne.useMemo(()=>Qq(c,i),[c,i]),m=aQ(c);return ne.createElement(ne.Fragment,null,h.map(g=>ne.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...t})),d.map(g=>ne.createElement("link",{key:g,rel:"modulepreload",href:g,...t})),m.map(({key:g,link:x})=>ne.createElement("link",{key:g,...x})))}function uQ(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var UU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{UU&&(window.__reactRouterVersion="7.6.0")}catch{}function cQ({basename:r,children:e,window:t}){let n=ne.useRef();n.current==null&&(n.current=JJ({window:t,v5Compat:!0}));let i=n.current,[s,o]=ne.useState({action:i.action,location:i.location}),a=ne.useCallback(l=>{ne.startTransition(()=>o(l))},[o]);return ne.useLayoutEffect(()=>i.listen(a),[i,a]),ne.createElement(Nq,{basename:r,children:e,location:s.location,navigationType:s.action,navigator:i})}var NU=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,CA=ne.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h,...d},m){let{basename:g}=ne.useContext(Xl),x=typeof u=="string"&&NU.test(u),_,S=!1;if(typeof u=="string"&&x&&(_=u,UU))try{let D=new URL(window.location.href),I=u.startsWith("//")?new URL(D.protocol+u):new URL(u),N=ec(I.pathname,g);I.origin===D.origin&&N!=null?u=N+I.search+I.hash:S=!0}catch{tl(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=Eq(u,{relative:i}),[E,C,R]=sQ(n,d),P=pQ(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:i,viewTransition:h});function L(D){e&&e(D),D.defaultPrevented||P(D)}let F=ne.createElement("a",{...d,...R,href:_||T,onClick:S||s?e:L,ref:uQ(m,C),target:l,"data-discover":!x&&t==="render"?"true":void 0});return E&&!x?ne.createElement(ne.Fragment,null,F,ne.createElement(oQ,{page:T})):F});CA.displayName="Link";var hQ=ne.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...u},c){let h=Fv(o,{relative:u.relative}),d=dd(),m=ne.useContext(MA),{navigator:g,basename:x}=ne.useContext(Xl),_=m!=null&&xQ(h)&&a===!0,S=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,T=d.pathname,E=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;t||(T=T.toLowerCase(),E=E?E.toLowerCase():null,S=S.toLowerCase()),E&&x&&(E=ec(E,x)||E);const C=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let R=T===S||!i&&T.startsWith(S)&&T.charAt(C)==="/",P=E!=null&&(E===S||!i&&E.startsWith(S)&&E.charAt(S.length)==="/"),L={isActive:R,isPending:P,isTransitioning:_},F=R?e:void 0,D;typeof n=="function"?D=n(L):D=[n,R?"active":null,P?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let I=typeof s=="function"?s(L):s;return ne.createElement(CA,{...u,"aria-current":F,className:D,ref:c,style:I,to:o,viewTransition:a},typeof l=="function"?l(L):l)});hQ.displayName="NavLink";var fQ=ne.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:i,state:s,method:o=p_,action:a,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:h,...d},m)=>{let g=vQ(),x=yQ(a,{relative:u}),_=o.toLowerCase()==="get"?"get":"post",S=typeof a=="string"&&NU.test(a),T=E=>{if(l&&l(E),E.defaultPrevented)return;E.preventDefault();let C=E.nativeEvent.submitter,R=(C==null?void 0:C.getAttribute("formmethod"))||o;g(C||E.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:i,state:s,relative:u,preventScrollReset:c,viewTransition:h})};return ne.createElement("form",{ref:m,method:_,action:x,onSubmit:n?l:T,...d,"data-discover":!S&&r==="render"?"true":void 0})});fQ.displayName="Form";function dQ(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function GU(r){let e=ne.useContext(Fm);return bi(e,dQ(r)),e}function pQ(r,{target:e,replace:t,state:n,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=Tq(),l=dd(),u=Fv(r,{relative:s});return ne.useCallback(c=>{if(jq(c,e)){c.preventDefault();let h=t!==void 0?t:sv(l)===sv(u);a(r,{replace:h,state:n,preventScrollReset:i,relative:s,viewTransition:o})}},[l,a,u,t,n,e,r,i,s,o])}var mQ=0,gQ=()=>`__${String(++mQ)}__`;function vQ(){let{router:r}=GU("useSubmit"),{basename:e}=ne.useContext(Xl),t=Fq();return ne.useCallback(async(n,i={})=>{let{action:s,method:o,encType:a,formData:l,body:u}=Xq(n,e);if(i.navigate===!1){let c=i.fetcherKey||gQ();await r.fetch(c,t,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await r.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[r,e,t])}function yQ(r,{relative:e}={}){let{basename:t}=ne.useContext(Xl),n=ne.useContext(lc);bi(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),s={...Fv(r||".",{relative:e})},o=dd();if(r==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(c=>c==="")){a.delete("index"),l.filter(h=>h).forEach(h=>a.append("index",h));let c=a.toString();s.search=c?`?${c}`:""}}return(!r||r===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:Ku([t,s.pathname])),sv(s)}function xQ(r,e={}){let t=ne.useContext(LU);bi(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=GU("useViewTransitionState"),i=Fv(r,{relative:e.relative});if(!t.isTransitioning)return!1;let s=ec(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=ec(t.nextLocation.pathname,n)||t.nextLocation.pathname;return gS(i.pathname,o)!=null||gS(i.pathname,s)!=null}[...nQ];const _Q=[{id:1,name:"Home",href:""},{id:2,name:"About",href:"about"},{id:3,name:"Work",href:"work"},{id:4,name:"Contact",href:"contact"}],HU=[{title:"LinguaLeap - Interactive Language Learning Platform",desc:"A gamified language learning platform featuring multiple interactive games and real-time multiplayer challenges to help users learn new languages in a fun and engaging way.",subdesc:`Tech Stack
Frontend
React 18 with TypeScript
Vite for build tooling
Tailwind CSS for styling
Framer Motion for animations
Zustand for state management
React Router for navigation
Socket.IO Client for real-time features
React Hot Toast for notifications
Backend
Node.js with Express
MongoDB with Mongoose
Socket.IO for real-time communication
JWT for authentication
Redis for caching (with fallback)
Cookie-based sessions
Google's Generative AI for content generation`,href:"https://praninara.github.io/LinguaLeap/",texture:"textures/project/project-1.mov",logo:"assets/project-1-logo.png",logoStyle:{backgroundColor:"#050a23",border:"0.8px solid #36201D",boxShadow:"0px 0px 60px 0px #0422b7D"},spotlight:"assets/spotlight1.png",tags:[{id:1,name:"Docker",path:"assets/docker.png"},{id:2,name:"Redis",path:"assets/redis.png"},{id:3,name:"React.js",path:"assets/react.svg"},{id:4,name:"TailwindCSS",path:"assets/tailwindcss.png"},{id:5,name:"TypeScript",path:"assets/typescript.png"},{id:6,name:"Nginx",path:"assets/nginx.png"},{id:7,name:"Vite",path:"assets/vite.png"}]},{title:"Column-Store DBMS - A lightweight Column-Oriented Database Management System",desc:"Column-Store DBMS is a custom-built, lightweight database management system developed in C++ that stores data in a column-oriented format for efficient analytical processing. It supports defining database schemas using XML, with data stored as individual binary files for each column. The system allows importing data from CSV files while enforcing relational constraints like primary, unique, and foreign keys, ensuring data integrity during insertion. It includes support for simple SQL-style SELECT queries and provides a basic utility framework for future operations like updates and deletions.",subdesc:`The project emphasizes modular design and low-level data handling, showcasing strong systems programming skills. It includes a basic query engine, a custom data loader, and view support to define reusable virtual tables. Built without relying on existing database libraries, the DBMS demonstrates an understanding of how data is stored, validated, and retrieved at a fundamental level. Planned extensions include support for joins, indexing, and transaction logging to enhance performance and reliability.
`,href:"https://praninara.github.io/LinguaLeap/",texture:"textures/project/project-1.mov",logo:"assets/project-1-logo.png",logoStyle:{backgroundColor:"#050a23",border:"0.8px solid #36201D",boxShadow:"0px 0px 60px 0px #0422b7D"},spotlight:"assets/spotlight1.png",tags:[{id:1,name:"CPP",path:"assets/c++.png"},{id:2,name:"XML",path:"assets/xml.png"}]}],l2=({onClick:r=()=>{}})=>J.jsx("ul",{className:"nav-ul flex flex-col sm:flex-row gap-4",children:_Q.map(e=>J.jsx("li",{className:"nav-li",children:J.jsx(CA,{to:e.href,className:"nav-li_a",onClick:r,children:e.name})},e.id))}),SQ=()=>{const[r,e]=ne.useState(!1),t=()=>e(!r),n=()=>e(!1);return J.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50 bg-black/90",children:[J.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center py-5 px-4",children:[J.jsx(CA,{to:"/",className:"text-neutral-400 font-bold text-xl hover:text-white transition-colors",children:"Pradyun Devarakonda"}),J.jsx("button",{onClick:t,className:"sm:hidden text-neutral-400 hover:text-white focus:outline-none","aria-label":"Toggle menu",children:J.jsx("img",{src:r?"assets/close.svg":"assets/menu.svg",alt:"menu",className:"w-6 h-6"})}),J.jsx("nav",{className:"hidden sm:block",children:J.jsx(l2,{})})]}),J.jsx("div",{className:`sm:hidden transition-all duration-300 ease-in-out overflow-hidden ${r?"max-h-screen":"max-h-0"}`,children:J.jsx("nav",{className:"px-4 pb-4",children:J.jsx(l2,{onClick:n})})})]})},AQ=()=>{const r=ne.useRef();return _h(({clock:e})=>{r.current&&(r.current.rotation.y=Math.sin(e.getElapsedTime()*.2)*.1,r.current.rotation.x=Math.cos(e.getElapsedTime()*.2)*.1)}),J.jsxs("group",{ref:r,children:[J.jsx(fM,{count:100,scale:[10,10,10],size:1,speed:.2,color:"#4cc9f0"}),J.jsx(fM,{count:50,scale:[8,8,8],size:2,speed:.1,color:"#7209b7"})]})},EQ=()=>J.jsxs("section",{className:"h-screen w-full relative",children:[J.jsxs(em,{camera:{position:[0,0,8],fov:75},className:"bg-[#1a1a2e]",children:[J.jsx("ambientLight",{intensity:.5}),J.jsx("pointLight",{position:[10,10,10],intensity:1}),J.jsx(AQ,{}),J.jsx(E0,{enableZoom:!1,enablePan:!1,autoRotate:!0,autoRotateSpeed:.5})]}),J.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center z-10",children:[J.jsx("h1",{className:"text-5xl font-bold text-white mb-4",children:"Creative Developer"}),J.jsx("p",{className:"text-xl text-[#4cc9f0]",children:"Blending Technology with Artistry"})]})]});function Bu(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function zU(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Uo={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_m={duration:.5,overwrite:!1,delay:0},EC,ts,gi,Hl=1e8,gs=1/Hl,mM=Math.PI*2,TQ=mM/4,MQ=0,VU=Math.sqrt,wQ=Math.cos,CQ=Math.sin,Gr=function(e){return typeof e=="string"},Ui=function(e){return typeof e=="function"},tc=function(e){return typeof e=="number"},TC=function(e){return typeof e>"u"},Kl=function(e){return typeof e=="object"},ao=function(e){return e!==!1},MC=function(){return typeof window<"u"},Jx=function(e){return Ui(e)||Gr(e)},WU=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},ys=Array.isArray,gM=/(?:-?\.?\d|\.)+/gi,jU=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Wp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ZE=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,KU=/[+-]=-?[.\d]+/,$U=/[^,'"\[\]\s]+/gi,bQ=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ti,Rl,vM,wC,zo={},vS={},XU,YU=function(e){return(vS=Sm(e,zo))&&ho},CC=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ov=function(e,t){return!t&&console.warn(e)},JU=function(e,t){return e&&(zo[e]=t)&&vS&&(vS[e]=t)||zo},av=function(){return 0},RQ={suppressEvents:!0,isStart:!0,kill:!1},g_={suppressEvents:!0,kill:!1},IQ={suppressEvents:!0},bC={},lh=[],yM={},qU,Io={},eT={},u2=30,v_=[],RC="",IC=function(e){var t=e[0],n,i;if(Kl(t)||Ui(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(i=v_.length;i--&&!v_[i].targetTest(t););n=v_[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new SN(e[i],n)))||e.splice(i,1);return e},Xf=function(e){return e._gsap||IC(pa(e))[0]._gsap},QU=function(e,t,n){return(n=e[t])&&Ui(n)?e[t]():TC(n)&&e.getAttribute&&e.getAttribute(t)||n},lo=function(e,t){return(e=e.split(",")).forEach(t)||e},Xi=function(e){return Math.round(e*1e5)/1e5||0},hr=function(e){return Math.round(e*1e7)/1e7||0},rm=function(e,t){var n=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),n==="+"?e+i:n==="-"?e-i:n==="*"?e*i:e/i},LQ=function(e,t){for(var n=t.length,i=0;e.indexOf(t[i])<0&&++i<n;);return i<n},yS=function(){var e=lh.length,t=lh.slice(0),n,i;for(yM={},lh.length=0,n=0;n<e;n++)i=t[n],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},LC=function(e){return!!(e._initted||e._startAt||e.add)},ZU=function(e,t,n,i){lh.length&&!ts&&yS(),e.render(t,n,!!(ts&&t<0&&LC(e))),lh.length&&!ts&&yS()},eN=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match($U).length<2?t:Gr(e)?e.trim():e},tN=function(e){return e},Vo=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},PQ=function(e){return function(t,n){for(var i in n)i in t||i==="duration"&&e||i==="ease"||(t[i]=n[i])}},Sm=function(e,t){for(var n in t)e[n]=t[n];return e},c2=function r(e,t){for(var n in t)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=Kl(t[n])?r(e[n]||(e[n]={}),t[n]):t[n]);return e},xS=function(e,t){var n={},i;for(i in e)i in t||(n[i]=e[i]);return n},b0=function(e){var t=e.parent||Ti,n=e.keyframes?PQ(ys(e.keyframes)):Vo;if(ao(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},DQ=function(e,t){for(var n=e.length,i=n===t.length;i&&n--&&e[n]===t[n];);return n<0},nN=function(e,t,n,i,s){var o=e[i],a;if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[i]=t,t._prev=o,t.parent=t._dp=e,t},bA=function(e,t,n,i){n===void 0&&(n="_first"),i===void 0&&(i="_last");var s=t._prev,o=t._next;s?s._next=o:e[n]===t&&(e[n]=o),o?o._prev=s:e[i]===t&&(e[i]=s),t._next=t._prev=t.parent=null},ph=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Yf=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},BQ=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},xM=function(e,t,n,i){return e._startAt&&(ts?e._startAt.revert(g_):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},FQ=function r(e){return!e||e._ts&&r(e.parent)},h2=function(e){return e._repeat?Am(e._tTime,e=e.duration()+e._rDelay)*e:0},Am=function(e,t){var n=Math.floor(e=hr(e/t));return e&&n===e?n-1:n},_S=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},RA=function(e){return e._end=hr(e._start+(e._tDur/Math.abs(e._ts||e._rts||gs)||0))},IA=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=hr(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),RA(e),n._dirty||Yf(n,e)),e},iN=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=_S(e.rawTime(),t),(!t._dur||kv(0,t.totalDuration(),n)-t._tTime>gs)&&t.render(n,!0)),Yf(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},Pl=function(e,t,n,i){return t.parent&&ph(t),t._start=hr((tc(n)?n:n||e!==Ti?aa(e,n,t):e._time)+t._delay),t._end=hr(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),nN(e,t,"_first","_last",e._sort?"_start":0),_M(t)||(e._recent=t),i||iN(e,t),e._ts<0&&IA(e,e._tTime),e},rN=function(e,t){return(zo.ScrollTrigger||CC("scrollTrigger",t))&&zo.ScrollTrigger.create(t,e)},sN=function(e,t,n,i,s){if(DC(e,t,s),!e._initted)return 1;if(!n&&e._pt&&!ts&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&qU!==Do.frame)return lh.push(e),e._lazy=[s,i],1},kQ=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},_M=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},OQ=function(e,t,n,i){var s=e.ratio,o=t<0||!t&&(!e._start&&kQ(e)&&!(!e._initted&&_M(e))||(e._ts<0||e._dp._ts<0)&&!_M(e))?0:1,a=e._rDelay,l=0,u,c,h;if(a&&e._repeat&&(l=kv(0,e._tDur,t),c=Am(l,a),e._yoyo&&c&1&&(o=1-o),c!==Am(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||ts||i||e._zTime===gs||!t&&e._zTime){if(!e._initted&&sN(e,t,i,n,l))return;for(h=e._zTime,e._zTime=t||(n?gs:0),n||(n=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,u=e._pt;u;)u.r(o,u.d),u=u._next;t<0&&xM(e,t,n,!0),e._onUpdate&&!n&&Fo(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&Fo(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&ph(e,1),!n&&!ts&&(Fo(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},UQ=function(e,t,n){var i;if(n>t)for(i=e._first;i&&i._start<=n;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=n;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},Em=function(e,t,n,i){var s=e._repeat,o=hr(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:hr(o*(s+1)+e._rDelay*s):o,a>0&&!i&&IA(e,e._tTime=e._tDur*a),e.parent&&RA(e),n||Yf(e.parent,e),e},f2=function(e){return e instanceof Us?Yf(e):Em(e,e._dur)},NQ={_start:0,endTime:av,totalDuration:av},aa=function r(e,t,n){var i=e.labels,s=e._recent||NQ,o=e.duration()>=Hl?s.endTime(!1):e._dur,a,l,u;return Gr(t)&&(isNaN(t)||t in i)?(l=t.charAt(0),u=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(u?(a<0?s:n).totalDuration()/100:1)):a<0?(t in i||(i[t]=o),i[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),u&&n&&(l=l/100*(ys(n)?n[0]:n).totalDuration()),a>1?r(e,t.substr(0,a-1),n)+l:o+l)):t==null?o:+t},R0=function(e,t,n){var i=tc(t[1]),s=(i?2:1)+(e<2?0:1),o=t[s],a,l;if(i&&(o.duration=t[1]),o.parent=n,e){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=ao(l.vars.inherit)&&l.parent;o.immediateRender=ao(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new cr(t[0],o,t[s+1])},Sh=function(e,t){return e||e===0?t(e):t},kv=function(e,t,n){return n<e?e:n>t?t:n},ps=function(e,t){return!Gr(e)||!(t=bQ.exec(e))?"":t[1]},GQ=function(e,t,n){return Sh(n,function(i){return kv(e,t,i)})},SM=[].slice,oN=function(e,t){return e&&Kl(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Kl(e[0]))&&!e.nodeType&&e!==Rl},HQ=function(e,t,n){return n===void 0&&(n=[]),e.forEach(function(i){var s;return Gr(i)&&!t||oN(i,1)?(s=n).push.apply(s,pa(i)):n.push(i)})||n},pa=function(e,t,n){return gi&&!t&&gi.selector?gi.selector(e):Gr(e)&&!n&&(vM||!Tm())?SM.call((t||wC).querySelectorAll(e),0):ys(e)?HQ(e,n):oN(e)?SM.call(e,0):e?[e]:[]},AM=function(e){return e=pa(e)[0]||ov("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return pa(t,n.querySelectorAll?n:n===e?ov("Invalid scope")||wC.createElement("div"):e)}},aN=function(e){return e.sort(function(){return .5-Math.random()})},lN=function(e){if(Ui(e))return e;var t=Kl(e)?e:{each:e},n=Jf(t.ease),i=t.from||0,s=parseFloat(t.base)||0,o={},a=i>0&&i<1,l=isNaN(i)||a,u=t.axis,c=i,h=i;return Gr(i)?c=h={center:.5,edges:.5,end:1}[i]||0:!a&&l&&(c=i[0],h=i[1]),function(d,m,g){var x=(g||t).length,_=o[x],S,T,E,C,R,P,L,F,D;if(!_){if(D=t.grid==="auto"?0:(t.grid||[1,Hl])[1],!D){for(L=-1e8;L<(L=g[D++].getBoundingClientRect().left)&&D<x;);D<x&&D--}for(_=o[x]=[],S=l?Math.min(D,x)*c-.5:i%D,T=D===Hl?0:l?x*h/D-.5:i/D|0,L=0,F=Hl,P=0;P<x;P++)E=P%D-S,C=T-(P/D|0),_[P]=R=u?Math.abs(u==="y"?C:E):VU(E*E+C*C),R>L&&(L=R),R<F&&(F=R);i==="random"&&aN(_),_.max=L-F,_.min=F,_.v=x=(parseFloat(t.amount)||parseFloat(t.each)*(D>x?x-1:u?u==="y"?x/D:D:Math.max(D,x/D))||0)*(i==="edges"?-1:1),_.b=x<0?s-x:s,_.u=ps(t.amount||t.each)||0,n=n&&x<0?yN(n):n}return x=(_[d]-_.min)/_.max||0,hr(_.b+(n?n(x):x)*_.v)+_.u}},EM=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var i=hr(Math.round(parseFloat(n)/e)*e*t);return(i-i%1)/t+(tc(n)?0:ps(n))}},uN=function(e,t){var n=ys(e),i,s;return!n&&Kl(e)&&(i=n=e.radius||Hl,e.values?(e=pa(e.values),(s=!tc(e[0]))&&(i*=i)):e=EM(e.increment)),Sh(t,n?Ui(e)?function(o){return s=e(o),Math.abs(s-o)<=i?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),u=Hl,c=0,h=e.length,d,m;h--;)s?(d=e[h].x-a,m=e[h].y-l,d=d*d+m*m):d=Math.abs(e[h]-a),d<u&&(u=d,c=h);return c=!i||u<=i?e[c]:o,s||c===o||tc(o)?c:c+ps(o)}:EM(e))},cN=function(e,t,n,i){return Sh(ys(e)?!t:n===!0?!!(n=0):!i,function(){return ys(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+n*.99))/n)*n*i)/i})},zQ=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){return t.reduce(function(s,o){return o(s)},i)}},VQ=function(e,t){return function(n){return e(parseFloat(n))+(t||ps(n))}},WQ=function(e,t,n){return fN(e,t,0,1,n)},hN=function(e,t,n){return Sh(n,function(i){return e[~~t(i)]})},jQ=function r(e,t,n){var i=t-e;return ys(e)?hN(e,r(0,e.length),t):Sh(n,function(s){return(i+(s-e)%i)%i+e})},KQ=function r(e,t,n){var i=t-e,s=i*2;return ys(e)?hN(e,r(0,e.length-1),t):Sh(n,function(o){return o=(s+(o-e)%s)%s||0,e+(o>i?s-o:o)})},lv=function(e){for(var t=0,n="",i,s,o,a;~(i=e.indexOf("random(",t));)o=e.indexOf(")",i),a=e.charAt(i+7)==="[",s=e.substr(i+7,o-i-7).match(a?$U:gM),n+=e.substr(t,i-t)+cN(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return n+e.substr(t,e.length-t)},fN=function(e,t,n,i,s){var o=t-e,a=i-n;return Sh(s,function(l){return n+((l-e)/o*a||0)})},$Q=function r(e,t,n,i){var s=isNaN(e+t)?0:function(m){return(1-m)*e+m*t};if(!s){var o=Gr(e),a={},l,u,c,h,d;if(n===!0&&(i=1)&&(n=null),o)e={p:e},t={p:t};else if(ys(e)&&!ys(t)){for(c=[],h=e.length,d=h-2,u=1;u<h;u++)c.push(r(e[u-1],e[u]));h--,s=function(g){g*=h;var x=Math.min(d,~~g);return c[x](g-x)},n=t}else i||(e=Sm(ys(e)?[]:{},e));if(!c){for(l in t)PC.call(a,e,l,"get",t[l]);s=function(g){return kC(g,a)||(o?e.p:e)}}}return Sh(n,s)},d2=function(e,t,n){var i=e.labels,s=Hl,o,a,l;for(o in i)a=i[o]-t,a<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},Fo=function(e,t,n){var i=e.vars,s=i[t],o=gi,a=e._ctx,l,u,c;if(s)return l=i[t+"Params"],u=i.callbackScope||e,n&&lh.length&&yS(),a&&(gi=a),c=l?s.apply(u,l):s.call(u),gi=o,c},a0=function(e){return ph(e),e.scrollTrigger&&e.scrollTrigger.kill(!!ts),e.progress()<1&&Fo(e,"onInterrupt"),e},jp,dN=[],pN=function(e){if(e)if(e=!e.name&&e.default||e,MC()||e.headless){var t=e.name,n=Ui(e),i=t&&!n&&e.init?function(){this._props=[]}:e,s={init:av,render:kC,add:PC,kill:uZ,modifier:lZ,rawVars:0},o={targetTest:0,get:0,getSetter:FC,aliases:{},register:0};if(Tm(),e!==i){if(Io[t])return;Vo(i,Vo(xS(e,s),o)),Sm(i.prototype,Sm(s,xS(e,o))),Io[i.prop=t]=i,e.targetTest&&(v_.push(i),bC[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}JU(t,i),e.register&&e.register(ho,i,uo)}else dN.push(e)},ei=255,l0={aqua:[0,ei,ei],lime:[0,ei,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ei],navy:[0,0,128],white:[ei,ei,ei],olive:[128,128,0],yellow:[ei,ei,0],orange:[ei,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ei,0,0],pink:[ei,192,203],cyan:[0,ei,ei],transparent:[ei,ei,ei,0]},tT=function(e,t,n){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*ei+.5|0},mN=function(e,t,n){var i=e?tc(e)?[e>>16,e>>8&ei,e&ei]:0:l0.black,s,o,a,l,u,c,h,d,m,g;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),l0[e])i=l0[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&ei,i&ei,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&ei,e&ei]}else if(e.substr(0,3)==="hsl"){if(i=g=e.match(gM),!t)l=+i[0]%360/360,u=+i[1]/100,c=+i[2]/100,o=c<=.5?c*(u+1):c+u-c*u,s=c*2-o,i.length>3&&(i[3]*=1),i[0]=tT(l+1/3,s,o),i[1]=tT(l,s,o),i[2]=tT(l-1/3,s,o);else if(~e.indexOf("="))return i=e.match(jU),n&&i.length<4&&(i[3]=1),i}else i=e.match(gM)||l0.transparent;i=i.map(Number)}return t&&!g&&(s=i[0]/ei,o=i[1]/ei,a=i[2]/ei,h=Math.max(s,o,a),d=Math.min(s,o,a),c=(h+d)/2,h===d?l=u=0:(m=h-d,u=c>.5?m/(2-h-d):m/(h+d),l=h===s?(o-a)/m+(o<a?6:0):h===o?(a-s)/m+2:(s-o)/m+4,l*=60),i[0]=~~(l+.5),i[1]=~~(u*100+.5),i[2]=~~(c*100+.5)),n&&i.length<4&&(i[3]=1),i},gN=function(e){var t=[],n=[],i=-1;return e.split(uh).forEach(function(s){var o=s.match(Wp)||[];t.push.apply(t,o),n.push(i+=o.length+1)}),t.c=n,t},p2=function(e,t,n){var i="",s=(e+i).match(uh),o=t?"hsla(":"rgba(",a=0,l,u,c,h;if(!s)return e;if(s=s.map(function(d){return(d=mN(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),n&&(c=gN(e),l=n.c,l.join(i)!==c.c.join(i)))for(u=e.replace(uh,"1").split(Wp),h=u.length-1;a<h;a++)i+=u[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(c.length?c:s.length?s:n).shift());if(!u)for(u=e.split(uh),h=u.length-1;a<h;a++)i+=u[a]+s[a];return i+u[h]},uh=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in l0)r+="|"+e+"\\b";return new RegExp(r+")","gi")}(),XQ=/hsl[a]?\(/,vN=function(e){var t=e.join(" "),n;if(uh.lastIndex=0,uh.test(t))return n=XQ.test(t),e[1]=p2(e[1],n),e[0]=p2(e[0],n,gN(e[1])),!0},uv,Do=function(){var r=Date.now,e=500,t=33,n=r(),i=n,s=1e3/240,o=s,a=[],l,u,c,h,d,m,g=function x(_){var S=r()-i,T=_===!0,E,C,R,P;if((S>e||S<0)&&(n+=S-t),i+=S,R=i-n,E=R-o,(E>0||T)&&(P=++h.frame,d=R-h.time*1e3,h.time=R=R/1e3,o+=E+(E>=s?4:s-E),C=1),T||(l=u(x)),C)for(m=0;m<a.length;m++)a[m](R,d,P,_)};return h={time:0,frame:0,tick:function(){g(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){XU&&(!vM&&MC()&&(Rl=vM=window,wC=Rl.document||{},zo.gsap=ho,(Rl.gsapVersions||(Rl.gsapVersions=[])).push(ho.version),YU(vS||Rl.GreenSockGlobals||!Rl.gsap&&Rl||{}),dN.forEach(pN)),c=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&h.sleep(),u=c||function(_){return setTimeout(_,o-h.time*1e3+1|0)},uv=1,g(2))},sleep:function(){(c?cancelAnimationFrame:clearTimeout)(l),uv=0,u=av},lagSmoothing:function(_,S){e=_||1/0,t=Math.min(S||33,e)},fps:function(_){s=1e3/(_||240),o=h.time*1e3+s},add:function(_,S,T){var E=S?function(C,R,P,L){_(C,R,P,L),h.remove(E)}:_;return h.remove(_),a[T?"unshift":"push"](E),Tm(),E},remove:function(_,S){~(S=a.indexOf(_))&&a.splice(S,1)&&m>=S&&m--},_listeners:a},h}(),Tm=function(){return!uv&&Do.wake()},Cn={},YQ=/^[\d.\-M][\d.\-,\s]/,JQ=/["']/g,qQ=function(e){for(var t={},n=e.substr(1,e.length-3).split(":"),i=n[0],s=1,o=n.length,a,l,u;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,u=l.substr(0,a),t[i]=isNaN(u)?u.replace(JQ,"").trim():+u,i=l.substr(a+1).trim();return t},QQ=function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<n?e.indexOf(")",n+1):n)},ZQ=function(e){var t=(e+"").split("("),n=Cn[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[qQ(t[1])]:QQ(e).split(",").map(eN)):Cn._CE&&YQ.test(e)?Cn._CE("",e):n},yN=function(e){return function(t){return 1-e(1-t)}},xN=function r(e,t){for(var n=e._first,i;n;)n instanceof Us?r(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?r(n.timeline,t):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=t)),n=n._next},Jf=function(e,t){return e&&(Ui(e)?e:Cn[e]||ZQ(e))||t},pd=function(e,t,n,i){n===void 0&&(n=function(l){return 1-t(1-l)}),i===void 0&&(i=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:n,easeInOut:i},o;return lo(e,function(a){Cn[a]=zo[a]=s,Cn[o=a.toLowerCase()]=n;for(var l in s)Cn[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=Cn[a+"."+l]=s[l]}),s},_N=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},nT=function r(e,t,n){var i=t>=1?t:1,s=(n||(e?.3:.45))/(t<1?t:1),o=s/mM*(Math.asin(1/i)||0),a=function(c){return c===1?1:i*Math.pow(2,-10*c)*CQ((c-o)*s)+1},l=e==="out"?a:e==="in"?function(u){return 1-a(1-u)}:_N(a);return s=mM/s,l.config=function(u,c){return r(e,u,c)},l},iT=function r(e,t){t===void 0&&(t=1.70158);var n=function(o){return o?--o*o*((t+1)*o+t)+1:0},i=e==="out"?n:e==="in"?function(s){return 1-n(1-s)}:_N(n);return i.config=function(s){return r(e,s)},i};lo("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;pd(r+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(n*2,t)/2:1-Math.pow((1-n)*2,t)/2})});Cn.Linear.easeNone=Cn.none=Cn.Linear.easeIn;pd("Elastic",nT("in"),nT("out"),nT());(function(r,e){var t=1/e,n=2*t,i=2.5*t,s=function(a){return a<t?r*a*a:a<n?r*Math.pow(a-1.5/e,2)+.75:a<i?r*(a-=2.25/e)*a+.9375:r*Math.pow(a-2.625/e,2)+.984375};pd("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);pd("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});pd("Circ",function(r){return-(VU(1-r*r)-1)});pd("Sine",function(r){return r===1?1:-wQ(r*TQ)+1});pd("Back",iT("in"),iT("out"),iT());Cn.SteppedEase=Cn.steps=zo.SteppedEase={config:function(e,t){e===void 0&&(e=1);var n=1/e,i=e+(t?0:1),s=t?1:0,o=1-gs;return function(a){return((i*kv(0,o,a)|0)+s)*n}}};_m.ease=Cn["quad.out"];lo("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return RC+=r+","+r+"Params,"});var SN=function(e,t){this.id=MQ++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:QU,this.set=t?t.getSetter:FC},cv=function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Em(this,+t.duration,1,1),this.data=t.data,gi&&(this._ctx=gi,gi.data.push(this)),uv||Do.wake()}var e=r.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,Em(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,i){if(Tm(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(IA(this,n),!s._dp||s.parent||iN(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Pl(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===gs||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),ZU(this,n,i)),this},e.time=function(n,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+h2(this))%(this._dur+this._rDelay)||(n?this._dur:0),i):this._time},e.totalProgress=function(n,i){return arguments.length?this.totalTime(this.totalDuration()*n,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(n,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+h2(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,i){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,i):this._repeat?Am(this._tTime,s)+1:1},e.timeScale=function(n,i){if(!arguments.length)return this._rts===-1e-8?0:this._rts;if(this._rts===n)return this;var s=this.parent&&this._ts?_S(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-1e-8?0:this._rts,this.totalTime(kv(-Math.abs(this._delay),this.totalDuration(),s),i!==!1),RA(this),BQ(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Tm(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==gs&&(this._tTime-=gs)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Pl(i,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(ao(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var i=this.parent||this._dp;return i?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_S(i.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=IQ);var i=ts;return ts=n,LC(this)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),ts=i,this},e.globalTime=function(n){for(var i=this,s=arguments.length?n:i.rawTime();i;)s=i._start+s/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,f2(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var i=this._time;return this._rDelay=n,f2(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,i){return this.totalTime(aa(this,n),ao(i))},e.restart=function(n,i){return this.play().totalTime(n?-this._delay:0,ao(i)),this._dur||(this._zTime=-1e-8),this},e.play=function(n,i){return n!=null&&this.seek(n,i),this.reversed(!1).paused(!1)},e.reverse=function(n,i){return n!=null&&this.seek(n||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(n,i){return n!=null&&this.seek(n,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var n=this.parent||this._dp,i=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=i&&s<this.endTime(!0)-gs)},e.eventCallback=function(n,i,s){var o=this.vars;return arguments.length>1?(i?(o[n]=i,s&&(o[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=i)):delete o[n],this):o[n]},e.then=function(n){var i=this;return new Promise(function(s){var o=Ui(n)?n:tN,a=function(){var u=i.then;i.then=null,Ui(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=u),s(o),i.then=u};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?a():i._prom=a})},e.kill=function(){a0(this)},r}();Vo(cv.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Us=function(r){zU(e,r);function e(n,i){var s;return n===void 0&&(n={}),s=r.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=ao(n.sortChildren),Ti&&Pl(n.parent||Ti,Bu(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&rN(Bu(s),n.scrollTrigger),s}var t=e.prototype;return t.to=function(i,s,o){return R0(0,arguments,this),this},t.from=function(i,s,o){return R0(1,arguments,this),this},t.fromTo=function(i,s,o,a){return R0(2,arguments,this),this},t.set=function(i,s,o){return s.duration=0,s.parent=this,b0(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new cr(i,s,aa(this,o),1),this},t.call=function(i,s,o){return Pl(this,cr.delayedCall(0,i,s),o)},t.staggerTo=function(i,s,o,a,l,u,c){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=u,o.onCompleteParams=c,o.parent=this,new cr(i,o,aa(this,l)),this},t.staggerFrom=function(i,s,o,a,l,u,c){return o.runBackwards=1,b0(o).immediateRender=ao(o.immediateRender),this.staggerTo(i,s,o,a,l,u,c)},t.staggerFromTo=function(i,s,o,a,l,u,c,h){return a.startAt=o,b0(a).immediateRender=ao(a.immediateRender),this.staggerTo(i,s,a,l,u,c,h)},t.render=function(i,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,u=this._dur,c=i<=0?0:hr(i),h=this._zTime<0!=i<0&&(this._initted||!u),d,m,g,x,_,S,T,E,C,R,P,L;if(this!==Ti&&c>l&&i>=0&&(c=l),c!==this._tTime||o||h){if(a!==this._time&&u&&(c+=this._time-a,i+=this._time-a),d=c,C=this._start,E=this._ts,S=!E,h&&(u||(a=this._zTime),(i||!s)&&(this._zTime=i)),this._repeat){if(P=this._yoyo,_=u+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(_*100+i,s,o);if(d=hr(c%_),c===l?(x=this._repeat,d=u):(R=hr(c/_),x=~~R,x&&x===R&&(d=u,x--),d>u&&(d=u)),R=Am(this._tTime,_),!a&&this._tTime&&R!==x&&this._tTime-R*_-this._dur<=0&&(R=x),P&&x&1&&(d=u-d,L=1),x!==R&&!this._lock){var F=P&&R&1,D=F===(P&&x&1);if(x<R&&(F=!F),a=F?0:c%u?u:c,this._lock=1,this.render(a||(L?0:hr(x*_)),s,!u)._lock=0,this._tTime=c,!s&&this.parent&&Fo(this,"onRepeat"),this.vars.repeatRefresh&&!L&&(this.invalidate()._lock=1),a&&a!==this._time||S!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(u=this._dur,l=this._tDur,D&&(this._lock=2,a=F?u:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!L&&this.invalidate()),this._lock=0,!this._ts&&!S)return this;xN(this,L)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(T=UQ(this,hr(a),hr(d)),T&&(c-=d-(d=T._start))),this._tTime=c,this._time=d,this._act=!E,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,a=0),!a&&c&&!s&&!R&&(Fo(this,"onStart"),this._tTime!==c))return this;if(d>=a&&i>=0)for(m=this._first;m;){if(g=m._next,(m._act||d>=m._start)&&m._ts&&T!==m){if(m.parent!==this)return this.render(i,s,o);if(m.render(m._ts>0?(d-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(d-m._start)*m._ts,s,o),d!==this._time||!this._ts&&!S){T=0,g&&(c+=this._zTime=-1e-8);break}}m=g}else{m=this._last;for(var I=i<0?i:d;m;){if(g=m._prev,(m._act||I<=m._end)&&m._ts&&T!==m){if(m.parent!==this)return this.render(i,s,o);if(m.render(m._ts>0?(I-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(I-m._start)*m._ts,s,o||ts&&LC(m)),d!==this._time||!this._ts&&!S){T=0,g&&(c+=this._zTime=I?-1e-8:gs);break}}m=g}}if(T&&!s&&(this.pause(),T.render(d>=a?0:-1e-8)._zTime=d>=a?1:-1,this._ts))return this._start=C,RA(this),this.render(i,s,o);this._onUpdate&&!s&&Fo(this,"onUpdate",!0),(c===l&&this._tTime>=this.totalDuration()||!c&&a)&&(C===this._start||Math.abs(E)!==Math.abs(this._ts))&&(this._lock||((i||!u)&&(c===l&&this._ts>0||!c&&this._ts<0)&&ph(this,1),!s&&!(i<0&&!a)&&(c||a||!l)&&(Fo(this,c===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,s){var o=this;if(tc(s)||(s=aa(this,s,i)),!(i instanceof cv)){if(ys(i))return i.forEach(function(a){return o.add(a,s)}),this;if(Gr(i))return this.addLabel(i,s);if(Ui(i))i=cr.delayedCall(0,i);else return this}return this!==i?Pl(this,i,s):this},t.getChildren=function(i,s,o,a){i===void 0&&(i=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-1e8);for(var l=[],u=this._first;u;)u._start>=a&&(u instanceof cr?s&&l.push(u):(o&&l.push(u),i&&l.push.apply(l,u.getChildren(!0,s,o)))),u=u._next;return l},t.getById=function(i){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===i)return s[o]},t.remove=function(i){return Gr(i)?this.removeLabel(i):Ui(i)?this.killTweensOf(i):(i.parent===this&&bA(this,i),i===this._recent&&(this._recent=this._last),Yf(this))},t.totalTime=function(i,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=hr(Do.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),r.prototype.totalTime.call(this,i,s),this._forcing=0,this):this._tTime},t.addLabel=function(i,s){return this.labels[i]=aa(this,s),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,s,o){var a=cr.delayedCall(0,s||av,o);return a.data="isPause",this._hasPause=1,Pl(this,a,aa(this,i))},t.removePause=function(i){var s=this._first;for(i=aa(this,i);s;)s._start===i&&s.data==="isPause"&&ph(s),s=s._next},t.killTweensOf=function(i,s,o){for(var a=this.getTweensOf(i,o),l=a.length;l--;)rh!==a[l]&&a[l].kill(i,s);return this},t.getTweensOf=function(i,s){for(var o=[],a=pa(i),l=this._first,u=tc(s),c;l;)l instanceof cr?LQ(l._targets,a)&&(u?(!rh||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(c=l.getTweensOf(a,s)).length&&o.push.apply(o,c),l=l._next;return o},t.tweenTo=function(i,s){s=s||{};var o=this,a=aa(o,i),l=s,u=l.startAt,c=l.onStart,h=l.onStartParams,d=l.immediateRender,m,g=cr.to(o,Vo({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(u&&"time"in u?u.time:o._time))/o.timeScale())||gs,onStart:function(){if(o.pause(),!m){var _=s.duration||Math.abs((a-(u&&"time"in u?u.time:o._time))/o.timeScale());g._dur!==_&&Em(g,_,0,1).render(g._time,!0,!0),m=1}c&&c.apply(g,h||[])}},s));return d?g.render(0):g},t.tweenFromTo=function(i,s,o){return this.tweenTo(s,Vo({startAt:{time:aa(this,i)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),d2(this,aa(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),d2(this,aa(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+gs)},t.shiftChildren=function(i,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,u;a;)a._start>=o&&(a._start+=i,a._end+=i),a=a._next;if(s)for(u in l)l[u]>=o&&(l[u]+=i);return Yf(this)},t.invalidate=function(i){var s=this._first;for(this._lock=0;s;)s.invalidate(i),s=s._next;return r.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),Yf(this)},t.totalDuration=function(i){var s=0,o=this,a=o._last,l=Hl,u,c,h;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-i:i));if(o._dirty){for(h=o.parent;a;)u=a._prev,a._dirty&&a.totalDuration(),c=a._start,c>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Pl(o,a,c-a._delay,1)._lock=0):l=c,c<0&&a._ts&&(s-=c,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=c/o._ts,o._time-=c,o._tTime-=c),o.shiftChildren(-c,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=u;Em(o,o===Ti&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(i){if(Ti._ts&&(ZU(Ti,_S(i,Ti)),qU=Do.frame),Do.frame>=u2){u2+=Uo.autoSleep||120;var s=Ti._first;if((!s||!s._ts)&&Uo.autoSleep&&Do._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Do.sleep()}}},e}(cv);Vo(Us.prototype,{_lock:0,_hasPause:0,_forcing:0});var eZ=function(e,t,n,i,s,o,a){var l=new uo(this._pt,e,t,0,1,CN,null,s),u=0,c=0,h,d,m,g,x,_,S,T;for(l.b=n,l.e=i,n+="",i+="",(S=~i.indexOf("random("))&&(i=lv(i)),o&&(T=[n,i],o(T,e,t),n=T[0],i=T[1]),d=n.match(ZE)||[];h=ZE.exec(i);)g=h[0],x=i.substring(u,h.index),m?m=(m+1)%5:x.substr(-5)==="rgba("&&(m=1),g!==d[c++]&&(_=parseFloat(d[c-1])||0,l._pt={_next:l._pt,p:x||c===1?x:",",s:_,c:g.charAt(1)==="="?rm(_,g)-_:parseFloat(g)-_,m:m&&m<4?Math.round:0},u=ZE.lastIndex);return l.c=u<i.length?i.substring(u,i.length):"",l.fp=a,(KU.test(i)||S)&&(l.e=0),this._pt=l,l},PC=function(e,t,n,i,s,o,a,l,u,c){Ui(i)&&(i=i(s||0,e,o));var h=e[t],d=n!=="get"?n:Ui(h)?u?e[t.indexOf("set")||!Ui(e["get"+t.substr(3)])?t:"get"+t.substr(3)](u):e[t]():h,m=Ui(h)?u?sZ:MN:BC,g;if(Gr(i)&&(~i.indexOf("random(")&&(i=lv(i)),i.charAt(1)==="="&&(g=rm(d,i)+(ps(d)||0),(g||g===0)&&(i=g))),!c||d!==i||TM)return!isNaN(d*i)&&i!==""?(g=new uo(this._pt,e,t,+d||0,i-(d||0),typeof h=="boolean"?aZ:wN,0,m),u&&(g.fp=u),a&&g.modifier(a,this,e),this._pt=g):(!h&&!(t in e)&&CC(t,i),eZ.call(this,e,t,d,i,m,l||Uo.stringFilter,u))},tZ=function(e,t,n,i,s){if(Ui(e)&&(e=I0(e,s,t,n,i)),!Kl(e)||e.style&&e.nodeType||ys(e)||WU(e))return Gr(e)?I0(e,s,t,n,i):e;var o={},a;for(a in e)o[a]=I0(e[a],s,t,n,i);return o},AN=function(e,t,n,i,s,o){var a,l,u,c;if(Io[e]&&(a=new Io[e]).init(s,a.rawVars?t[e]:tZ(t[e],i,s,o,n),n,i,o)!==!1&&(n._pt=l=new uo(n._pt,s,e,0,1,a.render,a,0,a.priority),n!==jp))for(u=n._ptLookup[n._targets.indexOf(s)],c=a._props.length;c--;)u[a._props[c]]=l;return a},rh,TM,DC=function r(e,t,n){var i=e.vars,s=i.ease,o=i.startAt,a=i.immediateRender,l=i.lazy,u=i.onUpdate,c=i.runBackwards,h=i.yoyoEase,d=i.keyframes,m=i.autoRevert,g=e._dur,x=e._startAt,_=e._targets,S=e.parent,T=S&&S.data==="nested"?S.vars.targets:_,E=e._overwrite==="auto"&&!EC,C=e.timeline,R,P,L,F,D,I,N,V,q,Q,re,ee,se;if(C&&(!d||!s)&&(s="none"),e._ease=Jf(s,_m.ease),e._yEase=h?yN(Jf(h===!0?s:h,_m.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!C&&!!i.runBackwards,!C||d&&!i.stagger){if(V=_[0]?Xf(_[0]).harness:0,ee=V&&i[V.prop],R=xS(i,bC),x&&(x._zTime<0&&x.progress(1),t<0&&c&&a&&!m?x.render(-1,!0):x.revert(c&&g?g_:RQ),x._lazy=0),o){if(ph(e._startAt=cr.set(_,Vo({data:"isStart",overwrite:!1,parent:S,immediateRender:!0,lazy:!x&&ao(l),startAt:null,delay:0,onUpdate:u&&function(){return Fo(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ts||!a&&!m)&&e._startAt.revert(g_),a&&g&&t<=0&&n<=0){t&&(e._zTime=t);return}}else if(c&&g&&!x){if(t&&(a=!1),L=Vo({overwrite:!1,data:"isFromStart",lazy:a&&!x&&ao(l),immediateRender:a,stagger:0,parent:S},R),ee&&(L[V.prop]=ee),ph(e._startAt=cr.set(_,L)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ts?e._startAt.revert(g_):e._startAt.render(-1,!0)),e._zTime=t,!a)r(e._startAt,gs,gs);else if(!t)return}for(e._pt=e._ptCache=0,l=g&&ao(l)||l&&!g,P=0;P<_.length;P++){if(D=_[P],N=D._gsap||IC(_)[P]._gsap,e._ptLookup[P]=Q={},yM[N.id]&&lh.length&&yS(),re=T===_?P:T.indexOf(D),V&&(q=new V).init(D,ee||R,e,re,T)!==!1&&(e._pt=F=new uo(e._pt,D,q.name,0,1,q.render,q,0,q.priority),q._props.forEach(function(W){Q[W]=F}),q.priority&&(I=1)),!V||ee)for(L in R)Io[L]&&(q=AN(L,R,e,re,D,T))?q.priority&&(I=1):Q[L]=F=PC.call(e,D,L,"get",R[L],re,T,0,i.stringFilter);e._op&&e._op[P]&&e.kill(D,e._op[P]),E&&e._pt&&(rh=e,Ti.killTweensOf(D,Q,e.globalTime(t)),se=!e.parent,rh=0),e._pt&&l&&(yM[N.id]=1)}I&&bN(e),e._onInit&&e._onInit(e)}e._onUpdate=u,e._initted=(!e._op||e._pt)&&!se,d&&t<=0&&C.render(Hl,!0,!0)},nZ=function(e,t,n,i,s,o,a,l){var u=(e._pt&&e._ptCache||(e._ptCache={}))[t],c,h,d,m;if(!u)for(u=e._ptCache[t]=[],d=e._ptLookup,m=e._targets.length;m--;){if(c=d[m][t],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==t&&c.fp!==t;)c=c._next;if(!c)return TM=1,e.vars[t]="+=0",DC(e,a),TM=0,l?ov(t+" not eligible for reset"):1;u.push(c)}for(m=u.length;m--;)h=u[m],c=h._pt||h,c.s=(i||i===0)&&!s?i:c.s+(i||0)+o*c.c,c.c=n-c.s,h.e&&(h.e=Xi(n)+ps(h.e)),h.b&&(h.b=c.s+ps(h.b))},iZ=function(e,t){var n=e[0]?Xf(e[0]).harness:0,i=n&&n.aliases,s,o,a,l;if(!i)return t;s=Sm({},t);for(o in i)if(o in s)for(l=i[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},rZ=function(e,t,n,i){var s=t.ease||i||"power1.inOut",o,a;if(ys(t))a=n[e]||(n[e]=[]),t.forEach(function(l,u){return a.push({t:u/(t.length-1)*100,v:l,e:s})});else for(o in t)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:s})},I0=function(e,t,n,i,s){return Ui(e)?e.call(t,n,i,s):Gr(e)&&~e.indexOf("random(")?lv(e):e},EN=RC+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",TN={};lo(EN+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return TN[r]=1});var cr=function(r){zU(e,r);function e(n,i,s,o){var a;typeof i=="number"&&(s.duration=i,i=s,s=null),a=r.call(this,o?i:b0(i))||this;var l=a.vars,u=l.duration,c=l.delay,h=l.immediateRender,d=l.stagger,m=l.overwrite,g=l.keyframes,x=l.defaults,_=l.scrollTrigger,S=l.yoyoEase,T=i.parent||Ti,E=(ys(n)||WU(n)?tc(n[0]):"length"in i)?[n]:pa(n),C,R,P,L,F,D,I,N;if(a._targets=E.length?IC(E):ov("GSAP target "+n+" not found. https://gsap.com",!Uo.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=m,g||d||Jx(u)||Jx(c)){if(i=a.vars,C=a.timeline=new Us({data:"nested",defaults:x||{},targets:T&&T.data==="nested"?T.vars.targets:E}),C.kill(),C.parent=C._dp=Bu(a),C._start=0,d||Jx(u)||Jx(c)){if(L=E.length,I=d&&lN(d),Kl(d))for(F in d)~EN.indexOf(F)&&(N||(N={}),N[F]=d[F]);for(R=0;R<L;R++)P=xS(i,TN),P.stagger=0,S&&(P.yoyoEase=S),N&&Sm(P,N),D=E[R],P.duration=+I0(u,Bu(a),R,D,E),P.delay=(+I0(c,Bu(a),R,D,E)||0)-a._delay,!d&&L===1&&P.delay&&(a._delay=c=P.delay,a._start+=c,P.delay=0),C.to(D,P,I?I(R,D,E):0),C._ease=Cn.none;C.duration()?u=c=0:a.timeline=0}else if(g){b0(Vo(C.vars.defaults,{ease:"none"})),C._ease=Jf(g.ease||i.ease||"none");var V=0,q,Q,re;if(ys(g))g.forEach(function(ee){return C.to(E,ee,">")}),C.duration();else{P={};for(F in g)F==="ease"||F==="easeEach"||rZ(F,g[F],P,g.easeEach);for(F in P)for(q=P[F].sort(function(ee,se){return ee.t-se.t}),V=0,R=0;R<q.length;R++)Q=q[R],re={ease:Q.e,duration:(Q.t-(R?q[R-1].t:0))/100*u},re[F]=Q.v,C.to(E,re,V),V+=re.duration;C.duration()<u&&C.to({},{duration:u-C.duration()})}}u||a.duration(u=C.duration())}else a.timeline=0;return m===!0&&!EC&&(rh=Bu(a),Ti.killTweensOf(E),rh=0),Pl(T,Bu(a),s),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(h||!u&&!g&&a._start===hr(T._time)&&ao(h)&&FQ(Bu(a))&&T.data!=="nested")&&(a._tTime=-1e-8,a.render(Math.max(0,-c)||0)),_&&rN(Bu(a),_),a}var t=e.prototype;return t.render=function(i,s,o){var a=this._time,l=this._tDur,u=this._dur,c=i<0,h=i>l-gs&&!c?l:i<gs?0:i,d,m,g,x,_,S,T,E,C;if(!u)OQ(this,i,s,o);else if(h!==this._tTime||!i||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c||this._lazy){if(d=h,E=this.timeline,this._repeat){if(x=u+this._rDelay,this._repeat<-1&&c)return this.totalTime(x*100+i,s,o);if(d=hr(h%x),h===l?(g=this._repeat,d=u):(_=hr(h/x),g=~~_,g&&g===_?(d=u,g--):d>u&&(d=u)),S=this._yoyo&&g&1,S&&(C=this._yEase,d=u-d),_=Am(this._tTime,x),d===a&&!o&&this._initted&&g===_)return this._tTime=h,this;g!==_&&(E&&this._yEase&&xN(E,S),this.vars.repeatRefresh&&!S&&!this._lock&&d!==x&&this._initted&&(this._lock=o=1,this.render(hr(x*g),!0).invalidate()._lock=0))}if(!this._initted){if(sN(this,c?i:d,o,s,h))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&g!==_))return this;if(u!==this._dur)return this.render(i,s,o)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=T=(C||this._ease)(d/u),this._from&&(this.ratio=T=1-T),!a&&h&&!s&&!_&&(Fo(this,"onStart"),this._tTime!==h))return this;for(m=this._pt;m;)m.r(T,m.d),m=m._next;E&&E.render(i<0?i:E._dur*E._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=i),this._onUpdate&&!s&&(c&&xM(this,i,s,o),Fo(this,"onUpdate")),this._repeat&&g!==_&&this.vars.onRepeat&&!s&&this.parent&&Fo(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(c&&!this._onUpdate&&xM(this,i,!0,!0),(i||!u)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&ph(this,1),!s&&!(c&&!a)&&(h||a||S)&&(Fo(this,h===l?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),r.prototype.invalidate.call(this,i)},t.resetTo=function(i,s,o,a,l){uv||Do.wake(),this._ts||this.play();var u=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||DC(this,u),c=this._ease(u/this._dur),nZ(this,i,s,o,a,c,u,l)?this.resetTo(i,s,o,a,1):(IA(this,0),this.parent||nN(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,s){if(s===void 0&&(s="all"),!i&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?a0(this):this.scrollTrigger&&this.scrollTrigger.kill(!!ts),this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(i,s,rh&&rh.vars.overwrite!==!0)._first||a0(this),this.parent&&o!==this.timeline.totalDuration()&&Em(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=i?pa(i):a,u=this._ptLookup,c=this._pt,h,d,m,g,x,_,S;if((!s||s==="all")&&DQ(a,l))return s==="all"&&(this._pt=0),a0(this);for(h=this._op=this._op||[],s!=="all"&&(Gr(s)&&(x={},lo(s,function(T){return x[T]=1}),s=x),s=iZ(a,s)),S=a.length;S--;)if(~l.indexOf(a[S])){d=u[S],s==="all"?(h[S]=s,g=d,m={}):(m=h[S]=h[S]||{},g=s);for(x in g)_=d&&d[x],_&&((!("kill"in _.d)||_.d.kill(x)===!0)&&bA(this,_,"_pt"),delete d[x]),m!=="all"&&(m[x]=1)}return this._initted&&!this._pt&&c&&a0(this),this},e.to=function(i,s){return new e(i,s,arguments[2])},e.from=function(i,s){return R0(1,arguments)},e.delayedCall=function(i,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(i,s,o){return R0(2,arguments)},e.set=function(i,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(i,s)},e.killTweensOf=function(i,s,o){return Ti.killTweensOf(i,s,o)},e}(cv);Vo(cr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});lo("staggerTo,staggerFrom,staggerFromTo",function(r){cr[r]=function(){var e=new Us,t=SM.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var BC=function(e,t,n){return e[t]=n},MN=function(e,t,n){return e[t](n)},sZ=function(e,t,n,i){return e[t](i.fp,n)},oZ=function(e,t,n){return e.setAttribute(t,n)},FC=function(e,t){return Ui(e[t])?MN:TC(e[t])&&e.setAttribute?oZ:BC},wN=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},aZ=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},CN=function(e,t){var n=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+i,n=n._next;i+=t.c}t.set(t.t,t.p,i,t)},kC=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},lZ=function(e,t,n,i){for(var s=this._pt,o;s;)o=s._next,s.p===i&&s.modifier(e,t,n),s=o},uZ=function(e){for(var t=this._pt,n,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?bA(this,t,"_pt"):t.dep||(n=1),t=i;return!n},cZ=function(e,t,n,i){i.mSet(e,t,i.m.call(i.tween,n,i.mt),i)},bN=function(e){for(var t=e._pt,n,i,s,o;t;){for(n=t._next,i=s;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:o)?t._prev._next=t:s=t,(t._next=i)?i._prev=t:o=t,t=n}e._pt=s},uo=function(){function r(t,n,i,s,o,a,l,u,c){this.t=n,this.s=s,this.c=o,this.p=i,this.r=a||wN,this.d=l||this,this.set=u||BC,this.pr=c||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(n,i,s){this.mSet=this.mSet||this.set,this.set=cZ,this.m=n,this.mt=s,this.tween=i},r}();lo(RC+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return bC[r]=1});zo.TweenMax=zo.TweenLite=cr;zo.TimelineLite=zo.TimelineMax=Us;Ti=new Us({sortChildren:!1,defaults:_m,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Uo.stringFilter=vN;var qf=[],y_={},hZ=[],m2=0,fZ=0,rT=function(e){return(y_[e]||hZ).map(function(t){return t()})},MM=function(){var e=Date.now(),t=[];e-m2>2&&(rT("matchMediaInit"),qf.forEach(function(n){var i=n.queries,s=n.conditions,o,a,l,u;for(a in i)o=Rl.matchMedia(i[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,u=1);u&&(n.revert(),l&&t.push(n))}),rT("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n,function(i){return n.add(null,i)})}),m2=e,rT("matchMedia"))},RN=function(){function r(t,n){this.selector=n&&AM(n),this.data=[],this._r=[],this.isReverted=!1,this.id=fZ++,t&&this.add(t)}var e=r.prototype;return e.add=function(n,i,s){Ui(n)&&(s=i,i=n,n=Ui);var o=this,a=function(){var u=gi,c=o.selector,h;return u&&u!==o&&u.data.push(o),s&&(o.selector=AM(s)),gi=o,h=i.apply(o,arguments),Ui(h)&&o._r.push(h),gi=u,o.selector=c,o.isReverted=!1,h};return o.last=a,n===Ui?a(o,function(l){return o.add(null,l)}):n?o[n]=a:a},e.ignore=function(n){var i=gi;gi=null,n(this),gi=i},e.getTweens=function(){var n=[];return this.data.forEach(function(i){return i instanceof r?n.push.apply(n,i.getTweens()):i instanceof cr&&!(i.parent&&i.parent.data==="nested")&&n.push(i)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,i){var s=this;if(n?function(){for(var a=s.getTweens(),l=s.data.length,u;l--;)u=s.data[l],u.data==="isFlip"&&(u.revert(),u.getChildren(!0,!0,!1).forEach(function(c){return a.splice(a.indexOf(c),1)}));for(a.map(function(c){return{g:c._dur||c._delay||c._sat&&!c._sat.vars.immediateRender?c.globalTime(0):-1/0,t:c}}).sort(function(c,h){return h.g-c.g||-1/0}).forEach(function(c){return c.t.revert(n)}),l=s.data.length;l--;)u=s.data[l],u instanceof Us?u.data!=="nested"&&(u.scrollTrigger&&u.scrollTrigger.revert(),u.kill()):!(u instanceof cr)&&u.revert&&u.revert(n);s._r.forEach(function(c){return c(n,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),i)for(var o=qf.length;o--;)qf[o].id===this.id&&qf.splice(o,1)},e.revert=function(n){this.kill(n||{})},r}(),dZ=function(){function r(t){this.contexts=[],this.scope=t,gi&&gi.data.push(this)}var e=r.prototype;return e.add=function(n,i,s){Kl(n)||(n={matches:n});var o=new RN(0,s||this.scope),a=o.conditions={},l,u,c;gi&&!o.selector&&(o.selector=gi.selector),this.contexts.push(o),i=o.add("onMatch",i),o.queries=n;for(u in n)u==="all"?c=1:(l=Rl.matchMedia(n[u]),l&&(qf.indexOf(o)<0&&qf.push(o),(a[u]=l.matches)&&(c=1),l.addListener?l.addListener(MM):l.addEventListener("change",MM)));return c&&i(o,function(h){return o.add(null,h)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(i){return i.kill(n,!0)})},r}(),SS={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(i){return pN(i)})},timeline:function(e){return new Us(e)},getTweensOf:function(e,t){return Ti.getTweensOf(e,t)},getProperty:function(e,t,n,i){Gr(e)&&(e=pa(e)[0]);var s=Xf(e||{}).get,o=n?tN:eN;return n==="native"&&(n=""),e&&(t?o((Io[t]&&Io[t].get||s)(e,t,n,i)):function(a,l,u){return o((Io[a]&&Io[a].get||s)(e,a,l,u))})},quickSetter:function(e,t,n){if(e=pa(e),e.length>1){var i=e.map(function(c){return ho.quickSetter(c,t,n)}),s=i.length;return function(c){for(var h=s;h--;)i[h](c)}}e=e[0]||{};var o=Io[t],a=Xf(e),l=a.harness&&(a.harness.aliases||{})[t]||t,u=o?function(c){var h=new o;jp._pt=0,h.init(e,n?c+n:c,jp,0,[e]),h.render(1,h),jp._pt&&kC(1,jp)}:a.set(e,l);return o?u:function(c){return u(e,l,n?c+n:c,a,1)}},quickTo:function(e,t,n){var i,s=ho.to(e,Vo((i={},i[t]="+=0.1",i.paused=!0,i.stagger=0,i),n||{})),o=function(l,u,c){return s.resetTo(t,l,u,c)};return o.tween=s,o},isTweening:function(e){return Ti.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Jf(e.ease,_m.ease)),c2(_m,e||{})},config:function(e){return c2(Uo,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,i=e.plugins,s=e.defaults,o=e.extendTimeline;(i||"").split(",").forEach(function(a){return a&&!Io[a]&&!zo[a]&&ov(t+" effect requires "+a+" plugin.")}),eT[t]=function(a,l,u){return n(pa(a),Vo(l||{},s),u)},o&&(Us.prototype[t]=function(a,l,u){return this.add(eT[t](a,Kl(l)?l:(u=l)&&{},this),u)})},registerEase:function(e,t){Cn[e]=Jf(t)},parseEase:function(e,t){return arguments.length?Jf(e,t):Cn},getById:function(e){return Ti.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var n=new Us(e),i,s;for(n.smoothChildTiming=ao(e.smoothChildTiming),Ti.remove(n),n._dp=0,n._time=n._tTime=Ti._time,i=Ti._first;i;)s=i._next,(t||!(!i._dur&&i instanceof cr&&i.vars.onComplete===i._targets[0]))&&Pl(n,i,i._start-i._delay),i=s;return Pl(Ti,n,0),n},context:function(e,t){return e?new RN(e,t):gi},matchMedia:function(e){return new dZ(e)},matchMediaRefresh:function(){return qf.forEach(function(e){var t=e.conditions,n,i;for(i in t)t[i]&&(t[i]=!1,n=1);n&&e.revert()})||MM()},addEventListener:function(e,t){var n=y_[e]||(y_[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=y_[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},utils:{wrap:jQ,wrapYoyo:KQ,distribute:lN,random:cN,snap:uN,normalize:WQ,getUnit:ps,clamp:GQ,splitColor:mN,toArray:pa,selector:AM,mapRange:fN,pipe:zQ,unitize:VQ,interpolate:$Q,shuffle:aN},install:YU,effects:eT,ticker:Do,updateRoot:Us.updateRoot,plugins:Io,globalTimeline:Ti,core:{PropTween:uo,globals:JU,Tween:cr,Timeline:Us,Animation:cv,getCache:Xf,_removeLinkedListItem:bA,reverting:function(){return ts},context:function(e){return e&&gi&&(gi.data.push(e),e._ctx=gi),gi},suppressOverwrites:function(e){return EC=e}}};lo("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return SS[r]=cr[r]});Do.add(Us.updateRoot);jp=SS.to({},{duration:0});var pZ=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},mZ=function(e,t){var n=e._targets,i,s,o;for(i in t)for(s=n.length;s--;)o=e._ptLookup[s][i],o&&(o=o.d)&&(o._pt&&(o=pZ(o,i)),o&&o.modifier&&o.modifier(t[i],e,n[s],i))},sT=function(e,t){return{name:e,headless:1,rawVars:1,init:function(i,s,o){o._onInit=function(a){var l,u;if(Gr(s)&&(l={},lo(s,function(c){return l[c]=1}),s=l),t){l={};for(u in s)l[u]=t(s[u]);s=l}mZ(a,s)}}}},ho=SS.registerPlugin({name:"attr",init:function(e,t,n,i,s){var o,a,l;this.tween=n;for(o in t)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",t[o],i,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var n=t._pt;n;)ts?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",headless:1,init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},sT("roundProps",EM),sT("modifiers"),sT("snap",uN))||SS;cr.version=Us.version=ho.version="3.13.0";XU=1;MC()&&Tm();Cn.Power0;Cn.Power1;Cn.Power2;Cn.Power3;Cn.Power4;Cn.Linear;Cn.Quad;Cn.Cubic;Cn.Quart;Cn.Quint;Cn.Strong;Cn.Elastic;Cn.Back;Cn.SteppedEase;Cn.Bounce;Cn.Sine;Cn.Expo;Cn.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var g2,sh,sm,OC,Of,v2,UC,gZ=function(){return typeof window<"u"},nc={},wf=180/Math.PI,om=Math.PI/180,Fp=Math.atan2,y2=1e8,NC=/([A-Z])/g,vZ=/(left|right|width|margin|padding|x)/i,yZ=/[\s,\(]\S/,kl={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},wM=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},xZ=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_Z=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},SZ=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},IN=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},LN=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},AZ=function(e,t,n){return e.style[t]=n},EZ=function(e,t,n){return e.style.setProperty(t,n)},TZ=function(e,t,n){return e._gsap[t]=n},MZ=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},wZ=function(e,t,n,i,s){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},CZ=function(e,t,n,i,s){var o=e._gsap;o[t]=n,o.renderTransform(s,o)},wi="transform",co=wi+"Origin",bZ=function r(e,t){var n=this,i=this.target,s=i.style,o=i._gsap;if(e in nc&&s){if(this.tfm=this.tfm||{},e!=="transform")e=kl[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return n.tfm[a]=ku(i,a)}):this.tfm[e]=o.x?o[e]:ku(i,e),e===co&&(this.tfm.zOrigin=o.zOrigin);else return kl.transform.split(",").forEach(function(a){return r.call(n,a,t)});if(this.props.indexOf(wi)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(co,t,"")),e=wi}(s||t)&&this.props.push(e,t,s[e])},PN=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},RZ=function(){var e=this.props,t=this.target,n=t.style,i=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(NC,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)i[o]=this.tfm[o];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=UC(),(!s||!s.isStart)&&!n[wi]&&(PN(n),i.zOrigin&&n[co]&&(n[co]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},DN=function(e,t){var n={target:e,props:[],revert:RZ,save:bZ};return e._gsap||ho.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(i){return n.save(i)}),n},BN,CM=function(e,t){var n=sh.createElementNS?sh.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):sh.createElement(e);return n&&n.style?n:sh.createElement(e)},ma=function r(e,t,n){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(NC,"-$1").toLowerCase())||i.getPropertyValue(t)||!n&&r(e,Mm(t)||t,1)||""},x2="O,Moz,ms,Ms,Webkit".split(","),Mm=function(e,t,n){var i=t||Of,s=i.style,o=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(x2[o]+e in s););return o<0?null:(o===3?"ms":o>=0?x2[o]:"")+e},bM=function(){gZ()&&window.document&&(g2=window,sh=g2.document,sm=sh.documentElement,Of=CM("div")||{style:{}},CM("div"),wi=Mm(wi),co=wi+"Origin",Of.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",BN=!!Mm("perspective"),UC=ho.core.reverting,OC=1)},_2=function(e){var t=e.ownerSVGElement,n=CM("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=e.cloneNode(!0),s;i.style.display="block",n.appendChild(i),sm.appendChild(n);try{s=i.getBBox()}catch{}return n.removeChild(i),sm.removeChild(n),s},S2=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},FN=function(e){var t,n;try{t=e.getBBox()}catch{t=_2(e),n=1}return t&&(t.width||t.height)||n||(t=_2(e)),t&&!t.width&&!t.x&&!t.y?{x:+S2(e,["x","cx","x1"])||0,y:+S2(e,["y","cy","y1"])||0,width:0,height:0}:t},kN=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&FN(e))},od=function(e,t){if(t){var n=e.style,i;t in nc&&t!==co&&(t=wi),n.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),n.removeProperty(i==="--"?t:t.replace(NC,"-$1").toLowerCase())):n.removeAttribute(t)}},oh=function(e,t,n,i,s,o){var a=new uo(e._pt,t,n,0,1,o?LN:IN);return e._pt=a,a.b=i,a.e=s,e._props.push(n),a},A2={deg:1,rad:1,turn:1},IZ={grid:1,flex:1},mh=function r(e,t,n,i){var s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=Of.style,l=vZ.test(t),u=e.tagName.toLowerCase()==="svg",c=(u?"client":"offset")+(l?"Width":"Height"),h=100,d=i==="px",m=i==="%",g,x,_,S;if(i===o||!s||A2[i]||A2[o])return s;if(o!=="px"&&!d&&(s=r(e,t,n,"px")),S=e.getCTM&&kN(e),(m||o==="%")&&(nc[t]||~t.indexOf("adius")))return g=S?e.getBBox()[l?"width":"height"]:e[c],Xi(m?s/g*h:s/100*g);if(a[l?"width":"height"]=h+(d?o:i),x=i!=="rem"&&~t.indexOf("adius")||i==="em"&&e.appendChild&&!u?e:e.parentNode,S&&(x=(e.ownerSVGElement||{}).parentNode),(!x||x===sh||!x.appendChild)&&(x=sh.body),_=x._gsap,_&&m&&_.width&&l&&_.time===Do.time&&!_.uncache)return Xi(s/_.width*h);if(m&&(t==="height"||t==="width")){var T=e.style[t];e.style[t]=h+i,g=e[c],T?e.style[t]=T:od(e,t)}else(m||o==="%")&&!IZ[ma(x,"display")]&&(a.position=ma(e,"position")),x===e&&(a.position="static"),x.appendChild(Of),g=Of[c],x.removeChild(Of),a.position="absolute";return l&&m&&(_=Xf(x),_.time=Do.time,_.width=x[c]),Xi(d?g*s/h:g&&s?h/g*s:0)},ku=function(e,t,n,i){var s;return OC||bM(),t in kl&&t!=="transform"&&(t=kl[t],~t.indexOf(",")&&(t=t.split(",")[0])),nc[t]&&t!=="transform"?(s=fv(e,i),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:ES(ma(e,co))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||i||~(s+"").indexOf("calc("))&&(s=AS[t]&&AS[t](e,t,n)||ma(e,t)||QU(e,t)||(t==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?mh(e,t,s,n)+n:s},LZ=function(e,t,n,i){if(!n||n==="none"){var s=Mm(t,e,1),o=s&&ma(e,s,1);o&&o!==n?(t=s,n=o):t==="borderColor"&&(n=ma(e,"borderTopColor"))}var a=new uo(this._pt,e.style,t,0,1,CN),l=0,u=0,c,h,d,m,g,x,_,S,T,E,C,R;if(a.b=n,a.e=i,n+="",i+="",i.substring(0,6)==="var(--"&&(i=ma(e,i.substring(4,i.indexOf(")")))),i==="auto"&&(x=e.style[t],e.style[t]=i,i=ma(e,t)||i,x?e.style[t]=x:od(e,t)),c=[n,i],vN(c),n=c[0],i=c[1],d=n.match(Wp)||[],R=i.match(Wp)||[],R.length){for(;h=Wp.exec(i);)_=h[0],T=i.substring(l,h.index),g?g=(g+1)%5:(T.substr(-5)==="rgba("||T.substr(-5)==="hsla(")&&(g=1),_!==(x=d[u++]||"")&&(m=parseFloat(x)||0,C=x.substr((m+"").length),_.charAt(1)==="="&&(_=rm(m,_)+C),S=parseFloat(_),E=_.substr((S+"").length),l=Wp.lastIndex-E.length,E||(E=E||Uo.units[t]||C,l===i.length&&(i+=E,a.e+=E)),C!==E&&(m=mh(e,t,x,E)||0),a._pt={_next:a._pt,p:T||u===1?T:",",s:m,c:S-m,m:g&&g<4||t==="zIndex"?Math.round:0});a.c=l<i.length?i.substring(l,i.length):""}else a.r=t==="display"&&i==="none"?LN:IN;return KU.test(i)&&(a.e=0),this._pt=a,a},E2={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},PZ=function(e){var t=e.split(" "),n=t[0],i=t[1]||"50%";return(n==="top"||n==="bottom"||i==="left"||i==="right")&&(e=n,n=i,i=e),t[0]=E2[n]||n,t[1]=E2[i]||i,t.join(" ")},DZ=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n=t.t,i=n.style,s=t.u,o=n._gsap,a,l,u;if(s==="all"||s===!0)i.cssText="",l=1;else for(s=s.split(","),u=s.length;--u>-1;)a=s[u],nc[a]&&(l=1,a=a==="transformOrigin"?co:wi),od(n,a);l&&(od(n,wi),o&&(o.svg&&n.removeAttribute("transform"),i.scale=i.rotate=i.translate="none",fv(n,1),o.uncache=1,PN(i)))}},AS={clearProps:function(e,t,n,i,s){if(s.data!=="isFromStart"){var o=e._pt=new uo(e._pt,t,n,0,0,DZ);return o.u=i,o.pr=-10,o.tween=s,e._props.push(n),1}}},hv=[1,0,0,1,0,0],ON={},UN=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},T2=function(e){var t=ma(e,wi);return UN(t)?hv:t.substr(7).match(jU).map(Xi)},GC=function(e,t){var n=e._gsap||Xf(e),i=e.style,s=T2(e),o,a,l,u;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?hv:s):(s===hv&&!e.offsetParent&&e!==sm&&!n.svg&&(l=i.display,i.display="block",o=e.parentNode,(!o||!e.offsetParent&&!e.getBoundingClientRect().width)&&(u=1,a=e.nextElementSibling,sm.appendChild(e)),s=T2(e),l?i.display=l:od(e,"display"),u&&(a?o.insertBefore(e,a):o?o.appendChild(e):sm.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},RM=function(e,t,n,i,s,o){var a=e._gsap,l=s||GC(e,!0),u=a.xOrigin||0,c=a.yOrigin||0,h=a.xOffset||0,d=a.yOffset||0,m=l[0],g=l[1],x=l[2],_=l[3],S=l[4],T=l[5],E=t.split(" "),C=parseFloat(E[0])||0,R=parseFloat(E[1])||0,P,L,F,D;n?l!==hv&&(L=m*_-g*x)&&(F=C*(_/L)+R*(-x/L)+(x*T-_*S)/L,D=C*(-g/L)+R*(m/L)-(m*T-g*S)/L,C=F,R=D):(P=FN(e),C=P.x+(~E[0].indexOf("%")?C/100*P.width:C),R=P.y+(~(E[1]||E[0]).indexOf("%")?R/100*P.height:R)),i||i!==!1&&a.smooth?(S=C-u,T=R-c,a.xOffset=h+(S*m+T*x)-S,a.yOffset=d+(S*g+T*_)-T):a.xOffset=a.yOffset=0,a.xOrigin=C,a.yOrigin=R,a.smooth=!!i,a.origin=t,a.originIsAbsolute=!!n,e.style[co]="0px 0px",o&&(oh(o,a,"xOrigin",u,C),oh(o,a,"yOrigin",c,R),oh(o,a,"xOffset",h,a.xOffset),oh(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",C+" "+R)},fv=function(e,t){var n=e._gsap||new SN(e);if("x"in n&&!t&&!n.uncache)return n;var i=e.style,s=n.scaleX<0,o="px",a="deg",l=getComputedStyle(e),u=ma(e,co)||"0",c,h,d,m,g,x,_,S,T,E,C,R,P,L,F,D,I,N,V,q,Q,re,ee,se,W,$,j,U,X,le,Z,oe;return c=h=d=x=_=S=T=E=C=0,m=g=1,n.svg=!!(e.getCTM&&kN(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[wi]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[wi]!=="none"?l[wi]:"")),i.scale=i.rotate=i.translate="none"),L=GC(e,n.svg),n.svg&&(n.uncache?(W=e.getBBox(),u=n.xOrigin-W.x+"px "+(n.yOrigin-W.y)+"px",se=""):se=!t&&e.getAttribute("data-svg-origin"),RM(e,se||u,!!se||n.originIsAbsolute,n.smooth!==!1,L)),R=n.xOrigin||0,P=n.yOrigin||0,L!==hv&&(N=L[0],V=L[1],q=L[2],Q=L[3],c=re=L[4],h=ee=L[5],L.length===6?(m=Math.sqrt(N*N+V*V),g=Math.sqrt(Q*Q+q*q),x=N||V?Fp(V,N)*wf:0,T=q||Q?Fp(q,Q)*wf+x:0,T&&(g*=Math.abs(Math.cos(T*om))),n.svg&&(c-=R-(R*N+P*q),h-=P-(R*V+P*Q))):(oe=L[6],le=L[7],j=L[8],U=L[9],X=L[10],Z=L[11],c=L[12],h=L[13],d=L[14],F=Fp(oe,X),_=F*wf,F&&(D=Math.cos(-F),I=Math.sin(-F),se=re*D+j*I,W=ee*D+U*I,$=oe*D+X*I,j=re*-I+j*D,U=ee*-I+U*D,X=oe*-I+X*D,Z=le*-I+Z*D,re=se,ee=W,oe=$),F=Fp(-q,X),S=F*wf,F&&(D=Math.cos(-F),I=Math.sin(-F),se=N*D-j*I,W=V*D-U*I,$=q*D-X*I,Z=Q*I+Z*D,N=se,V=W,q=$),F=Fp(V,N),x=F*wf,F&&(D=Math.cos(F),I=Math.sin(F),se=N*D+V*I,W=re*D+ee*I,V=V*D-N*I,ee=ee*D-re*I,N=se,re=W),_&&Math.abs(_)+Math.abs(x)>359.9&&(_=x=0,S=180-S),m=Xi(Math.sqrt(N*N+V*V+q*q)),g=Xi(Math.sqrt(ee*ee+oe*oe)),F=Fp(re,ee),T=Math.abs(F)>2e-4?F*wf:0,C=Z?1/(Z<0?-Z:Z):0),n.svg&&(se=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!UN(ma(e,wi)),se&&e.setAttribute("transform",se))),Math.abs(T)>90&&Math.abs(T)<270&&(s?(m*=-1,T+=x<=0?180:-180,x+=x<=0?180:-180):(g*=-1,T+=T<=0?180:-180)),t=t||n.uncache,n.x=c-((n.xPercent=c&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-c)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=h-((n.yPercent=h&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=d+o,n.scaleX=Xi(m),n.scaleY=Xi(g),n.rotation=Xi(x)+a,n.rotationX=Xi(_)+a,n.rotationY=Xi(S)+a,n.skewX=T+a,n.skewY=E+a,n.transformPerspective=C+o,(n.zOrigin=parseFloat(u.split(" ")[2])||!t&&n.zOrigin||0)&&(i[co]=ES(u)),n.xOffset=n.yOffset=0,n.force3D=Uo.force3D,n.renderTransform=n.svg?FZ:BN?NN:BZ,n.uncache=0,n},ES=function(e){return(e=e.split(" "))[0]+" "+e[1]},oT=function(e,t,n){var i=ps(t);return Xi(parseFloat(t)+parseFloat(mh(e,"x",n+"px",i)))+i},BZ=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,NN(e,t)},yf="0deg",Qg="0px",xf=") ",NN=function(e,t){var n=t||this,i=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,u=n.rotation,c=n.rotationY,h=n.rotationX,d=n.skewX,m=n.skewY,g=n.scaleX,x=n.scaleY,_=n.transformPerspective,S=n.force3D,T=n.target,E=n.zOrigin,C="",R=S==="auto"&&e&&e!==1||S===!0;if(E&&(h!==yf||c!==yf)){var P=parseFloat(c)*om,L=Math.sin(P),F=Math.cos(P),D;P=parseFloat(h)*om,D=Math.cos(P),o=oT(T,o,L*D*-E),a=oT(T,a,-Math.sin(P)*-E),l=oT(T,l,F*D*-E+E)}_!==Qg&&(C+="perspective("+_+xf),(i||s)&&(C+="translate("+i+"%, "+s+"%) "),(R||o!==Qg||a!==Qg||l!==Qg)&&(C+=l!==Qg||R?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+xf),u!==yf&&(C+="rotate("+u+xf),c!==yf&&(C+="rotateY("+c+xf),h!==yf&&(C+="rotateX("+h+xf),(d!==yf||m!==yf)&&(C+="skew("+d+", "+m+xf),(g!==1||x!==1)&&(C+="scale("+g+", "+x+xf),T.style[wi]=C||"translate(0, 0)"},FZ=function(e,t){var n=t||this,i=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,u=n.skewX,c=n.skewY,h=n.scaleX,d=n.scaleY,m=n.target,g=n.xOrigin,x=n.yOrigin,_=n.xOffset,S=n.yOffset,T=n.forceCSS,E=parseFloat(o),C=parseFloat(a),R,P,L,F,D;l=parseFloat(l),u=parseFloat(u),c=parseFloat(c),c&&(c=parseFloat(c),u+=c,l+=c),l||u?(l*=om,u*=om,R=Math.cos(l)*h,P=Math.sin(l)*h,L=Math.sin(l-u)*-d,F=Math.cos(l-u)*d,u&&(c*=om,D=Math.tan(u-c),D=Math.sqrt(1+D*D),L*=D,F*=D,c&&(D=Math.tan(c),D=Math.sqrt(1+D*D),R*=D,P*=D)),R=Xi(R),P=Xi(P),L=Xi(L),F=Xi(F)):(R=h,F=d,P=L=0),(E&&!~(o+"").indexOf("px")||C&&!~(a+"").indexOf("px"))&&(E=mh(m,"x",o,"px"),C=mh(m,"y",a,"px")),(g||x||_||S)&&(E=Xi(E+g-(g*R+x*L)+_),C=Xi(C+x-(g*P+x*F)+S)),(i||s)&&(D=m.getBBox(),E=Xi(E+i/100*D.width),C=Xi(C+s/100*D.height)),D="matrix("+R+","+P+","+L+","+F+","+E+","+C+")",m.setAttribute("transform",D),T&&(m.style[wi]=D)},kZ=function(e,t,n,i,s){var o=360,a=Gr(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?wf:1),u=l-i,c=i+u+"deg",h,d;return a&&(h=s.split("_")[1],h==="short"&&(u%=o,u!==u%(o/2)&&(u+=u<0?o:-360)),h==="cw"&&u<0?u=(u+o*y2)%o-~~(u/o)*o:h==="ccw"&&u>0&&(u=(u-o*y2)%o-~~(u/o)*o)),e._pt=d=new uo(e._pt,t,n,i,u,xZ),d.e=c,d.u="deg",e._props.push(n),d},M2=function(e,t){for(var n in t)e[n]=t[n];return e},OZ=function(e,t,n){var i=M2({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,u,c,h,d,m,g;i.svg?(u=n.getAttribute("transform"),n.setAttribute("transform",""),o[wi]=t,a=fv(n,1),od(n,wi),n.setAttribute("transform",u)):(u=getComputedStyle(n)[wi],o[wi]=t,a=fv(n,1),o[wi]=u);for(l in nc)u=i[l],c=a[l],u!==c&&s.indexOf(l)<0&&(m=ps(u),g=ps(c),h=m!==g?mh(n,l,u,g):parseFloat(u),d=parseFloat(c),e._pt=new uo(e._pt,a,l,h,d-h,wM),e._pt.u=g||0,e._props.push(l));M2(a,i)};lo("padding,margin,Width,Radius",function(r,e){var t="Top",n="Right",i="Bottom",s="Left",o=(e<3?[t,n,i,s]:[t+s,t+n,i+n,i+s]).map(function(a){return e<2?r+a:"border"+a+r});AS[e>1?"border"+r:r]=function(a,l,u,c,h){var d,m;if(arguments.length<4)return d=o.map(function(g){return ku(a,g,u)}),m=d.join(" "),m.split(d[0]).length===5?d[0]:m;d=(c+"").split(" "),m={},o.forEach(function(g,x){return m[g]=d[x]=d[x]||d[(x-1)/2|0]}),a.init(l,m,h)}});var GN={name:"css",register:bM,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,i,s){var o=this._props,a=e.style,l=n.vars.startAt,u,c,h,d,m,g,x,_,S,T,E,C,R,P,L,F;OC||bM(),this.styles=this.styles||DN(e),F=this.styles.props,this.tween=n;for(x in t)if(x!=="autoRound"&&(c=t[x],!(Io[x]&&AN(x,t,n,i,e,s)))){if(m=typeof c,g=AS[x],m==="function"&&(c=c.call(n,i,e,s),m=typeof c),m==="string"&&~c.indexOf("random(")&&(c=lv(c)),g)g(this,e,x,c,n)&&(L=1);else if(x.substr(0,2)==="--")u=(getComputedStyle(e).getPropertyValue(x)+"").trim(),c+="",uh.lastIndex=0,uh.test(u)||(_=ps(u),S=ps(c)),S?_!==S&&(u=mh(e,x,u,S)+S):_&&(c+=_),this.add(a,"setProperty",u,c,i,s,0,0,x),o.push(x),F.push(x,0,a[x]);else if(m!=="undefined"){if(l&&x in l?(u=typeof l[x]=="function"?l[x].call(n,i,e,s):l[x],Gr(u)&&~u.indexOf("random(")&&(u=lv(u)),ps(u+"")||u==="auto"||(u+=Uo.units[x]||ps(ku(e,x))||""),(u+"").charAt(1)==="="&&(u=ku(e,x))):u=ku(e,x),d=parseFloat(u),T=m==="string"&&c.charAt(1)==="="&&c.substr(0,2),T&&(c=c.substr(2)),h=parseFloat(c),x in kl&&(x==="autoAlpha"&&(d===1&&ku(e,"visibility")==="hidden"&&h&&(d=0),F.push("visibility",0,a.visibility),oh(this,a,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),x!=="scale"&&x!=="transform"&&(x=kl[x],~x.indexOf(",")&&(x=x.split(",")[0]))),E=x in nc,E){if(this.styles.save(x),m==="string"&&c.substring(0,6)==="var(--"&&(c=ma(e,c.substring(4,c.indexOf(")"))),h=parseFloat(c)),C||(R=e._gsap,R.renderTransform&&!t.parseTransform||fv(e,t.parseTransform),P=t.smoothOrigin!==!1&&R.smooth,C=this._pt=new uo(this._pt,a,wi,0,1,R.renderTransform,R,0,-1),C.dep=1),x==="scale")this._pt=new uo(this._pt,R,"scaleY",R.scaleY,(T?rm(R.scaleY,T+h):h)-R.scaleY||0,wM),this._pt.u=0,o.push("scaleY",x),x+="X";else if(x==="transformOrigin"){F.push(co,0,a[co]),c=PZ(c),R.svg?RM(e,c,0,P,0,this):(S=parseFloat(c.split(" ")[2])||0,S!==R.zOrigin&&oh(this,R,"zOrigin",R.zOrigin,S),oh(this,a,x,ES(u),ES(c)));continue}else if(x==="svgOrigin"){RM(e,c,1,P,0,this);continue}else if(x in ON){kZ(this,R,x,d,T?rm(d,T+c):c);continue}else if(x==="smoothOrigin"){oh(this,R,"smooth",R.smooth,c);continue}else if(x==="force3D"){R[x]=c;continue}else if(x==="transform"){OZ(this,c,e);continue}}else x in a||(x=Mm(x)||x);if(E||(h||h===0)&&(d||d===0)&&!yZ.test(c)&&x in a)_=(u+"").substr((d+"").length),h||(h=0),S=ps(c)||(x in Uo.units?Uo.units[x]:_),_!==S&&(d=mh(e,x,u,S)),this._pt=new uo(this._pt,E?R:a,x,d,(T?rm(d,T+h):h)-d,!E&&(S==="px"||x==="zIndex")&&t.autoRound!==!1?SZ:wM),this._pt.u=S||0,_!==S&&S!=="%"&&(this._pt.b=u,this._pt.r=_Z);else if(x in a)LZ.call(this,e,x,u,T?T+c:c);else if(x in e)this.add(e,x,u||e[x],T?T+c:c,i,s);else if(x!=="parseTransform"){CC(x,c);continue}E||(x in a?F.push(x,0,a[x]):typeof e[x]=="function"?F.push(x,2,e[x]()):F.push(x,1,u||e[x])),o.push(x)}}L&&bN(this)},render:function(e,t){if(t.tween._time||!UC())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:ku,aliases:kl,getSetter:function(e,t,n){var i=kl[t];return i&&i.indexOf(",")<0&&(t=i),t in nc&&t!==co&&(e._gsap.x||ku(e,"x"))?n&&v2===n?t==="scale"?MZ:TZ:(v2=n||{})&&(t==="scale"?wZ:CZ):e.style&&!TC(e.style[t])?AZ:~t.indexOf("-")?EZ:FC(e,t)},core:{_removeProperty:od,_getMatrix:GC}};ho.utils.checkPrefix=Mm;ho.core.getStyleSaver=DN;(function(r,e,t,n){var i=lo(r+","+e+","+t,function(s){nc[s]=1});lo(e,function(s){Uo.units[s]="deg",ON[s]=1}),kl[i[13]]=r+","+e,lo(n,function(s){var o=s.split(":");kl[o[1]]=i[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");lo("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){Uo.units[r]="px"});ho.registerPlugin(GN);var LA=ho.registerPlugin(GN)||ho;LA.core.Tween;/*!
 * @gsap/react 2.1.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let w2=typeof document<"u"?ne.useLayoutEffect:ne.useEffect,C2=r=>r&&!Array.isArray(r)&&typeof r=="object",qx=[],UZ={},HN=LA;const PA=(r,e=qx)=>{let t=UZ;C2(r)?(t=r,r=null,e="dependencies"in t?t.dependencies:qx):C2(e)&&(t=e,e="dependencies"in t?t.dependencies:qx),r&&typeof r!="function"&&console.warn("First parameter must be a function or config object");const{scope:n,revertOnUpdate:i}=t,s=ne.useRef(!1),o=ne.useRef(HN.context(()=>{},n)),a=ne.useRef(u=>o.current.add(null,u)),l=e&&e.length&&!i;return l&&w2(()=>(s.current=!0,()=>o.current.revert()),qx),w2(()=>{if(r&&o.current.add(r,n),!l||!s.current)return()=>o.current.revert()},e),{context:o.current,contextSafe:a.current}};PA.register=r=>{HN=r};PA.headless=!0;const NZ=()=>{const{progress:r}=mj();return J.jsxs(cj,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[J.jsx("span",{className:"canvas-loader"}),J.jsx("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:r!==0?`${r.toFixed(2)}%`:"Loading..."})]})},GZ=r=>{const e=ne.useRef(),{nodes:t,materials:n,animations:i}=oc("models/computer.glb"),{actions:s}=WJ(i,e),o=zJ(r.texture?r.texture:"textures/project/project-1.mov");return ne.useEffect(()=>{o&&(o.flipY=!1)},[o]),PA(()=>{LA.from(e.current.rotation,{y:Math.PI/2,duration:1,ease:"power3.out"})},[o]),J.jsx("group",{ref:e,...r,dispose:null,children:J.jsxs("group",{name:"Scene",children:[J.jsx("mesh",{name:"monitor-screen",geometry:t["monitor-screen"].geometry,material:t["monitor-screen"].material,position:[.127,1.831,.511],rotation:[1.571,-.005,.031],scale:[.661,.608,.401],children:J.jsx("meshBasicMaterial",{map:o,toneMapped:!1})}),J.jsxs("group",{name:"RootNode",position:[0,1.093,0],rotation:[-Math.PI/2,0,-.033],scale:.045,children:[J.jsx("group",{name:"Screen001",position:[5.658,1.643,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen002",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen003",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen004",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen005",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen006",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen007",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen008",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen009",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen010",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen011",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen012",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen013",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen014",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen015",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen016",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen017",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen018",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen019",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen020",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen021",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen022",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen023",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen024",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen025",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen026",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen027",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen028",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen029",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen030",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen031",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen032",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen033",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen034",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen035",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen036",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen037",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen038",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen039",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen040",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen041",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen042",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen043",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen044",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen045",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen046",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen047",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen048",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen049",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen050",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen051",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen052",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen053",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen054",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen055",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen056",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen057",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen058",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen059",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen060",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen061",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen062",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen063",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen064",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen065",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen066",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen067",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen068",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen069",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen070",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen071",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen072",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen073",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen074",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen075",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen076",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen077",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen078",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen079",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen080",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen081",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen082",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen083",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen084",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen085",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen086",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen087",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen088",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen089",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen090",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen091",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen092",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen093",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen094",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen095",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen096",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen097",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen098",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen099",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen100",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen101",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen102",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen103",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen104",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen105",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen106",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen107",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen108",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen109",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen110",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen111",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen112",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen113",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen114",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen115",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen116",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen117",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen118",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen119",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen120",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen121",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen122",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen123",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen124",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen125",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen126",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen127",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen128",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen129",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen130",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen131",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen132",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen133",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen134",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen135",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen136",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen137",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen138",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen139",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen140",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen141",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen142",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen143",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen144",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen145",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen146",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen147",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Screen148",position:[5.658,1.644,.812],rotation:[Math.PI/2,0,0],scale:[.923,.855,.855]}),J.jsx("group",{name:"Tower-light-007",position:[16.089,-3.47,-14.495],rotation:[Math.PI/2,0,0],scale:.963}),J.jsx("group",{name:"Tower-light-008",position:[15.155,-3.47,-14.495],rotation:[Math.PI/2,0,0],scale:.963})]}),J.jsxs("group",{name:"Monitor-B-_computer_0",position:[.266,1.132,.051],rotation:[0,-.033,0],scale:[.042,.045,.045],children:[J.jsx("mesh",{name:"Monitor-B-_computer_0_1",geometry:t["Monitor-B-_computer_0_1"].geometry,material:n.computer}),J.jsx("mesh",{name:"Monitor-B-_computer_0_2",geometry:t["Monitor-B-_computer_0_2"].geometry,material:n.base__0}),J.jsx("mesh",{name:"Monitor-B-_computer_0_3",geometry:t["Monitor-B-_computer_0_3"].geometry,material:n.Material_36}),J.jsx("mesh",{name:"Monitor-B-_computer_0_4",geometry:t["Monitor-B-_computer_0_4"].geometry,material:n.Material_35}),J.jsx("mesh",{name:"Monitor-B-_computer_0_5",geometry:t["Monitor-B-_computer_0_5"].geometry,material:n.Material_34}),J.jsx("mesh",{name:"Monitor-B-_computer_0_6",geometry:t["Monitor-B-_computer_0_6"].geometry,material:n.keys}),J.jsx("mesh",{name:"Monitor-B-_computer_0_7",geometry:t["Monitor-B-_computer_0_7"].geometry,material:n.keys2}),J.jsx("mesh",{name:"Monitor-B-_computer_0_8",geometry:t["Monitor-B-_computer_0_8"].geometry,material:n.Material_37})]})]})})};oc.preload("models/computer.glb");const b2=HU.length,HZ=()=>{const[r,e]=ne.useState(0),t=i=>{e(s=>i==="previous"?s===0?b2-1:s-1:s===b2-1?0:s+1)};PA(()=>{LA.fromTo(".animatedText",{opacity:0},{opacity:1,duration:1,stagger:.2,ease:"power2.inOut"})},[r]);const n=HU[r];return J.jsxs("section",{className:"c-space my-20",children:[J.jsx("p",{className:"head-text",children:"My Projects"}),J.jsxs("div",{className:"grid lg:grid-cols-2 grid-cols-1 mt-12 gap-5 w-full",children:[J.jsxs("div",{className:"flex flex-col gap-5 relative sm:p-10 py-10 px-5 shadow-2xl shadow-black-200",children:[J.jsx("div",{className:"absolute top-0 right-0",children:J.jsx("img",{src:n.spotlight,alt:"spotlight",className:"w-full h-96 object-cover rounded-xl"})}),J.jsx("div",{className:"p-3 backdrop-filter backdrop-blur-3xl w-fit rounded-lg",style:n.logoStyle,children:J.jsx("img",{className:"w-30 h-10 shadow-sm ",src:n.logo,alt:"logo"})}),J.jsxs("div",{className:"flex flex-col gap-5 text-white-600 my-5",children:[J.jsx("p",{className:"text-white text-2xl font-semibold animatedText",children:n.title}),J.jsx("p",{className:"animatedText",children:n.desc}),J.jsx("p",{className:"animatedText",children:n.subdesc})]}),J.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-5",children:[J.jsx("div",{className:"flex items-center gap-3",children:n.tags.map((i,s)=>J.jsx("div",{className:"tech-logo",children:i.name!=="Redis"?J.jsx("img",{src:i.path,alt:i.name,height:"full",width:"full"}):J.jsx("img",{src:i.path,alt:i.name,height:"100px",width:"100px"})},s))}),J.jsxs("a",{className:"flex items-center gap-2 cursor-pointer text-white-600",href:n.href,target:"_blank",rel:"noreferrer",children:[J.jsx("p",{children:"Check Live Site"}),J.jsx("img",{src:"assets/arrow-up.png",alt:"arrow",className:"w-3 h-3"})]})]}),J.jsxs("div",{className:"flex justify-between items-center mt-7",children:[J.jsx("button",{className:"arrow-btn",onClick:()=>t("previous"),children:J.jsx("img",{src:"assets/left-arrow.png",alt:"left arrow"})}),J.jsx("button",{className:"arrow-btn",onClick:()=>t("next"),children:J.jsx("img",{src:"assets/right-arrow.png",alt:"right arrow",className:"w-4 h-4"})})]})]}),J.jsx("div",{className:"border border-black-300 bg-black-200 rounded-lg h-96 md:h-full",children:J.jsxs(em,{children:[J.jsx("ambientLight",{intensity:Math.PI}),J.jsx("directionalLight",{position:[10,10,5]}),J.jsx(jJ,{children:J.jsx(ne.Suspense,{fallback:J.jsx(NZ,{}),children:J.jsx("group",{scale:2,position:[0,-3,0],rotation:[0,-.1,0],children:J.jsx(GZ,{texture:n.texture})})})}),J.jsx(E0,{maxPolarAngle:Math.PI/2,enableZoom:!1})]})})]})]})},zN=ne.createContext({});function DA(r){const e=ne.useRef(null);return e.current===null&&(e.current=r()),e.current}const HC=ne.createContext(null),zC=ne.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});function zZ(r=!0){const e=ne.useContext(HC);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:i}=e,s=ne.useId();ne.useEffect(()=>{r&&i(s)},[r]);const o=ne.useCallback(()=>r&&n&&n(s),[s,n,r]);return!t&&n?[!1,o]:[!0]}const VC=typeof window<"u",WC=VC?ne.useLayoutEffect:ne.useEffect,Gs=r=>r;let VZ=Gs,VN=Gs;function jC(r){let e;return()=>(e===void 0&&(e=r()),e)}const ad=(r,e,t)=>{const n=e-r;return n===0?1:(t-r)/n},$u=r=>r*1e3,Xu=r=>r/1e3,WZ={useManualTiming:!1};function jZ(r){let e=new Set,t=new Set,n=!1,i=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(u){s.has(u)&&(l.schedule(u),r()),u(o)}const l={schedule:(u,c=!1,h=!1)=>{const m=h&&n?e:t;return c&&s.add(u),m.has(u)||m.add(u),u},cancel:u=>{t.delete(u),s.delete(u)},process:u=>{if(o=u,n){i=!0;return}n=!0,[e,t]=[t,e],e.forEach(a),e.clear(),n=!1,i&&(i=!1,l.process(u))}};return l}const Qx=["read","resolveKeyframes","update","preRender","render","postRender"],KZ=40;function WN(r,e){let t=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Qx.reduce((S,T)=>(S[T]=jZ(s),S),{}),{read:a,resolveKeyframes:l,update:u,preRender:c,render:h,postRender:d}=o,m=()=>{const S=performance.now();t=!1,i.delta=n?1e3/60:Math.max(Math.min(S-i.timestamp,KZ),1),i.timestamp=S,i.isProcessing=!0,a.process(i),l.process(i),u.process(i),c.process(i),h.process(i),d.process(i),i.isProcessing=!1,t&&e&&(n=!1,r(m))},g=()=>{t=!0,n=!0,i.isProcessing||r(m)};return{schedule:Qx.reduce((S,T)=>{const E=o[T];return S[T]=(C,R=!1,P=!1)=>(t||g(),E.schedule(C,R,P)),S},{}),cancel:S=>{for(let T=0;T<Qx.length;T++)o[Qx[T]].cancel(S)},state:i,steps:o}}const{schedule:Hn,cancel:nl,state:Or,steps:aT}=WN(typeof requestAnimationFrame<"u"?requestAnimationFrame:Gs,!0),jN=ne.createContext({strict:!1}),R2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},wm={};for(const r in R2)wm[r]={isEnabled:e=>R2[r].some(t=>!!e[t])};function $Z(r){for(const e in r)wm[e]={...wm[e],...r[e]}}const XZ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function TS(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||XZ.has(r)}let KN=r=>!TS(r);function YZ(r){r&&(KN=e=>e.startsWith("on")?!TS(e):r(e))}try{YZ(require("@emotion/is-prop-valid").default)}catch{}function JZ(r,e,t){const n={};for(const i in r)i==="values"&&typeof r.values=="object"||(KN(i)||t===!0&&TS(i)||!e&&!TS(i)||r.draggable&&i.startsWith("onDrag"))&&(n[i]=r[i]);return n}function qZ(r){if(typeof Proxy>"u")return r;const e=new Map,t=(...n)=>r(...n);return new Proxy(t,{get:(n,i)=>i==="create"?r:(e.has(i)||e.set(i,r(i)),e.get(i))})}const BA=ne.createContext({});function dv(r){return typeof r=="string"||Array.isArray(r)}function FA(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}const KC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],$C=["initial",...KC];function kA(r){return FA(r.animate)||$C.some(e=>dv(r[e]))}function $N(r){return!!(kA(r)||r.variants)}function QZ(r,e){if(kA(r)){const{initial:t,animate:n}=r;return{initial:t===!1||dv(t)?t:void 0,animate:dv(n)?n:void 0}}return r.inherit!==!1?e:{}}function ZZ(r){const{initial:e,animate:t}=QZ(r,ne.useContext(BA));return ne.useMemo(()=>({initial:e,animate:t}),[I2(e),I2(t)])}function I2(r){return Array.isArray(r)?r.join(" "):r}const eee=Symbol.for("motionComponentSymbol");function Kp(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function tee(r,e,t){return ne.useCallback(n=>{n&&r.onMount&&r.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):Kp(t)&&(t.current=n))},[e])}const XC=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),nee="framerAppearId",XN="data-"+XC(nee),{schedule:YC}=WN(queueMicrotask,!1),YN=ne.createContext({});function iee(r,e,t,n,i){var s,o;const{visualElement:a}=ne.useContext(BA),l=ne.useContext(jN),u=ne.useContext(HC),c=ne.useContext(zC).reducedMotion,h=ne.useRef(null);n=n||l.renderer,!h.current&&n&&(h.current=n(r,{visualState:e,parent:a,props:t,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:c}));const d=h.current,m=ne.useContext(YN);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&ree(h.current,t,i,m);const g=ne.useRef(!1);ne.useInsertionEffect(()=>{d&&g.current&&d.update(t,u)});const x=t[XN],_=ne.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,x)));return WC(()=>{d&&(g.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),YC.render(d.render),_.current&&d.animationState&&d.animationState.animateChanges())}),ne.useEffect(()=>{d&&(!_.current&&d.animationState&&d.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)===null||S===void 0||S.call(window,x)}),_.current=!1))}),d}function ree(r,e,t,n){const{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:u}=e;r.projection=new t(r.latestValues,e["data-framer-portal-id"]?void 0:JN(r.parent)),r.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&Kp(a),visualElement:r,animationType:typeof s=="string"?s:"both",initialPromotionConfig:n,layoutScroll:l,layoutRoot:u})}function JN(r){if(r)return r.options.allowProjection!==!1?r.projection:JN(r.parent)}function see({preloadedFeatures:r,createVisualElement:e,useRender:t,useVisualState:n,Component:i}){var s,o;r&&$Z(r);function a(u,c){let h;const d={...ne.useContext(zC),...u,layoutId:oee(u)},{isStatic:m}=d,g=ZZ(u),x=n(u,m);if(!m&&VC){aee();const _=lee(d);h=_.MeasureLayout,g.visualElement=iee(i,x,d,e,_.ProjectionNode)}return J.jsxs(BA.Provider,{value:g,children:[h&&g.visualElement?J.jsx(h,{visualElement:g.visualElement,...d}):null,t(i,u,tee(x,g.visualElement,c),x,m,g.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&o!==void 0?o:""})`}`;const l=ne.forwardRef(a);return l[eee]=i,l}function oee({layoutId:r}){const e=ne.useContext(zN).id;return e&&r!==void 0?e+"-"+r:r}function aee(r,e){ne.useContext(jN).strict}function lee(r){const{drag:e,layout:t}=wm;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(r)||t!=null&&t.isEnabled(r)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const uee=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function JC(r){return typeof r!="string"||r.includes("-")?!1:!!(uee.indexOf(r)>-1||/[A-Z]/u.test(r))}function L2(r){const e=[{},{}];return r==null||r.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function qC(r,e,t,n){if(typeof e=="function"){const[i,s]=L2(n);e=e(t!==void 0?t:r.custom,i,s)}if(typeof e=="string"&&(e=r.variants&&r.variants[e]),typeof e=="function"){const[i,s]=L2(n);e=e(t!==void 0?t:r.custom,i,s)}return e}const IM=r=>Array.isArray(r),cee=r=>!!(r&&typeof r=="object"&&r.mix&&r.toValue),hee=r=>IM(r)?r[r.length-1]||0:r,vs=r=>!!(r&&r.getVelocity);function x_(r){const e=vs(r)?r.get():r;return cee(e)?e.toValue():e}function fee({scrapeMotionValuesFromProps:r,createRenderState:e,onUpdate:t},n,i,s){const o={latestValues:dee(n,i,s,r),renderState:e()};return t&&(o.onMount=a=>t({props:n,current:a,...o}),o.onUpdate=a=>t(a)),o}const qN=r=>(e,t)=>{const n=ne.useContext(BA),i=ne.useContext(HC),s=()=>fee(r,e,n,i);return t?s():DA(s)};function dee(r,e,t,n){const i={},s=n(r,{});for(const d in s)i[d]=x_(s[d]);let{initial:o,animate:a}=r;const l=kA(r),u=$N(r);e&&u&&!l&&r.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let c=t?t.initial===!1:!1;c=c||o===!1;const h=c?a:o;if(h&&typeof h!="boolean"&&!FA(h)){const d=Array.isArray(h)?h:[h];for(let m=0;m<d.length;m++){const g=qC(r,d[m]);if(g){const{transitionEnd:x,transition:_,...S}=g;for(const T in S){let E=S[T];if(Array.isArray(E)){const C=c?E.length-1:0;E=E[C]}E!==null&&(i[T]=E)}for(const T in x)i[T]=x[T]}}}return i}const km=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],md=new Set(km),QN=r=>e=>typeof e=="string"&&e.startsWith(r),ZN=QN("--"),pee=QN("var(--"),QC=r=>pee(r)?mee.test(r.split("/*")[0].trim()):!1,mee=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,e3=(r,e)=>e&&typeof r=="number"?e.transform(r):r,$l=(r,e,t)=>t>e?e:t<r?r:t,Om={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},pv={...Om,transform:r=>$l(0,1,r)},Zx={...Om,default:1},Ov=r=>({test:e=>typeof e=="string"&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),Zc=Ov("deg"),zl=Ov("%"),qt=Ov("px"),gee=Ov("vh"),vee=Ov("vw"),P2={...zl,parse:r=>zl.parse(r)/100,transform:r=>zl.transform(r*100)},yee={borderWidth:qt,borderTopWidth:qt,borderRightWidth:qt,borderBottomWidth:qt,borderLeftWidth:qt,borderRadius:qt,radius:qt,borderTopLeftRadius:qt,borderTopRightRadius:qt,borderBottomRightRadius:qt,borderBottomLeftRadius:qt,width:qt,maxWidth:qt,height:qt,maxHeight:qt,top:qt,right:qt,bottom:qt,left:qt,padding:qt,paddingTop:qt,paddingRight:qt,paddingBottom:qt,paddingLeft:qt,margin:qt,marginTop:qt,marginRight:qt,marginBottom:qt,marginLeft:qt,backgroundPositionX:qt,backgroundPositionY:qt},xee={rotate:Zc,rotateX:Zc,rotateY:Zc,rotateZ:Zc,scale:Zx,scaleX:Zx,scaleY:Zx,scaleZ:Zx,skew:Zc,skewX:Zc,skewY:Zc,distance:qt,translateX:qt,translateY:qt,translateZ:qt,x:qt,y:qt,z:qt,perspective:qt,transformPerspective:qt,opacity:pv,originX:P2,originY:P2,originZ:qt},D2={...Om,transform:Math.round},ZC={...yee,...xee,zIndex:D2,size:qt,fillOpacity:pv,strokeOpacity:pv,numOctaves:D2},_ee={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},See=km.length;function Aee(r,e,t){let n="",i=!0;for(let s=0;s<See;s++){const o=km[s],a=r[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||t){const u=e3(a,ZC[o]);if(!l){i=!1;const c=_ee[o]||o;n+=`${c}(${u}) `}t&&(e[o]=u)}}return n=n.trim(),t?n=t(e,i?"":n):i&&(n="none"),n}function eb(r,e,t){const{style:n,vars:i,transformOrigin:s}=r;let o=!1,a=!1;for(const l in e){const u=e[l];if(md.has(l)){o=!0;continue}else if(ZN(l)){i[l]=u;continue}else{const c=e3(u,ZC[l]);l.startsWith("origin")?(a=!0,s[l]=c):n[l]=c}}if(e.transform||(o||t?n.transform=Aee(e,r.transform,t):n.transform&&(n.transform="none")),a){const{originX:l="50%",originY:u="50%",originZ:c=0}=s;n.transformOrigin=`${l} ${u} ${c}`}}const Eee={offset:"stroke-dashoffset",array:"stroke-dasharray"},Tee={offset:"strokeDashoffset",array:"strokeDasharray"};function Mee(r,e,t=1,n=0,i=!0){r.pathLength=1;const s=i?Eee:Tee;r[s.offset]=qt.transform(-n);const o=qt.transform(e),a=qt.transform(t);r[s.array]=`${o} ${a}`}function B2(r,e,t){return typeof r=="string"?r:qt.transform(e+t*r)}function wee(r,e,t){const n=B2(e,r.x,r.width),i=B2(t,r.y,r.height);return`${n} ${i}`}function tb(r,{attrX:e,attrY:t,attrScale:n,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...u},c,h){if(eb(r,u,h),c){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:d,style:m,dimensions:g}=r;d.transform&&(g&&(m.transform=d.transform),delete d.transform),g&&(i!==void 0||s!==void 0||m.transform)&&(m.transformOrigin=wee(g,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(d.x=e),t!==void 0&&(d.y=t),n!==void 0&&(d.scale=n),o!==void 0&&Mee(d,o,a,l,!1)}const nb=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),t3=()=>({...nb(),attrs:{}}),ib=r=>typeof r=="string"&&r.toLowerCase()==="svg";function n3(r,{style:e,vars:t},n,i){Object.assign(r.style,e,i&&i.getProjectionStyles(n));for(const s in t)r.style.setProperty(s,t[s])}const i3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function r3(r,e,t,n){n3(r,e,void 0,n);for(const i in e.attrs)r.setAttribute(i3.has(i)?i:XC(i),e.attrs[i])}const MS={};function Cee(r){Object.assign(MS,r)}function s3(r,{layout:e,layoutId:t}){return md.has(r)||r.startsWith("origin")||(e||t!==void 0)&&(!!MS[r]||r==="opacity")}function rb(r,e,t){var n;const{style:i}=r,s={};for(const o in i)(vs(i[o])||e.style&&vs(e.style[o])||s3(o,r)||((n=t==null?void 0:t.getValue(o))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(s[o]=i[o]);return s}function o3(r,e,t){const n=rb(r,e,t);for(const i in r)if(vs(r[i])||vs(e[i])){const s=km.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[s]=r[i]}return n}function bee(r,e){try{e.dimensions=typeof r.getBBox=="function"?r.getBBox():r.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const F2=["x","y","width","height","cx","cy","r"],Ree={useVisualState:qN({scrapeMotionValuesFromProps:o3,createRenderState:t3,onUpdate:({props:r,prevProps:e,current:t,renderState:n,latestValues:i})=>{if(!t)return;let s=!!r.drag;if(!s){for(const a in i)if(md.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<F2.length;a++){const l=F2[a];r[l]!==e[l]&&(o=!0)}o&&Hn.read(()=>{bee(t,n),Hn.render(()=>{tb(n,i,ib(t.tagName),r.transformTemplate),r3(t,n)})})}})},Iee={useVisualState:qN({scrapeMotionValuesFromProps:rb,createRenderState:nb})};function a3(r,e,t){for(const n in e)!vs(e[n])&&!s3(n,t)&&(r[n]=e[n])}function Lee({transformTemplate:r},e){return ne.useMemo(()=>{const t=nb();return eb(t,e,r),Object.assign({},t.vars,t.style)},[e])}function Pee(r,e){const t=r.style||{},n={};return a3(n,t,r),Object.assign(n,Lee(r,e)),n}function Dee(r,e){const t={},n=Pee(r,e);return r.drag&&r.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(t.tabIndex=0),t.style=n,t}function Bee(r,e,t,n){const i=ne.useMemo(()=>{const s=t3();return tb(s,e,ib(n),r.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(r.style){const s={};a3(s,r.style,r),i.style={...s,...i.style}}return i}function Fee(r=!1){return(t,n,i,{latestValues:s},o)=>{const l=(JC(t)?Bee:Dee)(n,s,o,t),u=JZ(n,typeof t=="string",r),c=t!==ne.Fragment?{...u,...l,ref:i}:{},{children:h}=n,d=ne.useMemo(()=>vs(h)?h.get():h,[h]);return ne.createElement(t,{...c,children:d})}}function kee(r,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...JC(n)?Ree:Iee,preloadedFeatures:r,useRender:Fee(i),createVisualElement:e,Component:n};return see(o)}}function l3(r,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==r.length)return!1;for(let n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}function OA(r,e,t){const n=r.getProps();return qC(n,e,t!==void 0?t:n.custom,r)}const u3=jC(()=>window.ScrollTimeline!==void 0);class Oee{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map(i=>{if(u3()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{n.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Uee extends Oee{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function sb(r,e){return r?r[e]||r.default||r:void 0}const LM=2e4;function c3(r){let e=0;const t=50;let n=r.next(e);for(;!n.done&&e<LM;)e+=t,n=r.next(e);return e>=LM?1/0:e}function ob(r){return typeof r=="function"}function k2(r,e){r.timeline=e,r.onfinish=null}const ab=r=>Array.isArray(r)&&typeof r[0]=="number",Nee={linearEasing:void 0};function Gee(r,e){const t=jC(r);return()=>{var n;return(n=Nee[e])!==null&&n!==void 0?n:t()}}const wS=Gee(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),h3=(r,e,t=10)=>{let n="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)n+=r(ad(0,i-1,s))+", ";return`linear(${n.substring(0,n.length-2)})`};function f3(r){return!!(typeof r=="function"&&wS()||!r||typeof r=="string"&&(r in PM||wS())||ab(r)||Array.isArray(r)&&r.every(f3))}const u0=([r,e,t,n])=>`cubic-bezier(${r}, ${e}, ${t}, ${n})`,PM={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:u0([0,.65,.55,1]),circOut:u0([.55,0,1,.45]),backIn:u0([.31,.01,.66,-.59]),backOut:u0([.33,1.53,.69,.99])};function d3(r,e){if(r)return typeof r=="function"&&wS()?h3(r,e):ab(r)?u0(r):Array.isArray(r)?r.map(t=>d3(t,e)||PM.easeOut):PM[r]}const Xa={x:!1,y:!1};function p3(){return Xa.x||Xa.y}function m3(r,e,t){var n;if(r instanceof Element)return[r];if(typeof r=="string"){let i=document;const s=(n=void 0)!==null&&n!==void 0?n:i.querySelectorAll(r);return s?Array.from(s):[]}return Array.from(r)}function g3(r,e){const t=m3(r),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[t,i,()=>n.abort()]}function O2(r){return e=>{e.pointerType==="touch"||p3()||r(e)}}function Hee(r,e,t={}){const[n,i,s]=g3(r,t),o=O2(a=>{const{target:l}=a,u=e(a);if(typeof u!="function"||!l)return;const c=O2(h=>{u(h),l.removeEventListener("pointerleave",c)});l.addEventListener("pointerleave",c,i)});return n.forEach(a=>{a.addEventListener("pointerenter",o,i)}),s}const v3=(r,e)=>e?r===e?!0:v3(r,e.parentElement):!1,lb=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,zee=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Vee(r){return zee.has(r.tagName)||r.tabIndex!==-1}const c0=new WeakSet;function U2(r){return e=>{e.key==="Enter"&&r(e)}}function lT(r,e){r.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Wee=(r,e)=>{const t=r.currentTarget;if(!t)return;const n=U2(()=>{if(c0.has(t))return;lT(t,"down");const i=U2(()=>{lT(t,"up")}),s=()=>lT(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function N2(r){return lb(r)&&!p3()}function jee(r,e,t={}){const[n,i,s]=g3(r,t),o=a=>{const l=a.currentTarget;if(!N2(a)||c0.has(l))return;c0.add(l);const u=e(a),c=(m,g)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",d),!(!N2(m)||!c0.has(l))&&(c0.delete(l),typeof u=="function"&&u(m,{success:g}))},h=m=>{c(m,t.useGlobalTarget||v3(l,m.target))},d=m=>{c(m,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",d,i)};return n.forEach(a=>{!Vee(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),a.addEventListener("focus",u=>Wee(u,i),i)}),s}function Kee(r){return r==="x"||r==="y"?Xa[r]?null:(Xa[r]=!0,()=>{Xa[r]=!1}):Xa.x||Xa.y?null:(Xa.x=Xa.y=!0,()=>{Xa.x=Xa.y=!1})}const y3=new Set(["width","height","top","left","right","bottom",...km]);let __;function $ee(){__=void 0}const Vl={now:()=>(__===void 0&&Vl.set(Or.isProcessing||WZ.useManualTiming?Or.timestamp:performance.now()),__),set:r=>{__=r,queueMicrotask($ee)}};function ub(r,e){r.indexOf(e)===-1&&r.push(e)}function cb(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}class hb{constructor(){this.subscriptions=[]}add(e){return ub(this.subscriptions,e),()=>cb(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,n);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function fb(r,e){return e?r*(1e3/e):0}const G2=30,Xee=r=>!isNaN(parseFloat(r)),L0={current:void 0};class Yee{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{const s=Vl.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Vl.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Xee(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new hb);const n=this.events[e].add(t);return e==="change"?()=>{n(),Hn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return L0.current&&L0.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Vl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>G2)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,G2);return fb(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ol(r,e){return new Yee(r,e)}function Jee(r,e,t){r.hasValue(e)?r.getValue(e).set(t):r.addValue(e,Ol(t))}function qee(r,e){const t=OA(r,e);let{transitionEnd:n={},transition:i={},...s}=t||{};s={...s,...n};for(const o in s){const a=hee(s[o]);Jee(r,o,a)}}function Qee(r){return!!(vs(r)&&r.add)}function DM(r,e){const t=r.getValue("willChange");if(Qee(t))return t.add(e)}function x3(r){return r.props[XN]}const _3=(r,e,t)=>(((1-3*t+3*e)*r+(3*t-6*e))*r+3*e)*r,Zee=1e-7,ete=12;function tte(r,e,t,n,i){let s,o,a=0;do o=e+(t-e)/2,s=_3(o,n,i)-r,s>0?t=o:e=o;while(Math.abs(s)>Zee&&++a<ete);return o}function Uv(r,e,t,n){if(r===e&&t===n)return Gs;const i=s=>tte(s,0,1,r,t);return s=>s===0||s===1?s:_3(i(s),e,n)}const S3=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,A3=r=>e=>1-r(1-e),E3=Uv(.33,1.53,.69,.99),db=A3(E3),T3=S3(db),M3=r=>(r*=2)<1?.5*db(r):.5*(2-Math.pow(2,-10*(r-1))),pb=r=>1-Math.sin(Math.acos(r)),w3=A3(pb),C3=S3(pb),b3=r=>/^0[^.\s]+$/u.test(r);function nte(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||b3(r):!0}const P0=r=>Math.round(r*1e5)/1e5,mb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ite(r){return r==null}const rte=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,gb=(r,e)=>t=>!!(typeof t=="string"&&rte.test(t)&&t.startsWith(r)||e&&!ite(t)&&Object.prototype.hasOwnProperty.call(t,e)),R3=(r,e,t)=>n=>{if(typeof n!="string")return n;const[i,s,o,a]=n.match(mb);return{[r]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},ste=r=>$l(0,255,r),uT={...Om,transform:r=>Math.round(ste(r))},Uf={test:gb("rgb","red"),parse:R3("red","green","blue"),transform:({red:r,green:e,blue:t,alpha:n=1})=>"rgba("+uT.transform(r)+", "+uT.transform(e)+", "+uT.transform(t)+", "+P0(pv.transform(n))+")"};function ote(r){let e="",t="",n="",i="";return r.length>5?(e=r.substring(1,3),t=r.substring(3,5),n=r.substring(5,7),i=r.substring(7,9)):(e=r.substring(1,2),t=r.substring(2,3),n=r.substring(3,4),i=r.substring(4,5),e+=e,t+=t,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const BM={test:gb("#"),parse:ote,transform:Uf.transform},$p={test:gb("hsl","hue"),parse:R3("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(r)+", "+zl.transform(P0(e))+", "+zl.transform(P0(t))+", "+P0(pv.transform(n))+")"},ds={test:r=>Uf.test(r)||BM.test(r)||$p.test(r),parse:r=>Uf.test(r)?Uf.parse(r):$p.test(r)?$p.parse(r):BM.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?Uf.transform(r):$p.transform(r)},ate=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function lte(r){var e,t;return isNaN(r)&&typeof r=="string"&&(((e=r.match(mb))===null||e===void 0?void 0:e.length)||0)+(((t=r.match(ate))===null||t===void 0?void 0:t.length)||0)>0}const I3="number",L3="color",ute="var",cte="var(",H2="${}",hte=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function mv(r){const e=r.toString(),t=[],n={color:[],number:[],var:[]},i=[];let s=0;const a=e.replace(hte,l=>(ds.test(l)?(n.color.push(s),i.push(L3),t.push(ds.parse(l))):l.startsWith(cte)?(n.var.push(s),i.push(ute),t.push(l)):(n.number.push(s),i.push(I3),t.push(parseFloat(l))),++s,H2)).split(H2);return{values:t,split:a,indexes:n,types:i}}function P3(r){return mv(r).values}function D3(r){const{split:e,types:t}=mv(r),n=e.length;return i=>{let s="";for(let o=0;o<n;o++)if(s+=e[o],i[o]!==void 0){const a=t[o];a===I3?s+=P0(i[o]):a===L3?s+=ds.transform(i[o]):s+=i[o]}return s}}const fte=r=>typeof r=="number"?0:r;function dte(r){const e=P3(r);return D3(r)(e.map(fte))}const gh={test:lte,parse:P3,createTransformer:D3,getAnimatableNone:dte},pte=new Set(["brightness","contrast","saturate","opacity"]);function mte(r){const[e,t]=r.slice(0,-1).split("(");if(e==="drop-shadow")return r;const[n]=t.match(mb)||[];if(!n)return r;const i=t.replace(n,"");let s=pte.has(e)?1:0;return n!==t&&(s*=100),e+"("+s+i+")"}const gte=/\b([a-z-]*)\(.*?\)/gu,FM={...gh,getAnimatableNone:r=>{const e=r.match(gte);return e?e.map(mte).join(" "):r}},vte={...ZC,color:ds,backgroundColor:ds,outlineColor:ds,fill:ds,stroke:ds,borderColor:ds,borderTopColor:ds,borderRightColor:ds,borderBottomColor:ds,borderLeftColor:ds,filter:FM,WebkitFilter:FM},vb=r=>vte[r];function B3(r,e){let t=vb(r);return t!==FM&&(t=gh),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const yte=new Set(["auto","none","0"]);function xte(r,e,t){let n=0,i;for(;n<r.length&&!i;){const s=r[n];typeof s=="string"&&!yte.has(s)&&mv(s).values.length&&(i=r[n]),n++}if(i&&t)for(const s of e)r[s]=B3(t,i)}const z2=r=>r===Om||r===qt,V2=(r,e)=>parseFloat(r.split(", ")[e]),W2=(r,e)=>(t,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return V2(i[1],e);{const s=n.match(/^matrix\((.+)\)$/u);return s?V2(s[1],r):0}},_te=new Set(["x","y","z"]),Ste=km.filter(r=>!_te.has(r));function Ate(r){const e=[];return Ste.forEach(t=>{const n=r.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const Cm={width:({x:r},{paddingLeft:e="0",paddingRight:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),height:({y:r},{paddingTop:e="0",paddingBottom:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),top:(r,{top:e})=>parseFloat(e),left:(r,{left:e})=>parseFloat(e),bottom:({y:r},{top:e})=>parseFloat(e)+(r.max-r.min),right:({x:r},{left:e})=>parseFloat(e)+(r.max-r.min),x:W2(4,13),y:W2(5,14)};Cm.translateX=Cm.x;Cm.translateY=Cm.y;const Qf=new Set;let kM=!1,OM=!1;function F3(){if(OM){const r=Array.from(Qf).filter(n=>n.needsMeasurement),e=new Set(r.map(n=>n.element)),t=new Map;e.forEach(n=>{const i=Ate(n);i.length&&(t.set(n,i),n.render())}),r.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=t.get(n);i&&i.forEach(([s,o])=>{var a;(a=n.getValue(s))===null||a===void 0||a.set(o)})}),r.forEach(n=>n.measureEndState()),r.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}OM=!1,kM=!1,Qf.forEach(r=>r.complete()),Qf.clear()}function k3(){Qf.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(OM=!0)})}function Ete(){k3(),F3()}class yb{constructor(e,t,n,i,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Qf.add(this),kM||(kM=!0,Hn.read(k3),Hn.resolveKeyframes(F3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=i==null?void 0:i.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(n&&t){const l=n.readValue(t,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Qf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Qf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const O3=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r),Tte=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Mte(r){const e=Tte.exec(r);if(!e)return[,];const[,t,n,i]=e;return[`--${t??n}`,i]}function U3(r,e,t=1){const[n,i]=Mte(r);if(!n)return;const s=window.getComputedStyle(e).getPropertyValue(n);if(s){const o=s.trim();return O3(o)?parseFloat(o):o}return QC(i)?U3(i,e,t+1):i}const N3=r=>e=>e.test(r),wte={test:r=>r==="auto",parse:r=>r},G3=[Om,qt,zl,Zc,vee,gee,wte],j2=r=>G3.find(N3(r));class H3 extends yb{constructor(e,t,n,i,s){super(e,t,n,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),QC(u))){const c=U3(u,t.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!y3.has(n)||e.length!==2)return;const[i,s]=e,o=j2(i),a=j2(s);if(o!==a)if(z2(o)&&z2(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let i=0;i<e.length;i++)nte(e[i])&&n.push(i);n.length&&xte(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Cm[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=Cm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const K2=(r,e)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(gh.test(r)||r==="0")&&!r.startsWith("url("));function Cte(r){const e=r[0];if(r.length===1)return!0;for(let t=0;t<r.length;t++)if(r[t]!==e)return!0}function bte(r,e,t,n){const i=r[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=r[r.length-1],o=K2(i,e),a=K2(s,e);return!o||!a?!1:Cte(r)||(t==="spring"||ob(t))&&n}const Rte=r=>r!==null;function UA(r,{repeat:e,repeatType:t="loop"},n){const i=r.filter(Rte),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||n===void 0?i[s]:n}const Ite=40;class z3{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Vl.now(),this.options={autoplay:e,delay:t,type:n,repeat:i,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Ite?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Ete(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Vl.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:s,delay:o,onComplete:a,onUpdate:l,isGenerator:u}=this.options;if(!u&&!bte(e,n,i,s))if(o)this.options.duration=0;else{l&&l(UA(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const c=this.initPlayback(e,t);c!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...c},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Ci=(r,e,t)=>r+(e-r)*t;function cT(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function Lte({hue:r,saturation:e,lightness:t,alpha:n}){r/=360,e/=100,t/=100;let i=0,s=0,o=0;if(!e)i=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=cT(l,a,r+1/3),s=cT(l,a,r),o=cT(l,a,r-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:n}}function CS(r,e){return t=>t>0?e:r}const hT=(r,e,t)=>{const n=r*r,i=t*(e*e-n)+n;return i<0?0:Math.sqrt(i)},Pte=[BM,Uf,$p],Dte=r=>Pte.find(e=>e.test(r));function $2(r){const e=Dte(r);if(!e)return!1;let t=e.parse(r);return e===$p&&(t=Lte(t)),t}const X2=(r,e)=>{const t=$2(r),n=$2(e);if(!t||!n)return CS(r,e);const i={...t};return s=>(i.red=hT(t.red,n.red,s),i.green=hT(t.green,n.green,s),i.blue=hT(t.blue,n.blue,s),i.alpha=Ci(t.alpha,n.alpha,s),Uf.transform(i))},Bte=(r,e)=>t=>e(r(t)),Nv=(...r)=>r.reduce(Bte),UM=new Set(["none","hidden"]);function Fte(r,e){return UM.has(r)?t=>t<=0?r:e:t=>t>=1?e:r}function kte(r,e){return t=>Ci(r,e,t)}function xb(r){return typeof r=="number"?kte:typeof r=="string"?QC(r)?CS:ds.test(r)?X2:Nte:Array.isArray(r)?V3:typeof r=="object"?ds.test(r)?X2:Ote:CS}function V3(r,e){const t=[...r],n=t.length,i=r.map((s,o)=>xb(s)(s,e[o]));return s=>{for(let o=0;o<n;o++)t[o]=i[o](s);return t}}function Ote(r,e){const t={...r,...e},n={};for(const i in t)r[i]!==void 0&&e[i]!==void 0&&(n[i]=xb(r[i])(r[i],e[i]));return i=>{for(const s in n)t[s]=n[s](i);return t}}function Ute(r,e){var t;const n=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=r.indexes[o][i[o]],l=(t=r.values[a])!==null&&t!==void 0?t:0;n[s]=l,i[o]++}return n}const Nte=(r,e)=>{const t=gh.createTransformer(e),n=mv(r),i=mv(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?UM.has(r)&&!i.values.length||UM.has(e)&&!n.values.length?Fte(r,e):Nv(V3(Ute(n,i),i.values),t):CS(r,e)};function W3(r,e,t){return typeof r=="number"&&typeof e=="number"&&typeof t=="number"?Ci(r,e,t):xb(r)(r,e)}const Gte=5;function j3(r,e,t){const n=Math.max(e-Gte,0);return fb(t-r(n),e-n)}const ki={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Y2=.001;function Hte({duration:r=ki.duration,bounce:e=ki.bounce,velocity:t=ki.velocity,mass:n=ki.mass}){let i,s,o=1-e;o=$l(ki.minDamping,ki.maxDamping,o),r=$l(ki.minDuration,ki.maxDuration,Xu(r)),o<1?(i=u=>{const c=u*o,h=c*r,d=c-t,m=NM(u,o),g=Math.exp(-h);return Y2-d/m*g},s=u=>{const h=u*o*r,d=h*t+t,m=Math.pow(o,2)*Math.pow(u,2)*r,g=Math.exp(-h),x=NM(Math.pow(u,2),o);return(-i(u)+Y2>0?-1:1)*((d-m)*g)/x}):(i=u=>{const c=Math.exp(-u*r),h=(u-t)*r+1;return-.001+c*h},s=u=>{const c=Math.exp(-u*r),h=(t-u)*(r*r);return c*h});const a=5/r,l=Vte(i,s,a);if(r=$u(r),isNaN(l))return{stiffness:ki.stiffness,damping:ki.damping,duration:r};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:r}}}const zte=12;function Vte(r,e,t){let n=t;for(let i=1;i<zte;i++)n=n-r(n)/e(n);return n}function NM(r,e){return r*Math.sqrt(1-e*e)}const Wte=["duration","bounce"],jte=["stiffness","damping","mass"];function J2(r,e){return e.some(t=>r[t]!==void 0)}function Kte(r){let e={velocity:ki.velocity,stiffness:ki.stiffness,damping:ki.damping,mass:ki.mass,isResolvedFromDuration:!1,...r};if(!J2(r,jte)&&J2(r,Wte))if(r.visualDuration){const t=r.visualDuration,n=2*Math.PI/(t*1.2),i=n*n,s=2*$l(.05,1,1-(r.bounce||0))*Math.sqrt(i);e={...e,mass:ki.mass,stiffness:i,damping:s}}else{const t=Hte(r);e={...e,...t,mass:ki.mass},e.isResolvedFromDuration=!0}return e}function K3(r=ki.visualDuration,e=ki.bounce){const t=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:e}:r;let{restSpeed:n,restDelta:i}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:u,mass:c,duration:h,velocity:d,isResolvedFromDuration:m}=Kte({...t,velocity:-Xu(t.velocity||0)}),g=d||0,x=u/(2*Math.sqrt(l*c)),_=o-s,S=Xu(Math.sqrt(l/c)),T=Math.abs(_)<5;n||(n=T?ki.restSpeed.granular:ki.restSpeed.default),i||(i=T?ki.restDelta.granular:ki.restDelta.default);let E;if(x<1){const R=NM(S,x);E=P=>{const L=Math.exp(-x*S*P);return o-L*((g+x*S*_)/R*Math.sin(R*P)+_*Math.cos(R*P))}}else if(x===1)E=R=>o-Math.exp(-S*R)*(_+(g+S*_)*R);else{const R=S*Math.sqrt(x*x-1);E=P=>{const L=Math.exp(-x*S*P),F=Math.min(R*P,300);return o-L*((g+x*S*_)*Math.sinh(F)+R*_*Math.cosh(F))/R}}const C={calculatedDuration:m&&h||null,next:R=>{const P=E(R);if(m)a.done=R>=h;else{let L=0;x<1&&(L=R===0?$u(g):j3(E,R,P));const F=Math.abs(L)<=n,D=Math.abs(o-P)<=i;a.done=F&&D}return a.value=a.done?o:P,a},toString:()=>{const R=Math.min(c3(C),LM),P=h3(L=>C.next(R*L).value,R,30);return R+"ms "+P}};return C}function q2({keyframes:r,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:u=.5,restSpeed:c}){const h=r[0],d={done:!1,value:h},m=F=>a!==void 0&&F<a||l!==void 0&&F>l,g=F=>a===void 0?l:l===void 0||Math.abs(a-F)<Math.abs(l-F)?a:l;let x=t*e;const _=h+x,S=o===void 0?_:o(_);S!==_&&(x=S-h);const T=F=>-x*Math.exp(-F/n),E=F=>S+T(F),C=F=>{const D=T(F),I=E(F);d.done=Math.abs(D)<=u,d.value=d.done?S:I};let R,P;const L=F=>{m(d.value)&&(R=F,P=K3({keyframes:[d.value,g(d.value)],velocity:j3(E,F,d.value),damping:i,stiffness:s,restDelta:u,restSpeed:c}))};return L(0),{calculatedDuration:null,next:F=>{let D=!1;return!P&&R===void 0&&(D=!0,C(F),L(F)),R!==void 0&&F>=R?P.next(F-R):(!D&&C(F),d)}}}const $te=Uv(.42,0,1,1),Xte=Uv(0,0,.58,1),$3=Uv(.42,0,.58,1),Yte=r=>Array.isArray(r)&&typeof r[0]!="number",Jte={linear:Gs,easeIn:$te,easeInOut:$3,easeOut:Xte,circIn:pb,circInOut:C3,circOut:w3,backIn:db,backInOut:T3,backOut:E3,anticipate:M3},Q2=r=>{if(ab(r)){VN(r.length===4);const[e,t,n,i]=r;return Uv(e,t,n,i)}else if(typeof r=="string")return Jte[r];return r};function qte(r,e,t){const n=[],i=t||W3,s=r.length-1;for(let o=0;o<s;o++){let a=i(r[o],r[o+1]);if(e){const l=Array.isArray(e)?e[o]||Gs:e;a=Nv(l,a)}n.push(a)}return n}function _b(r,e,{clamp:t=!0,ease:n,mixer:i}={}){const s=r.length;if(VN(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=r[0]===r[1];r[0]>r[s-1]&&(r=[...r].reverse(),e=[...e].reverse());const a=qte(e,n,i),l=a.length,u=c=>{if(o&&c<r[0])return e[0];let h=0;if(l>1)for(;h<r.length-2&&!(c<r[h+1]);h++);const d=ad(r[h],r[h+1],c);return a[h](d)};return t?c=>u($l(r[0],r[s-1],c)):u}function Qte(r,e){const t=r[r.length-1];for(let n=1;n<=e;n++){const i=ad(0,e,n);r.push(Ci(t,1,i))}}function X3(r){const e=[0];return Qte(e,r.length-1),e}function Zte(r,e){return r.map(t=>t*e)}function ene(r,e){return r.map(()=>e||$3).splice(0,r.length-1)}function bS({duration:r=300,keyframes:e,times:t,ease:n="easeInOut"}){const i=Yte(n)?n.map(Q2):Q2(n),s={done:!1,value:e[0]},o=Zte(t&&t.length===e.length?t:X3(e),r),a=_b(o,e,{ease:Array.isArray(i)?i:ene(e,i)});return{calculatedDuration:r,next:l=>(s.value=a(l),s.done=l>=r,s)}}const tne=r=>{const e=({timestamp:t})=>r(t);return{start:()=>Hn.update(e,!0),stop:()=>nl(e),now:()=>Or.isProcessing?Or.timestamp:Vl.now()}},nne={decay:q2,inertia:q2,tween:bS,keyframes:bS,spring:K3},ine=r=>r/100;class Sb extends z3{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:n,element:i,keyframes:s}=this.options,o=(i==null?void 0:i.KeyframeResolver)||yb,a=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new o(s,a,t,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=this.options,a=ob(t)?t:nne[t]||bS;let l,u;a!==bS&&typeof e[0]!="number"&&(l=Nv(ine,W3(e[0],e[1])),e=[0,100]);const c=a({...this.options,keyframes:e});s==="mirror"&&(u=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=c3(c));const{calculatedDuration:h}=c,d=h+i,m=d*(n+1)-i;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:m}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:n}=this;if(!n){const{keyframes:F}=this.options;return{done:!0,value:F[F.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:h}=n;if(this.startTime===null)return s.next(0);const{delay:d,repeat:m,repeatType:g,repeatDelay:x,onUpdate:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const S=this.currentTime-d*(this.speed>=0?1:-1),T=this.speed>=0?S<0:S>c;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let E=this.currentTime,C=s;if(m){const F=Math.min(this.currentTime,c)/h;let D=Math.floor(F),I=F%1;!I&&F>=1&&(I=1),I===1&&D--,D=Math.min(D,m+1),!!(D%2)&&(g==="reverse"?(I=1-I,x&&(I-=x/h)):g==="mirror"&&(C=o)),E=$l(0,1,I)*h}const R=T?{done:!1,value:l[0]}:C.next(E);a&&(R.value=a(R.value));let{done:P}=R;!T&&u!==null&&(P=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const L=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return L&&i!==void 0&&(R.value=UA(l,this.options,i)),_&&_(R.value),L&&this.finish(),R}get duration(){const{resolved:e}=this;return e?Xu(e.calculatedDuration):0}get time(){return Xu(this.currentTime)}set time(e){e=$u(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Xu(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=tne,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const rne=new Set(["opacity","clipPath","filter","transform"]);function sne(r,e,t,{delay:n=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const u={[e]:t};l&&(u.offset=l);const c=d3(a,i);return Array.isArray(c)&&(u.easing=c),r.animate(u,{delay:n,duration:i,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const one=jC(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),RS=10,ane=2e4;function lne(r){return ob(r.type)||r.type==="spring"||!f3(r.ease)}function une(r,e){const t=new Sb({...e,keyframes:r,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:r[0]};const i=[];let s=0;for(;!n.done&&s<ane;)n=t.sample(s),i.push(n.value),s+=RS;return{times:void 0,keyframes:i,duration:s-RS,ease:"linear"}}const Y3={anticipate:M3,backInOut:T3,circInOut:C3};function cne(r){return r in Y3}class Z2 extends z3{constructor(e){super(e);const{name:t,motionValue:n,element:i,keyframes:s}=this.options;this.resolver=new H3(s,(o,a)=>this.onKeyframesResolved(o,a),t,n,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:n=300,times:i,ease:s,type:o,motionValue:a,name:l,startTime:u}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&wS()&&cne(s)&&(s=Y3[s]),lne(this.options)){const{onComplete:h,onUpdate:d,motionValue:m,element:g,...x}=this.options,_=une(e,x);e=_.keyframes,e.length===1&&(e[1]=e[0]),n=_.duration,i=_.times,s=_.ease,o="keyframes"}const c=sne(a.owner.current,l,e,{...this.options,duration:n,times:i,ease:s});return c.startTime=u??this.calcStartTime(),this.pendingTimeline?(k2(c,this.pendingTimeline),this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:h}=this.options;a.set(UA(e,this.options,t)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:n,times:i,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Xu(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Xu(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=$u(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Gs;const{animation:n}=t;k2(n,e)}return Gs}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:i,type:s,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:c,onComplete:h,element:d,...m}=this.options,g=new Sb({...m,keyframes:n,duration:i,type:s,ease:o,times:a,isGenerator:!0}),x=$u(this.time);u.setWithVelocity(g.sample(x-RS).value,g.sample(x).value,RS)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:i,repeatType:s,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return one()&&n&&rne.has(n)&&!l&&!u&&!i&&s!=="mirror"&&o!==0&&a!=="inertia"}}const hne={type:"spring",stiffness:500,damping:25,restSpeed:10},fne=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),dne={type:"keyframes",duration:.8},pne={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},mne=(r,{keyframes:e})=>e.length>2?dne:md.has(r)?r.startsWith("scale")?fne(e[1]):hne:pne;function gne({when:r,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const Ab=(r,e,t,n={},i,s)=>o=>{const a=sb(n,r)||{},l=a.delay||n.delay||0;let{elapsed:u=0}=n;u=u-$u(l);let c={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:d=>{e.set(d),a.onUpdate&&a.onUpdate(d)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:r,motionValue:e,element:s?void 0:i};gne(a)||(c={...c,...mne(r,c)}),c.duration&&(c.duration=$u(c.duration)),c.repeatDelay&&(c.repeatDelay=$u(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let h=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(h=!0)),h&&!s&&e.get()!==void 0){const d=UA(c.keyframes,a);if(d!==void 0)return Hn.update(()=>{c.onUpdate(d),c.onComplete()}),new Uee([])}return!s&&Z2.supports(c)?new Z2(c):new Sb(c)};function vne({protectedKeys:r,needsAnimating:e},t){const n=r.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function J3(r,e,{delay:t=0,transitionOverride:n,type:i}={}){var s;let{transition:o=r.getDefaultTransition(),transitionEnd:a,...l}=e;n&&(o=n);const u=[],c=i&&r.animationState&&r.animationState.getState()[i];for(const h in l){const d=r.getValue(h,(s=r.latestValues[h])!==null&&s!==void 0?s:null),m=l[h];if(m===void 0||c&&vne(c,h))continue;const g={delay:t,...sb(o||{},h)};let x=!1;if(window.MotionHandoffAnimation){const S=x3(r);if(S){const T=window.MotionHandoffAnimation(S,h,Hn);T!==null&&(g.startTime=T,x=!0)}}DM(r,h),d.start(Ab(h,d,m,r.shouldReduceMotion&&y3.has(h)?{type:!1}:g,r,x));const _=d.animation;_&&u.push(_)}return a&&Promise.all(u).then(()=>{Hn.update(()=>{a&&qee(r,a)})}),u}function GM(r,e,t={}){var n;const i=OA(r,e,t.type==="exit"?(n=r.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:s=r.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const o=i?()=>Promise.all(J3(r,i,t)):()=>Promise.resolve(),a=r.variantChildren&&r.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:d}=s;return yne(r,e,c+u,h,d,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,c]=l==="beforeChildren"?[o,a]:[a,o];return u().then(()=>c())}else return Promise.all([o(),a(t.delay)])}function yne(r,e,t=0,n=0,i=1,s){const o=[],a=(r.variantChildren.size-1)*n,l=i===1?(u=0)=>u*n:(u=0)=>a-u*n;return Array.from(r.variantChildren).sort(xne).forEach((u,c)=>{u.notify("AnimationStart",e),o.push(GM(u,e,{...s,delay:t+l(c)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function xne(r,e){return r.sortNodePosition(e)}function _ne(r,e,t={}){r.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(s=>GM(r,s,t));n=Promise.all(i)}else if(typeof e=="string")n=GM(r,e,t);else{const i=typeof e=="function"?OA(r,e,t.custom):e;n=Promise.all(J3(r,i,t))}return n.then(()=>{r.notify("AnimationComplete",e)})}const Sne=$C.length;function q3(r){if(!r)return;if(!r.isControllingVariants){const t=r.parent?q3(r.parent)||{}:{};return r.props.initial!==void 0&&(t.initial=r.props.initial),t}const e={};for(let t=0;t<Sne;t++){const n=$C[t],i=r.props[n];(dv(i)||i===!1)&&(e[n]=i)}return e}const Ane=[...KC].reverse(),Ene=KC.length;function Tne(r){return e=>Promise.all(e.map(({animation:t,options:n})=>_ne(r,t,n)))}function Mne(r){let e=Tne(r),t=eD(),n=!0;const i=l=>(u,c)=>{var h;const d=OA(r,c,l==="exit"?(h=r.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:g,...x}=d;u={...u,...x,...g}}return u};function s(l){e=l(r)}function o(l){const{props:u}=r,c=q3(r.parent)||{},h=[],d=new Set;let m={},g=1/0;for(let _=0;_<Ene;_++){const S=Ane[_],T=t[S],E=u[S]!==void 0?u[S]:c[S],C=dv(E),R=S===l?T.isActive:null;R===!1&&(g=_);let P=E===c[S]&&E!==u[S]&&C;if(P&&n&&r.manuallyAnimateOnMount&&(P=!1),T.protectedKeys={...m},!T.isActive&&R===null||!E&&!T.prevProp||FA(E)||typeof E=="boolean")continue;const L=wne(T.prevProp,E);let F=L||S===l&&T.isActive&&!P&&C||_>g&&C,D=!1;const I=Array.isArray(E)?E:[E];let N=I.reduce(i(S),{});R===!1&&(N={});const{prevResolvedValues:V={}}=T,q={...V,...N},Q=se=>{F=!0,d.has(se)&&(D=!0,d.delete(se)),T.needsAnimating[se]=!0;const W=r.getValue(se);W&&(W.liveStyle=!1)};for(const se in q){const W=N[se],$=V[se];if(m.hasOwnProperty(se))continue;let j=!1;IM(W)&&IM($)?j=!l3(W,$):j=W!==$,j?W!=null?Q(se):d.add(se):W!==void 0&&d.has(se)?Q(se):T.protectedKeys[se]=!0}T.prevProp=E,T.prevResolvedValues=N,T.isActive&&(m={...m,...N}),n&&r.blockInitialAnimation&&(F=!1),F&&(!(P&&L)||D)&&h.push(...I.map(se=>({animation:se,options:{type:S}})))}if(d.size){const _={};d.forEach(S=>{const T=r.getBaseTarget(S),E=r.getValue(S);E&&(E.liveStyle=!0),_[S]=T??null}),h.push({animation:_})}let x=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!r.manuallyAnimateOnMount&&(x=!1),n=!1,x?e(h):Promise.resolve()}function a(l,u){var c;if(t[l].isActive===u)return Promise.resolve();(c=r.variantChildren)===null||c===void 0||c.forEach(d=>{var m;return(m=d.animationState)===null||m===void 0?void 0:m.setActive(l,u)}),t[l].isActive=u;const h=o(l);for(const d in t)t[d].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=eD(),n=!0}}}function wne(r,e){return typeof e=="string"?e!==r:Array.isArray(e)?!l3(e,r):!1}function _f(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function eD(){return{animate:_f(!0),whileInView:_f(),whileHover:_f(),whileTap:_f(),whileDrag:_f(),whileFocus:_f(),exit:_f()}}class Ah{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Cne extends Ah{constructor(e){super(e),e.animationState||(e.animationState=Mne(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();FA(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let bne=0;class Rne extends Ah{constructor(){super(...arguments),this.id=bne++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Ine={animation:{Feature:Cne},exit:{Feature:Rne}};function gv(r,e,t,n={passive:!0}){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t)}function Gv(r){return{point:{x:r.pageX,y:r.pageY}}}const Lne=r=>e=>lb(e)&&r(e,Gv(e));function D0(r,e,t,n){return gv(r,e,Lne(t),n)}const tD=(r,e)=>Math.abs(r-e);function Pne(r,e){const t=tD(r.x,e.x),n=tD(r.y,e.y);return Math.sqrt(t**2+n**2)}class Q3{constructor(e,t,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=dT(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,m=Pne(h.offset,{x:0,y:0})>=3;if(!d&&!m)return;const{point:g}=h,{timestamp:x}=Or;this.history.push({...g,timestamp:x});const{onStart:_,onMove:S}=this.handlers;d||(_&&_(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=fT(d,this.transformPagePoint),Hn.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=dT(h.type==="pointercancel"?this.lastMoveEventInfo:fT(d,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,_),g&&g(h,_)},!lb(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=n,this.contextWindow=i||window;const o=Gv(e),a=fT(o,this.transformPagePoint),{point:l}=a,{timestamp:u}=Or;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=t;c&&c(e,dT(a,this.history)),this.removeListeners=Nv(D0(this.contextWindow,"pointermove",this.handlePointerMove),D0(this.contextWindow,"pointerup",this.handlePointerUp),D0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),nl(this.updatePoint)}}function fT(r,e){return e?{point:e(r.point)}:r}function nD(r,e){return{x:r.x-e.x,y:r.y-e.y}}function dT({point:r},e){return{point:r,delta:nD(r,Z3(e)),offset:nD(r,Dne(e)),velocity:Bne(e,.1)}}function Dne(r){return r[0]}function Z3(r){return r[r.length-1]}function Bne(r,e){if(r.length<2)return{x:0,y:0};let t=r.length-1,n=null;const i=Z3(r);for(;t>=0&&(n=r[t],!(i.timestamp-n.timestamp>$u(e)));)t--;if(!n)return{x:0,y:0};const s=Xu(i.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-n.x)/s,y:(i.y-n.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const e4=1e-4,Fne=1-e4,kne=1+e4,t4=.01,One=0-t4,Une=0+t4;function Wo(r){return r.max-r.min}function Nne(r,e,t){return Math.abs(r-e)<=t}function iD(r,e,t,n=.5){r.origin=n,r.originPoint=Ci(e.min,e.max,r.origin),r.scale=Wo(t)/Wo(e),r.translate=Ci(t.min,t.max,r.origin)-r.originPoint,(r.scale>=Fne&&r.scale<=kne||isNaN(r.scale))&&(r.scale=1),(r.translate>=One&&r.translate<=Une||isNaN(r.translate))&&(r.translate=0)}function B0(r,e,t,n){iD(r.x,e.x,t.x,n?n.originX:void 0),iD(r.y,e.y,t.y,n?n.originY:void 0)}function rD(r,e,t){r.min=t.min+e.min,r.max=r.min+Wo(e)}function Gne(r,e,t){rD(r.x,e.x,t.x),rD(r.y,e.y,t.y)}function sD(r,e,t){r.min=e.min-t.min,r.max=r.min+Wo(e)}function F0(r,e,t){sD(r.x,e.x,t.x),sD(r.y,e.y,t.y)}function Hne(r,{min:e,max:t},n){return e!==void 0&&r<e?r=n?Ci(e,r,n.min):Math.max(r,e):t!==void 0&&r>t&&(r=n?Ci(t,r,n.max):Math.min(r,t)),r}function oD(r,e,t){return{min:e!==void 0?r.min+e:void 0,max:t!==void 0?r.max+t-(r.max-r.min):void 0}}function zne(r,{top:e,left:t,bottom:n,right:i}){return{x:oD(r.x,t,i),y:oD(r.y,e,n)}}function aD(r,e){let t=e.min-r.min,n=e.max-r.max;return e.max-e.min<r.max-r.min&&([t,n]=[n,t]),{min:t,max:n}}function Vne(r,e){return{x:aD(r.x,e.x),y:aD(r.y,e.y)}}function Wne(r,e){let t=.5;const n=Wo(r),i=Wo(e);return i>n?t=ad(e.min,e.max-n,r.min):n>i&&(t=ad(r.min,r.max-i,e.min)),$l(0,1,t)}function jne(r,e){const t={};return e.min!==void 0&&(t.min=e.min-r.min),e.max!==void 0&&(t.max=e.max-r.min),t}const HM=.35;function Kne(r=HM){return r===!1?r=0:r===!0&&(r=HM),{x:lD(r,"left","right"),y:lD(r,"top","bottom")}}function lD(r,e,t){return{min:uD(r,e),max:uD(r,t)}}function uD(r,e){return typeof r=="number"?r:r[e]||0}const cD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Xp=()=>({x:cD(),y:cD()}),hD=()=>({min:0,max:0}),$i=()=>({x:hD(),y:hD()});function la(r){return[r("x"),r("y")]}function n4({top:r,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:r,max:n}}}function $ne({x:r,y:e}){return{top:e.min,right:r.max,bottom:e.max,left:r.min}}function Xne(r,e){if(!e)return r;const t=e({x:r.left,y:r.top}),n=e({x:r.right,y:r.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function pT(r){return r===void 0||r===1}function zM({scale:r,scaleX:e,scaleY:t}){return!pT(r)||!pT(e)||!pT(t)}function Cf(r){return zM(r)||i4(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function i4(r){return fD(r.x)||fD(r.y)}function fD(r){return r&&r!=="0%"}function IS(r,e,t){const n=r-t,i=e*n;return t+i}function dD(r,e,t,n,i){return i!==void 0&&(r=IS(r,i,n)),IS(r,t,n)+e}function VM(r,e=0,t=1,n,i){r.min=dD(r.min,e,t,n,i),r.max=dD(r.max,e,t,n,i)}function r4(r,{x:e,y:t}){VM(r.x,e.translate,e.scale,e.originPoint),VM(r.y,t.translate,t.scale,t.originPoint)}const pD=.999999999999,mD=1.0000000000001;function Yne(r,e,t,n=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=t[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Jp(r,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,r4(r,o)),n&&Cf(s.latestValues)&&Jp(r,s.latestValues))}e.x<mD&&e.x>pD&&(e.x=1),e.y<mD&&e.y>pD&&(e.y=1)}function Yp(r,e){r.min=r.min+e,r.max=r.max+e}function gD(r,e,t,n,i=.5){const s=Ci(r.min,r.max,i);VM(r,e,t,s,n)}function Jp(r,e){gD(r.x,e.x,e.scaleX,e.scale,e.originX),gD(r.y,e.y,e.scaleY,e.scale,e.originY)}function s4(r,e){return n4(Xne(r.getBoundingClientRect(),e))}function Jne(r,e,t){const n=s4(r,t),{scroll:i}=e;return i&&(Yp(n.x,i.offset.x),Yp(n.y,i.offset.y)),n}const o4=({current:r})=>r?r.ownerDocument.defaultView:null,qne=new WeakMap;class Qne{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$i(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=c=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Gv(c).point)},s=(c,h)=>{const{drag:d,dragPropagation:m,onDragStart:g}=this.getProps();if(d&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Kee(d),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),la(_=>{let S=this.getAxisMotionValue(_).get()||0;if(zl.test(S)){const{projection:T}=this.visualElement;if(T&&T.layout){const E=T.layout.layoutBox[_];E&&(S=Wo(E)*(parseFloat(S)/100))}}this.originPoint[_]=S}),g&&Hn.postRender(()=>g(c,h)),DM(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(c,h)=>{const{dragPropagation:d,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!d&&!this.openDragLock)return;const{offset:_}=h;if(m&&this.currentDirection===null){this.currentDirection=Zne(_),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,_),this.updateAxis("y",h.point,_),this.visualElement.render(),x&&x(c,h)},a=(c,h)=>this.stop(c,h),l=()=>la(c=>{var h;return this.getAnimationState(c)==="paused"&&((h=this.getAxisMotionValue(c).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Q3(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:o4(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&Hn.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!e_(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=Hne(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Kp(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=zne(i.layoutBox,t):this.constraints=!1,this.elastic=Kne(n),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&la(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=jne(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Kp(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=Jne(n,i.root,this.visualElement.getTransformPagePoint());let o=Vne(i.layout.layoutBox,s);if(t){const a=t($ne(o));this.hasMutatedConstraints=!!a,a&&(o=n4(a))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=la(c=>{if(!e_(c,t,this.currentDirection))return;let h=l&&l[c]||{};o&&(h={min:0,max:0});const d=i?200:1e6,m=i?40:1e7,g={type:"inertia",velocity:n?e[c]:0,bounceStiffness:d,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(c,g)});return Promise.all(u).then(a)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return DM(this.visualElement,e),n.start(Ab(e,n,0,t,this.visualElement,!1))}stopAnimation(){la(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){la(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){la(t=>{const{drag:n}=this.getProps();if(!e_(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[t];s.set(e[t]-Ci(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Kp(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};la(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=Wne({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),la(o=>{if(!e_(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:u}=this.constraints[o];a.set(Ci(l,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;qne.set(this.visualElement,this);const e=this.visualElement.current,t=D0(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Kp(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Hn.read(n);const o=gv(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(la(c=>{const h=this.getAxisMotionValue(c);h&&(this.originPoint[c]+=l[c].translate,h.set(h.get()+l[c].translate))}),this.visualElement.render())});return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=HM,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function e_(r,e,t){return(e===!0||e===r)&&(t===null||t===r)}function Zne(r,e=10){let t=null;return Math.abs(r.y)>e?t="y":Math.abs(r.x)>e&&(t="x"),t}class eie extends Ah{constructor(e){super(e),this.removeGroupControls=Gs,this.removeListeners=Gs,this.controls=new Qne(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gs}unmount(){this.removeGroupControls(),this.removeListeners()}}const vD=r=>(e,t)=>{r&&Hn.postRender(()=>r(e,t))};class tie extends Ah{constructor(){super(...arguments),this.removePointerDownListener=Gs}onPointerDown(e){this.session=new Q3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:o4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:vD(e),onStart:vD(t),onMove:n,onEnd:(s,o)=>{delete this.session,i&&Hn.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=D0(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const S_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function yD(r,e){return e.max===e.min?0:r/(e.max-e.min)*100}const Zg={correct:(r,e)=>{if(!e.target)return r;if(typeof r=="string")if(qt.test(r))r=parseFloat(r);else return r;const t=yD(r,e.target.x),n=yD(r,e.target.y);return`${t}% ${n}%`}},nie={correct:(r,{treeScale:e,projectionDelta:t})=>{const n=r,i=gh.parse(r);if(i.length>5)return n;const s=gh.createTransformer(r),o=typeof i[0]!="number"?1:0,a=t.x.scale*e.x,l=t.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const u=Ci(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),s(i)}};class iie extends ne.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:s}=e;Cee(rie),s&&(t.group&&t.group.add(s),n&&n.register&&i&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),S_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:s}=this.props,o=n.projection;return o&&(o.isPresent=s,i||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Hn.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),YC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function a4(r){const[e,t]=zZ(),n=ne.useContext(zN);return J.jsx(iie,{...r,layoutGroup:n,switchLayoutGroup:ne.useContext(YN),isPresent:e,safeToRemove:t})}const rie={borderRadius:{...Zg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Zg,borderTopRightRadius:Zg,borderBottomLeftRadius:Zg,borderBottomRightRadius:Zg,boxShadow:nie};function sie(r,e,t){const n=vs(r)?r:Ol(r);return n.start(Ab("",n,e,t)),n.animation}function oie(r){return r instanceof SVGElement&&r.tagName!=="svg"}const aie=(r,e)=>r.depth-e.depth;class lie{constructor(){this.children=[],this.isDirty=!1}add(e){ub(this.children,e),this.isDirty=!0}remove(e){cb(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(aie),this.isDirty=!1,this.children.forEach(e)}}function uie(r,e){const t=Vl.now(),n=({timestamp:i})=>{const s=i-t;s>=e&&(nl(n),r(s-e))};return Hn.read(n,!0),()=>nl(n)}const l4=["TopLeft","TopRight","BottomLeft","BottomRight"],cie=l4.length,xD=r=>typeof r=="string"?parseFloat(r):r,_D=r=>typeof r=="number"||qt.test(r);function hie(r,e,t,n,i,s){i?(r.opacity=Ci(0,t.opacity!==void 0?t.opacity:1,fie(n)),r.opacityExit=Ci(e.opacity!==void 0?e.opacity:1,0,die(n))):s&&(r.opacity=Ci(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,n));for(let o=0;o<cie;o++){const a=`border${l4[o]}Radius`;let l=SD(e,a),u=SD(t,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||_D(l)===_D(u)?(r[a]=Math.max(Ci(xD(l),xD(u),n),0),(zl.test(u)||zl.test(l))&&(r[a]+="%")):r[a]=u}(e.rotate||t.rotate)&&(r.rotate=Ci(e.rotate||0,t.rotate||0,n))}function SD(r,e){return r[e]!==void 0?r[e]:r.borderRadius}const fie=u4(0,.5,w3),die=u4(.5,.95,Gs);function u4(r,e,t){return n=>n<r?0:n>e?1:t(ad(r,e,n))}function AD(r,e){r.min=e.min,r.max=e.max}function oa(r,e){AD(r.x,e.x),AD(r.y,e.y)}function ED(r,e){r.translate=e.translate,r.scale=e.scale,r.originPoint=e.originPoint,r.origin=e.origin}function TD(r,e,t,n,i){return r-=e,r=IS(r,1/t,n),i!==void 0&&(r=IS(r,1/i,n)),r}function pie(r,e=0,t=1,n=.5,i,s=r,o=r){if(zl.test(e)&&(e=parseFloat(e),e=Ci(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Ci(s.min,s.max,n);r===s&&(a-=e),r.min=TD(r.min,e,t,a,i),r.max=TD(r.max,e,t,a,i)}function MD(r,e,[t,n,i],s,o){pie(r,e[t],e[n],e[i],e.scale,s,o)}const mie=["x","scaleX","originX"],gie=["y","scaleY","originY"];function wD(r,e,t,n){MD(r.x,e,mie,t?t.x:void 0,n?n.x:void 0),MD(r.y,e,gie,t?t.y:void 0,n?n.y:void 0)}function CD(r){return r.translate===0&&r.scale===1}function c4(r){return CD(r.x)&&CD(r.y)}function bD(r,e){return r.min===e.min&&r.max===e.max}function vie(r,e){return bD(r.x,e.x)&&bD(r.y,e.y)}function RD(r,e){return Math.round(r.min)===Math.round(e.min)&&Math.round(r.max)===Math.round(e.max)}function h4(r,e){return RD(r.x,e.x)&&RD(r.y,e.y)}function ID(r){return Wo(r.x)/Wo(r.y)}function LD(r,e){return r.translate===e.translate&&r.scale===e.scale&&r.originPoint===e.originPoint}class yie{constructor(){this.members=[]}add(e){ub(this.members,e),e.scheduleRender()}remove(e){if(cb(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let n;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function xie(r,e,t){let n="";const i=r.x.translate/e.x,s=r.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((i||s||o)&&(n=`translate3d(${i}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:c,rotateX:h,rotateY:d,skewX:m,skewY:g}=t;u&&(n=`perspective(${u}px) ${n}`),c&&(n+=`rotate(${c}deg) `),h&&(n+=`rotateX(${h}deg) `),d&&(n+=`rotateY(${d}deg) `),m&&(n+=`skewX(${m}deg) `),g&&(n+=`skewY(${g}deg) `)}const a=r.x.scale*e.x,l=r.y.scale*e.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const bf={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},h0=typeof window<"u"&&window.MotionDebug!==void 0,mT=["","X","Y","Z"],_ie={visibility:"hidden"},PD=1e3;let Sie=0;function gT(r,e,t,n){const{latestValues:i}=e;i[r]&&(t[r]=i[r],e.setStaticValue(r,0),n&&(n[r]=0))}function f4(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:e}=r.options;if(!e)return;const t=x3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=r.options;window.MotionCancelOptimisedAnimation(t,"transform",Hn,!(i||s))}const{parent:n}=r;n&&!n.hasCheckedOptimisedAppear&&f4(n)}function d4({attachResizeListener:r,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=Sie++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,h0&&(bf.totalNodes=bf.resolvedTargetDeltas=bf.recalculatedProjection=0),this.nodes.forEach(Tie),this.nodes.forEach(Rie),this.nodes.forEach(Iie),this.nodes.forEach(Mie),h0&&window.MotionDebug.record(bf)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new lie)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new hb),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=oie(o),this.instance=o;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(u||l)&&(this.isLayoutDirty=!0),r){let h;const d=()=>this.root.updateBlockedByResize=!1;r(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=uie(d,250),S_.hasAnimatedSinceResize&&(S_.hasAnimatedSinceResize=!1,this.nodes.forEach(BD))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||c.getDefaultTransition()||Fie,{onLayoutAnimationStart:_,onLayoutAnimationComplete:S}=c.getProps(),T=!this.targetLayout||!h4(this.targetLayout,g)||m,E=!d&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||E||d&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,E);const C={...sb(x,"layout"),onPlay:_,onComplete:S};(c.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else d||BD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,nl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Lie),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&f4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const h=this.path[c];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(DD);return}this.isUpdating||this.nodes.forEach(Cie),this.isUpdating=!1,this.nodes.forEach(bie),this.nodes.forEach(Aie),this.nodes.forEach(Eie),this.clearAllSnapshots();const a=Vl.now();Or.delta=$l(0,1e3/60,a-Or.timestamp),Or.timestamp=a,Or.isProcessing=!0,aT.update.process(Or),aT.preRender.process(Or),aT.render.process(Or),Or.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,YC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(wie),this.sharedNodes.forEach(Pie)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Hn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Hn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$i(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!c4(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;o&&(a||Cf(this.latestValues)||c)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),kie(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return $i();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(Oie))){const{scroll:c}=this.root;c&&(Yp(l.x,c.offset.x),Yp(l.y,c.offset.y))}return l}removeElementScroll(o){var a;const l=$i();if(oa(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:h,options:d}=c;c!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&oa(l,o),Yp(l.x,h.offset.x),Yp(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=$i();oa(l,o);for(let u=0;u<this.path.length;u++){const c=this.path[u];!a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&Jp(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Cf(c.latestValues)&&Jp(l,c.latestValues)}return Cf(this.latestValues)&&Jp(l,this.latestValues),l}removeTransform(o){const a=$i();oa(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Cf(u.latestValues))continue;zM(u.latestValues)&&u.updateSnapshot();const c=$i(),h=u.measurePageBox();oa(c,h),wD(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return Cf(this.latestValues)&&wD(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Or.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=Or.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$i(),this.relativeTargetOrigin=$i(),F0(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),oa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=$i(),this.targetWithTransforms=$i()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Gne(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):oa(this.target,this.layout.layoutBox),r4(this.target,this.targetDelta)):oa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$i(),this.relativeTargetOrigin=$i(),F0(this.relativeTargetOrigin,this.target,m.target),oa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}h0&&bf.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||zM(this.parent.latestValues)||i4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Or.timestamp&&(u=!1),u)return;const{layout:c,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||h))return;oa(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,m=this.treeScale.y;Yne(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=$i());const{target:g}=a;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ED(this.prevProjectionDelta.x,this.projectionDelta.x),ED(this.prevProjectionDelta.y,this.projectionDelta.y)),B0(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==m||!LD(this.projectionDelta.x,this.prevProjectionDelta.x)||!LD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),h0&&bf.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Xp(),this.projectionDelta=Xp(),this.projectionDeltaWithTransform=Xp()}setAnimationOrigin(o,a=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},h=Xp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=$i(),m=l?l.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,_=this.getStack(),S=!_||_.members.length<=1,T=!!(x&&!S&&this.options.crossfade===!0&&!this.path.some(Bie));this.animationProgress=0;let E;this.mixTargetDelta=C=>{const R=C/1e3;FD(h.x,o.x,R),FD(h.y,o.y,R),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(F0(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Die(this.relativeTarget,this.relativeTargetOrigin,d,R),E&&vie(this.relativeTarget,E)&&(this.isProjectionDirty=!1),E||(E=$i()),oa(E,this.relativeTarget)),x&&(this.animationValues=c,hie(c,u,this.latestValues,R,T,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(nl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Hn.update(()=>{S_.hasAnimatedSinceResize=!0,this.currentAnimation=sie(0,PD,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(PD),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:c}=o;if(!(!a||!l||!u)){if(this!==o&&this.layout&&u&&p4(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||$i();const h=Wo(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=Wo(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}oa(a,l),Jp(a,c),B0(this.projectionDeltaWithTransform,this.layoutCorrected,a,c)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new yie),this.sharedNodes.get(o).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const u={};l.z&&gT("z",o,u,this.animationValues);for(let c=0;c<mT.length;c++)gT(`rotate${mT[c]}`,o,u,this.animationValues),gT(`skew${mT[c]}`,o,u,this.animationValues);o.render();for(const c in u)o.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return _ie;const u={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=x_(o==null?void 0:o.pointerEvents)||"",u.transform=c?c(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=x_(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Cf(this.latestValues)&&(x.transform=c?c({},""):"none",this.hasProjected=!1),x}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=xie(this.projectionDeltaWithTransform,this.treeScale,d),c&&(u.transform=c(d,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:u.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in MS){if(d[x]===void 0)continue;const{correct:_,applyTo:S}=MS[x],T=u.transform==="none"?d[x]:_(d[x],h);if(S){const E=S.length;for(let C=0;C<E;C++)u[S[C]]=T}else u[x]=T}return this.options.layoutId&&(u.pointerEvents=h===this?x_(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(DD),this.root.sharedNodes.clear()}}}function Aie(r){r.updateLayout()}function Eie(r){var e;const t=((e=r.resumeFrom)===null||e===void 0?void 0:e.snapshot)||r.snapshot;if(r.isLead()&&r.layout&&t&&r.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=r.layout,{animationType:s}=r.options,o=t.source!==r.layout.source;s==="size"?la(h=>{const d=o?t.measuredBox[h]:t.layoutBox[h],m=Wo(d);d.min=n[h].min,d.max=d.min+m}):p4(s,t.layoutBox,n)&&la(h=>{const d=o?t.measuredBox[h]:t.layoutBox[h],m=Wo(n[h]);d.max=d.min+m,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[h].max=r.relativeTarget[h].min+m)});const a=Xp();B0(a,n,t.layoutBox);const l=Xp();o?B0(l,r.applyTransform(i,!0),t.measuredBox):B0(l,n,t.layoutBox);const u=!c4(a);let c=!1;if(!r.resumeFrom){const h=r.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:m}=h;if(d&&m){const g=$i();F0(g,t.layoutBox,d.layoutBox);const x=$i();F0(x,n,m.layoutBox),h4(g,x)||(c=!0),h.options.layoutRoot&&(r.relativeTarget=x,r.relativeTargetOrigin=g,r.relativeParent=h)}}}r.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeTargetChanged:c})}else if(r.isLead()){const{onExitComplete:n}=r.options;n&&n()}r.options.transition=void 0}function Tie(r){h0&&bf.totalNodes++,r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function Mie(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function wie(r){r.clearSnapshot()}function DD(r){r.clearMeasurements()}function Cie(r){r.isLayoutDirty=!1}function bie(r){const{visualElement:e}=r.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),r.resetTransform()}function BD(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function Rie(r){r.resolveTargetDelta()}function Iie(r){r.calcProjection()}function Lie(r){r.resetSkewAndRotation()}function Pie(r){r.removeLeadSnapshot()}function FD(r,e,t){r.translate=Ci(e.translate,0,t),r.scale=Ci(e.scale,1,t),r.origin=e.origin,r.originPoint=e.originPoint}function kD(r,e,t,n){r.min=Ci(e.min,t.min,n),r.max=Ci(e.max,t.max,n)}function Die(r,e,t,n){kD(r.x,e.x,t.x,n),kD(r.y,e.y,t.y,n)}function Bie(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const Fie={duration:.45,ease:[.4,0,.1,1]},OD=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),UD=OD("applewebkit/")&&!OD("chrome/")?Math.round:Gs;function ND(r){r.min=UD(r.min),r.max=UD(r.max)}function kie(r){ND(r.x),ND(r.y)}function p4(r,e,t){return r==="position"||r==="preserve-aspect"&&!Nne(ID(e),ID(t),.2)}function Oie(r){var e;return r!==r.root&&((e=r.scroll)===null||e===void 0?void 0:e.wasRoot)}const Uie=d4({attachResizeListener:(r,e)=>gv(r,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vT={current:void 0},m4=d4({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!vT.current){const r=new Uie({});r.mount(window),r.setOptions({layoutScroll:!0}),vT.current=r}return vT.current},resetTransform:(r,e)=>{r.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),Nie={pan:{Feature:tie},drag:{Feature:eie,ProjectionNode:m4,MeasureLayout:a4}};function GD(r,e,t){const{props:n}=r;r.animationState&&n.whileHover&&r.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=n[i];s&&Hn.postRender(()=>s(e,Gv(e)))}class Gie extends Ah{mount(){const{current:e}=this.node;e&&(this.unmount=Hee(e,t=>(GD(this.node,t,"Start"),n=>GD(this.node,n,"End"))))}unmount(){}}class Hie extends Ah{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Nv(gv(this.node.current,"focus",()=>this.onFocus()),gv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function HD(r,e,t){const{props:n}=r;r.animationState&&n.whileTap&&r.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=n[i];s&&Hn.postRender(()=>s(e,Gv(e)))}class zie extends Ah{mount(){const{current:e}=this.node;e&&(this.unmount=jee(e,t=>(HD(this.node,t,"Start"),(n,{success:i})=>HD(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const WM=new WeakMap,yT=new WeakMap,Vie=r=>{const e=WM.get(r.target);e&&e(r)},Wie=r=>{r.forEach(Vie)};function jie({root:r,...e}){const t=r||document;yT.has(t)||yT.set(t,{});const n=yT.get(t),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(Wie,{root:r,...e})),n[i]}function Kie(r,e,t){const n=jie(e);return WM.set(r,t),n.observe(r),()=>{WM.delete(r),n.unobserve(r)}}const $ie={some:0,all:1};class Xie extends Ah{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:$ie[i]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:h}=this.node.getProps(),d=u?c:h;d&&d(l)};return Kie(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Yie(e,t))&&this.startObserver()}unmount(){}}function Yie({viewport:r={}},{viewport:e={}}={}){return t=>r[t]!==e[t]}const Jie={inView:{Feature:Xie},tap:{Feature:zie},focus:{Feature:Hie},hover:{Feature:Gie}},qie={layout:{ProjectionNode:m4,MeasureLayout:a4}},jM={current:null},g4={current:!1};function Qie(){if(g4.current=!0,!!VC)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),e=()=>jM.current=r.matches;r.addListener(e),e()}else jM.current=!1}const Zie=[...G3,ds,gh],ere=r=>Zie.find(N3(r)),zD=new WeakMap;function tre(r,e,t){for(const n in e){const i=e[n],s=t[n];if(vs(i))r.addValue(n,i);else if(vs(s))r.addValue(n,Ol(i,{owner:r}));else if(s!==i)if(r.hasValue(n)){const o=r.getValue(n);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=r.getStaticValue(n);r.addValue(n,Ol(o!==void 0?o:i,{owner:r}))}}for(const n in t)e[n]===void 0&&r.removeValue(n);return e}const VD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class nre{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=yb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Vl.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Hn.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:c}=o;this.onUpdate=c,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=kA(t),this.isVariantNode=$N(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in d){const g=d[m];l[m]!==void 0&&vs(g)&&g.set(l[m],!1)}}mount(e){this.current=e,zD.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),g4.current||Qie(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:jM.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){zD.delete(this.current),this.projection&&this.projection.unmount(),nl(this.notifyUpdate),nl(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=md.has(e),i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Hn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in wm){const t=wm[e];if(!t)continue;const{isEnabled:n,Feature:i}=t;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$i()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<VD.length;n++){const i=VD[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=e[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=tre(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=Ol(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(O3(i)||b3(i))?i=parseFloat(i):!ere(i)&&gh.test(t)&&(i=B3(e,t)),this.setBaseTarget(e,vs(i)?i.get():i)),vs(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const o=qC(this.props,n,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(i=o[e])}if(n&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!vs(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new hb),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class v4 extends nre{constructor(){super(...arguments),this.KeyframeResolver=H3}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;vs(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function ire(r){return window.getComputedStyle(r)}class rre extends v4{constructor(){super(...arguments),this.type="html",this.renderInstance=n3}readValueFromInstance(e,t){if(md.has(t)){const n=vb(t);return n&&n.default||0}else{const n=ire(e),i=(ZN(t)?n.getPropertyValue(t):n[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return s4(e,t)}build(e,t,n){eb(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return rb(e,t,n)}}class sre extends v4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$i}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(md.has(t)){const n=vb(t);return n&&n.default||0}return t=i3.has(t)?t:XC(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return o3(e,t,n)}build(e,t,n){tb(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,i){r3(e,t,n,i)}mount(e){this.isSVGTag=ib(e.tagName),super.mount(e)}}const ore=(r,e)=>JC(r)?new sre(e):new rre(e,{allowProjection:r!==ne.Fragment}),are=kee({...Ine,...Jie,...Nie,...qie},ore),LS=qZ(are);function y4(r,e){let t;const n=()=>{const{currentTime:i}=e,o=(i===null?0:i.value)/100;t!==o&&r(o),t=o};return Hn.update(n,!0),()=>nl(n)}const A_=new WeakMap;let eh;function lre(r,e){if(e){const{inlineSize:t,blockSize:n}=e[0];return{width:t,height:n}}else return r instanceof SVGElement&&"getBBox"in r?r.getBBox():{width:r.offsetWidth,height:r.offsetHeight}}function ure({target:r,contentRect:e,borderBoxSize:t}){var n;(n=A_.get(r))===null||n===void 0||n.forEach(i=>{i({target:r,contentSize:e,get size(){return lre(r,t)}})})}function cre(r){r.forEach(ure)}function hre(){typeof ResizeObserver>"u"||(eh=new ResizeObserver(cre))}function fre(r,e){eh||hre();const t=m3(r);return t.forEach(n=>{let i=A_.get(n);i||(i=new Set,A_.set(n,i)),i.add(e),eh==null||eh.observe(n)}),()=>{t.forEach(n=>{const i=A_.get(n);i==null||i.delete(e),i!=null&&i.size||eh==null||eh.unobserve(n)})}}const E_=new Set;let k0;function dre(){k0=()=>{const r={width:window.innerWidth,height:window.innerHeight},e={target:window,size:r,contentSize:r};E_.forEach(t=>t(e))},window.addEventListener("resize",k0)}function pre(r){return E_.add(r),k0||dre(),()=>{E_.delete(r),!E_.size&&k0&&(k0=void 0)}}function mre(r,e){return typeof r=="function"?pre(r):fre(r,e)}const gre=50,WD=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),vre=()=>({time:0,x:WD(),y:WD()}),yre={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function jD(r,e,t,n){const i=t[e],{length:s,position:o}=yre[e],a=i.current,l=t.time;i.current=r[`scroll${o}`],i.scrollLength=r[`scroll${s}`]-r[`client${s}`],i.offset.length=0,i.offset[0]=0,i.offset[1]=i.scrollLength,i.progress=ad(0,i.scrollLength,i.current);const u=n-l;i.velocity=u>gre?0:fb(i.current-a,u)}function xre(r,e,t){jD(r,"x",e,t),jD(r,"y",e,t),e.time=t}function _re(r,e){const t={x:0,y:0};let n=r;for(;n&&n!==e;)if(n instanceof HTMLElement)t.x+=n.offsetLeft,t.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const i=n.getBoundingClientRect();n=n.parentElement;const s=n.getBoundingClientRect();t.x+=i.left-s.left,t.y+=i.top-s.top}else if(n instanceof SVGGraphicsElement){const{x:i,y:s}=n.getBBox();t.x+=i,t.y+=s;let o=null,a=n.parentNode;for(;!o;)a.tagName==="svg"&&(o=a),a=n.parentNode;n=o}else break;return t}const KM={start:0,center:.5,end:1};function KD(r,e,t=0){let n=0;if(r in KM&&(r=KM[r]),typeof r=="string"){const i=parseFloat(r);r.endsWith("px")?n=i:r.endsWith("%")?r=i/100:r.endsWith("vw")?n=i/100*document.documentElement.clientWidth:r.endsWith("vh")?n=i/100*document.documentElement.clientHeight:r=i}return typeof r=="number"&&(n=e*r),t+n}const Sre=[0,0];function Are(r,e,t,n){let i=Array.isArray(r)?r:Sre,s=0,o=0;return typeof r=="number"?i=[r,r]:typeof r=="string"&&(r=r.trim(),r.includes(" ")?i=r.split(" "):i=[r,KM[r]?r:"0"]),s=KD(i[0],t,n),o=KD(i[1],e),s-o}const Ere={All:[[0,0],[1,1]]},Tre={x:0,y:0};function Mre(r){return"getBBox"in r&&r.tagName!=="svg"?r.getBBox():{width:r.clientWidth,height:r.clientHeight}}function wre(r,e,t){const{offset:n=Ere.All}=t,{target:i=r,axis:s="y"}=t,o=s==="y"?"height":"width",a=i!==r?_re(i,r):Tre,l=i===r?{width:r.scrollWidth,height:r.scrollHeight}:Mre(i),u={width:r.clientWidth,height:r.clientHeight};e[s].offset.length=0;let c=!e[s].interpolate;const h=n.length;for(let d=0;d<h;d++){const m=Are(n[d],u[o],l[o],a[s]);!c&&m!==e[s].interpolatorOffsets[d]&&(c=!0),e[s].offset[d]=m}c&&(e[s].interpolate=_b(e[s].offset,X3(n),{clamp:!1}),e[s].interpolatorOffsets=[...e[s].offset]),e[s].progress=$l(0,1,e[s].interpolate(e[s].current))}function Cre(r,e=r,t){if(t.x.targetOffset=0,t.y.targetOffset=0,e!==r){let n=e;for(;n&&n!==r;)t.x.targetOffset+=n.offsetLeft,t.y.targetOffset+=n.offsetTop,n=n.offsetParent}t.x.targetLength=e===r?e.scrollWidth:e.clientWidth,t.y.targetLength=e===r?e.scrollHeight:e.clientHeight,t.x.containerLength=r.clientWidth,t.y.containerLength=r.clientHeight}function bre(r,e,t,n={}){return{measure:()=>Cre(r,n.target,t),update:i=>{xre(r,t,i),(n.offset||n.target)&&wre(r,t,n)},notify:()=>e(t)}}const e0=new WeakMap,$D=new WeakMap,xT=new WeakMap,XD=r=>r===document.documentElement?window:r;function Eb(r,{container:e=document.documentElement,...t}={}){let n=xT.get(e);n||(n=new Set,xT.set(e,n));const i=vre(),s=bre(e,r,i,t);if(n.add(s),!e0.has(e)){const a=()=>{for(const d of n)d.measure()},l=()=>{for(const d of n)d.update(Or.timestamp)},u=()=>{for(const d of n)d.notify()},c=()=>{Hn.read(a,!1,!0),Hn.read(l,!1,!0),Hn.update(u,!1,!0)};e0.set(e,c);const h=XD(e);window.addEventListener("resize",c,{passive:!0}),e!==document.documentElement&&$D.set(e,mre(e,c)),h.addEventListener("scroll",c,{passive:!0})}const o=e0.get(e);return Hn.read(o,!1,!0),()=>{var a;nl(o);const l=xT.get(e);if(!l||(l.delete(s),l.size))return;const u=e0.get(e);e0.delete(e),u&&(XD(e).removeEventListener("scroll",u),(a=$D.get(e))===null||a===void 0||a(),window.removeEventListener("resize",u))}}function Rre({source:r,container:e,axis:t="y"}){r&&(e=r);const n={value:0},i=Eb(s=>{n.value=s[t].progress*100},{container:e,axis:t});return{currentTime:n,cancel:i}}const _T=new Map;function x4({source:r,container:e=document.documentElement,axis:t="y"}={}){r&&(e=r),_T.has(e)||_T.set(e,{});const n=_T.get(e);return n[t]||(n[t]=u3()?new ScrollTimeline({source:e,axis:t}):Rre({source:e,axis:t})),n[t]}function Ire(r){return r.length===2}function _4(r){return r&&(r.target||r.offset)}function Lre(r,e){return Ire(r)||_4(e)?Eb(t=>{r(t[e.axis].progress,t)},e):y4(r,x4(e))}function Pre(r,e){if(r.flatten(),_4(e))return r.pause(),Eb(t=>{r.time=r.duration*t[e.axis].progress},e);{const t=x4(e);return r.attachTimeline?r.attachTimeline(t,n=>(n.pause(),y4(i=>{n.time=n.duration*i},t))):Gs}}function Dre(r,{axis:e="y",...t}={}){const n={axis:e,...t};return typeof r=="function"?Lre(r,n):Pre(r,n)}function YD(r,e){VZ(!!(!e||e.current))}const Bre=()=>({scrollX:Ol(0),scrollY:Ol(0),scrollXProgress:Ol(0),scrollYProgress:Ol(0)});function JD({container:r,target:e,layoutEffect:t=!0,...n}={}){const i=DA(Bre);return(t?WC:ne.useEffect)(()=>(YD("target",e),YD("container",r),Dre((o,{x:a,y:l})=>{i.scrollX.set(a.current),i.scrollXProgress.set(a.progress),i.scrollY.set(l.current),i.scrollYProgress.set(l.progress)},{...n,container:(r==null?void 0:r.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[r,e,JSON.stringify(n.offset)]),i}function Fre(r){const e=DA(()=>Ol(r)),{isStatic:t}=ne.useContext(zC);if(t){const[,n]=ne.useState(r);ne.useEffect(()=>e.on("change",n),[])}return e}function S4(r,e){const t=Fre(e()),n=()=>t.set(e());return n(),WC(()=>{const i=()=>Hn.preRender(n,!1,!0),s=r.map(o=>o.on("change",i));return()=>{s.forEach(o=>o()),nl(n)}}),t}const kre=r=>r&&typeof r=="object"&&r.mix,Ore=r=>kre(r)?r.mix:void 0;function Ure(...r){const e=!Array.isArray(r[0]),t=e?0:-1,n=r[0+t],i=r[1+t],s=r[2+t],o=r[3+t],a=_b(i,s,{mixer:Ore(s[0]),...o});return e?a(n):a}function Nre(r){L0.current=[],r();const e=S4(L0.current,r);return L0.current=void 0,e}function t0(r,e,t,n){if(typeof r=="function")return Nre(r);const i=typeof e=="function"?e:Ure(e,t,n);return Array.isArray(r)?qD(r,i):qD([r],([s])=>i(s))}function qD(r,e){const t=DA(()=>[]);return S4(r,()=>{t.length=0;const n=r.length;for(let i=0;i<n;i++)t[i]=r[i].get();return e(t)})}const Gre=()=>{const r=[{title:"[Publication Title]",authors:"[Authors]",journal:"[Journal/Conference Name]",year:"[Year]",link:"#"}];return J.jsx("section",{id:"publications",className:"min-h-screen py-20 px-4 bg-[#1a1a2e]",children:J.jsxs("div",{className:"max-w-4xl mx-auto",children:[J.jsx("h2",{className:"text-4xl font-bold text-[#4cc9f0] mb-12",children:"Publications"}),J.jsx("div",{className:"space-y-8",children:r.map((e,t)=>J.jsxs(LS.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},transition:{duration:.5},className:"bg-[#252542] p-6 rounded-lg",children:[J.jsx("h3",{className:"text-xl font-bold text-[#7209b7] mb-2",children:e.title}),J.jsx("p",{className:"text-gray-300 mb-2",children:e.authors}),J.jsxs("p",{className:"text-[#4cc9f0]",children:[e.journal,", ",e.year]}),J.jsx("a",{href:e.link,className:"inline-block mt-4 text-white hover:text-[#4cc9f0] transition-colors",children:"Read More →"})]},t))})]})})},Hre=()=>{const r=[{name:"GitHub",url:"#"},{name:"LinkedIn",url:"#"},{name:"Twitter",url:"#"}];return J.jsxs("section",{id:"connect",className:"min-h-screen py-20 px-4 bg-[#1a1a2e] relative",children:[J.jsx("div",{className:"absolute inset-0",children:J.jsxs(em,{children:[J.jsx("ambientLight",{intensity:.5}),J.jsx(fM,{count:100,scale:[10,10,10],size:1,speed:.2,color:"#4cc9f0"})]})}),J.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[J.jsx("h2",{className:"text-4xl font-bold text-[#4cc9f0] mb-12",children:"Let's Connect"}),J.jsxs("div",{className:"bg-[#252542]/80 p-8 rounded-lg backdrop-blur-lg",children:[J.jsx("p",{className:"text-white text-lg mb-8",children:"[Your inviting message to connect]"}),J.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-2xl font-bold text-[#7209b7] mb-4",children:"Social Links"}),J.jsx("div",{className:"space-y-4",children:r.map((e,t)=>J.jsx(LS.a,{href:e.url,whileHover:{scale:1.05},className:"block p-4 bg-[#1a1a2e] rounded-lg text-white hover:text-[#4cc9f0] transition-colors",children:e.name},t))})]}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-2xl font-bold text-[#7209b7] mb-4",children:"Contact Form"}),J.jsxs("form",{className:"space-y-4",children:[J.jsx("input",{type:"email",placeholder:"Your Email",className:"w-full p-3 bg-[#1a1a2e] rounded-lg text-white"}),J.jsx("textarea",{placeholder:"Your Message",rows:4,className:"w-full p-3 bg-[#1a1a2e] rounded-lg text-white"}),J.jsx("button",{type:"submit",className:"w-full p-3 bg-[#7209b7] text-white rounded-lg hover:bg-[#4cc9f0] transition-colors",children:"Send Message"})]})]})]})]})]})]})};var $M=new Map,t_=new WeakMap,QD=0,zre=void 0;function Vre(r){return r?(t_.has(r)||(QD+=1,t_.set(r,QD.toString())),t_.get(r)):"0"}function Wre(r){return Object.keys(r).sort().filter(e=>r[e]!==void 0).map(e=>`${e}_${e==="root"?Vre(r.root):r[e]}`).toString()}function jre(r){const e=Wre(r);let t=$M.get(e);if(!t){const n=new Map;let i;const s=new IntersectionObserver(o=>{o.forEach(a=>{var l;const u=a.isIntersecting&&i.some(c=>a.intersectionRatio>=c);r.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=u),(l=n.get(a.target))==null||l.forEach(c=>{c(u,a)})})},r);i=s.thresholds||(Array.isArray(r.threshold)?r.threshold:[r.threshold||0]),t={id:e,observer:s,elements:n},$M.set(e,t)}return t}function Kre(r,e,t={},n=zre){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const l=r.getBoundingClientRect();return e(n,{isIntersecting:n,target:r,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:i,observer:s,elements:o}=jre(t),a=o.get(r)||[];return o.has(r)||o.set(r,a),a.push(e),s.observe(r),function(){a.splice(a.indexOf(e),1),a.length===0&&(o.delete(r),s.unobserve(r)),o.size===0&&(s.disconnect(),$M.delete(i))}}function ZD({threshold:r,delay:e,trackVisibility:t,rootMargin:n,root:i,triggerOnce:s,skip:o,initialInView:a,fallbackInView:l,onChange:u}={}){var c;const[h,d]=ne.useState(null),m=ne.useRef(u),[g,x]=ne.useState({inView:!!a,entry:void 0});m.current=u,ne.useEffect(()=>{if(o||!h)return;let E;return E=Kre(h,(C,R)=>{x({inView:C,entry:R}),m.current&&m.current(C,R),R.isIntersecting&&s&&E&&(E(),E=void 0)},{root:i,rootMargin:n,threshold:r,trackVisibility:t,delay:e},l),()=>{E&&E()}},[Array.isArray(r)?r.toString():r,h,i,n,s,o,t,l,e]);const _=(c=g.entry)==null?void 0:c.target,S=ne.useRef(void 0);!h&&_&&!s&&!o&&S.current!==_&&(S.current=_,x({inView:!!a,entry:void 0}));const T=[d,g.inView,g.entry];return T.ref=T[0],T.inView=T[1],T.entry=T[2],T}var A4={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},eB=Vu.createContext&&Vu.createContext(A4),$re=["attr","size","title"];function Xre(r,e){if(r==null)return{};var t=Yre(r,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function Yre(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function PS(){return PS=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},PS.apply(this,arguments)}function tB(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function DS(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?tB(Object(t),!0).forEach(function(n){Jre(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):tB(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Jre(r,e,t){return e=qre(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function qre(r){var e=Qre(r,"string");return typeof e=="symbol"?e:e+""}function Qre(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function E4(r){return r&&r.map((e,t)=>Vu.createElement(e.tag,DS({key:t},e.attr),E4(e.child)))}function T4(r){return e=>Vu.createElement(Zre,PS({attr:DS({},r.attr)},e),E4(r.child))}function Zre(r){var e=t=>{var{attr:n,size:i,title:s}=r,o=Xre(r,$re),a=i||t.size||"1em",l;return t.className&&(l=t.className),r.className&&(l=(l?l+" ":"")+r.className),Vu.createElement("svg",PS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,o,{className:l,style:DS(DS({color:r.color||t.color},t.style),r.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&Vu.createElement("title",null,s),r.children)};return eB!==void 0?Vu.createElement(eB.Consumer,null,t=>e(t)):e(A4)}function ese(r){return T4({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"},child:[]}]})(r)}function tse(r){return T4({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"},child:[]}]})(r)}const nse=()=>J.jsxs("div",{className:"w-64 md:w-80 bg-[#121212] text-white p-6 rounded-xl shadow-2xl",children:[J.jsx("h3",{className:"text-2xl font-bold mb-4 border-b-2 border-[#fa233b] pb-2",children:"Music"}),J.jsx("p",{className:"text-sm mb-6",children:"I listen to music constantly—beats fuel my creativity."}),J.jsxs("div",{className:"flex space-x-4 mb-6",children:[J.jsx("a",{href:"https://open.spotify.com/user/z49xhylh3jqjx48hyjtu9j51p?si=ac1ea297eab94a5d",target:"_blank",rel:"noopener noreferrer",className:"hover:text-green-400 transition",children:J.jsx(tse,{size:24})}),J.jsx("a",{href:"https://music.apple.com/profile/pradyundevarakonda24",target:"_blank",rel:"noopener noreferrer",className:"hover:text-[#fa233b] transition",children:J.jsx(ese,{size:24})})]}),J.jsx("div",{className:"rounded-md overflow-hidden border border-[#fa233b]",children:J.jsx("iframe",{title:"Apple Music Playlist: Musical Marathon",allow:"autoplay *; encrypted-media *;",frameBorder:"0",height:"200",style:{width:"100%",overflow:"hidden",background:"transparent"},sandbox:"allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation",src:"https://embed.music.apple.com/in/playlist/musical-marathon/pl.u-jV890ggFDNGNYdl"})})]});oc.preload("/Pradyunuydarp/models/rocks_vinyl.glb");function ise({scrollProgress:r}){const e=ne.useRef(),{scene:t}=oc("/Pradyunuydarp/models/rocks_vinyl.glb"),n=[Math.PI/2,0,0];return ne.useEffect(()=>{e.current&&e.current.rotation.set(...n)},[]),_h(()=>{const i=r.get();e.current.rotation.y=n[1]+i*Math.PI*1.5,e.current.position.y=Math.sin(i*Math.PI*2)*.5}),t.traverse(i=>{i.isMesh&&(i.material.metalness=.8,i.material.roughness=.1)}),J.jsx("group",{ref:e,scale:1.2,children:J.jsx("primitive",{object:t})})}const rse=()=>{const r=ne.useRef();_h((n,i)=>{r.current.rotation.y+=i*.1,r.current.rotation.x=Math.sin(n.clock.elapsedTime)*.1});const e=[[-.6,0,0],[.6,0,0],[0,.8,.2]],t=[[0,1],[1,2],[2,0]];return J.jsxs("group",{ref:r,scale:2,children:[e.map((n,i)=>J.jsx(KJ,{speed:1,floatIntensity:.2,rotationIntensity:.1,children:J.jsxs("mesh",{position:n,children:[J.jsx("sphereGeometry",{args:[.12,32,32]}),J.jsx("meshStandardMaterial",{color:"#D4AF37",metalness:.9,roughness:.1})]})},i)),t.map(([n,i],s)=>J.jsx(cK,{points:[e[n],e[i]],lineWidth:1,color:"#D4AF37"},s))]})};oc.preload("/Pradyunuydarp/models/son_goku_and_kintoun_nimbus.glb");const sse=()=>{const r=ne.useRef(),{scene:e}=oc("/Pradyunuydarp/models/son_goku_and_kintoun_nimbus.glb");return e.traverse(t=>t.isMesh&&(t.material.ior=1.5)),J.jsx("primitive",{ref:r,object:e,scale:3})},ose=()=>{const r=ne.useRef(),{scrollYProgress:e}=JD({target:r,offset:["start end","end start"]}),t=t0(e,[.3,.6],[0,.8]),n=ne.useRef(),{scrollYProgress:i}=JD({target:n,offset:["start end","end start"]}),s=t0(i,[0,1],["-100%","100%"]),o=t0(i,[0,.5,1],["0%","-20%","50%"]),a=t0(i,[0,1],[Math.PI,0]);return t0(i,[.8,.9],[0,1]),ZD({triggerOnce:!0,threshold:.2}),ZD({threshold:.4}),J.jsxs("main",{ref:r,className:"bg-gradient-to-b from-[#1A1A1A] to-[#2D2D2D]",children:[J.jsx("section",{className:"min-h-screen flex items-center justify-center overflow-hidden",children:J.jsxs("div",{className:"container mx-auto flex flex-col md:flex-row items-center px-6",children:[J.jsxs(LS.div,{className:"md:w-1/2 md:pr-12",initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:1,ease:"easeOut"},children:[J.jsx("h2",{className:"text-5xl font-bold mb-6 bg-gradient-to-r from-[#D4AF37] to-[#FFD700] bg-clip-text text-transparent",children:"Algorithmic Artistry"}),J.jsx("p",{className:"text-[#E5E5E5] text-lg leading-relaxed",children:"Transforming complex computational concepts into elegant visual experiences."})]}),J.jsx("div",{className:"md:w-1/2 h-[60vh] mt-12 md:mt-0",children:J.jsxs(em,{children:[J.jsx("ambientLight",{intensity:.4}),J.jsx("spotLight",{position:[5,10,5],angle:.3,penumbra:1,intensity:1,color:"#FFD700"}),J.jsx(ne.Suspense,{fallback:null,children:J.jsx(rse,{})}),J.jsx(E0,{enableZoom:!1,enablePan:!1})]})})]})}),J.jsxs("section",{className:"h-screen sticky top-0 overflow-hidden relative",children:[J.jsxs(em,{className:"absolute inset-0 transform -translate-x-8",children:[J.jsx("ambientLight",{intensity:1}),J.jsx("spotLight",{position:[0,3,2],angle:.5,penumbra:.8,intensity:150,color:"#FFA500",castShadow:!0}),J.jsxs(ne.Suspense,{fallback:null,children:[J.jsx(ise,{scrollProgress:t}),J.jsx(VL,{position:[0,.2,1.5],fontSize:.3,maxWidth:4,lineHeight:1.2,textAlign:"center",color:"#ffffff",anchorX:"center",anchorY:"middle"}),J.jsx(VL,{position:[0,-.3,1.5],fontSize:.15,maxWidth:3.5,textAlign:"center",color:"#E5E5E5"})]}),J.jsx(E0,{enableZoom:!1,enablePan:!1})]}),J.jsx("div",{className:"absolute top-1/2 right-12 transform -translate-y-1/2 z-10",children:J.jsx(nse,{})})]}),J.jsxs("section",{ref:n,className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-[#2D2D2D] to-[#1A1A1A]",children:[J.jsxs("div",{className:"absolute top-1/2 right-12 transform -translate-y-1/2 z-10 max-w-md",children:[J.jsx("h2",{className:"text-4xl font-bold mb-4 text-white",children:"Visual Storytelling"}),J.jsx("p",{className:"text-lg text-gray-300 leading-relaxed",children:"Journey through narratives that inspire innovation. Watch as Goku soars below this text, symbolizing the limitless possibilities when creativity meets technology."})]}),J.jsx(LS.div,{style:{x:s,y:o,rotateY:a},className:"absolute w-1/4 h-1/4 top-0 left-0 transform",children:J.jsxs(em,{children:[J.jsx("ambientLight",{intensity:.5}),J.jsx("spotLight",{position:[10,10,10],angle:.2,penumbra:1,intensity:1}),J.jsx(ne.Suspense,{fallback:null,children:J.jsx(sse,{})}),J.jsx(E0,{enableZoom:!1,enablePan:!1})]})})]})]})};class Hv{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const ase=()=>{if(!(typeof localStorage>"u"))return{get:r=>Promise.resolve(localStorage.getItem(r)),set:(r,e)=>Promise.resolve(localStorage.setItem(r,e)),remove:r=>Promise.resolve(localStorage.removeItem(r))}},es={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:ase()},Tb=r=>r?typeof r=="string"?{publicKey:r}:r.toString()==="[object Object]"?r:{}:{},lse=(r,e="https://api.emailjs.com")=>{if(!r)return;const t=Tb(r);es.publicKey=t.publicKey,es.blockHeadless=t.blockHeadless,es.storageProvider=t.storageProvider,es.blockList=t.blockList,es.limitRate=t.limitRate,es.origin=t.origin||e},M4=async(r,e,t={})=>{const n=await fetch(es.origin+r,{method:"POST",headers:t,body:e}),i=await n.text(),s=new Hv(n.status,i);if(n.ok)return s;throw s},w4=(r,e,t)=>{if(!r||typeof r!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},use=r=>{if(r&&r.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},C4=r=>r.webdriver||!r.languages||r.languages.length===0,b4=()=>new Hv(451,"Unavailable For Headless Browser"),cse=(r,e)=>{if(!Array.isArray(r))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},hse=r=>{var e;return!((e=r.list)!=null&&e.length)||!r.watchVariable},fse=(r,e)=>r instanceof FormData?r.get(e):r[e],R4=(r,e)=>{if(hse(r))return!1;cse(r.list,r.watchVariable);const t=fse(e,r.watchVariable);return typeof t!="string"?!1:r.list.includes(t)},I4=()=>new Hv(403,"Forbidden"),dse=(r,e)=>{if(typeof r!="number"||r<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},pse=async(r,e,t)=>{const n=Number(await t.get(r)||0);return e-Date.now()+n},L4=async(r,e,t)=>{if(!e.throttle||!t)return!1;dse(e.throttle,e.id);const n=e.id||r;return await pse(n,e.throttle,t)>0?!0:(await t.set(n,Date.now().toString()),!1)},P4=()=>new Hv(429,"Too Many Requests"),mse=async(r,e,t,n)=>{const i=Tb(n),s=i.publicKey||es.publicKey,o=i.blockHeadless||es.blockHeadless,a=i.storageProvider||es.storageProvider,l={...es.blockList,...i.blockList},u={...es.limitRate,...i.limitRate};return o&&C4(navigator)?Promise.reject(b4()):(w4(s,r,e),use(t),t&&R4(l,t)?Promise.reject(I4()):await L4(location.pathname,u,a)?Promise.reject(P4()):M4("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:r,template_id:e,template_params:t}),{"Content-type":"application/json"}))},gse=r=>{if(!r||r.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},vse=r=>typeof r=="string"?document.querySelector(r):r,yse=async(r,e,t,n)=>{const i=Tb(n),s=i.publicKey||es.publicKey,o=i.blockHeadless||es.blockHeadless,a=es.storageProvider||i.storageProvider,l={...es.blockList,...i.blockList},u={...es.limitRate,...i.limitRate};if(o&&C4(navigator))return Promise.reject(b4());const c=vse(t);w4(s,r,e),gse(c);const h=new FormData(c);return R4(l,h)?Promise.reject(I4()):await L4(location.pathname,u,a)?Promise.reject(P4()):(h.append("lib_version","4.4.1"),h.append("service_id",r),h.append("template_id",e),h.append("user_id",s),M4("/api/v1.0/email/send-form",h))},xse={init:lse,send:mse,sendForm:yse,EmailJSResponseStatus:Hv},_se=()=>{const[r,e]=ne.useState({show:!1,text:"",type:"danger"});return{alert:r,showAlert:({text:i,type:s="danger"})=>e({show:!0,text:i,type:s}),hideAlert:()=>e({show:!1,text:"",type:"danger"})}},Sse=({type:r,text:e})=>J.jsx("div",{className:"fixed bottom-5 right-5 flex justify-center items-center z-50",children:J.jsxs("div",{className:`p-2 ${r==="danger"?"bg-red-800":"bg-blue-800"} items-center text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex rounded-md p-5`,role:"alert",children:[J.jsx("p",{className:`flex rounded-full ${r==="danger"?"bg-red-500":"bg-blue-500"} uppercase px-2 py-1 text-xs font-semibold mr-3`,children:r==="danger"?"Failed":"Success"}),J.jsx("p",{className:"mr-2 text-left",children:e})]})}),D4=()=>J.jsxs("footer",{className:"c-space pt-7 pb-3 border-t border-black-300 flex justify-between items-center flex-wrap gap-5",children:[J.jsxs("div",{className:"flex gap-3",children:[J.jsxs("div",{className:"social-icon",children:[J.jsx("img",{src:"assets/github.svg",alt:"github",className:"w-1/2 h-1/2"}),J.jsx("a",{href:"https://github.com/pradyunuydarp",target:"_blank",rel:"noreferrer"})]}),J.jsx("div",{className:"social-icon",children:J.jsx("img",{src:"assets/twitter.svg",alt:"twitter",className:"w-1/2 h-1/2"})}),J.jsxs("div",{className:"social-icon",children:[J.jsx("img",{src:"assets/instagram.svg",alt:"instagram",className:"w-1/2 h-1/2"}),J.jsx("a",{href:"https://instagram.com/pradyunuydarp",target:"_blank",rel:"noreferrer"})]})]}),J.jsx("p",{className:"text-white-500",children:"© 2025 Pradyun Devarakonda. All rights reserved."})]}),Ase=()=>{const r=ne.useRef(),{alert:e,showAlert:t,hideAlert:n}=_se(),[i,s]=ne.useState(!1),[o,a]=ne.useState({name:"",email:"",message:""}),l=({target:{name:c,value:h}})=>{a({...o,[c]:h})},u=c=>{c.preventDefault(),s(!0),xse.send(void 0,void 0,{from_name:o.name,to_name:"JavaScript Mastery",from_email:o.email,to_email:"sujata@jsmastery.pro",message:o.message},void 0).then(()=>{s(!1),t({show:!0,text:"Thank you for your message 😃",type:"success"}),setTimeout(()=>{n(!1),a({name:"",email:"",message:""})},[3e3])},h=>{s(!1),console.error(h),t({show:!0,text:"I didn't receive your message 😢",type:"danger"})})};return J.jsxs("section",{className:"c-space my-20",id:"contact",children:[e.show&&J.jsx(Sse,{...e}),J.jsx("div",{className:"relative min-h-screen flex items-center justify-center flex-col",children:J.jsxs("div",{className:"contact-container",children:[J.jsx("h3",{className:"head-text",children:"Let's talk"}),J.jsx("p",{className:"text-lg text-white-600 mt-3",children:"Whether you’re looking to build a new website, improve your existing platform, or bring a unique project to life, I’m here to help."}),J.jsxs("form",{ref:r,onSubmit:u,className:"mt-12 flex flex-col space-y-7",children:[J.jsxs("label",{className:"space-y-3",children:[J.jsx("span",{className:"field-label",children:"Full Name"}),J.jsx("input",{type:"text",name:"name",value:o.name,onChange:l,required:!0,className:"field-input",placeholder:"ex., John Doe"})]}),J.jsxs("label",{className:"space-y-3",children:[J.jsx("span",{className:"field-label",children:"Email address"}),J.jsx("input",{type:"email",name:"email",value:o.email,onChange:l,required:!0,className:"field-input",placeholder:"ex., johndoe@gmail.com"})]}),J.jsxs("label",{className:"space-y-3",children:[J.jsx("span",{className:"field-label",children:"Your message"}),J.jsx("textarea",{name:"message",value:o.message,onChange:l,required:!0,rows:5,className:"field-input",placeholder:"Share your thoughts or inquiries..."})]}),J.jsxs("button",{className:"field-btn",type:"submit",disabled:i,children:[i?"Sending...":"Send Message",J.jsx("img",{src:"assets/arrow-up.png",alt:"arrow-up",className:"field-btn_arrow"})]})]})]})}),J.jsx(D4,{})]})},Ese=()=>J.jsxs(cQ,{children:[J.jsx(SQ,{}),J.jsx("main",{className:"bg-[#1a1a2e] pt-20 min-h-screen",children:J.jsxs(Gq,{children:[J.jsx(o0,{path:"/",element:J.jsxs(J.Fragment,{children:[J.jsx(EQ,{}),J.jsx(HZ,{}),J.jsx(Gre,{}),J.jsx(D4,{})]})}),J.jsx(o0,{path:"/about",element:J.jsx(ose,{})}),J.jsx(o0,{path:"/connect",element:J.jsx(Hre,{})}),J.jsx(o0,{path:"/contact",element:J.jsx(Ase,{})})]})})]});iB.createRoot(document.getElementById("root")).render(J.jsx(ne.StrictMode,{children:J.jsx(Ese,{})}));
